// ==UserScript==
// @name         Pepper product cards filter
// @description  Hide product cards by filter
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.pepper.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.75517818
// @icon         https://www.google.com/s2/favicons?sz=64&domain=pepper.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/pepper.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var B={5467:(F,s,n)=>{n.d(s,{E2:()=>m});var a=n(9928);function m(N,i={},t=null){const r=(0,a.Sw)(i,t);return r.append(N),r}function f(N,i=null,t={},r={}){const v=createActionLink(N,i,r);return m(v,t)}function l(N,i=null,t=null,r={},v={}){const w=createActionLinkWithIcon(N,t,i,v);return m(w,r)}},9928:(F,s,n)=>{n.d(s,{S:()=>N,Sw:()=>k,kU:()=>f,o5:()=>l});var a=n(4921),m=n(5539);function f(d,u,x){const p=i(d,"text",u);return p.value=x,p}function l(d,u,x,p,D,P){const A=i(d,"number",u);return A.value=x,A.step=p,A.min=D,A.max=P,A}function N(d,u,x){const p=i(d,"checkbox",u);return p.checked=x,p}function i(d={},u=null,x=null){const p=C("input",d);return u&&(p.type=u),x&&(p.addEventListener("keyup",(0,a.sg)(x,200)),p.addEventListener("change",(0,a.sg)(x,100))),p}function t(d={},u=null){return C("span",d,u)}function r(d={},u=null,x=null){const p=C("a",d,u);return x&&(p.href=x),p}function v(d,u=null,x={}){x.cursor||="pointer";const p=r(x,u);return d&&p.addEventListener("click",d),p}function w(d,u,x=null,p={},D={}){p.display||="inline-flex",p.alignItems||="center",p.gap||="0.25em";const P=v(d,x,p);return P.prepend(c(u,D)),P}function S(d={},u=null,x=null){const p=C("button",d,u);return x&&p.addEventListener("click",x),p}function k(d={},u=null){return C("div",d,u)}function y(d={}){return C("i",d)}function c(d,u={}){u.width||="1em",u.height||="1em",u.paddingBottom||="1px";const x=y(u);return x.setAttribute("data-lucide",d),x}function C(d,u,x=null){if(typeof u!="object"||u===null)throw new TypeError("styles should be an object");const p=document.createElement(d);return(0,m.ZM)(p,u),x&&(p.innerHTML=x),p}},573:(F,s,n)=>{n.d(s,{Fi:()=>f,YA:()=>t,fI:()=>l});var a=n(4214);function m(c,C=document){return!!C.querySelector(c)}function f(c,C=document,d=!1){const u=C.querySelector(c);return d&&!u&&console.log(`No element found for selector: ${c}`),u}function l(c,C=document,d=!1){const u=C.querySelectorAll(c);return d&&!u.length&&console.log(`No elements found for selector: ${c}`),u}function N(c,C,d){return[...c.querySelectorAll(C)].find(u=>u.textContent.trim().includes(d))}function i(c,C,d=!1,u=!1,x=null){const p=f(C,c);return t(p,d,u,x)}function t(c,C=!1,d=!1,u=null){if(!c)return u===null?(console.log("No element found"),null):u;const x=c.innerText;return w(x,C,d)}function r(c,C,d=!1){const u=c[C];return t(u,d)}function v(c,C=!1,d=!1){const u=c.textContent;return w(u,C,d)}function w(c,C,d){C&&(c=(0,a.zr)(c)),d&&(c=c.replace(",","."));const u=Number(c);return Number.isNaN(u)?(console.log(`Invalid number: ${c}`),0):u}function S(c){return[...c.childNodes].find(C=>C.nodeType===Node.TEXT_NODE)}function k(c){const C=d=>d.nodeType===Node.TEXT_NODE&&d.textContent.trim()!==""?[d]:[...d.childNodes].flatMap(C);return C(c)}function y(c){return normalizeSpacing(c.textContent)}},5539:(F,s,n)=>{n.d(s,{D9:()=>c,ZM:()=>b,iV:()=>d,vJ:()=>C});function a(e,o){e.parentNode.insertBefore(o,e.nextSibling)}function m(e){e.style.display="none"}function f(e){w(e),m(e)}function l(e){e.intersectionObserver||runOnceOnIntersection(e,()=>m(e))}function N(e){e.style.display=""}function i(e){const o=v(e);e.style.display=o}function t(e,o){o?m(e):N(e)}function r(e,o){o?l(e):(clearIntersectionObserver(e),N(e))}function v(e){return w(e),e.defaultDisplay}function w(e){if(e.defaultDisplay)return;const{display:o}=getComputedStyle(e);e.defaultDisplay=o}function S(){return{show:[],hide:[]}}function k(e,o,E){e?o.hide.push(E):o.show.push(E)}function y(e){e.show.forEach(N),e.hide.forEach(m)}function c(e,o,E=.3){o?d(e,E):C(e)}function C(e){e.style.opacity=""}function d(e,o=.3){e.style.opacity=o}function u(e){e.style.order=""}function x(e,o){e.style.order=o}function p(e,o){e.style.background=o}function D(e,o){const E=getFirstElement(o);if(!E)return;const I=createLink();I.href=e,E.parentNode.append(I),I.append(E)}function P(e,o){const E=getFirstElement(o);E&&A(e,E)}function A(e,o){const E=createLink();E.href=e,E.append(...o.childNodes),o.append(E)}function h(){const e=getURLQueryParam("scrollTo");if(!e)return;const o=document.getElementById(e);o?o.scrollIntoView():console.log(`Element with ID "${e}" was not found.`)}function g(e,o="custom-global-style"){let E=document.getElementById(o);E||(E=document.createElement("style"),E.id=o,E.type="text/css",document.head.appendChild(E)),E.textContent=e}function b(e,o){Object.assign(e.style,o)}function T(e){return Object.entries(e).map(([o,E])=>`${o.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${E};`).join(" ")}function V(e){return e?e.split(";").filter(o=>o.trim()!=="").reduce((o,E)=>{const[I,L]=E.split(":").map(U=>U.trim()),R=I.replace(/-([a-z])/g,(U,$)=>$.toUpperCase());return o[R]=L,o},{}):{}}function H(e,o,E="text/plain"){const I=new Blob([e],{type:E}),L=URL.createObjectURL(I),R=document.createElement("a");R.href=L,R.download=o,document.body.appendChild(R),R.click(),document.body.removeChild(R),requestAnimationFrame(()=>URL.revokeObjectURL(L))}},4921:(F,s,n)=>{n.d(s,{sg:()=>l});function a(t,r,v=null){const w=t.querySelector(r);return w?Promise.resolve(w):new Promise(S=>{const k=new MutationObserver(c);k.observe(t,{childList:!0,subtree:!0});let y;v&&(y=setTimeout(()=>{k.disconnect(),console.log(`No element found for selector: ${r}`),S(null)},v));function c(){const C=t.querySelector(r);C&&(y&&clearTimeout(y),k.disconnect(),S(C))}})}function m(t,r){return t.querySelector(r)?new Promise(w=>{const S=new MutationObserver(k);S.observe(t,{childList:!0,subtree:!0});function k(){t.querySelector(r)||(S.disconnect(),w())}}):Promise.resolve()}function f(t,r=400){return new Promise(v=>{let w;const S=new MutationObserver(()=>{clearTimeout(w),k()});function k(){w=setTimeout(()=>{S.disconnect(),v()},r)}k(),S.observe(t,{childList:!0,subtree:!0})})}function l(t,r=250){let v;return(...w)=>{clearTimeout(v),v=setTimeout(()=>t(...w),r)}}function N(t,r){const v=new IntersectionObserver(w=>{w.forEach(S=>{S.isIntersecting&&(r(),i(t))})});t.intersectionObserver=v,v.observe(t)}function i(t){t.intersectionObserver&&(t.intersectionObserver.disconnect(),t.intersectionObserver=null)}},3829:(F,s,n)=>{n.d(s,{Ay:()=>m,JE:()=>l,iG:()=>N});var a=n(8355);function m(t,r){return!f(t,r)}function f(t,r){if(!r.value)return!0;const v=t.toLowerCase(),w=(0,a.R)(r),S=[],k=[];return w.forEach(y=>{if(y.startsWith("!")){const c=y.substring(1);c&&k.push(c)}else S.push(y)}),S.every(y=>v.includes(y))&&k.every(y=>!v.includes(y))}function l(t,r){return r.value!=null&&t<r.value}function N(t,r){return r.value!=null&&t>r.value}function i(t,r){return r.value&&t!==r.value}},4521:(F,s,n)=>{n.d(s,{z:()=>m});var a=n(3048);function m(f,l=null){return{createGlobalFilter(N,i=null,t=f){return a.V.create(N,i,t)},createSectionFilter(N,i=null,t=f){if(!l)throw new Error("sectionId must be provided to use createSectionFilter.");return a.V.createWithCompositeKey(l,N,i,t)}}}},5884:(F,s,n)=>{n.d(s,{Hw:()=>N,Nm:()=>f,nW:()=>l});var a=n(9928),m=n(5467);function f(i,t,r={},v={}){const w=(0,a.kU)(v,t.updateValueFromEvent,t.value);return(0,m.E2)(w,r,i)}function l(i,t,r,v,w,S={},k={}){const y=(0,a.o5)(k,t.updateValueFromEvent,t.value,r,v,w);return(0,m.E2)(y,S,i)}function N(i,t,r={},v={}){const w=(0,a.S)(v,t.updateValueFromEvent,t.value);return(0,m.E2)(w,r,i)}},7877:(F,s,n)=>{n.d(s,{E9:()=>m,H1:()=>y,pW:()=>A});var a=n(5884);function m(h,g={},b={}){return(0,a.Nm)("\u041F\u043E\u0438\u0441\u043A: ",h,g,b)}function f(h,g={},b={},T=.1,V=3){return createNumberFilterControl("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",h,T,V,5,g,b)}function l(h,g={},b={},T=.1,V=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",h,T,V,5,g,b)}function N(h,g={},b={}){return t("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",h,g,b)}function i(h,g={},b={}){return t("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",h,g,b)}function t(h,g,b={},T={}){return createNumberFilterControl(h,g,"1","1","999999",b,T)}function r(h,g={},b={}){return v("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",h,g,b)}function v(h,g,b={},T={}){return createNumberFilterControl(h,g,"5","0","100",b,T)}function w(h,g={},b={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",h,"5","0","100",g,b)}function S(h,g,b={},T={},V="250"){return(0,a.nW)(h,g,V,"0","1000000",b,T)}function k(h,g={},b={},T="25"){return S("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",h,g,b,T)}function y(h,g={},b={},T="25"){return S("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",h,g,b,T)}function c(h,g={},b={}){return C("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",h,g,b)}function C(h,g,b={},T={}){return createNumberFilterControl(h,g,"1","0","99999",b,T)}function d(h,g={},b={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",h,"1","2","7",g,b)}function u(h,g={},b={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",h,1,1,10,g,b)}function x(h,g={},b={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",h,g,b)}function p(h,g={},b={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",h,g,b)}function D(h,g={},b={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",h,g,b)}function P(h,g={},b={}){return createCheckboxFilterControl("\u0411\u0430\u043B\u043B\u044B: ",h,g,b)}function A(h,g={},b={}){return(0,a.Hw)("\u0412\u043A\u043B: ",h,g,b)}},8355:(F,s,n)=>{n.d(s,{R:()=>a});function a(f){return f.value.toLowerCase().split(",").map(l=>l.trim()).filter(l=>l!=="")}function m(f){return a(f).filter(l=>!l.startsWith("!"))}},5213:(F,s,n)=>{n.d(s,{b:()=>f});var a=n(9928),m=n(573);function f(l,N,i=!1,t="customFiltersContainer"){let r=(0,m.Fi)(`#${t}`,l);if(r)if(i)r.remove();else return;r=(0,a.Sw)(),r.id=t,N(r,l)}},8200:(F,s,n)=>{n.d(s,{s:()=>a});function a(m){const{target:f}=m,{type:l}=f;switch(l){case"text":return`"${f.value}"`;case"number":return f.value;case"checkbox":return f.checked;default:return console.log(`Unknown input type: ${l}`),null}}},157:(F,s,n)=>{n.d(s,{Fg:()=>a,vx:()=>f});const a=window.GM_setValue,m=window.GM.setValue,f=window.GM_getValue,l=window.GM_addValueChangeListener},1870:(F,s,n)=>{n.d(s,{j:()=>a});class a{constructor(f,l){this.value=f,this.onChange=l}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(F,s,n)=>{n.d(s,{V:()=>N});var a=n(1870),m=n(8200),f=n(3976),l=n(157);class N extends a.j{constructor(t,r=null,v=null){super((0,l.vx)(t,r),v),this.storageKey=t,this.defaultValue=r}static create(t,r=null,v=null){return new N(t,r,v)}static createWithCompositeKey(t,r,v=null,w=null){const S=`${t}-${r}`;return new N(S,v,w)}updateValueFromEvent=t=>{const r=(0,m.s)(t),v=(0,f.$)(r);this.updateValue(v)};updateValue(t,r=!0){this.value!==t&&((0,l.Fg)(this.storageKey,t),this.value=t,r&&this.onChangeIfDefined())}clearValue(t=!1){this.updateValue(null,t)}resetValue(t=!1){this.updateValue(this.defaultValue,t)}}},3976:(F,s,n)=>{n.d(s,{$:()=>a});function a(m){return m===""?null:JSON.parse(m)}},4214:(F,s,n)=>{n.d(s,{zr:()=>m});function a(i){return i.replace(/\D/g,"")}function m(i){return i.replace(/[^\d.,-]/g,"")}function f(i){return i.replace(/\s/g,"")}function l(i){return i.charAt(0).toUpperCase()+i.slice(1)}function N(i){return i.replace(/\s+/g," ").trim()}},1365:(F,s,n)=>{n.d(s,{i:()=>a});const a={MARK_AS_NEWEST_SEEN_APPENDED:"markAsNewestSeenAppended"}},7234:(F,s,n)=>{n.d(s,{CU:()=>f,Fr:()=>N,MB:()=>i,Su:()=>m,X0:()=>l,sV:()=>t});var a=n(157);function m(r){(0,a.Fg)("newest-seen-product-id",r)}function f(){return(0,a.vx)("newest-seen-product-id")}function l(r){(0,a.Fg)("prev-newest-seen-product-id",r)}function N(){return(0,a.vx)("prev-newest-seen-product-id")}function i(){(0,a.Fg)("last-newest-seen-product-update",Date.now())}function t(){return(0,a.vx)("last-newest-seen-product-update")}},9374:(F,s,n)=>{n.a(F,async(a,m)=>{try{let D=function(){const e=(0,t.fI)(w.Z.PRODUCT_CARD);if(console.log(e.length),e.length){const o=e[0].parentElement;(0,f.b)(o,P),A(),new MutationObserver(A).observe(o,{childList:!0,subtree:!0})}},P=function(e,o){(0,i.ZM)(e,S.r.FILTERS_CONTAINER);const E=(0,r.E9)(C,S.r.CONTROL,S.r.TEXT_INPUT),I=(0,N.nW)("\u041C\u0438\u043D. \u0433\u043E\u043B\u043E\u0441\u043E\u0432: ",d,"50","0","10000",S.r.CONTROL,S.r.NUMBER_INPUT),L=(0,r.H1)(u,S.r.CONTROL,S.r.NUMBER_INPUT),R=(0,N.Hw)("\u0417\u0430\u0432\u0435\u0440\u0448\u0451\u043D\u043D\u044B\u0435: ",x,S.r.CONTROL,S.r.CHECKBOX_INPUT),U=(0,r.pW)(p,S.r.CONTROL,S.r.CHECKBOX_INPUT);e.append(E,I,L,R,U),o.prepend(e)},A=function(){(0,t.fI)(w.Z.PRODUCT_CARD).forEach(h)},h=function(e){const o=(0,t.Fi)(w.Z.PRODUCT_CARD_LINK,e),E=g(o);if(b(E,e),T(e,o,E),!p.value){(0,i.vJ)(e);return}if(e.classList.contains("expired-view")&&!x.value){(0,i.iV)(e);return}const L=(0,t.Fi)(w.Z.PRODUCT_CARD_RATING,e);if(L.innerText.includes("\u041D\u043E\u0432\u043E\u0435"))return;const R=(0,t.Fi)(w.Z.PRODUCT_NAME,e),U=(0,t.Fi)(w.Z.PRODUCT_PRICE,e),$=R.innerText,j=(0,t.YA)(L,!0),Z=(0,t.YA)(U,!0),z=(0,l.Ay)($,C)||(0,l.JE)(j,d)||(0,l.iG)(Z,u);(0,i.D9)(e,z)},g=function(e){return+e.getAttribute("href").split("-").pop()},b=function(e,o){e>(0,k.Fr)()?o.style.border="3px solid #8ab854":o.style.removeProperty("border")},T=function(e,o,E){e.hasAttribute(y.i.MARK_AS_NEWEST_SEEN_APPENDED)||(e.addEventListener("mousedown",I=>{if(I.button===1&&I.target!==o){const L=(0,k.sV)(),U=`\u041F\u043E\u043C\u0435\u0442\u0438\u0442\u044C \u043A\u0430\u043A \u043D\u043E\u0432\u043E\u0435?
\u041F\u043E\u0441\u043B\u0435\u0434\u043D\u0435\u0435 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435 ${L?new Date(L).toLocaleString():"\u043E\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442"}`;confirm(U)&&(V(E),I.preventDefault())}}),e.setAttribute(y.i.MARK_AS_NEWEST_SEEN_APPENDED,""))},V=function(e){const o=(0,k.CU)();(0,k.X0)(o),(0,k.Su)(e),(0,k.MB)(),A()};var f=n(5213),l=n(3829),N=n(5884),i=n(5539),t=n(573),r=n(7877),v=n(4521),w=n(2756),S=n(8050),k=n(7234),y=n(1365);const{createGlobalFilter:c}=(0,v.z)(D),C=c("name-filter"),d=c("min-votes-filter",50),u=c("max-price-filter"),x=c("show-expired-filter",!1),p=c("filter-enabled",!0);await H(),D();async function H(){const e=(0,t.Fi)(w.Z.DISCUSSIONS);e&&(e.style.position="sticky",e.style.top="0")}m()}catch(c){m(c)}},1)},2756:(F,s,n)=>{n.d(s,{Z:()=>a});const a={DISCUSSIONS:"div.md\\:block.hidden.common-box:nth-of-type(3)",PRODUCT_CARD:".deal-card",PRODUCT_CARD_RATING:".common-box span",PRODUCT_NAME:".custom-card-title",PRODUCT_CARD_LINK:".custom-card-title > a",PRODUCT_PRICE:"div.md\\:text-xll.text-lg.font-bold.text-primary.mr-2"}},8050:(F,s,n)=>{n.d(s,{r:()=>m});const a={INPUT:{border:"1px solid #d1d5db",borderRadius:"8px",marginLeft:"7px"}},m={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",padding:"11px 19px",marginBottom:".5rem",backgroundColor:"#fff",borderWidth:"1px",borderColor:"rgb(229, 229, 229)",borderRadius:"10px",position:"sticky",zIndex:"11",top:"-1px"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...a.INPUT,width:"180px",padding:"7px 14px",backgroundColor:"#fff"},NUMBER_INPUT:{...a.INPUT,width:"90px",padding:"7px 14px",backgroundColor:"#fff"},CHECKBOX_INPUT:{...a.INPUT,width:"24px",height:"24px"}}}},G={};function O(F){var s=G[F];if(s!==void 0)return s.exports;var n=G[F]={exports:{}};return B[F](n,n.exports,O),n.exports}(()=>{var F=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",s=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",n=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",a=f=>{f&&f.d<1&&(f.d=1,f.forEach(l=>l.r--),f.forEach(l=>l.r--?l.r++:l()))},m=f=>f.map(l=>{if(l!==null&&typeof l=="object"){if(l[F])return l;if(l.then){var N=[];N.d=0,l.then(r=>{i[s]=r,a(N)},r=>{i[n]=r,a(N)});var i={};return i[F]=r=>r(N),i}}var t={};return t[F]=r=>{},t[s]=l,t});O.a=(f,l,N)=>{var i;N&&((i=[]).d=-1);var t=new Set,r=f.exports,v,w,S,k=new Promise((y,c)=>{S=c,w=y});k[s]=r,k[F]=y=>(i&&y(i),t.forEach(y),k.catch(c=>{})),f.exports=k,l(y=>{v=m(y);var c,C=()=>v.map(u=>{if(u[n])throw u[n];return u[s]}),d=new Promise(u=>{c=()=>u(C),c.r=0;var x=p=>p!==i&&!t.has(p)&&(t.add(p),p&&!p.d&&(c.r++,p.push(c)));v.map(p=>p[F](x))});return c.r?d:C()},y=>(y?S(k[n]=y):w(r),a(i))),i&&i.d<0&&(i.d=0)}})(),O.d=(F,s)=>{for(var n in s)O.o(s,n)&&!O.o(F,n)&&Object.defineProperty(F,n,{enumerable:!0,get:s[n]})},O.o=(F,s)=>Object.prototype.hasOwnProperty.call(F,s);var X=O(9374)})();})();
