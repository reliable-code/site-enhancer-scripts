// ==UserScript==
// @name         Pepper product cards filter
// @description  Hide product cards by filter
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.pepper.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.75569505
// @icon         https://www.google.com/s2/favicons?sz=64&domain=pepper.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/pepper.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var H={5467:(S,a,t)=>{t.d(a,{E2:()=>v});var l=t(9928);function v(E,i={},e=null){const r=(0,l.Sw)(i,e);return r.append(E),r}function f(E,i=null,e={},r={}){const b=createActionLink(E,i,r);return v(b,e)}function s(E,i=null,e=null,r={},b={}){const w=createActionLinkWithIcon(E,e,i,b);return v(w,r)}},9928:(S,a,t)=>{t.d(a,{S:()=>E,Sw:()=>T,kU:()=>f,o5:()=>s});var l=t(4921),v=t(5539);function f(d,o,x){const m=i(d,"text",o);return m.value=x,m}function s(d,o,x,m,V,P){const R=i(d,"number",o);return R.value=x,R.step=m,R.min=V,R.max=P,R}function E(d,o,x){const m=i(d,"checkbox",o);return m.checked=x,m}function i(d={},o=null,x=null){const m=N("input",d);return o&&(m.type=o),x&&(m.addEventListener("keyup",(0,l.sg)(x,200)),m.addEventListener("change",(0,l.sg)(x,100))),m}function e(d={},o=null){return N("span",d,o)}function r(d={},o=null,x=null){const m=N("a",d,o);return x&&(m.href=x),m}function b(d,o=null,x={}){x.cursor||="pointer";const m=r(x,o);return d&&m.addEventListener("click",d),m}function w(d,o,x=null,m={},V={}){m.display||="inline-flex",m.alignItems||="center",m.gap||="0.25em";const P=b(d,x,m);return P.prepend(c(o,V)),P}function F(d={},o=null,x=null){const m=N("button",d,o);return x&&m.addEventListener("click",x),m}function T(d={},o=null){return N("div",d,o)}function y(d={}){return N("i",d)}function c(d,o={}){o.width||="1em",o.height||="1em",o.paddingBottom||="1px";const x=y(o);return x.setAttribute("data-lucide",d),x}function N(d,o,x=null){if(typeof o!="object"||o===null)throw new TypeError("styles should be an object");const m=document.createElement(d);return(0,v.ZM)(m,o),x&&(m.innerHTML=x),m}},573:(S,a,t)=>{t.d(a,{Fi:()=>f,YA:()=>e,fI:()=>s});var l=t(4214);function v(c,N=document){return!!N.querySelector(c)}function f(c,N=document,d=!1){const o=N.querySelector(c);return d&&!o&&console.log(`No element found for selector: ${c}`),o}function s(c,N=document,d=!1){const o=N.querySelectorAll(c);return d&&!o.length&&console.log(`No elements found for selector: ${c}`),o}function E(c,N,d){return[...c.querySelectorAll(N)].find(o=>o.textContent.trim().includes(d))}function i(c,N,d=!1,o=!1,x=null){const m=f(N,c);return e(m,d,o,x)}function e(c,N=!1,d=!1,o=null){if(!c)return o===null?(console.log("No element found"),null):o;const x=c.innerText;return w(x,N,d)}function r(c,N,d=!1){const o=c[N];return e(o,d)}function b(c,N=!1,d=!1){const o=c.textContent;return w(o,N,d)}function w(c,N,d){N&&(c=(0,l.zr)(c)),d&&(c=c.replace(",","."));const o=Number(c);return Number.isNaN(o)?(console.log(`Invalid number: ${c}`),0):o}function F(c){return[...c.childNodes].find(N=>N.nodeType===Node.TEXT_NODE)}function T(c){const N=d=>d.nodeType===Node.TEXT_NODE&&d.textContent.trim()!==""?[d]:[...d.childNodes].flatMap(N);return N(c)}function y(c){return normalizeSpacing(c.textContent)}},5539:(S,a,t)=>{t.d(a,{D9:()=>c,ZM:()=>h,iV:()=>d,vJ:()=>N});function l(u,n){u.parentNode.insertBefore(n,u.nextSibling)}function v(u){u.style.display="none"}function f(u){w(u),v(u)}function s(u){u.intersectionObserver||runOnceOnIntersection(u,()=>v(u))}function E(u){u.style.display=""}function i(u){const n=b(u);u.style.display=n}function e(u,n){n?v(u):E(u)}function r(u,n){n?s(u):(clearIntersectionObserver(u),E(u))}function b(u){return w(u),u.defaultDisplay}function w(u){if(u.defaultDisplay)return;const{display:n}=getComputedStyle(u);u.defaultDisplay=n}function F(){return{show:[],hide:[]}}function T(u,n,p){u?n.hide.push(p):n.show.push(p)}function y(u){u.show.forEach(E),u.hide.forEach(v)}function c(u,n,p=.3){n?d(u,p):N(u)}function N(u){u.style.opacity=""}function d(u,n=.3){u.style.opacity=n}function o(u){u.style.order=""}function x(u,n){u.style.order=n}function m(u,n){u.style.background=n}function V(u,n){const p=getFirstElement(n);if(!p)return;const k=createLink();k.href=u,p.parentNode.append(k),k.append(p)}function P(u,n){const p=getFirstElement(n);p&&R(u,p)}function R(u,n){const p=createLink();p.href=u,p.append(...n.childNodes),n.append(p)}function g(){const u=getURLQueryParam("scrollTo");if(!u)return;const n=document.getElementById(u);n?n.scrollIntoView():console.log(`Element with ID "${u}" was not found.`)}function C(u,n="custom-global-style"){let p=document.getElementById(n);p||(p=document.createElement("style"),p.id=n,p.type="text/css",document.head.appendChild(p)),p.textContent=u}function h(u,n){Object.assign(u.style,n)}function A(u){return Object.entries(u).map(([n,p])=>`${n.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${p};`).join(" ")}function U(u){return u?u.split(";").filter(n=>n.trim()!=="").reduce((n,p)=>{const[k,D]=p.split(":").map(L=>L.trim()),I=k.replace(/-([a-z])/g,(L,B)=>B.toUpperCase());return n[I]=D,n},{}):{}}function G(u,n,p="text/plain"){const k=new Blob([u],{type:p}),D=URL.createObjectURL(k),I=document.createElement("a");I.href=D,I.download=n,document.body.appendChild(I),I.click(),document.body.removeChild(I),requestAnimationFrame(()=>URL.revokeObjectURL(D))}},4921:(S,a,t)=>{t.d(a,{sg:()=>s});function l(e,r,b=null){const w=e.querySelector(r);return w?Promise.resolve(w):new Promise(F=>{const T=new MutationObserver(c);T.observe(e,{childList:!0,subtree:!0});let y;b&&(y=setTimeout(()=>{T.disconnect(),console.log(`No element found for selector: ${r}`),F(null)},b));function c(){const N=e.querySelector(r);N&&(y&&clearTimeout(y),T.disconnect(),F(N))}})}function v(e,r){return e.querySelector(r)?new Promise(w=>{const F=new MutationObserver(T);F.observe(e,{childList:!0,subtree:!0});function T(){e.querySelector(r)||(F.disconnect(),w())}}):Promise.resolve()}function f(e,r=400){return new Promise(b=>{let w;const F=new MutationObserver(()=>{clearTimeout(w),T()});function T(){w=setTimeout(()=>{F.disconnect(),b()},r)}T(),F.observe(e,{childList:!0,subtree:!0})})}function s(e,r=250){let b;return(...w)=>{clearTimeout(b),b=setTimeout(()=>e(...w),r)}}function E(e,r){const b=new IntersectionObserver(w=>{w.forEach(F=>{F.isIntersecting&&(r(),i(e))})});e.intersectionObserver=b,b.observe(e)}function i(e){e.intersectionObserver&&(e.intersectionObserver.disconnect(),e.intersectionObserver=null)}},3829:(S,a,t)=>{t.d(a,{Ay:()=>v,JE:()=>s,iG:()=>E});var l=t(8355);function v(e,r){return!f(e,r)}function f(e,r){if(!r.value)return!0;const b=e.toLowerCase(),w=(0,l.R)(r),F=[],T=[];return w.forEach(y=>{if(y.startsWith("!")){const c=y.substring(1);c&&T.push(c)}else F.push(y)}),F.every(y=>b.includes(y))&&T.every(y=>!b.includes(y))}function s(e,r){return r.value!=null&&e<r.value}function E(e,r){return r.value!=null&&e>r.value}function i(e,r){return r.value&&e!==r.value}},4521:(S,a,t)=>{t.d(a,{z:()=>v});var l=t(3048);function v(f,s=null){return{createGlobalFilter(E,i=null,e=f){return l.V.create(E,i,e)},createSectionFilter(E,i=null,e=f){if(!s)throw new Error("sectionId must be provided to use createSectionFilter.");return l.V.createWithCompositeKey(s,E,i,e)}}}},5884:(S,a,t)=>{t.d(a,{Hw:()=>E,Nm:()=>f,nW:()=>s});var l=t(9928),v=t(5467);function f(i,e,r={},b={}){const w=(0,l.kU)(b,e.updateValueFromEvent,e.value);return(0,v.E2)(w,r,i)}function s(i,e,r,b,w,F={},T={}){const y=(0,l.o5)(T,e.updateValueFromEvent,e.value,r,b,w);return(0,v.E2)(y,F,i)}function E(i,e,r={},b={}){const w=(0,l.S)(b,e.updateValueFromEvent,e.value);return(0,v.E2)(w,r,i)}},7877:(S,a,t)=>{t.d(a,{E9:()=>v,H1:()=>y,pW:()=>R});var l=t(5884);function v(g,C={},h={}){return(0,l.Nm)("\u041F\u043E\u0438\u0441\u043A: ",g,C,h)}function f(g,C={},h={},A=.1,U=3){return createNumberFilterControl("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",g,A,U,5,C,h)}function s(g,C={},h={},A=.1,U=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",g,A,U,5,C,h)}function E(g,C={},h={}){return e("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",g,C,h)}function i(g,C={},h={}){return e("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",g,C,h)}function e(g,C,h={},A={}){return createNumberFilterControl(g,C,"1","1","999999",h,A)}function r(g,C={},h={}){return b("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",g,C,h)}function b(g,C,h={},A={}){return createNumberFilterControl(g,C,"5","0","100",h,A)}function w(g,C={},h={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",g,"5","0","100",C,h)}function F(g,C,h={},A={},U="250"){return(0,l.nW)(g,C,U,"0","1000000",h,A)}function T(g,C={},h={},A="25"){return F("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",g,C,h,A)}function y(g,C={},h={},A="25"){return F("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",g,C,h,A)}function c(g,C={},h={}){return N("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",g,C,h)}function N(g,C,h={},A={}){return createNumberFilterControl(g,C,"1","0","99999",h,A)}function d(g,C={},h={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",g,"1","2","7",C,h)}function o(g,C={},h={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",g,1,1,10,C,h)}function x(g,C={},h={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",g,C,h)}function m(g,C={},h={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",g,C,h)}function V(g,C={},h={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",g,C,h)}function P(g,C={},h={}){return createCheckboxFilterControl("\u0411\u0430\u043B\u043B\u044B: ",g,C,h)}function R(g,C={},h={}){return(0,l.Hw)("\u0412\u043A\u043B: ",g,C,h)}},8355:(S,a,t)=>{t.d(a,{R:()=>l});function l(f){return f.value.toLowerCase().split(",").map(s=>s.trim()).filter(s=>s!=="")}function v(f){return l(f).filter(s=>!s.startsWith("!"))}},5213:(S,a,t)=>{t.d(a,{b:()=>f});var l=t(9928),v=t(573);function f(s,E,i=!1,e="customFiltersContainer"){let r=(0,v.Fi)(`#${e}`,s);if(r)if(i)r.remove();else return;r=(0,l.Sw)(),r.id=e,E(r,s)}},8200:(S,a,t)=>{t.d(a,{s:()=>l});function l(v){const{target:f}=v,{type:s}=f;switch(s){case"text":return`"${f.value}"`;case"number":return f.value;case"checkbox":return f.checked;default:return console.log(`Unknown input type: ${s}`),null}}},157:(S,a,t)=>{t.d(a,{Fg:()=>l,vx:()=>f});const l=window.GM_setValue,v=window.GM.setValue,f=window.GM_getValue,s=window.GM_addValueChangeListener},1870:(S,a,t)=>{t.d(a,{j:()=>l});class l{constructor(f,s){this.value=f,this.onChange=s}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(S,a,t)=>{t.d(a,{V:()=>E});var l=t(1870),v=t(8200),f=t(3976),s=t(157);class E extends l.j{constructor(e,r=null,b=null){super((0,s.vx)(e,r),b),this.storageKey=e,this.defaultValue=r}static create(e,r=null,b=null){return new E(e,r,b)}static createWithCompositeKey(e,r,b=null,w=null){const F=`${e}-${r}`;return new E(F,b,w)}updateValueFromEvent=e=>{const r=(0,v.s)(e),b=(0,f.$)(r);this.updateValue(b)};updateValue(e,r=!0){this.value!==e&&((0,s.Fg)(this.storageKey,e),this.value=e,r&&this.onChangeIfDefined())}clearValue(e=!1){this.updateValue(null,e)}resetValue(e=!1){this.updateValue(this.defaultValue,e)}}},3976:(S,a,t)=>{t.d(a,{$:()=>l});function l(v){return v===""?null:JSON.parse(v)}},4214:(S,a,t)=>{t.d(a,{zr:()=>v});function l(i){return i.replace(/\D/g,"")}function v(i){return i.replace(/[^\d.,-]/g,"")}function f(i){return i.replace(/\s/g,"")}function s(i){return i.charAt(0).toUpperCase()+i.slice(1)}function E(i){return i.replace(/\s+/g," ").trim()}},1365:(S,a,t)=>{t.d(a,{i:()=>l});const l={MARK_AS_NEWEST_SEEN_APPENDED:"markAsNewestSeenAppended"}},7234:(S,a,t)=>{t.d(a,{CU:()=>f,Fr:()=>E,MB:()=>i,Su:()=>v,X0:()=>s,sV:()=>e});var l=t(157);function v(r){(0,l.Fg)("newest-seen-product-id",r)}function f(){return(0,l.vx)("newest-seen-product-id")}function s(r){(0,l.Fg)("prev-newest-seen-product-id",r)}function E(){return(0,l.vx)("prev-newest-seen-product-id")}function i(){(0,l.Fg)("last-newest-seen-product-update",Date.now())}function e(){return(0,l.vx)("last-newest-seen-product-update")}},9374:(S,a,t)=>{t.a(S,async(l,v)=>{try{let V=function(){const n=(0,e.fI)(w.Z.PRODUCT_CARD);if(console.log(n.length),n.length){const p=n[0].parentElement;(0,f.b)(p,P),R(),new MutationObserver(R).observe(p,{childList:!0,subtree:!0})}},P=function(n,p){(0,i.ZM)(n,F.r.FILTERS_CONTAINER);const k=(0,r.E9)(N,F.r.CONTROL,F.r.TEXT_INPUT),D=(0,E.nW)("\u041C\u0438\u043D. \u0433\u043E\u043B\u043E\u0441\u043E\u0432: ",d,"50","0","10000",F.r.CONTROL,F.r.NUMBER_INPUT),I=(0,r.H1)(o,F.r.CONTROL,F.r.NUMBER_INPUT),L=(0,E.Hw)("\u0417\u0430\u0432\u0435\u0440\u0448\u0451\u043D\u043D\u044B\u0435: ",x,F.r.CONTROL,F.r.CHECKBOX_INPUT),B=(0,r.pW)(m,F.r.CONTROL,F.r.CHECKBOX_INPUT);n.append(k,D,I,L,B),p.prepend(n)},R=function(){(0,e.fI)(w.Z.PRODUCT_CARD).forEach(g)},g=function(n){const p=(0,e.Fi)(w.Z.PRODUCT_CARD_LINK,n),k=C(p);if(h(k,n),A(n,p,k),!m.value){(0,i.vJ)(n);return}if(n.classList.contains("expired-view")&&!x.value){(0,i.iV)(n);return}const I=(0,e.Fi)(w.Z.PRODUCT_CARD_RATING,n);if(I.innerText.includes("\u041D\u043E\u0432\u043E\u0435"))return;const L=(0,e.Fi)(w.Z.PRODUCT_NAME,n),B=(0,e.Fi)(w.Z.PRODUCT_PRICE,n),j=L.innerText,Z=(0,e.YA)(I,!0),z=(0,e.YA)(B,!0),X=(0,s.Ay)(j,N)||(0,s.JE)(Z,d)||(0,s.iG)(z,o);(0,i.D9)(n,X)},C=function(n){return+n.getAttribute("href").split("-").pop()},h=function(n,p){n>(0,T.Fr)()?p.style.border="3px solid #8ab854":p.style.removeProperty("border")},A=function(n,p,k){n.hasAttribute(y.i.MARK_AS_NEWEST_SEEN_APPENDED)||(n.addEventListener("mousedown",D=>{if(D.button===1&&D.target!==p){const I=(0,T.sV)(),L=`\u041F\u043E\u043C\u0435\u0442\u0438\u0442\u044C \u043A\u0430\u043A \u043D\u043E\u0432\u043E\u0435?

${U(I)}`;confirm(L)&&(G(k),D.preventDefault())}}),n.setAttribute(y.i.MARK_AS_NEWEST_SEEN_APPENDED,""))},U=function(n){const p=n?new Date(n):null;if(!p)return"";let k=Math.floor((Date.now()-p.getTime())/6e4);const D=Math.floor(k/1440);k-=D*1440;const I=Math.floor(k/60),L=k-I*60;return D>0?`\u0421 \u043F\u0440\u043E\u0448\u043B\u043E\u0433\u043E \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u043F\u0440\u043E\u0448\u043B\u043E ${D} \u0434. ${I} \u0447. ${L} \u043C.`:I>0?`\u0421 \u043F\u0440\u043E\u0448\u043B\u043E\u0433\u043E \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u043F\u0440\u043E\u0448\u043B\u043E ${I} \u0447. ${L} \u043C.`:`\u0421 \u043F\u0440\u043E\u0448\u043B\u043E\u0433\u043E \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u043F\u0440\u043E\u0448\u043B\u043E ${L} \u043C.`},G=function(n){const p=(0,T.CU)();(0,T.X0)(p),(0,T.Su)(n),(0,T.MB)(),R()};var f=t(5213),s=t(3829),E=t(5884),i=t(5539),e=t(573),r=t(7877),b=t(4521),w=t(2756),F=t(8050),T=t(7234),y=t(1365);const{createGlobalFilter:c}=(0,b.z)(V),N=c("name-filter"),d=c("min-votes-filter",50),o=c("max-price-filter"),x=c("show-expired-filter",!1),m=c("filter-enabled",!0);await u(),V();async function u(){const n=(0,e.Fi)(w.Z.DISCUSSIONS);n&&(n.style.position="sticky",n.style.top="0")}v()}catch(c){v(c)}},1)},2756:(S,a,t)=>{t.d(a,{Z:()=>l});const l={DISCUSSIONS:"div.md\\:block.hidden.common-box:nth-of-type(3)",PRODUCT_CARD:".deal-card",PRODUCT_CARD_RATING:".common-box span",PRODUCT_NAME:".custom-card-title",PRODUCT_CARD_LINK:".custom-card-title > a",PRODUCT_PRICE:"div.md\\:text-xll.text-lg.font-bold.text-primary.mr-2"}},8050:(S,a,t)=>{t.d(a,{r:()=>v});const l={INPUT:{border:"1px solid #d1d5db",borderRadius:"8px",marginLeft:"7px"}},v={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",padding:"11px 19px",marginBottom:".5rem",backgroundColor:"#fff",borderWidth:"1px",borderColor:"rgb(229, 229, 229)",borderRadius:"10px",position:"sticky",zIndex:"11",top:"-1px"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...l.INPUT,width:"180px",padding:"7px 14px",backgroundColor:"#fff"},NUMBER_INPUT:{...l.INPUT,width:"90px",padding:"7px 14px",backgroundColor:"#fff"},CHECKBOX_INPUT:{...l.INPUT,width:"24px",height:"24px"}}}},O={};function $(S){var a=O[S];if(a!==void 0)return a.exports;var t=O[S]={exports:{}};return H[S](t,t.exports,$),t.exports}(()=>{var S=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",a=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",t=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",l=f=>{f&&f.d<1&&(f.d=1,f.forEach(s=>s.r--),f.forEach(s=>s.r--?s.r++:s()))},v=f=>f.map(s=>{if(s!==null&&typeof s=="object"){if(s[S])return s;if(s.then){var E=[];E.d=0,s.then(r=>{i[a]=r,l(E)},r=>{i[t]=r,l(E)});var i={};return i[S]=r=>r(E),i}}var e={};return e[S]=r=>{},e[a]=s,e});$.a=(f,s,E)=>{var i;E&&((i=[]).d=-1);var e=new Set,r=f.exports,b,w,F,T=new Promise((y,c)=>{F=c,w=y});T[a]=r,T[S]=y=>(i&&y(i),e.forEach(y),T.catch(c=>{})),f.exports=T,s(y=>{b=v(y);var c,N=()=>b.map(o=>{if(o[t])throw o[t];return o[a]}),d=new Promise(o=>{c=()=>o(N),c.r=0;var x=m=>m!==i&&!e.has(m)&&(e.add(m),m&&!m.d&&(c.r++,m.push(c)));b.map(m=>m[S](x))});return c.r?d:N()},y=>(y?F(T[t]=y):w(r),l(i))),i&&i.d<0&&(i.d=0)}})(),$.d=(S,a)=>{for(var t in a)$.o(a,t)&&!$.o(S,t)&&Object.defineProperty(S,t,{enumerable:!0,get:a[t]})},$.o=(S,a)=>Object.prototype.hasOwnProperty.call(S,a);var Q=$(9374)})();})();
