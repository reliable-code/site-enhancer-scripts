// ==UserScript==
// @name         Pepper product cards filter
// @description  Hide product cards by filter
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.pepper.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.74553179
// @icon         https://www.google.com/s2/favicons?sz=64&domain=pepper.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/pepper.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var j={5467:(w,c,n)=>{n.d(c,{E2:()=>b});var s=n(9928);function b(E,i={},t=null){const r=(0,s.Sw)(i,t);return r.append(E),r}function f(E,i=null,t={},r={}){const m=createActionLink(E,i,r);return b(m,t)}function a(E,i=null,t=null,r={},m={}){const S=createActionLinkWithIcon(E,t,i,m);return b(S,r)}},9928:(w,c,n)=>{n.d(c,{S:()=>E,Sw:()=>x,kU:()=>f,o5:()=>a});var s=n(4921),b=n(5539);function f(l,u,N){const v=i(l,"text",u);return v.value=N,v}function a(l,u,N,v,L,O){const A=i(l,"number",u);return A.value=N,A.step=v,A.min=L,A.max=O,A}function E(l,u,N){const v=i(l,"checkbox",u);return v.checked=N,v}function i(l={},u=null,N=null){const v=p("input",l);return u&&(v.type=u),N&&(v.addEventListener("keyup",(0,s.sg)(N,200)),v.addEventListener("change",(0,s.sg)(N,100))),v}function t(l={},u=null){return p("span",l,u)}function r(l={},u=null,N=null){const v=p("a",l,u);return N&&(v.href=N),v}function m(l,u=null,N={}){N.cursor||="pointer";const v=r(N,u);return l&&v.addEventListener("click",l),v}function S(l,u,N=null,v={},L={}){v.display||="inline-flex",v.alignItems||="center",v.gap||="0.25em";const O=m(l,N,v);return O.prepend(d(u,L)),O}function y(l={},u=null,N=null){const v=p("button",l,u);return N&&v.addEventListener("click",N),v}function x(l={},u=null){return p("div",l,u)}function T(l={}){return p("i",l)}function d(l,u={}){u.width||="1em",u.height||="1em",u.paddingBottom||="1px";const N=T(u);return N.setAttribute("data-lucide",l),N}function p(l,u,N=null){if(typeof u!="object"||u===null)throw new TypeError("styles should be an object");const v=document.createElement(l);return(0,b.ZM)(v,u),N&&(v.innerHTML=N),v}},573:(w,c,n)=>{n.d(c,{Fi:()=>f,YA:()=>t,fI:()=>a});var s=n(4214);function b(d,p=document){return!!p.querySelector(d)}function f(d,p=document,l=!1){const u=p.querySelector(d);return l&&!u&&console.log(`No element found for selector: ${d}`),u}function a(d,p=document,l=!1){const u=p.querySelectorAll(d);return l&&!u.length&&console.log(`No elements found for selector: ${d}`),u}function E(d,p,l){return[...d.querySelectorAll(p)].find(u=>u.textContent.trim().includes(l))}function i(d,p,l=!1,u=!1,N=null){const v=f(p,d);return t(v,l,u,N)}function t(d,p=!1,l=!1,u=null){if(!d)return u===null?(console.log("No element found"),null):u;const N=d.innerText;return S(N,p,l)}function r(d,p,l=!1){const u=d[p];return t(u,l)}function m(d,p=!1,l=!1){const u=d.textContent;return S(u,p,l)}function S(d,p,l){p&&(d=(0,s.zr)(d)),l&&(d=d.replace(",","."));const u=Number(d);return Number.isNaN(u)?(console.log(`Invalid number: ${d}`),0):u}function y(d){return[...d.childNodes].find(p=>p.nodeType===Node.TEXT_NODE)}function x(d){const p=l=>l.nodeType===Node.TEXT_NODE&&l.textContent.trim()!==""?[l]:[...l.childNodes].flatMap(p);return p(d)}function T(d){return normalizeSpacing(d.textContent)}},5539:(w,c,n)=>{n.d(c,{D9:()=>d,ZM:()=>h,iV:()=>l,vJ:()=>p});function s(e,o){e.parentNode.insertBefore(o,e.nextSibling)}function b(e){e.style.display="none"}function f(e){S(e),b(e)}function a(e){e.intersectionObserver||runOnceOnIntersection(e,()=>b(e))}function E(e){e.style.display=""}function i(e){const o=m(e);e.style.display=o}function t(e,o){o?b(e):E(e)}function r(e,o){o?a(e):(clearIntersectionObserver(e),E(e))}function m(e){return S(e),e.defaultDisplay}function S(e){if(e.defaultDisplay)return;const{display:o}=getComputedStyle(e);e.defaultDisplay=o}function y(){return{show:[],hide:[]}}function x(e,o,F){e?o.hide.push(F):o.show.push(F)}function T(e){e.show.forEach(E),e.hide.forEach(b)}function d(e,o,F=.3){o?l(e,F):p(e)}function p(e){e.style.opacity=""}function l(e,o=.3){e.style.opacity=o}function u(e){e.style.order=""}function N(e,o){e.style.order=o}function v(e,o){e.style.background=o}function L(e,o){const F=getFirstElement(o);if(!F)return;const k=createLink();k.href=e,F.parentNode.append(k),k.append(F)}function O(e,o){const F=getFirstElement(o);F&&A(e,F)}function A(e,o){const F=createLink();F.href=e,F.append(...o.childNodes),o.append(F)}function C(){const e=getURLQueryParam("scrollTo");if(!e)return;const o=document.getElementById(e);o?o.scrollIntoView():console.log(`Element with ID "${e}" was not found.`)}function g(e,o="custom-global-style"){let F=document.getElementById(o);F||(F=document.createElement("style"),F.id=o,F.type="text/css",document.head.appendChild(F)),F.textContent=e}function h(e,o){Object.assign(e.style,o)}function I(e){return Object.entries(e).map(([o,F])=>`${o.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${F};`).join(" ")}function P(e){return e?e.split(";").filter(o=>o.trim()!=="").reduce((o,F)=>{const[k,R]=F.split(":").map(V=>V.trim()),D=k.replace(/-([a-z])/g,(V,B)=>B.toUpperCase());return o[D]=R,o},{}):{}}function G(e,o,F="text/plain"){const k=new Blob([e],{type:F}),R=URL.createObjectURL(k),D=document.createElement("a");D.href=R,D.download=o,document.body.appendChild(D),D.click(),document.body.removeChild(D),requestAnimationFrame(()=>URL.revokeObjectURL(R))}},4921:(w,c,n)=>{n.d(c,{sg:()=>a,xk:()=>s});function s(t,r,m=null){const S=t.querySelector(r);return S?Promise.resolve(S):new Promise(y=>{const x=new MutationObserver(d);x.observe(t,{childList:!0,subtree:!0});let T;m&&(T=setTimeout(()=>{x.disconnect(),console.log(`No element found for selector: ${r}`),y(null)},m));function d(){const p=t.querySelector(r);p&&(T&&clearTimeout(T),x.disconnect(),y(p))}})}function b(t,r){return t.querySelector(r)?new Promise(S=>{const y=new MutationObserver(x);y.observe(t,{childList:!0,subtree:!0});function x(){t.querySelector(r)||(y.disconnect(),S())}}):Promise.resolve()}function f(t,r=400){return new Promise(m=>{let S;const y=new MutationObserver(()=>{clearTimeout(S),x()});function x(){S=setTimeout(()=>{y.disconnect(),m()},r)}x(),y.observe(t,{childList:!0,subtree:!0})})}function a(t,r=250){let m;return(...S)=>{clearTimeout(m),m=setTimeout(()=>t(...S),r)}}function E(t,r){const m=new IntersectionObserver(S=>{S.forEach(y=>{y.isIntersecting&&(r(),i(t))})});t.intersectionObserver=m,m.observe(t)}function i(t){t.intersectionObserver&&(t.intersectionObserver.disconnect(),t.intersectionObserver=null)}},3829:(w,c,n)=>{n.d(c,{Ay:()=>b,JE:()=>a});var s=n(8355);function b(t,r){return!f(t,r)}function f(t,r){if(!r.value)return!0;const m=t.toLowerCase(),S=(0,s.R)(r),y=[],x=[];return S.forEach(T=>{if(T.startsWith("!")){const d=T.substring(1);d&&x.push(d)}else y.push(T)}),y.every(T=>m.includes(T))&&x.every(T=>!m.includes(T))}function a(t,r){return r.value!=null&&t<r.value}function E(t,r){return r.value!=null&&t>r.value}function i(t,r){return r.value&&t!==r.value}},4521:(w,c,n)=>{n.d(c,{z:()=>b});var s=n(3048);function b(f,a=null){return{createGlobalFilter(E,i=null,t=f){return s.V.create(E,i,t)},createSectionFilter(E,i=null,t=f){if(!a)throw new Error("sectionId must be provided to use createSectionFilter.");return s.V.createWithCompositeKey(a,E,i,t)}}}},5884:(w,c,n)=>{n.d(c,{Hw:()=>E,Nm:()=>f,nW:()=>a});var s=n(9928),b=n(5467);function f(i,t,r={},m={}){const S=(0,s.kU)(m,t.updateValueFromEvent,t.value);return(0,b.E2)(S,r,i)}function a(i,t,r,m,S,y={},x={}){const T=(0,s.o5)(x,t.updateValueFromEvent,t.value,r,m,S);return(0,b.E2)(T,y,i)}function E(i,t,r={},m={}){const S=(0,s.S)(m,t.updateValueFromEvent,t.value);return(0,b.E2)(S,r,i)}},7877:(w,c,n)=>{n.d(c,{E9:()=>b,pW:()=>A});var s=n(5884);function b(C,g={},h={}){return(0,s.Nm)("\u041F\u043E\u0438\u0441\u043A: ",C,g,h)}function f(C,g={},h={},I=.1,P=3){return createNumberFilterControl("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",C,I,P,5,g,h)}function a(C,g={},h={},I=.1,P=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",C,I,P,5,g,h)}function E(C,g={},h={}){return t("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",C,g,h)}function i(C,g={},h={}){return t("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",C,g,h)}function t(C,g,h={},I={}){return createNumberFilterControl(C,g,"1","1","999999",h,I)}function r(C,g={},h={}){return m("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",C,g,h)}function m(C,g,h={},I={}){return createNumberFilterControl(C,g,"5","0","100",h,I)}function S(C,g={},h={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",C,"5","0","100",g,h)}function y(C,g,h={},I={},P="250"){return createNumberFilterControl(C,g,P,"0","1000000",h,I)}function x(C,g={},h={},I="25"){return y("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",C,g,h,I)}function T(C,g={},h={},I="25"){return y("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",C,g,h,I)}function d(C,g={},h={}){return p("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",C,g,h)}function p(C,g,h={},I={}){return createNumberFilterControl(C,g,"1","0","99999",h,I)}function l(C,g={},h={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",C,"1","2","7",g,h)}function u(C,g={},h={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",C,1,1,10,g,h)}function N(C,g={},h={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",C,g,h)}function v(C,g={},h={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",C,g,h)}function L(C,g={},h={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",C,g,h)}function O(C,g={},h={}){return createCheckboxFilterControl("\u0411\u0430\u043B\u043B\u044B: ",C,g,h)}function A(C,g={},h={}){return(0,s.Hw)("\u0412\u043A\u043B: ",C,g,h)}},8355:(w,c,n)=>{n.d(c,{R:()=>s});function s(f){return f.value.toLowerCase().split(",").map(a=>a.trim()).filter(a=>a!=="")}function b(f){return s(f).filter(a=>!a.startsWith("!"))}},5213:(w,c,n)=>{n.d(c,{b:()=>f});var s=n(9928),b=n(573);function f(a,E,i=!1,t="customFiltersContainer"){let r=(0,b.Fi)(`#${t}`,a);if(r)if(i)r.remove();else return;r=(0,s.Sw)(),r.id=t,E(r,a)}},8200:(w,c,n)=>{n.d(c,{s:()=>s});function s(b){const{target:f}=b,{type:a}=f;switch(a){case"text":return`"${f.value}"`;case"number":return f.value;case"checkbox":return f.checked;default:return console.log(`Unknown input type: ${a}`),null}}},157:(w,c,n)=>{n.d(c,{Fg:()=>s,vx:()=>f});const s=window.GM_setValue,b=window.GM.setValue,f=window.GM_getValue,a=window.GM_addValueChangeListener},1870:(w,c,n)=>{n.d(c,{j:()=>s});class s{constructor(f,a){this.value=f,this.onChange=a}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(w,c,n)=>{n.d(c,{V:()=>E});var s=n(1870),b=n(8200),f=n(3976),a=n(157);class E extends s.j{constructor(t,r=null,m=null){super((0,a.vx)(t,r),m),this.storageKey=t,this.defaultValue=r}static create(t,r=null,m=null){return new E(t,r,m)}static createWithCompositeKey(t,r,m=null,S=null){const y=`${t}-${r}`;return new E(y,m,S)}updateValueFromEvent=t=>{const r=(0,b.s)(t),m=(0,f.$)(r);this.updateValue(m)};updateValue(t,r=!0){this.value!==t&&((0,a.Fg)(this.storageKey,t),this.value=t,r&&this.onChangeIfDefined())}clearValue(t=!1){this.updateValue(null,t)}resetValue(t=!1){this.updateValue(this.defaultValue,t)}}},3976:(w,c,n)=>{n.d(c,{$:()=>s});function s(b){return b===""?null:JSON.parse(b)}},4214:(w,c,n)=>{n.d(c,{zr:()=>b});function s(i){return i.replace(/\D/g,"")}function b(i){return i.replace(/[^\d.,-]/g,"")}function f(i){return i.replace(/\s/g,"")}function a(i){return i.charAt(0).toUpperCase()+i.slice(1)}function E(i){return i.replace(/\s+/g," ").trim()}},1365:(w,c,n)=>{n.d(c,{i:()=>s});const s={MARK_AS_NEWEST_SEEN_APPENDED:"markAsNewestSeenAppended"}},7234:(w,c,n)=>{n.d(c,{CU:()=>f,Fr:()=>E,Su:()=>b,X0:()=>a});var s=n(157);function b(i){(0,s.Fg)("newest-seen-product-id",i)}function f(){return(0,s.vx)("newest-seen-product-id")}function a(i){(0,s.Fg)("prev-newest-seen-product-id",i)}function E(){return(0,s.vx)("prev-newest-seen-product-id")}},9374:(w,c,n)=>{n.a(w,async(s,b)=>{try{let L=function(){const e=(0,r.fI)(y.Z.PRODUCT_CARD);if(e.length){const o=e[0].parentElement;(0,a.b)(o,O),A(),new MutationObserver(A).observe(o,{childList:!0,subtree:!0})}},O=function(e,o){(0,t.ZM)(e,x.r.FILTERS_CONTAINER);const F=(0,m.E9)(l,x.r.CONTROL,x.r.TEXT_INPUT),k=(0,i.nW)("\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u043E \u0433\u043E\u043B\u043E\u0441\u043E\u0432: ",u,"50","0","10000",x.r.CONTROL,x.r.NUMBER_INPUT),R=(0,i.Hw)("\u0417\u0430\u0432\u0435\u0440\u0448\u0451\u043D\u043D\u044B\u0435: ",N,x.r.CONTROL,x.r.CHECKBOX_INPUT),D=(0,m.pW)(v,x.r.CONTROL,x.r.CHECKBOX_INPUT);e.append(F,k,R,D),o.prepend(e)},A=function(){(0,r.fI)(y.Z.PRODUCT_CARD).forEach(C)},C=function(e){const o=(0,r.Fi)(y.Z.PRODUCT_CARD_LINK,e),F=g(o);if(h(F,e),I(e,o,F),!v.value){(0,t.vJ)(e);return}if(e.classList.contains("expired-view")&&!N.value){(0,t.iV)(e);return}const R=(0,r.Fi)(y.Z.PRODUCT_CARD_RATING,e);if(R.innerText.includes("\u041D\u043E\u0432\u043E\u0435"))return;const D=(0,r.Fi)(y.Z.PRODUCT_NAME,e),V=(0,r.YA)(R,!0),B=D.innerText,H=(0,E.Ay)(B,l)||(0,E.JE)(V,u);(0,t.D9)(e,H)},g=function(e){return+e.getAttribute("href").split("-").pop()},h=function(e,o){e>(0,T.Fr)()?o.style.border="3px solid #8ab854":o.style.removeProperty("border")},I=function(e,o,F){e.hasAttribute(d.i.MARK_AS_NEWEST_SEEN_APPENDED)||(e.addEventListener("mousedown",k=>{k.button===1&&k.target!==o&&confirm("\u041F\u043E\u043C\u0435\u0442\u0438\u0442\u044C \u043A\u0430\u043A \u043D\u043E\u0432\u043E\u0435?")&&(P(F),k.preventDefault())}),e.setAttribute(d.i.MARK_AS_NEWEST_SEEN_APPENDED,""))},P=function(e){const o=(0,T.CU)();(0,T.X0)(o),(0,T.Su)(e),A()};var f=n(4921),a=n(5213),E=n(3829),i=n(5884),t=n(5539),r=n(573),m=n(7877),S=n(4521),y=n(2756),x=n(8050),T=n(7234),d=n(1365);const{createGlobalFilter:p}=(0,S.z)(L),l=p("name-filter"),u=p("min-votes-filter",50),N=p("show-expired-filter",!1),v=p("filter-enabled",!0);await G(),L();async function G(){const e=await(0,f.xk)(document,y.Z.DISCUSSIONS);e&&(e.style.position="sticky",e.style.top="0")}b()}catch(p){b(p)}},1)},2756:(w,c,n)=>{n.d(c,{Z:()=>s});const s={DISCUSSIONS:"div.md\\:block.hidden.common-box:nth-of-type(3)",PRODUCT_CARD:".deal-card",PRODUCT_CARD_RATING:".common-box span",PRODUCT_NAME:".custom-card-title",PRODUCT_CARD_LINK:".custom-card-title > a"}},8050:(w,c,n)=>{n.d(c,{r:()=>b});const s={INPUT:{border:"1px solid #d1d5db",borderRadius:"8px",marginLeft:"7px"}},b={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",padding:"11px 19px",marginBottom:".5rem",backgroundColor:"#fff",borderWidth:"1px",borderColor:"rgb(229, 229, 229)",borderRadius:"10px",position:"sticky",zIndex:"11",top:"-1px"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...s.INPUT,width:"180px",padding:"7px 14px",backgroundColor:"#fff"},NUMBER_INPUT:{...s.INPUT,width:"90px",padding:"7px 14px",backgroundColor:"#fff"},CHECKBOX_INPUT:{...s.INPUT,width:"24px",height:"24px"}}}},$={};function U(w){var c=$[w];if(c!==void 0)return c.exports;var n=$[w]={exports:{}};return j[w](n,n.exports,U),n.exports}(()=>{var w=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",c=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",n=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",s=f=>{f&&f.d<1&&(f.d=1,f.forEach(a=>a.r--),f.forEach(a=>a.r--?a.r++:a()))},b=f=>f.map(a=>{if(a!==null&&typeof a=="object"){if(a[w])return a;if(a.then){var E=[];E.d=0,a.then(r=>{i[c]=r,s(E)},r=>{i[n]=r,s(E)});var i={};return i[w]=r=>r(E),i}}var t={};return t[w]=r=>{},t[c]=a,t});U.a=(f,a,E)=>{var i;E&&((i=[]).d=-1);var t=new Set,r=f.exports,m,S,y,x=new Promise((T,d)=>{y=d,S=T});x[c]=r,x[w]=T=>(i&&T(i),t.forEach(T),x.catch(d=>{})),f.exports=x,a(T=>{m=b(T);var d,p=()=>m.map(u=>{if(u[n])throw u[n];return u[c]}),l=new Promise(u=>{d=()=>u(p),d.r=0;var N=v=>v!==i&&!t.has(v)&&(t.add(v),v&&!v.d&&(d.r++,v.push(d)));m.map(v=>v[w](N))});return d.r?l:p()},T=>(T?y(x[n]=T):S(r),s(i))),i&&i.d<0&&(i.d=0)}})(),U.d=(w,c)=>{for(var n in c)U.o(c,n)&&!U.o(w,n)&&Object.defineProperty(w,n,{enumerable:!0,get:c[n]})},U.o=(w,c)=>Object.prototype.hasOwnProperty.call(w,c);var z=U(9374)})();})();
