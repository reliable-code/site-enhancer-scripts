// ==UserScript==
// @name         Pepper product cards filter
// @description  Hide product cards by filter
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.pepper.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.75596238
// @icon         https://www.google.com/s2/favicons?sz=64&domain=pepper.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/pepper.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var j={5467:(x,c,t)=>{t.d(c,{E2:()=>h});var i=t(9928);function h(d,u={},e=null){const n=(0,i.Sw)(u,e);return n.append(d),n}function f(d,u=null,e={},n={}){const m=createActionLink(d,u,n);return h(m,e)}function l(d,u=null,e=null,n={},m={}){const g=createActionLinkWithIcon(d,e,u,m);return h(g,n)}},9928:(x,c,t)=>{t.d(c,{S:()=>d,Sw:()=>y,kU:()=>f,o5:()=>l});var i=t(4921),h=t(6754);function f(s,o,S){const b=u(s,"text",o);return b.value=S,b}function l(s,o,S,b,P,R){const L=u(s,"number",o);return L.value=S,L.step=b,L.min=P,L.max=R,L}function d(s,o,S){const b=u(s,"checkbox",o);return b.checked=S,b}function u(s={},o=null,S=null){const b=p("input",s);return o&&(b.type=o),S&&(b.addEventListener("keyup",(0,i.sg)(S,200)),b.addEventListener("change",(0,i.sg)(S,100))),b}function e(s={},o=null){return p("span",s,o)}function n(s={},o=null,S=null){const b=p("a",s,o);return S&&(b.href=S),b}function m(s,o=null,S={}){S.cursor||="pointer";const b=n(S,o);return s&&b.addEventListener("click",s),b}function g(s,o,S=null,b={},P={}){b.display||="inline-flex",b.alignItems||="center",b.gap||="0.25em";const R=m(s,S,b);return R.prepend(a(o,P)),R}function F(s={},o=null,S=null){const b=p("button",s,o);return S&&b.addEventListener("click",S),b}function y(s={},o=null){return p("div",s,o)}function T(s={}){return p("i",s)}function a(s,o={}){o.width||="1em",o.height||="1em",o.paddingBottom||="1px";const S=T(o);return S.setAttribute("data-lucide",s),S}function p(s,o,S=null){if(typeof o!="object"||o===null)throw new TypeError("styles should be an object");const b=document.createElement(s);return(0,h.ZM)(b,o),S&&(b.innerHTML=S),b}},573:(x,c,t)=>{t.d(c,{Fi:()=>f,YA:()=>e,fI:()=>l});var i=t(4214);function h(a,p=document){return!!p.querySelector(a)}function f(a,p=document,s=!1){const o=p.querySelector(a);return s&&!o&&console.log(`No element found for selector: ${a}`),o}function l(a,p=document,s=!1){const o=p.querySelectorAll(a);return s&&!o.length&&console.log(`No elements found for selector: ${a}`),o}function d(a,p,s){return[...a.querySelectorAll(p)].find(o=>o.textContent.trim().includes(s))}function u(a,p,s=!1,o=!1,S=null){const b=f(p,a);return e(b,s,o,S)}function e(a,p=!1,s=!1,o=null){if(!a)return o===null?(console.log("No element found"),null):o;const S=a.innerText;return g(S,p,s)}function n(a,p,s=!1){const o=a[p];return e(o,s)}function m(a,p=!1,s=!1){const o=a.textContent;return g(o,p,s)}function g(a,p,s){p&&(a=(0,i.zr)(a)),s&&(a=a.replace(",","."));const o=Number(a);return Number.isNaN(o)?(console.log(`Invalid number: ${a}`),0):o}function F(a){return[...a.childNodes].find(p=>p.nodeType===Node.TEXT_NODE)}function y(a){const p=s=>s.nodeType===Node.TEXT_NODE&&s.textContent.trim()!==""?[s]:[...s.childNodes].flatMap(p);return p(a)}function T(a){return normalizeSpacing(a.textContent)}},5539:(x,c,t)=>{t.d(c,{D9:()=>a,iV:()=>s,vJ:()=>p});function i(r,N){r.parentNode.insertBefore(N,r.nextSibling)}function h(r){r.style.display="none"}function f(r){g(r),h(r)}function l(r){r.intersectionObserver||runOnceOnIntersection(r,()=>h(r))}function d(r){r.style.display=""}function u(r){const N=m(r);r.style.display=N}function e(r,N){N?h(r):d(r)}function n(r,N){N?l(r):(clearIntersectionObserver(r),d(r))}function m(r){return g(r),r.defaultDisplay}function g(r){if(r.defaultDisplay)return;const{display:N}=getComputedStyle(r);r.defaultDisplay=N}function F(){return{show:[],hide:[]}}function y(r,N,k){r?N.hide.push(k):N.show.push(k)}function T(r){r.show.forEach(d),r.hide.forEach(h)}function a(r,N,k=.3){N?s(r,k):p(r)}function p(r){r.style.opacity=""}function s(r,N=.3){r.style.opacity=N}function o(r){r.style.order=""}function S(r,N){r.style.order=N}function b(r,N){r.style.background=N}function P(r,N){const k=getFirstElement(N);k&&R(r,k)}function R(r,N){const k=createLink();k.href=r,N.parentNode.append(k),k.append(N)}function L(r,N){const k=getFirstElement(N);k&&v(r,k)}function v(r,N){const k=createLink();k.href=r,k.append(...N.childNodes),N.append(k)}function C(){const r=getURLQueryParam("scrollTo");if(!r)return;const N=document.getElementById(r);N?N.scrollIntoView():console.log(`Element with ID "${r}" was not found.`)}function E(r,N,k="text/plain"){const O=new Blob([r],{type:k}),B=URL.createObjectURL(O),w=document.createElement("a");w.href=B,w.download=N,document.body.appendChild(w),w.click(),document.body.removeChild(w),requestAnimationFrame(()=>URL.revokeObjectURL(B))}},6754:(x,c,t)=>{t.d(c,{ZM:()=>i});function i(d,u){Object.assign(d.style,u)}function h(d,u="custom-global-style"){let e=document.getElementById(u);e||(e=document.createElement("style"),e.id=u,e.type="text/css",document.head.appendChild(e)),e.textContent=d}function f(d){return Object.entries(d).map(([u,e])=>`${u.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${e};`).join(" ")}function l(d){return d?d.split(";").filter(u=>u.trim()!=="").reduce((u,e)=>{const[n,m]=e.split(":").map(F=>F.trim()),g=n.replace(/-([a-z])/g,(F,y)=>y.toUpperCase());return u[g]=m,u},{}):{}}},4921:(x,c,t)=>{t.d(c,{sg:()=>l});function i(e,n,m=null){const g=e.querySelector(n);return g?Promise.resolve(g):new Promise(F=>{const y=new MutationObserver(a);y.observe(e,{childList:!0,subtree:!0});let T;m&&(T=setTimeout(()=>{y.disconnect(),console.log(`No element found for selector: ${n}`),F(null)},m));function a(){const p=e.querySelector(n);p&&(T&&clearTimeout(T),y.disconnect(),F(p))}})}function h(e,n){return e.querySelector(n)?new Promise(g=>{const F=new MutationObserver(y);F.observe(e,{childList:!0,subtree:!0});function y(){e.querySelector(n)||(F.disconnect(),g())}}):Promise.resolve()}function f(e,n=400){return new Promise(m=>{let g;const F=new MutationObserver(()=>{clearTimeout(g),y()});function y(){g=setTimeout(()=>{F.disconnect(),m()},n)}y(),F.observe(e,{childList:!0,subtree:!0})})}function l(e,n=250){let m;return(...g)=>{clearTimeout(m),m=setTimeout(()=>e(...g),n)}}function d(e,n){const m=new IntersectionObserver(g=>{g.forEach(F=>{F.isIntersecting&&(n(),u(e))})});e.intersectionObserver=m,m.observe(e)}function u(e){e.intersectionObserver&&(e.intersectionObserver.disconnect(),e.intersectionObserver=null)}},3829:(x,c,t)=>{t.d(c,{Ay:()=>h,JE:()=>l,iG:()=>d});var i=t(8355);function h(e,n){return!f(e,n)}function f(e,n){if(!n.value)return!0;const m=e.toLowerCase(),g=(0,i.R)(n),F=[],y=[];return g.forEach(T=>{if(T.startsWith("!")){const a=T.substring(1);a&&y.push(a)}else F.push(T)}),F.every(T=>m.includes(T))&&y.every(T=>!m.includes(T))}function l(e,n){return n.value!=null&&e<n.value}function d(e,n){return n.value!=null&&e>n.value}function u(e,n){return n.value&&e!==n.value}},4521:(x,c,t)=>{t.d(c,{z:()=>h});var i=t(3048);function h(f,l=null){return{createGlobalFilter(d,u=null,e=f){return i.V.create(d,u,e)},createSectionFilter(d,u=null,e=f){if(!l)throw new Error("sectionId must be provided to use createSectionFilter.");return i.V.createWithCompositeKey(l,d,u,e)}}}},5884:(x,c,t)=>{t.d(c,{Hw:()=>d,Nm:()=>f,nW:()=>l});var i=t(9928),h=t(5467);function f(u,e,n={},m={}){const g=(0,i.kU)(m,e.updateValueFromEvent,e.value);return(0,h.E2)(g,n,u)}function l(u,e,n,m,g,F={},y={}){const T=(0,i.o5)(y,e.updateValueFromEvent,e.value,n,m,g);return(0,h.E2)(T,F,u)}function d(u,e,n={},m={}){const g=(0,i.S)(m,e.updateValueFromEvent,e.value);return(0,h.E2)(g,n,u)}},7877:(x,c,t)=>{t.d(c,{E9:()=>h,H1:()=>T,pW:()=>L});var i=t(5884);function h(v,C={},E={}){return(0,i.Nm)("\u041F\u043E\u0438\u0441\u043A: ",v,C,E)}function f(v,C={},E={},r=.1,N=3){return createNumberFilterControl("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",v,r,N,5,C,E)}function l(v,C={},E={},r=.1,N=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",v,r,N,5,C,E)}function d(v,C={},E={}){return e("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",v,C,E)}function u(v,C={},E={}){return e("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",v,C,E)}function e(v,C,E={},r={}){return createNumberFilterControl(v,C,"1","1","999999",E,r)}function n(v,C={},E={}){return m("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",v,C,E)}function m(v,C,E={},r={}){return createNumberFilterControl(v,C,"5","0","100",E,r)}function g(v,C={},E={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",v,"5","0","100",C,E)}function F(v,C,E={},r={},N="250"){return(0,i.nW)(v,C,N,"0","1000000",E,r)}function y(v,C={},E={},r="25"){return F("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",v,C,E,r)}function T(v,C={},E={},r="25"){return F("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",v,C,E,r)}function a(v,C={},E={}){return p("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",v,C,E)}function p(v,C,E={},r={}){return createNumberFilterControl(v,C,"1","0","99999",E,r)}function s(v,C={},E={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",v,"1","2","7",C,E)}function o(v,C={},E={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",v,1,1,10,C,E)}function S(v,C={},E={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",v,C,E)}function b(v,C={},E={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",v,C,E)}function P(v,C={},E={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",v,C,E)}function R(v,C={},E={}){return createCheckboxFilterControl("\u0411\u0430\u043B\u043B\u044B: ",v,C,E)}function L(v,C={},E={}){return(0,i.Hw)("\u0412\u043A\u043B: ",v,C,E)}},8355:(x,c,t)=>{t.d(c,{R:()=>i});function i(f){return f.value.toLowerCase().split(",").map(l=>l.trim()).filter(l=>l!=="")}function h(f){return i(f).filter(l=>!l.startsWith("!"))}},5213:(x,c,t)=>{t.d(c,{b:()=>f});var i=t(9928),h=t(573);function f(l,d,u=!1,e="customFiltersContainer"){let n=(0,h.Fi)(`#${e}`,l);if(n)if(u)n.remove();else return;n=(0,i.Sw)(),n.id=e,d(n,l)}},8200:(x,c,t)=>{t.d(c,{s:()=>i});function i(h){const{target:f}=h,{type:l}=f;switch(l){case"text":return`"${f.value}"`;case"number":return f.value;case"checkbox":return f.checked;default:return console.log(`Unknown input type: ${l}`),null}}},157:(x,c,t)=>{t.d(c,{Fg:()=>i,vx:()=>f});const i=window.GM_setValue,h=window.GM.setValue,f=window.GM_getValue,l=window.GM_addValueChangeListener},1870:(x,c,t)=>{t.d(c,{j:()=>i});class i{constructor(f,l){this.value=f,this.onChange=l}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(x,c,t)=>{t.d(c,{V:()=>d});var i=t(1870),h=t(8200),f=t(3976),l=t(157);class d extends i.j{constructor(e,n=null,m=null){super((0,l.vx)(e,n),m),this.storageKey=e,this.defaultValue=n}static create(e,n=null,m=null){return new d(e,n,m)}static createWithCompositeKey(e,n,m=null,g=null){const F=`${e}-${n}`;return new d(F,m,g)}updateValueFromEvent=e=>{const n=(0,h.s)(e),m=(0,f.$)(n);this.updateValue(m)};updateValue(e,n=!0){this.value!==e&&((0,l.Fg)(this.storageKey,e),this.value=e,n&&this.onChangeIfDefined())}clearValue(e=!1){this.updateValue(null,e)}resetValue(e=!1){this.updateValue(this.defaultValue,e)}}},3976:(x,c,t)=>{t.d(c,{$:()=>i});function i(h){return h===""?null:JSON.parse(h)}},4214:(x,c,t)=>{t.d(c,{zr:()=>h});function i(u){return u.replace(/\D/g,"")}function h(u){return u.replace(/[^\d.,-]/g,"")}function f(u){return u.replace(/\s/g,"")}function l(u){return u.charAt(0).toUpperCase()+u.slice(1)}function d(u){return u.replace(/\s+/g," ").trim()}},1365:(x,c,t)=>{t.d(c,{i:()=>i});const i={MARK_AS_NEWEST_SEEN_APPENDED:"markAsNewestSeenAppended"}},7234:(x,c,t)=>{t.d(c,{CU:()=>f,Fr:()=>d,MB:()=>u,Su:()=>h,X0:()=>l,sV:()=>e});var i=t(157);function h(n){(0,i.Fg)("newest-seen-product-id",n)}function f(){return(0,i.vx)("newest-seen-product-id")}function l(n){(0,i.Fg)("prev-newest-seen-product-id",n)}function d(){return(0,i.vx)("prev-newest-seen-product-id")}function u(){(0,i.Fg)("last-newest-seen-product-update",Date.now())}function e(){return(0,i.vx)("last-newest-seen-product-update")}},9374:(x,c,t)=>{t.a(x,async(i,h)=>{try{let R=function(){const w=(0,e.fI)(g.Z.PRODUCT_CARD);if(console.log(w.length),w.length){const I=w[0].parentElement;(0,f.b)(I,L),v(),new MutationObserver(v).observe(I,{childList:!0,subtree:!0})}},L=function(w,I){(0,a.ZM)(w,F.r.FILTERS_CONTAINER);const A=(0,n.E9)(s,F.r.CONTROL,F.r.TEXT_INPUT),V=(0,d.nW)("\u041C\u0438\u043D. \u0433\u043E\u043B\u043E\u0441\u043E\u0432: ",o,"50","0","10000",F.r.CONTROL,F.r.NUMBER_INPUT),D=(0,n.H1)(S,F.r.CONTROL,F.r.NUMBER_INPUT),U=(0,d.Hw)("\u0417\u0430\u0432\u0435\u0440\u0448\u0451\u043D\u043D\u044B\u0435: ",b,F.r.CONTROL,F.r.CHECKBOX_INPUT),G=(0,n.pW)(P,F.r.CONTROL,F.r.CHECKBOX_INPUT);w.append(A,V,D,U,G),I.prepend(w)},v=function(){(0,e.fI)(g.Z.PRODUCT_CARD).forEach(C)},C=function(w){const I=(0,e.Fi)(g.Z.PRODUCT_CARD_LINK,w),A=E(I);if(r(A,w),N(w,I,A),!P.value){(0,u.vJ)(w);return}if(w.classList.contains("expired-view")&&!b.value){(0,u.iV)(w);return}const D=(0,e.Fi)(g.Z.PRODUCT_CARD_RATING,w);if(D.innerText.includes("\u041D\u043E\u0432\u043E\u0435"))return;const U=(0,e.Fi)(g.Z.PRODUCT_NAME,w),G=(0,e.Fi)(g.Z.PRODUCT_PRICE,w),Z=U.innerText,z=(0,e.YA)(D,!0),X=(0,e.YA)(G,!0),Q=(0,l.Ay)(Z,s)||(0,l.JE)(z,o)||(0,l.iG)(X,S);(0,u.D9)(w,Q)},E=function(w){return+w.getAttribute("href").split("-").pop()},r=function(w,I){w>(0,y.Fr)()?I.style.border="3px solid #8ab854":I.style.removeProperty("border")},N=function(w,I,A){w.hasAttribute(T.i.MARK_AS_NEWEST_SEEN_APPENDED)||(w.addEventListener("mousedown",V=>{if(V.button===1&&V.target!==I){const D=(0,y.sV)(),U=`\u041F\u043E\u043C\u0435\u0442\u0438\u0442\u044C \u043A\u0430\u043A \u043D\u043E\u0432\u043E\u0435?

${k(D)}`;confirm(U)&&(O(A),V.preventDefault())}}),w.setAttribute(T.i.MARK_AS_NEWEST_SEEN_APPENDED,""))},k=function(w){const I=w?new Date(w):null;if(!I)return"";let A=Math.floor((Date.now()-I.getTime())/6e4);const V=Math.floor(A/1440);A-=V*1440;const D=Math.floor(A/60),U=A-D*60;return V>0?`\u0421 \u043F\u0440\u043E\u0448\u043B\u043E\u0433\u043E \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u043F\u0440\u043E\u0448\u043B\u043E ${V} \u0434. ${D} \u0447. ${U} \u043C.`:D>0?`\u0421 \u043F\u0440\u043E\u0448\u043B\u043E\u0433\u043E \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u043F\u0440\u043E\u0448\u043B\u043E ${D} \u0447. ${U} \u043C.`:`\u0421 \u043F\u0440\u043E\u0448\u043B\u043E\u0433\u043E \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u043F\u0440\u043E\u0448\u043B\u043E ${U} \u043C.`},O=function(w){const I=(0,y.CU)();(0,y.X0)(I),(0,y.Su)(w),(0,y.MB)(),v()};var f=t(5213),l=t(3829),d=t(5884),u=t(5539),e=t(573),n=t(7877),m=t(4521),g=t(2756),F=t(8050),y=t(7234),T=t(1365),a=t(6754);const{createGlobalFilter:p}=(0,m.z)(R),s=p("name-filter"),o=p("min-votes-filter",50),S=p("max-price-filter"),b=p("show-expired-filter",!1),P=p("filter-enabled",!0);await B(),R();async function B(){const w=(0,e.Fi)(g.Z.DISCUSSIONS);w&&(w.style.position="sticky",w.style.top="0")}h()}catch(p){h(p)}},1)},2756:(x,c,t)=>{t.d(c,{Z:()=>i});const i={DISCUSSIONS:"div.md\\:block.hidden.common-box:nth-of-type(3)",PRODUCT_CARD:".deal-card",PRODUCT_CARD_RATING:".common-box span",PRODUCT_NAME:".custom-card-title",PRODUCT_CARD_LINK:".custom-card-title > a",PRODUCT_PRICE:"div.md\\:text-xll.text-lg.font-bold.text-primary.mr-2"}},8050:(x,c,t)=>{t.d(c,{r:()=>h});const i={INPUT:{border:"1px solid #d1d5db",borderRadius:"8px",marginLeft:"7px"}},h={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",padding:"11px 19px",marginBottom:".5rem",backgroundColor:"#fff",borderWidth:"1px",borderColor:"rgb(229, 229, 229)",borderRadius:"10px",position:"sticky",zIndex:"11",top:"-1px"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...i.INPUT,width:"180px",padding:"7px 14px",backgroundColor:"#fff"},NUMBER_INPUT:{...i.INPUT,width:"90px",padding:"7px 14px",backgroundColor:"#fff"},CHECKBOX_INPUT:{...i.INPUT,width:"24px",height:"24px"}}}},H={};function $(x){var c=H[x];if(c!==void 0)return c.exports;var t=H[x]={exports:{}};return j[x](t,t.exports,$),t.exports}(()=>{var x=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",c=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",t=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",i=f=>{f&&f.d<1&&(f.d=1,f.forEach(l=>l.r--),f.forEach(l=>l.r--?l.r++:l()))},h=f=>f.map(l=>{if(l!==null&&typeof l=="object"){if(l[x])return l;if(l.then){var d=[];d.d=0,l.then(n=>{u[c]=n,i(d)},n=>{u[t]=n,i(d)});var u={};return u[x]=n=>n(d),u}}var e={};return e[x]=n=>{},e[c]=l,e});$.a=(f,l,d)=>{var u;d&&((u=[]).d=-1);var e=new Set,n=f.exports,m,g,F,y=new Promise((T,a)=>{F=a,g=T});y[c]=n,y[x]=T=>(u&&T(u),e.forEach(T),y.catch(a=>{})),f.exports=y,l(T=>{m=h(T);var a,p=()=>m.map(o=>{if(o[t])throw o[t];return o[c]}),s=new Promise(o=>{a=()=>o(p),a.r=0;var S=b=>b!==u&&!e.has(b)&&(e.add(b),b&&!b.d&&(a.r++,b.push(a)));m.map(b=>b[x](S))});return a.r?s:p()},T=>(T?F(y[t]=T):g(n),i(u))),u&&u.d<0&&(u.d=0)}})(),$.d=(x,c)=>{for(var t in c)$.o(c,t)&&!$.o(x,t)&&Object.defineProperty(x,t,{enumerable:!0,get:c[t]})},$.o=(x,c)=>Object.prototype.hasOwnProperty.call(x,c);var J=$(9374)})();})();
