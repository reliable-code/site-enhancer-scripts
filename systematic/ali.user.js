// ==UserScript==
// @name         Aliexpress product cards filter
// @description  Hide product cards by filter
// @grant        GM_addStyle
// @grant        GM_deleteValue
// @grant        GM_listValues
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://aliexpress.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.77144487
// @icon         https://www.google.com/s2/favicons?sz=64&domain=aliexpress.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/ali.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var ge={9830:(b,g,r)=>{r.a(b,async(h,L)=>{try{var p=r(5406),d=r(4921),_=r(6113),a=r(5413),T=r(7708);(0,_.N)(),await(0,d.Un)(R),(0,p.k1)(async()=>{await R(!0)});async function R(E=!1){if(await(0,d.XW)(document.head),(0,p.z2)("category","store","wholesale")){await(0,a.P)(E);return}(0,p.z2)("item")&&await(0,T.K)(E)}L()}catch(R){L(R)}},1)},6113:(b,g,r)=>{r.d(g,{N:()=>p,p:()=>d});const h=`.us-control{color:#898993!important;&:hover{color:#547dff!important}}#customFiltersContainer{padding:8px 0 8px 3px!important}[class*=RedSeoFilter_TopPanel__container__] #customFiltersContainer{padding:5px 0 18px 3px!important}[class*=RedFilter_FilterHeader__filterHeaderContainer__]{padding:0!important}[class*=RedFilter_RedFilter__topPadding__]{padding-top:2px!important}span[class*=rating_Rating__rating__]+span[class*=red-ali-kit_Body__M__]{padding-top:1px!important}
`;var L=r(5406);function p(){window.GM_addStyle(h)}function d(){return(0,L.C$)(2,"unknown").replace(".html","")}},7549:(b,g,r)=>{r.d(g,{r:()=>h});const h={DISLIKE_CONTROL:{marginLeft:"auto",gap:"3px"},DISLIKE_BUTTON_ICON_SM:{height:"0.9em",marginBottom:"1px",marginRight:"2px"},DISLIKE_BUTTON_ICON_MD:{marginTop:"1px"},REMOVE_DISLIKE_BUTTON_ICON_SM:{height:"0.9em",marginBottom:"1px"},REMOVE_DISLIKE_BUTTON_ICON_MD:{marginBottom:"1px"}}},5413:(b,g,r)=>{r.d(g,{P:()=>Ae});var h=r(4921),L=r(5539),p=r(573);const d={PRODUCT_LIST_CONTAINER:['[class*="RedFilter_RedFilter__centerBlock__"]','[class*="RedSeoFilter_RedSeoFilter__centerBlock__"]','[class*="ShopFilter_ShopFilter__centerBlock__"]'].join(", "),PRODUCT_LIST_HEADER:['[class*="RedFilter_TopPanel__container__"]','[class*="RedSeoFilter_TopPanel__container__"]','[class*="ShopFilter_TopPanel__container__"]'].join(", "),PRODUCT_LIST:['[class*="red-snippet_RedSnippet__grid__"]'].join(", "),PRODUCT:'[class^="red-snippet_RedSnippet__container__"]',PRODUCT_NAME:'[class^="red-snippet_RedSnippet__title__"]',PRODUCT_RATING_CONTAINER:'[class^="red-snippet_RedSnippet__trust__"]',PRODUCT_RATING_WRAP:":scope > div:has(img) > span",PRODUCT_PURCHASES_WRAP:":scope > div:not(:has(img)) > span"};function _(t){if(!t)return[];const n=a(t).flat().filter(i=>i&&!i.isNegative&&i.term).map(i=>i.term);return[...new Set(n)]}function a(t){return t?t.toLowerCase().split(",").map(T).filter(Boolean):[]}function T(t){const e=t.split("/").map(i=>i.trim()).filter(Boolean);if(e.length===0)return null;const n=e.map(R).filter(Boolean);return n.length>0?n:null}function R(t){const e=t.startsWith("!"),n=e?t.slice(1).trim():t;return n?{term:n,isNegative:e}:null}function E(t,e){D(t,n=>n.style.display!=="none",e)}function C(t,e){D(t,n=>n.style.opacity==="",e)}function D(t,e,n){const i=[...t].filter(e).length,y=t.length;f(n,i,y)}function f(t,e,n){t.textContent=`\u041F\u043E\u043A\u0430\u0437\u0430\u043D\u043E: ${e} \u0438\u0437 ${n}`}function s(t,e){return!v(t,e)}function v(t,e){if(!e||!e.value)return!0;const n=a(e.value);return o(t,n)}function o(t,e){if(!e||!e.length)return!0;const n=(t||"").toLowerCase();return e.every(i=>m(n,i))}function m(t,e){return e.some(({term:n,isNegative:i})=>{const y=t.includes(n);return i?!y:y})}function c(t,e){return e.value!=null&&t<e.value}function l(t,e){return e.value!=null&&t>e.value}function I(t,e){return e.value==null?!1:t<parseDateFromISO(e.value)}function S(t,e){return e.value==null?!1:t>parseDateFromISO(e.value)}function k(t,e){return e.value&&t!==e.value}function $(t){let i=2166136261;for(let y=0;y<t.length;y+=1){const A=t.charCodeAt(y);i^=A,i=Math.imul(i,16777619)}return i>>>0}function B(t){return $(t).toString(16).padStart(8,"0")}function Y(t,e="common"){return t?B(t):e}var ue=r(6754);const Z={INPUT:{marginLeft:"6px",border:"1px solid #d9d9d9",borderRadius:"8px",padding:"7px 14px 6px",fontSize:"15px"},CONTROL:{display:"flex",alignItems:"center",fontSize:"14px"}},M={FILTERS_CONTAINER:{display:"flex",justifyContent:"flex-end",gap:"12px"},CONTROL:Z.CONTROL,TEXT_INPUT_CONTROL:{...Z.CONTROL,flexGrow:1},TEXT_INPUT:{...Z.INPUT,flexGrow:1},NUMBER_INPUT:{...Z.INPUT,width:"85px"},CHECKBOX_INPUT:{marginLeft:"6px",width:"21px",height:"21px",webkitAppearance:"auto"}};var G=r(7549),K=r(5406),ne=r(7273);function H(t,e={},n=null){const i=(0,ne.S)(e,n);return i.append(t),i}function _e(t,e=null,n={},i={}){const y=createActionLink(t,e,i);return H(y,n)}function re(t,e=null,n=null,i={},y={},A={}){const w=createActionLinkWithIcon(t,n,e,y,A);return H(w,i)}var se=r(5558);function ae(t,e,n){const i=P(t,"text",e);return i.value=n,i}function le(t,e,n,i,y,A){const w=P(t,"number",e);return w.value=n,w.step=i,w.min=y,w.max=A,w}function u(t,e,n){const i=P(t,"date",e);return i.value=n,i}function O(t,e,n){const i=P(t,"checkbox",e);return i.checked=n,i}function P(t={},e=null,n=null){const i=(0,se.n)("input",t);return e&&(i.type=e),n&&(i.addEventListener("keyup",(0,h.sg)(n,200)),i.addEventListener("change",(0,h.sg)(n,100))),i}function x(t,e,n){const i=createElement("select",t);return e&&i.addEventListener("change",e),i.value=n,i}function X(t,e,n={},i={}){const y=ae(i,e.updateValueFromEvent,e.value);return H(y,n,t)}function N(t,e,n,i,y,A={},w={}){const j=le(w,e.updateValueFromEvent,e.value,n,i,y);return H(j,A,t)}function oe(t,e,n={},i={}){const y=createSelect(i,e.updateValueFromEvent,e.value);return createControl(y,n,t)}function Qe(t,e,n={},i={}){const y=createDateInput(i,e.updateValueFromEvent,e.value);return createControl(y,n,t)}function Ce(t,e,n={},i={}){const y=O(i,e.updateValueFromEvent,e.value);return H(y,n,t)}function ve(t,e={},n={}){return X("\u041F\u043E\u0438\u0441\u043A: ",t,e,n)}function ye(t,e={},n={},i=.1,y=3){return N("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",t,i,y,5,e,n)}function Ye(t,e={},n={},i=.1,y=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",t,i,y,5,e,n)}function Ze(t,e={},n={}){return ce("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",t,e,n)}function Je(t,e={},n={}){return ce("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",t,e,n)}function ce(t,e,n={},i={}){return createNumberFilterControl(t,e,"1","1","999999",n,i)}function qe(t,e={},n={}){return createDateFilterControl("\u041C\u0438\u043D. \u0434\u0430\u0442\u0430: ",t,e,n)}function et(t,e={},n={}){return Re("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",t,e,n)}function Re(t,e,n={},i={}){return createNumberFilterControl(t,e,"5","0","100",n,i)}function tt(t,e={},n={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",t,"5","0","100",e,n)}function de(t,e,n={},i={},y="250"){return createNumberFilterControl(t,e,y,"0","1000000",n,i)}function nt(t,e={},n={},i="25"){return de("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",t,e,n,i)}function rt(t,e={},n={},i="25"){return de("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",t,e,n,i)}function ot(t,e={},n={}){return De("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",t,e,n)}function De(t,e,n={},i={}){return createNumberFilterControl(t,e,"1","0","99999",n,i)}function it(t,e={},n={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",t,"1","2","8",e,n)}function Te(t,e={},n={}){return N("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",t,1,1,10,e,n)}function ut(t,e={},n={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",t,e,n)}function st(t,e={},n={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",t,e,n)}function at(t,e={},n={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",t,e,n)}function lt(t,e={},n={}){return createCheckboxFilterControl("\u0411\u043E\u043D\u0443\u0441: ",t,e,n)}function ct(t,e={},n={}){return createCheckboxFilterControl("\u0412 \u043D\u0430\u043B\u0438\u0447\u0438\u0438: ",t,e,n)}function Le(t,e={},n={}){return Ce("\u0412\u043A\u043B: ",t,e,n)}function dt(t,e,n={}){const i=[{value:-25,emoji:"\u{1F48E}",tooltip:"\u0421\u0443\u043F\u0435\u0440 \u0446\u0435\u043D\u0430 (-25%)"},{value:-15,emoji:"\u{1F525}",tooltip:"\u041E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-15%)"},{value:-5,emoji:"\u{1F31F}",tooltip:"\u041A\u043B\u0430\u0441\u0441\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-5%)"},{value:5,emoji:"\u{1F44C}",tooltip:"\u0425\u043E\u0440\u043E\u0448\u0430\u044F \u0446\u0435\u043D\u0430 (+5%)"}],y={active:{background:"#e3f2fd",borderColor:"#2196f3",boxShadow:"0 0 0 1px #2196f3"},inactive:{background:"#fff",borderColor:"#ccc",boxShadow:"none"},hover:{background:"#f5f5f5"}},A=createDiv({display:"inline-flex",gap:"4px",marginLeft:"4px"}),w=[],j=()=>e?parseFloat(e.value)||0:t.value,W=()=>{const V=j();w.forEach(({button:ee,value:te})=>{const Q=te<=V?y.active:y.inactive;Object.assign(ee.style,Q)})};return i.forEach(({value:V,emoji:ee,tooltip:te})=>{const U=createButton({padding:"2px 6px",fontSize:"16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"#fff",transition:"all 0.2s",...n},ee);U.title=te,U.type="button",U.addEventListener("click",Q=>{Q.preventDefault(),t.updateValue(V),e&&(e.value=V),W()}),U.addEventListener("mouseenter",()=>{V<=j()||(U.style.background=y.hover.background)}),U.addEventListener("mouseleave",()=>{W()}),w.push({button:U,value:V}),A.appendChild(U)}),W(),e&&(e.addEventListener("input",W),e.addEventListener("change",W)),A}function Oe(t,e,n=!1,i="customFiltersContainer"){let y=t.querySelector(`#${i}`);if(y){if(!n)return;y.replaceChildren()}else y=(0,ne.S)(),y.id=i;e(y,t)}class be{constructor(e,n){this.value=e,this.onChange=n}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}function Ie(t){const{target:e}=t,{type:n}=e;switch(n){case"text":return`"${e.value}"`;case"number":return e.value;case"select-one":return e.value;case"date":return`"${e.value}"`;case"checkbox":return e.checked;default:return console.log(`Unknown input type: ${n}`),null}}function Pe(t){return t===""?null:JSON.parse(t)}var fe=r(157);class J extends be{constructor(e,n=null,i=null){super((0,fe.vx)(e,n),i),this.storageKey=e,this.defaultValue=n}static create(e,n=null,i=null){return new J(e,n,i)}static createWithCompositeKey(e,n,i=null,y=null){const A=`${e}-${n}`;return new J(A,i,y)}updateValueFromEvent=e=>{const n=Ie(e),i=Pe(n);this.updateValue(i)};updateValue(e,n=!0){this.value!==e&&((0,fe.Fg)(this.storageKey,e),this.value=e,n&&this.onChangeIfDefined())}clearValue(e=!1){this.updateValue(null,e)}resetValue(e=!1){this.updateValue(this.defaultValue,e)}}function Fe(t,e=null){return{createGlobalFilter(n,i=null,y=t){return J.create(n,i,y)},createSectionFilter(n,i=null,y=t){if(!e)throw new Error("sectionId must be provided to use createSectionFilter.");return J.createWithCompositeKey(e,n,i,y)}}}var pe=r(6700),me=r(9412);const we=window.GM_addValueChangeListener,Se=(0,me.wq)(he),F={productListContainer:null,productListObserver:null,containerObserver:null,isFiltersInitialized:!1,filters:{nameFilter:null,minPurchasesFilter:null,minRatingFilter:null,maxNameLines:null,filterEnabled:null},productCardsCache:new WeakMap};async function Ae(t){t&&He(),Ne(),Me()}function Ne(){if(!F.isFiltersInitialized){const t=xe(),{createGlobalFilter:e,createSectionFilter:n}=Fe(q,t);F.filters.nameFilter=n("name-filter"),F.filters.minPurchasesFilter=n("min-purchases-filter"),F.filters.minRatingFilter=n("min-rating-filter",4.8),F.filters.maxNameLines=e("max-name-lines",4),F.filters.filterEnabled=n("filter-enabled",!0),F.isFiltersInitialized=!0}}function xe(){return Y(ke())}function ke(){return(0,K.z2)("store")?(0,K.Fc)(2):(0,K.z2)("category")?(0,K.Fc)(3):(0,K.z2)("wholesale")?(0,K.$F)("SearchText"):"common"}function Me(){F.productListContainer=(0,p.Fi)(d.PRODUCT_LIST_CONTAINER),F.productListContainer&&(Ee(),F.containerObserver=new MutationObserver((0,h.sg)(Ee)),F.containerObserver.observe(F.productListContainer,{childList:!0,subtree:!0}))}function Ee(){const t=(0,p.Fi)(d.PRODUCT_LIST_HEADER,F.productListContainer);if(!t)return;const e=(0,p.Fi)(d.PRODUCT_LIST,F.productListContainer);e&&(Oe(t,Ue),we(pe.d5.LAST_RATE_UPDATE,()=>q(!0)),q(!1),F.productListObserver&&(0,h.wP)(F.productListObserver),F.productListObserver=new MutationObserver(()=>q(!1)),F.productListObserver.observe(e,{childList:!0}))}function Ue(t,e){(0,ue.ZM)(t,M.FILTERS_CONTAINER);const n=ve(F.filters.nameFilter,M.TEXT_INPUT_CONTROL,M.TEXT_INPUT),i=N("\u041C\u0438\u043D. \u043F\u043E\u043A\u0443\u043F\u043E\u043A: ",F.filters.minPurchasesFilter,"1","1","999999",M.CONTROL,M.NUMBER_INPUT),y=ye(F.filters.minRatingFilter,M.CONTROL,M.NUMBER_INPUT),A=Te(F.filters.maxNameLines,M.CONTROL,M.NUMBER_INPUT),w=Le(F.filters.filterEnabled,M.CONTROL,M.CHECKBOX_INPUT);t.append(n,i,y,A,w),e.append(t)}function q(t=!1){(0,p.fI)(d.PRODUCT).forEach(n=>{Be(n,t)})}function Be(t,e){if(!F.filters.filterEnabled.value){(0,L.kl)(t);return}let n=F.productCardsCache.get(t);if(n)e&&Se(n);else{const y=(0,p.Fi)("a",t),A=(0,p.Fi)(d.PRODUCT_NAME,t),w=(0,p.Fi)(d.PRODUCT_RATING_CONTAINER,t);if(!y||!A||!w){(0,L.Bt)(t);return}const j=A.innerText,{productId:W}=t.dataset,{ratingWrap:V,purchasesCount:ee,rating:te,storedRating:U,originalRating:Q}=We(w,y,W),Ge=ze(w,W,U);n={productId:W,nameWrap:A,name:j,ratingWrap:V,purchasesCount:ee,rating:te,storedRating:U,originalRating:Q,dislikeControls:Ge},F.productCardsCache.set(t,n)}je(n.nameWrap);const i=s(n.name,F.filters.nameFilter)||c(n.purchasesCount,F.filters.minPurchasesFilter)||c(n.rating,F.filters.minRatingFilter);(0,L.UC)(t,i)}function We(t,e,n){const i=(0,p.Fi)(d.PRODUCT_PURCHASES_WRAP,t),y=(0,p.YA)(i,!0,!1,0);if(i){const V=(0,K.y_)(e.getAttribute("href"));Ke(i,V,n)}const A=(0,pe.b$)(n),w=(0,p.Fi)(d.PRODUCT_RATING_WRAP,t),j=w?.textContent,W=$e(A,w);return{ratingWrap:w,purchasesCount:y,rating:W,storedRating:A,originalRating:j}}function Ke(t,e,n){const i=Ve(e,n);(0,L.y4)(i,t)}function Ve(t,e){const n=new URL(t),i=n.pathname.split("/");return`${n.origin}/${i[1]}/${e}/reviews`}function $e(t,e){return t?(e&&he(e,t),t):(0,p.YA)(e,!0,!1,0)}function he(t,e){t.textContent=e.toString().padEnd(5)}function je(t){const e=F.filters.maxNameLines.value;t.style.height=`${e}lh`,t.style.maxHeight=`${e}lh`,t.style.webkitLineClamp=e}function ze(t,e,n){const i=()=>q(!0),y={needLabel:!1,onDislike:i,onRemoveDislike:i,styles:{link:G.r.DISLIKE_CONTROL,dislikeIcon:G.r.DISLIKE_BUTTON_ICON_MD,removeDislikeIcon:G.r.REMOVE_DISLIKE_BUTTON_ICON_MD}};return(0,me.xb)(t,e,n,y)}function He(){F.productListContainer=null,F.isFiltersInitialized=!1,F.filters={nameFilter:null,minPurchasesFilter:null,minRatingFilter:null,maxNameLines:null,filterEnabled:null},F.productCardsCache=new WeakMap,(0,h.wP)(F.containerObserver),(0,h.wP)(F.productListObserver)}},7708:(b,g,r)=>{r.d(g,{K:()=>D});var h=r(6113),L=r(6700);const p={EXTRA_INFO:'[class*="HazeProductDescription_HazeProductDescription__extraInfo__"]:not([class*="__stickyOffer__"])',RATING_WRAP:'[class*="HazeProductDescription_HazeProductDescription__ratingWrap__"] > span:nth-of-type(2)',REVIEWS_LINK:'a[href="#reviews_anchor"]'};var d=r(573),_=r(4921),a=r(7273);const T={DISLIKE_CONTROLS_WRAP:{width:"100%",marginTop:"5px",fontSize:"15px",fontWeight:"500"}};var R=r(7549),E=r(9412);const C={productId:null,extraInfo:null,originalRating:null,ratingWraps:[],dislikeControls:null};async function D(l){l&&c(),C.productId=(0,h.p)(),C.extraInfo=await(0,_.xk)(document,p.EXTRA_INFO),await Promise.all([f(),v(),o()])}async function f(){if(C.ratingWraps=(0,d.fI)(p.RATING_WRAP),!C.ratingWraps.length)return;const l=(0,L.b$)(C.productId);l&&s(l)}function s(l){C.ratingWraps.forEach(I=>{C.originalRating??=I.textContent,I.textContent=l})}async function v(){const l=await(0,_.xk)(C.extraInfo,p.REVIEWS_LINK);l&&(l.href=`${window.location.pathname.replace(".html","")}/reviews`)}function o(){const l=(0,a.S)(T.DISLIKE_CONTROLS_WRAP),I=(0,L.b$)(C.productId);C.dislikeControls=(0,E.xb)(l,C.productId,I,{needLabel:!0,onDislike:S=>m(S,S),onRemoveDislike:S=>m(C.originalRating,S),styles:{link:R.r.DISLIKE_CONTROL,dislikeIcon:R.r.DISLIKE_BUTTON_ICON_SM,removeDislikeIcon:R.r.REMOVE_DISLIKE_BUTTON_ICON_SM}}),C.extraInfo.append(l)}function m(l,I){s(l),(0,E.nF)(I,C.dislikeControls)}function c(){C.productId=null,C.extraInfo=null,C.originalRating=null,C.ratingWraps=[],C.dislikeControls=null}},5059:(b,g,r)=>{var h=r(157);const L=window.GM_listValues;function p(R,E,C=!1){getStorageValue("dbVersion")!==E&&(R(),!C&&setStorageValue("dbVersion",E))}function d(R,E=!0){const C=L();a(C,R,E)}function _(R,E,C=!0){const f=L().filter(R);a(f,E,C)}function a(R,E,C){let D=0;R.forEach(f=>{const s=getStorageValue(f);C&&console.log(f,s),E(f,s),D+=1}),C&&console.log(`Total entries processed: ${D}`)}function T(R,E=!1){_(R,D=>{E||window.GM_deleteValue(D)})}},6700:(b,g,r)=>{r.d(g,{b$:()=>E,d5:()=>d,v7:()=>_});var h=r(157),L=r(6001),p=r(5059);const d={LAST_RATE_UPDATE:"last-rate-update",REVIEWS_LAST_PRODUCT_ARTICLE:"reviews-last-product-article"};function _(s,v,o=!1){const m=a(s),c=(0,h.vx)(m),l=T(c);o&&l.rating===1||(l.rating=v,l.updateLastCheckDate(),(0,h.Fg)(m,l),(0,h.Fg)(d.LAST_RATE_UPDATE,Date.now()))}function a(s){return`product-${s}`}function T(s){return s?L.w.fromObject(s):new L.w}function R(s){const v=a(s);return(0,h.vx)(v)}function E(s){return R(s)?.rating??null}function C(s){return setStorageValue(d.REVIEWS_LAST_PRODUCT_ARTICLE,s)}function D(){return getStorageValue(d.REVIEWS_LAST_PRODUCT_ARTICLE)}function f(){const s=c=>c.startsWith("product-"),v=[],o=(c,l)=>{new Date(l.lastCheckDate)<getDateMonthsAgo(9)&&v.push(l.lastCheckDate)};processEntriesByKeyFilter(s,o,!1),[...v].sort((c,l)=>new Date(c)-new Date(l)).forEach(c=>{console.log(new Date(c).toLocaleDateString())})}},8738:(b,g,r)=>{r.d(g,{d:()=>_,kv:()=>E,yu:()=>C});var h=r(9319),L=r(9898),p=r(5558),d=r(7811);function _(f={},s=null,v=null){const o=(0,p.n)("a",f,s);return v&&(o.href=v),o}function a(f,s=null,v={}){v.cursor||="pointer";const o=_(v,s);return f&&o.addEventListener("click",f),o}function T(f,s,v=null,o={},m={}){o.display||="inline-flex",o.alignItems||="center",o.gap||="0.25em";const c=a(f,v,o);return c.prepend((0,d.U)(s,m)),c}function R(f,s,v,o=null,m={},c={},l="us-control"){const I=$=>{$.stopPropagation(),$.preventDefault(),window.confirm(v)&&f()},S=o?`<span>${o}</span>`:null,k=T(I,s,S,m,c);return k.classList.add(l),k}function E(f,s,v={},o={}){return R(f,h.A,"\u0412\u044B\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u043D\u0438\u0437\u043A\u0438\u0439 \u0440\u0435\u0439\u0442\u0438\u043D\u0433?",s?"\u0414\u0438\u0437\u043B\u0430\u0439\u043A":null,v,o)}function C(f,s,v={},o={}){return R(f,L.A,"\u0423\u0431\u0440\u0430\u0442\u044C \u043D\u0438\u0437\u043A\u0438\u0439 \u0440\u0435\u0439\u0442\u0438\u043D\u0433?",s?"\u0423\u0431\u0440\u0430\u0442\u044C \u0434\u0438\u0437\u043B\u0430\u0439\u043A":null,v,o)}function D(f={},s=null,v=null){const o=createElement("button",f,s);return v&&o.addEventListener("click",v),o}},7273:(b,g,r)=>{r.d(g,{S:()=>p});var h=r(5558);function L(d={},_=null){return createElement("span",d,_)}function p(d={},_=null){return(0,h.n)("div",d,_)}},5558:(b,g,r)=>{r.d(g,{n:()=>L});var h=r(6754);function L(p,d,_=null){if(typeof d!="object"||d===null)throw new TypeError("styles should be an object");const a=document.createElement(p);return(0,h.ZM)(a,d),_&&(a.innerHTML=_),a}},7811:(b,g,r)=>{r.d(g,{U:()=>d});var h=r(4082),L=r(6754);function p(_={},a=null){return createElement("i",_,a)}function d(_,a={}){a.width||="1em",a.height||="1em";const T=(0,h.A)(_);return(0,L.ZM)(T,a),T}},573:(b,g,r)=>{r.d(g,{Fi:()=>p,YA:()=>R,fI:()=>d});var h=r(4214);function L(o,m=document){return!!m.querySelector(o)}function p(o,m=document,c=!1){const l=m.querySelector(o);return c&&!l&&console.log(`No element found for selector: ${o}`),l}function d(o,m=document,c=!1){const l=m.querySelectorAll(o);return c&&!l.length&&console.log(`No elements found for selector: ${o}`),l}function _(o,m=1){let c=o;for(let l=0;l<m;l++){if(!c.parentElement)return null;c=c.parentElement}return c}function a(o,m,c){return[...o.querySelectorAll(m)].find(l=>l.textContent.trim().includes(c))}function T(o,m,c=!1,l=!1,I=null){const S=p(m,o);return R(S,c,l,I)}function R(o,m=!1,c=!1,l=null){if(!o)return l===null?(console.log("No element found"),null):l;const I=o.innerText;return D(I,m,c)}function E(o,m,c=!1){const l=o[m];return R(l,c)}function C(o,m=!1,c=!1){const l=o.textContent;return D(l,m,c)}function D(o,m,c){m&&(o=(0,h.zr)(o)),c&&(o=o.replace(",","."));const l=Number(o);return Number.isNaN(l)?(console.log(`Invalid number: ${o}`),0):l}function f(o){return[...o.childNodes].find(m=>m.nodeType===Node.TEXT_NODE)}function s(o){const m=c=>c.nodeType===Node.TEXT_NODE&&c.textContent.trim()!==""?[c]:[...c.childNodes].flatMap(m);return m(o)}function v(o){return normalizeSpacing(o.textContent)}},5539:(b,g,r)=>{r.d(g,{Bt:()=>p,UC:()=>D,hh:()=>B,kl:()=>E,y4:()=>re});var h=r(8738);function L(u,O){u.parentNode.insertBefore(O,u.nextSibling)}function p(u){u.style.display="none"}function d(u,O=1){const P=document.querySelector(u);P&&_(P,O)}function _(u,O=1){const P=getElementAncestor(u,O);P&&p(P)}function a(u,O,P){const x=findElementByText(u,O,P);x&&p(x)}function T(u){v(u),p(u)}function R(u){u.intersectionObserver||runOnceOnIntersection(u,()=>p(u))}function E(u){u.style.display=""}function C(u){const O=s(u);u.style.display=O}function D(u,O){O?p(u):E(u)}function f(u,O){O?R(u):(clearIntersectionObserver(u),E(u))}function s(u){return v(u),u.dataset.defaultDisplay}function v(u){if(u.dataset.defaultDisplay)return;const{display:O}=getComputedStyle(u);u.dataset.defaultDisplay=O}function o(){return{show:[],hide:[]}}function m(u,O,P){u?O.hide.push(P):O.show.push(P)}function c(u){u.show.forEach(E),u.hide.forEach(p)}function l(u,O,P=.3){O?S(u,P):I(u)}function I(u){u.style.opacity=""}function S(u,O=.3){u.style.opacity=O}function k(u){u.style.order=""}function $(u,O){u.style.order=O}function B(u,O,P,x="inline-flex"){O.style.display=u?x:"none",P.style.display=u?"none":x}function Y(u,O=.3){u.style.transition="opacity 0.3s",u.style.opacity=O,G(u)}function ue(u){u.style.opacity="",K(u)}function Z(u){u.style.animation="loading-pulse 2.5s ease-in-out infinite",G(u)}function M(u){u.style.animation="",K(u)}function G(u){u.style.pointerEvents="none",u.style.cursor="wait"}function K(u){u.style.pointerEvents="",u.style.cursor=""}function ne(u,O){const P=getFirstElement(O);P&&H(u,P)}function H(u,O){const P=createLink();P.href=u,O.parentNode.append(P),P.append(O)}function _e(u,O){const P=getFirstElement(O);P&&re(u,P)}function re(u,O,P={}){const x=(0,h.d)(P);x.href=u,x.append(...O.childNodes),O.append(x)}function se(){const u=getURLQueryParam("scrollTo");if(!u)return;const O=document.getElementById(u);O?O.scrollIntoView():console.log(`Element with ID "${u}" was not found.`)}function ae(u,O,P=null){const x=`${O}-click-passed`,X=P?N=>findElementByText(N,u,P):N=>getFirstElement(u,N);return function(N){if(N.hasAttribute(x))return!1;const oe=X(N);return oe&&oe.click(),N.setAttribute(x,""),!0}}function le(u,O,P="text/plain"){const x=new Blob([u],{type:P}),X=URL.createObjectURL(x),N=document.createElement("a");N.href=X,N.download=O,document.body.appendChild(N),N.click(),document.body.removeChild(N),requestAnimationFrame(()=>URL.revokeObjectURL(X))}},6754:(b,g,r)=>{r.d(g,{ZM:()=>h});function h(_,a){Object.assign(_.style,a)}function L(_,a="custom-global-style"){let T=document.getElementById(a);T||(T=document.createElement("style"),T.id=a,T.type="text/css",document.head.appendChild(T)),T.textContent=_}function p(_){return Object.entries(_).map(([a,T])=>`${a.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${T};`).join(" ")}function d(_){return _?_.split(";").filter(a=>a.trim()!=="").reduce((a,T)=>{const[R,E]=T.split(":").map(D=>D.trim()),C=R.replace(/-([a-z])/g,(D,f)=>f.toUpperCase());return a[C]=E,a},{}):{}}},4921:(b,g,r)=>{r.d(g,{Un:()=>_,XW:()=>p,sg:()=>d,wP:()=>R,xk:()=>h});function h(E,C,D=null){const f=E.querySelector(C);return f?Promise.resolve(f):new Promise(s=>{const v=new MutationObserver(m);v.observe(E,{childList:!0,subtree:!0});let o;D&&(o=setTimeout(()=>{v.disconnect(),console.log(`No element found for selector: ${C}`),s(null)},D));function m(){const c=E.querySelector(C);c&&(o&&clearTimeout(o),v.disconnect(),s(c))}})}function L(E,C){return E.querySelector(C)?new Promise(f=>{const s=new MutationObserver(v);s.observe(E,{childList:!0,subtree:!0});function v(){E.querySelector(C)||(s.disconnect(),f())}}):Promise.resolve()}function p(E,C=400){return new Promise(D=>{let f;const s=new MutationObserver(()=>{clearTimeout(f),v()});function v(){f=setTimeout(()=>{s.disconnect(),D()},C)}v(),s.observe(E,{childList:!0,subtree:!0})})}function d(E,C=250){let D;return function(...f){const s=this;clearTimeout(D),D=setTimeout(()=>E.apply(s,f),C)}}async function _(E){document.visibilityState==="visible"?await E():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await E()},{once:!0})}function a(E,C){const D=new IntersectionObserver(f=>{f.forEach(s=>{s.isIntersecting&&(C(),T(E))})});E.intersectionObserver=D,D.observe(E)}function T(E){E.intersectionObserver&&(E.intersectionObserver.disconnect(),E.intersectionObserver=null)}function R(E){E&&(E.disconnect(),E=null)}},3789:(b,g,r)=>{r.d(g,{K:()=>h});class h{constructor(p=Date.now(),d=null,_=null,a={}){this.lastCheckDate=p,this.lowestPrice=d,this.highestPrice=_,this.priceHistory=a}get lowestPriceValue(){return this.lowestPrice?this.lowestPrice.value:0}get highestPriceValue(){return this.highestPrice?this.highestPrice.value:0}updateLastCheckDate=()=>{this.lastCheckDate=Date.now()};static fromObject(p){const{lastCheckDate:d,lowestPrice:_,highestPrice:a,priceHistory:T}=p;return new h(d,_,a,T)}}},6001:(b,g,r)=>{r.d(g,{w:()=>L});var h=r(3789);class L extends h.K{constructor(d=Date.now(),_=null,a=null,T={},R=null){super(d,_,a,T),this.rating=R}static fromObject(d){const{lastCheckDate:_,lowestPrice:a,highestPrice:T,priceHistory:R,rating:E}=d;return new L(_,a,T,R,E)}}},9412:(b,g,r)=>{r.d(g,{nF:()=>C,wq:()=>_,xb:()=>a});var h=r(5539),L=r(6700),p=r(8738);function d(D){let f=0,s=0;D.forEach(o=>{f+=o.rating,s+=1});const v=s>0?f/s:0;return roundToPrecision(v)}function _(D){return function(f){const s=(0,L.b$)(f.productId);f.storedRating!==s&&(f.storedRating=s,f.rating=s??f.originalRating,f.ratingWrap&&D(f.ratingWrap,f.rating),C(s,f.dislikeControls))}}function a(D,f,s,v={}){const{needLabel:o,onDislike:m,onRemoveDislike:c,styles:l={}}=v,I=(0,p.kv)(()=>T(f,m),o,l.link,l.dislikeIcon),S=(0,p.yu)(()=>R(f,c),o,l.link,l.removeDislikeIcon);D.append(I,S);const k={dislikeButton:I,removeDislikeButton:S};return C(s,k),k}async function T(D,f){await E(D,1,f)}async function R(D,f){await E(D,null,f)}async function E(D,f,s){(0,L.v7)(D,f),s&&await s(f)}function C(D,f){const{dislikeButton:s,removeDislikeButton:v}=f,o=D!==1;(0,h.hh)(o,s,v)}},157:(b,g,r)=>{r.d(g,{Fg:()=>h,vx:()=>p});const h=window.GM_setValue,L=window.GM.setValue,p=window.GM_getValue},4214:(b,g,r)=>{r.d(g,{zr:()=>L});function h(a){return a.replace(/\D/g,"")}function L(a){return a.replace(/[^\d.,-]/g,"")}function p(a){return a.replace(/\s/g,"")}function d(a){return a.charAt(0).toUpperCase()+a.slice(1)}function _(a){return a.replace(/\s+/g," ").trim()}},5406:(b,g,r)=>{r.d(g,{$F:()=>a,C$:()=>p,Fc:()=>h,k1:()=>s,y_:()=>T,z2:()=>D});function h(o,m="common",c=!1){const{pathname:l}=window.location;return L(l,o,m,c)}function L(o,m,c,l=!1){const I=o.split("/");m=m<0?I.length+m:m;const S=I[m]||c;return l&&console.log(`Pathname element: ${S}`),S}function p(o,m="common",c=!1){const l=h(o,"",c);return d(l,m,c)}function d(o,m,c){if(!o)return m;const l=o.split("-").at(-1);return c&&console.log(`Pathname element ending: ${l}`),l}function _(o,m,c="common",l=!1){const I=L(o,m,"",l);return d(I,c,l)}function a(o){return new URLSearchParams(window.location.search).get(o)}function T(o){return o.split("?")[0]}function R(o){return window.location.pathname.endsWith(o)}function E(o){return window.location.pathname.includes(o)}function C(o){return o.some(m=>E(m))}function D(...o){return window.location.pathname.split("/").some(c=>o.includes(c))}function f(o){try{const m=new URL(window.location.href);Object.entries(o).forEach(([c,l])=>{m.searchParams.set(c,l)}),window.location.href=m.toString()}catch(m){console.error("Failed to redirect:",m)}}function s(o,m=[]){const c=new AbortController;let l=!1;const I=k=>{const $=new URL(k),B={pathname:$.pathname};return m.forEach(Y=>{B[Y]=$.searchParams.get(Y)}),B};let S=I(window.location.href);return window.navigation.addEventListener("navigatesuccess",async()=>{if(l)return;const k=I(window.navigation.currentEntry.url);if(Object.keys(S).some(B=>S[B]!==k[B])){S=k,l=!0;try{await o(k)}catch(B){console.error("URL observer error:",B)}finally{l=!1}}},{signal:c.signal}),()=>c.abort()}function v(o=[]){s(()=>window.location.reload(),o)}},4082:(b,g,r)=>{r.d(g,{A:()=>L});const h=(p,d,_=[])=>{const a=document.createElementNS("http://www.w3.org/2000/svg",p);return Object.keys(d).forEach(T=>{a.setAttribute(T,String(d[T]))}),_.length&&_.forEach(T=>{const R=h(...T);a.appendChild(R)}),a};var L=([p,d,_])=>h(p,d,_)},1426:(b,g,r)=>{r.d(g,{A:()=>h});const h={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"}},9898:(b,g,r)=>{r.d(g,{A:()=>L});var h=r(1426);const L=["svg",h.A,[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}],["path",{d:"M3 3v5h5"}]]]},9319:(b,g,r)=>{r.d(g,{A:()=>L});var h=r(1426);const L=["svg",h.A,[["path",{d:"M17 14V2"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z"}]]]}},ie={};function z(b){var g=ie[b];if(g!==void 0)return g.exports;var r=ie[b]={exports:{}};return ge[b](r,r.exports,z),r.exports}(()=>{var b=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",g=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",r=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",h=p=>{p&&p.d<1&&(p.d=1,p.forEach(d=>d.r--),p.forEach(d=>d.r--?d.r++:d()))},L=p=>p.map(d=>{if(d!==null&&typeof d=="object"){if(d[b])return d;if(d.then){var _=[];_.d=0,d.then(R=>{a[g]=R,h(_)},R=>{a[r]=R,h(_)});var a={};return a[b]=R=>R(_),a}}var T={};return T[b]=R=>{},T[g]=d,T});z.a=(p,d,_)=>{var a;_&&((a=[]).d=-1);var T=new Set,R=p.exports,E,C,D,f=new Promise((s,v)=>{D=v,C=s});f[g]=R,f[b]=s=>(a&&s(a),T.forEach(s),f.catch(v=>{})),p.exports=f,d(s=>{E=L(s);var v,o=()=>E.map(c=>{if(c[r])throw c[r];return c[g]}),m=new Promise(c=>{v=()=>c(o),v.r=0;var l=I=>I!==a&&!T.has(I)&&(T.add(I),I&&!I.d&&(v.r++,I.push(v)));E.map(I=>I[b](l))});return v.r?m:o()},s=>(s?D(f[r]=s):C(R),h(a))),a&&a.d<0&&(a.d=0)}})(),z.d=(b,g)=>{for(var r in g)z.o(g,r)&&!z.o(b,r)&&Object.defineProperty(b,r,{enumerable:!0,get:g[r]})},z.o=(b,g)=>Object.prototype.hasOwnProperty.call(b,g);var Xe=z(9830)})();})();
