// ==UserScript==
// @name         Aliexpress product cards filter
// @description  Hide product cards by filter
// @grant        GM_addStyle
// @grant        GM_deleteValue
// @grant        GM_listValues
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://aliexpress.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.77116688
// @icon         https://www.google.com/s2/favicons?sz=64&domain=aliexpress.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/ali.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var ge={9830:(b,g,r)=>{r.a(b,async(E,T)=>{try{var p=r(5406),m=r(4921),_=r(5027),s=r(5413),L=r(7708);(0,_.N)(),await(0,m.Un)(R),(0,p.k1)(async()=>{await R(!0)});async function R(h=!1){if(await(0,m.XW)(document.head),(0,p.z2)("category","store","wholesale")){await(0,s.P)(h);return}(0,p.z2)("item")&&await(0,L.K)(h)}T()}catch(R){T(R)}},1)},5027:(b,g,r)=>{r.d(g,{N:()=>T,p:()=>p});var E=r(5406);function T(){window.GM_addStyle(`        
        .us-control {
            color: #898993 !important;
            
            &:hover {
                color: #547dff !important;
            }
        }
        
        #customFiltersContainer {
          padding: 8px 0px 8px 3px !important;
        }
        
        [class*="RedSeoFilter_TopPanel__container__"] #customFiltersContainer {
          padding: 5px 0px 18px 3px !important;
        }
        
        [class*="RedFilter_FilterHeader__filterHeaderContainer__"] {
          padding: 0 !important;
        }
        
        [class*="RedFilter_RedFilter__topPadding__"] {
          padding-top: 2px !important;
        }
        
        span[class*="rating_Rating__rating__"] + span[class*="red-ali-kit_Body__M__"] {
          padding-top: 1px !important;
        }
    `)}function p(){return(0,E.C$)(2,"unknown").replace(".html","")}},7549:(b,g,r)=>{r.d(g,{r:()=>E});const E={DISLIKE_CONTROL:{marginLeft:"auto",gap:"3px"},DISLIKE_BUTTON_ICON_SM:{height:"0.9em",marginBottom:"1px",marginRight:"2px"},DISLIKE_BUTTON_ICON_MD:{marginTop:"1px"},REMOVE_DISLIKE_BUTTON_ICON_SM:{height:"0.9em",marginBottom:"1px"},REMOVE_DISLIKE_BUTTON_ICON_MD:{marginBottom:"1px"}}},5413:(b,g,r)=>{r.d(g,{P:()=>Ae});var E=r(4921),T=r(5539),p=r(573);const m={PRODUCT_LIST_CONTAINER:['[class*="RedFilter_RedFilter__centerBlock__"]','[class*="RedSeoFilter_RedSeoFilter__centerBlock__"]','[class*="ShopFilter_ShopFilter__centerBlock__"]'].join(", "),PRODUCT_LIST_HEADER:['[class*="RedFilter_TopPanel__container__"]','[class*="RedSeoFilter_TopPanel__container__"]','[class*="ShopFilter_TopPanel__container__"]'].join(", "),PRODUCT_LIST:['[class*="red-snippet_RedSnippet__grid__"]'].join(", "),PRODUCT:'[class^="red-snippet_RedSnippet__container__"]',PRODUCT_NAME:'[class^="red-snippet_RedSnippet__title__"]',PRODUCT_RATING_CONTAINER:'[class^="red-snippet_RedSnippet__trust__"]',PRODUCT_RATING_WRAP:":scope > div:has(img) > span",PRODUCT_PURCHASES_WRAP:":scope > div:not(:has(img)) > span"};function _(t){if(!t)return[];const n=s(t).flat().filter(i=>i&&!i.isNegative&&i.term).map(i=>i.term);return[...new Set(n)]}function s(t){return t?t.toLowerCase().split(",").map(L).filter(Boolean):[]}function L(t){const e=t.split("/").map(i=>i.trim()).filter(Boolean);if(e.length===0)return null;const n=e.map(R).filter(Boolean);return n.length>0?n:null}function R(t){const e=t.startsWith("!"),n=e?t.slice(1).trim():t;return n?{term:n,isNegative:e}:null}function h(t,e){D(t,n=>n.style.display!=="none",e)}function C(t,e){D(t,n=>n.style.opacity==="",e)}function D(t,e,n){const i=[...t].filter(e).length,y=t.length;d(n,i,y)}function d(t,e,n){t.textContent=`\u041F\u043E\u043A\u0430\u0437\u0430\u043D\u043E: ${e} \u0438\u0437 ${n}`}function a(t,e){return!v(t,e)}function v(t,e){if(!e||!e.value)return!0;const n=s(e.value);return o(t,n)}function o(t,e){if(!e||!e.length)return!0;const n=(t||"").toLowerCase();return e.every(i=>f(n,i))}function f(t,e){return e.some(({term:n,isNegative:i})=>{const y=t.includes(n);return i?!y:y})}function c(t,e){return e.value!=null&&t<e.value}function l(t,e){return e.value!=null&&t>e.value}function w(t,e){return e.value==null?!1:t<parseDateFromISO(e.value)}function F(t,e){return e.value==null?!1:t>parseDateFromISO(e.value)}function k(t,e){return e.value&&t!==e.value}function x(t){let i=2166136261;for(let y=0;y<t.length;y+=1){const A=t.charCodeAt(y);i^=A,i=Math.imul(i,16777619)}return i>>>0}function N(t){return x(t).toString(16).padStart(8,"0")}function Y(t,e="common"){return t?N(t):e}var ue=r(6754);const Z={INPUT:{marginLeft:"6px",border:"1px solid #d9d9d9",borderRadius:"8px",padding:"7px 14px 6px",fontSize:"15px"},CONTROL:{display:"flex",alignItems:"center",fontSize:"14px"}},B={FILTERS_CONTAINER:{display:"flex",justifyContent:"flex-end",gap:"12px"},CONTROL:Z.CONTROL,TEXT_INPUT_CONTROL:{...Z.CONTROL,flexGrow:1},TEXT_INPUT:{...Z.INPUT,flexGrow:1},NUMBER_INPUT:{...Z.INPUT,width:"85px"},CHECKBOX_INPUT:{marginLeft:"6px",width:"21px",height:"21px",webkitAppearance:"auto"}};var G=r(7549),V=r(5406),ne=r(7273);function H(t,e={},n=null){const i=(0,ne.S)(e,n);return i.append(t),i}function _e(t,e=null,n={},i={}){const y=createActionLink(t,e,i);return H(y,n)}function re(t,e=null,n=null,i={},y={},A={}){const S=createActionLinkWithIcon(t,n,e,y,A);return H(S,i)}var se=r(5558);function ae(t,e,n){const i=I(t,"text",e);return i.value=n,i}function le(t,e,n,i,y,A){const S=I(t,"number",e);return S.value=n,S.step=i,S.min=y,S.max=A,S}function u(t,e,n){const i=I(t,"date",e);return i.value=n,i}function O(t,e,n){const i=I(t,"checkbox",e);return i.checked=n,i}function I(t={},e=null,n=null){const i=(0,se.n)("input",t);return e&&(i.type=e),n&&(i.addEventListener("keyup",(0,E.sg)(n,200)),i.addEventListener("change",(0,E.sg)(n,100))),i}function U(t,e,n){const i=createElement("select",t);return e&&i.addEventListener("change",e),i.value=n,i}function X(t,e,n={},i={}){const y=ae(i,e.updateValueFromEvent,e.value);return H(y,n,t)}function M(t,e,n,i,y,A={},S={}){const j=le(S,e.updateValueFromEvent,e.value,n,i,y);return H(j,A,t)}function oe(t,e,n={},i={}){const y=createSelect(i,e.updateValueFromEvent,e.value);return createControl(y,n,t)}function Qe(t,e,n={},i={}){const y=createDateInput(i,e.updateValueFromEvent,e.value);return createControl(y,n,t)}function Ce(t,e,n={},i={}){const y=O(i,e.updateValueFromEvent,e.value);return H(y,n,t)}function ve(t,e={},n={}){return X("\u041F\u043E\u0438\u0441\u043A: ",t,e,n)}function Re(t,e={},n={},i=.1,y=3){return M("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",t,i,y,5,e,n)}function Ye(t,e={},n={},i=.1,y=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",t,i,y,5,e,n)}function Ze(t,e={},n={}){return ce("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",t,e,n)}function Je(t,e={},n={}){return ce("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",t,e,n)}function ce(t,e,n={},i={}){return createNumberFilterControl(t,e,"1","1","999999",n,i)}function qe(t,e={},n={}){return createDateFilterControl("\u041C\u0438\u043D. \u0434\u0430\u0442\u0430: ",t,e,n)}function et(t,e={},n={}){return ye("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",t,e,n)}function ye(t,e,n={},i={}){return createNumberFilterControl(t,e,"5","0","100",n,i)}function tt(t,e={},n={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",t,"5","0","100",e,n)}function de(t,e,n={},i={},y="250"){return createNumberFilterControl(t,e,y,"0","1000000",n,i)}function nt(t,e={},n={},i="25"){return de("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",t,e,n,i)}function rt(t,e={},n={},i="25"){return de("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",t,e,n,i)}function ot(t,e={},n={}){return Le("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",t,e,n)}function Le(t,e,n={},i={}){return createNumberFilterControl(t,e,"1","0","99999",n,i)}function it(t,e={},n={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",t,"1","2","8",e,n)}function De(t,e={},n={}){return M("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",t,1,1,10,e,n)}function ut(t,e={},n={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",t,e,n)}function st(t,e={},n={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",t,e,n)}function at(t,e={},n={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",t,e,n)}function lt(t,e={},n={}){return createCheckboxFilterControl("\u0411\u043E\u043D\u0443\u0441: ",t,e,n)}function ct(t,e={},n={}){return createCheckboxFilterControl("\u0412 \u043D\u0430\u043B\u0438\u0447\u0438\u0438: ",t,e,n)}function Te(t,e={},n={}){return Ce("\u0412\u043A\u043B: ",t,e,n)}function dt(t,e,n={}){const i=[{value:-25,emoji:"\u{1F48E}",tooltip:"\u0421\u0443\u043F\u0435\u0440 \u0446\u0435\u043D\u0430 (-25%)"},{value:-15,emoji:"\u{1F525}",tooltip:"\u041E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-15%)"},{value:-5,emoji:"\u{1F31F}",tooltip:"\u041A\u043B\u0430\u0441\u0441\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-5%)"},{value:5,emoji:"\u{1F44C}",tooltip:"\u0425\u043E\u0440\u043E\u0448\u0430\u044F \u0446\u0435\u043D\u0430 (+5%)"}],y={active:{background:"#e3f2fd",borderColor:"#2196f3",boxShadow:"0 0 0 1px #2196f3"},inactive:{background:"#fff",borderColor:"#ccc",boxShadow:"none"},hover:{background:"#f5f5f5"}},A=createDiv({display:"inline-flex",gap:"4px",marginLeft:"4px"}),S=[],j=()=>e?parseFloat(e.value)||0:t.value,K=()=>{const $=j();S.forEach(({button:ee,value:te})=>{const Q=te<=$?y.active:y.inactive;Object.assign(ee.style,Q)})};return i.forEach(({value:$,emoji:ee,tooltip:te})=>{const W=createButton({padding:"2px 6px",fontSize:"16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"#fff",transition:"all 0.2s",...n},ee);W.title=te,W.type="button",W.addEventListener("click",Q=>{Q.preventDefault(),t.updateValue($),e&&(e.value=$),K()}),W.addEventListener("mouseenter",()=>{$<=j()||(W.style.background=y.hover.background)}),W.addEventListener("mouseleave",()=>{K()}),S.push({button:W,value:$}),A.appendChild(W)}),K(),e&&(e.addEventListener("input",K),e.addEventListener("change",K)),A}function Oe(t,e,n=!1,i="customFiltersContainer"){let y=t.querySelector(`#${i}`);if(y){if(!n)return;y.replaceChildren()}else y=(0,ne.S)(),y.id=i;e(y,t)}class be{constructor(e,n){this.value=e,this.onChange=n}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}function we(t){const{target:e}=t,{type:n}=e;switch(n){case"text":return`"${e.value}"`;case"number":return e.value;case"select-one":return e.value;case"date":return`"${e.value}"`;case"checkbox":return e.checked;default:return console.log(`Unknown input type: ${n}`),null}}function Ie(t){return t===""?null:JSON.parse(t)}var fe=r(157);class J extends be{constructor(e,n=null,i=null){super((0,fe.vx)(e,n),i),this.storageKey=e,this.defaultValue=n}static create(e,n=null,i=null){return new J(e,n,i)}static createWithCompositeKey(e,n,i=null,y=null){const A=`${e}-${n}`;return new J(A,i,y)}updateValueFromEvent=e=>{const n=we(e),i=Ie(n);this.updateValue(i)};updateValue(e,n=!0){this.value!==e&&((0,fe.Fg)(this.storageKey,e),this.value=e,n&&this.onChangeIfDefined())}clearValue(e=!1){this.updateValue(null,e)}resetValue(e=!1){this.updateValue(this.defaultValue,e)}}function Pe(t,e=null){return{createGlobalFilter(n,i=null,y=t){return J.create(n,i,y)},createSectionFilter(n,i=null,y=t){if(!e)throw new Error("sectionId must be provided to use createSectionFilter.");return J.createWithCompositeKey(e,n,i,y)}}}var pe=r(6700),me=r(9412);const Fe=window.GM_addValueChangeListener,Se=(0,me.wq)(Ee),P={productListContainer:null,productListObserver:null,containerObserver:null,isFiltersInitialized:!1,filters:{nameFilter:null,minPurchasesFilter:null,minRatingFilter:null,maxNameLines:null,filterEnabled:null},productCardsCache:new WeakMap};async function Ae(t){t&&He(),Ne(),Me()}function Ne(){if(!P.isFiltersInitialized){const t=xe(),{createGlobalFilter:e,createSectionFilter:n}=Pe(q,t);P.filters.nameFilter=n("name-filter"),P.filters.minPurchasesFilter=n("min-purchases-filter"),P.filters.minRatingFilter=n("min-rating-filter",4.8),P.filters.maxNameLines=e("max-name-lines",4),P.filters.filterEnabled=n("filter-enabled",!0),P.isFiltersInitialized=!0}}function xe(){return Y(ke())}function ke(){return(0,V.z2)("store")?(0,V.Fc)(2):(0,V.z2)("category")?(0,V.Fc)(3):(0,V.z2)("wholesale")?(0,V.$F)("SearchText"):"common"}function Me(){P.productListContainer=(0,p.Fi)(m.PRODUCT_LIST_CONTAINER),P.productListContainer&&(he(),P.containerObserver=new MutationObserver((0,E.sg)(he)),P.containerObserver.observe(P.productListContainer,{childList:!0,subtree:!0}))}function he(){const t=(0,p.Fi)(m.PRODUCT_LIST_HEADER,P.productListContainer);if(!t)return;const e=(0,p.Fi)(m.PRODUCT_LIST,P.productListContainer);e&&(Oe(t,Ue),Fe(pe.d5.LAST_RATE_UPDATE,()=>q(!0)),q(!1),P.productListObserver&&(0,E.wP)(P.productListObserver),P.productListObserver=new MutationObserver(()=>q(!1)),P.productListObserver.observe(e,{childList:!0}))}function Ue(t,e){(0,ue.ZM)(t,B.FILTERS_CONTAINER);const n=ve(P.filters.nameFilter,B.TEXT_INPUT_CONTROL,B.TEXT_INPUT),i=M("\u041C\u0438\u043D. \u043F\u043E\u043A\u0443\u043F\u043E\u043A: ",P.filters.minPurchasesFilter,"1","1","999999",B.CONTROL,B.NUMBER_INPUT),y=Re(P.filters.minRatingFilter,B.CONTROL,B.NUMBER_INPUT),A=De(P.filters.maxNameLines,B.CONTROL,B.NUMBER_INPUT),S=Te(P.filters.filterEnabled,B.CONTROL,B.CHECKBOX_INPUT);t.append(n,i,y,A,S),e.append(t)}function q(t=!1){(0,p.fI)(m.PRODUCT).forEach(n=>{Be(n,t)})}function Be(t,e){if(!P.filters.filterEnabled.value){(0,T.kl)(t);return}let n=P.productCardsCache.get(t);if(n)e&&Se(n);else{const y=(0,p.Fi)("a",t),A=(0,p.Fi)(m.PRODUCT_NAME,t),S=(0,p.Fi)(m.PRODUCT_RATING_CONTAINER,t);if(!y||!A||!S){(0,T.Bt)(t);return}const j=A.innerText,{productId:K}=t.dataset,{ratingWrap:$,purchasesCount:ee,rating:te,storedRating:W,originalRating:Q}=We(S,y,K),Ge=ze(S,K,W);n={productId:K,nameWrap:A,name:j,ratingWrap:$,purchasesCount:ee,rating:te,storedRating:W,originalRating:Q,dislikeControls:Ge},P.productCardsCache.set(t,n)}je(n.nameWrap);const i=a(n.name,P.filters.nameFilter)||c(n.purchasesCount,P.filters.minPurchasesFilter)||c(n.rating,P.filters.minRatingFilter);(0,T.UC)(t,i)}function We(t,e,n){const i=(0,p.Fi)(m.PRODUCT_PURCHASES_WRAP,t),y=(0,p.YA)(i,!0,!1,0);if(i){const $=(0,V.y_)(e.getAttribute("href"));Ke(i,$,n)}const A=(0,pe.b$)(n),S=(0,p.Fi)(m.PRODUCT_RATING_WRAP,t),j=S?.textContent,K=$e(A,S);return{ratingWrap:S,purchasesCount:y,rating:K,storedRating:A,originalRating:j}}function Ke(t,e,n){const i=Ve(e,n);(0,T.y4)(i,t)}function Ve(t,e){const n=new URL(t),i=n.pathname.split("/");return`${n.origin}/${i[1]}/${e}/reviews`}function $e(t,e){return t?(e&&Ee(e,t),t):(0,p.YA)(e,!0,!1,0)}function Ee(t,e){t.textContent=e.toString().padEnd(5)}function je(t){const e=P.filters.maxNameLines.value;t.style.height=`${e}lh`,t.style.maxHeight=`${e}lh`,t.style.webkitLineClamp=e}function ze(t,e,n){const i=()=>q(!0),y={needLabel:!1,onDislike:i,onRemoveDislike:i,styles:{link:G.r.DISLIKE_CONTROL,dislikeIcon:G.r.DISLIKE_BUTTON_ICON_MD,removeDislikeIcon:G.r.REMOVE_DISLIKE_BUTTON_ICON_MD}};return(0,me.xb)(t,e,n,y)}function He(){P.productListContainer=null,P.isFiltersInitialized=!1,P.filters={nameFilter:null,minPurchasesFilter:null,minRatingFilter:null,maxNameLines:null,filterEnabled:null},P.productCardsCache=new WeakMap,(0,E.wP)(P.containerObserver),(0,E.wP)(P.productListObserver)}},7708:(b,g,r)=>{r.d(g,{K:()=>D});var E=r(5027),T=r(6700);const p={EXTRA_INFO:'[class*="HazeProductDescription_HazeProductDescription__extraInfo__"]:not([class*="__stickyOffer__"])',RATING_WRAP:'[class*="HazeProductDescription_HazeProductDescription__ratingWrap__"] > span:nth-of-type(2)',REVIEWS_LINK:'a[href="#reviews_anchor"]'};var m=r(573),_=r(4921),s=r(7273);const L={DISLIKE_CONTROLS_WRAP:{width:"100%",marginTop:"5px",fontSize:"15px",fontWeight:"500"}};var R=r(7549),h=r(9412);const C={productId:null,extraInfo:null,originalRating:null,ratingWraps:[],dislikeControls:null};async function D(l){l&&c(),C.productId=(0,E.p)(),C.extraInfo=await(0,_.xk)(document,p.EXTRA_INFO),await Promise.all([d(),v(),o()])}async function d(){if(C.ratingWraps=(0,m.fI)(p.RATING_WRAP),!C.ratingWraps.length)return;const l=(0,T.b$)(C.productId);l&&a(l)}function a(l){C.ratingWraps.forEach(w=>{C.originalRating??=w.textContent,w.textContent=l})}async function v(){const l=await(0,_.xk)(C.extraInfo,p.REVIEWS_LINK);l&&(l.href=`${window.location.pathname.replace(".html","")}/reviews`)}function o(){const l=(0,s.S)(L.DISLIKE_CONTROLS_WRAP),w=(0,T.b$)(C.productId);C.dislikeControls=(0,h.xb)(l,C.productId,w,{needLabel:!0,onDislike:F=>f(F,F),onRemoveDislike:F=>f(C.originalRating,F),styles:{link:R.r.DISLIKE_CONTROL,dislikeIcon:R.r.DISLIKE_BUTTON_ICON_SM,removeDislikeIcon:R.r.REMOVE_DISLIKE_BUTTON_ICON_SM}}),C.extraInfo.append(l)}function f(l,w){a(l),(0,h.nF)(w,C.dislikeControls)}function c(){C.productId=null,C.extraInfo=null,C.originalRating=null,C.ratingWraps=[],C.dislikeControls=null}},5059:(b,g,r)=>{var E=r(157);const T=window.GM_listValues;function p(R,h,C=!1){getStorageValue("dbVersion")!==h&&(R(),!C&&setStorageValue("dbVersion",h))}function m(R,h=!0){const C=T();s(C,R,h)}function _(R,h,C=!0){const d=T().filter(R);s(d,h,C)}function s(R,h,C){let D=0;R.forEach(d=>{const a=getStorageValue(d);C&&console.log(d,a),h(d,a),D+=1}),C&&console.log(`Total entries processed: ${D}`)}function L(R,h=!1){_(R,D=>{h||window.GM_deleteValue(D)})}},6700:(b,g,r)=>{r.d(g,{b$:()=>h,d5:()=>m,v7:()=>_});var E=r(157),T=r(6001),p=r(5059);const m={LAST_RATE_UPDATE:"last-rate-update",REVIEWS_LAST_PRODUCT_ARTICLE:"reviews-last-product-article"};function _(a,v,o=!1){const f=s(a),c=(0,E.vx)(f),l=L(c);o&&l.rating===1||(l.rating=v,l.updateLastCheckDate(),(0,E.Fg)(f,l),(0,E.Fg)(m.LAST_RATE_UPDATE,Date.now()))}function s(a){return`product-${a}`}function L(a){return a?T.w.fromObject(a):new T.w}function R(a){const v=s(a);return(0,E.vx)(v)}function h(a){return R(a)?.rating??null}function C(a){return setStorageValue(m.REVIEWS_LAST_PRODUCT_ARTICLE,a)}function D(){return getStorageValue(m.REVIEWS_LAST_PRODUCT_ARTICLE)}function d(){const a=c=>c.startsWith("product-"),v=[],o=(c,l)=>{new Date(l.lastCheckDate)<getDateMonthsAgo(9)&&v.push(l.lastCheckDate)};processEntriesByKeyFilter(a,o,!1),[...v].sort((c,l)=>new Date(c)-new Date(l)).forEach(c=>{console.log(new Date(c).toLocaleDateString())})}},8738:(b,g,r)=>{r.d(g,{d:()=>_,kv:()=>h,yu:()=>C});var E=r(9319),T=r(9898),p=r(5558),m=r(7811);function _(d={},a=null,v=null){const o=(0,p.n)("a",d,a);return v&&(o.href=v),o}function s(d,a=null,v={}){v.cursor||="pointer";const o=_(v,a);return d&&o.addEventListener("click",d),o}function L(d,a,v=null,o={},f={}){o.display||="inline-flex",o.alignItems||="center",o.gap||="0.25em";const c=s(d,v,o);return c.prepend((0,m.U)(a,f)),c}function R(d,a,v,o=null,f={},c={},l="us-control"){const w=x=>{x.stopPropagation(),x.preventDefault(),window.confirm(v)&&d()},F=o?`<span>${o}</span>`:null,k=L(w,a,F,f,c);return k.classList.add(l),k}function h(d,a,v={},o={}){return R(d,E.A,"\u0412\u044B\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u043D\u0438\u0437\u043A\u0438\u0439 \u0440\u0435\u0439\u0442\u0438\u043D\u0433?",a?"\u0414\u0438\u0437\u043B\u0430\u0439\u043A":null,v,o)}function C(d,a,v={},o={}){return R(d,T.A,"\u0423\u0431\u0440\u0430\u0442\u044C \u043D\u0438\u0437\u043A\u0438\u0439 \u0440\u0435\u0439\u0442\u0438\u043D\u0433?",a?"\u0423\u0431\u0440\u0430\u0442\u044C \u0434\u0438\u0437\u043B\u0430\u0439\u043A":null,v,o)}function D(d={},a=null,v=null){const o=createElement("button",d,a);return v&&o.addEventListener("click",v),o}},7273:(b,g,r)=>{r.d(g,{S:()=>p});var E=r(5558);function T(m={},_=null){return createElement("span",m,_)}function p(m={},_=null){return(0,E.n)("div",m,_)}},5558:(b,g,r)=>{r.d(g,{n:()=>T});var E=r(6754);function T(p,m,_=null){if(typeof m!="object"||m===null)throw new TypeError("styles should be an object");const s=document.createElement(p);return(0,E.ZM)(s,m),_&&(s.innerHTML=_),s}},7811:(b,g,r)=>{r.d(g,{U:()=>m});var E=r(4082),T=r(6754);function p(_={},s=null){return createElement("i",_,s)}function m(_,s={}){s.width||="1em",s.height||="1em";const L=(0,E.A)(_);return(0,T.ZM)(L,s),L}},573:(b,g,r)=>{r.d(g,{Fi:()=>p,YA:()=>R,fI:()=>m});var E=r(4214);function T(o,f=document){return!!f.querySelector(o)}function p(o,f=document,c=!1){const l=f.querySelector(o);return c&&!l&&console.log(`No element found for selector: ${o}`),l}function m(o,f=document,c=!1){const l=f.querySelectorAll(o);return c&&!l.length&&console.log(`No elements found for selector: ${o}`),l}function _(o,f=1){let c=o;for(let l=0;l<f;l++){if(!c.parentElement)return null;c=c.parentElement}return c}function s(o,f,c){return[...o.querySelectorAll(f)].find(l=>l.textContent.trim().includes(c))}function L(o,f,c=!1,l=!1,w=null){const F=p(f,o);return R(F,c,l,w)}function R(o,f=!1,c=!1,l=null){if(!o)return l===null?(console.log("No element found"),null):l;const w=o.innerText;return D(w,f,c)}function h(o,f,c=!1){const l=o[f];return R(l,c)}function C(o,f=!1,c=!1){const l=o.textContent;return D(l,f,c)}function D(o,f,c){f&&(o=(0,E.zr)(o)),c&&(o=o.replace(",","."));const l=Number(o);return Number.isNaN(l)?(console.log(`Invalid number: ${o}`),0):l}function d(o){return[...o.childNodes].find(f=>f.nodeType===Node.TEXT_NODE)}function a(o){const f=c=>c.nodeType===Node.TEXT_NODE&&c.textContent.trim()!==""?[c]:[...c.childNodes].flatMap(f);return f(o)}function v(o){return normalizeSpacing(o.textContent)}},5539:(b,g,r)=>{r.d(g,{Bt:()=>p,UC:()=>D,hh:()=>N,kl:()=>h,y4:()=>re});var E=r(8738);function T(u,O){u.parentNode.insertBefore(O,u.nextSibling)}function p(u){u.style.display="none"}function m(u,O=1){const I=document.querySelector(u);I&&_(I,O)}function _(u,O=1){const I=getElementAncestor(u,O);I&&p(I)}function s(u,O,I){const U=findElementByText(u,O,I);U&&p(U)}function L(u){v(u),p(u)}function R(u){u.intersectionObserver||runOnceOnIntersection(u,()=>p(u))}function h(u){u.style.display=""}function C(u){const O=a(u);u.style.display=O}function D(u,O){O?p(u):h(u)}function d(u,O){O?R(u):(clearIntersectionObserver(u),h(u))}function a(u){return v(u),u.dataset.defaultDisplay}function v(u){if(u.dataset.defaultDisplay)return;const{display:O}=getComputedStyle(u);u.dataset.defaultDisplay=O}function o(){return{show:[],hide:[]}}function f(u,O,I){u?O.hide.push(I):O.show.push(I)}function c(u){u.show.forEach(h),u.hide.forEach(p)}function l(u,O,I=.3){O?F(u,I):w(u)}function w(u){u.style.opacity=""}function F(u,O=.3){u.style.opacity=O}function k(u){u.style.order=""}function x(u,O){u.style.order=O}function N(u,O,I,U="inline-flex"){O.style.display=u?U:"none",I.style.display=u?"none":U}function Y(u,O=.3){u.style.transition="opacity 0.3s",u.style.opacity=O,G(u)}function ue(u){u.style.opacity="",V(u)}function Z(u){u.style.animation="loading-pulse 2.5s ease-in-out infinite",G(u)}function B(u){u.style.animation="",V(u)}function G(u){u.style.pointerEvents="none",u.style.cursor="wait"}function V(u){u.style.pointerEvents="",u.style.cursor=""}function ne(u,O){const I=getFirstElement(O);I&&H(u,I)}function H(u,O){const I=createLink();I.href=u,O.parentNode.append(I),I.append(O)}function _e(u,O){const I=getFirstElement(O);I&&re(u,I)}function re(u,O,I={}){const U=(0,E.d)(I);U.href=u,U.append(...O.childNodes),O.append(U)}function se(){const u=getURLQueryParam("scrollTo");if(!u)return;const O=document.getElementById(u);O?O.scrollIntoView():console.log(`Element with ID "${u}" was not found.`)}function ae(u,O,I=null){const U=`${O}-click-passed`,X=I?M=>findElementByText(M,u,I):M=>getFirstElement(u,M);return function(M){if(M.hasAttribute(U))return!1;const oe=X(M);return oe&&oe.click(),M.setAttribute(U,""),!0}}function le(u,O,I="text/plain"){const U=new Blob([u],{type:I}),X=URL.createObjectURL(U),M=document.createElement("a");M.href=X,M.download=O,document.body.appendChild(M),M.click(),document.body.removeChild(M),requestAnimationFrame(()=>URL.revokeObjectURL(X))}},6754:(b,g,r)=>{r.d(g,{ZM:()=>E});function E(_,s){Object.assign(_.style,s)}function T(_,s="custom-global-style"){let L=document.getElementById(s);L||(L=document.createElement("style"),L.id=s,L.type="text/css",document.head.appendChild(L)),L.textContent=_}function p(_){return Object.entries(_).map(([s,L])=>`${s.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${L};`).join(" ")}function m(_){return _?_.split(";").filter(s=>s.trim()!=="").reduce((s,L)=>{const[R,h]=L.split(":").map(D=>D.trim()),C=R.replace(/-([a-z])/g,(D,d)=>d.toUpperCase());return s[C]=h,s},{}):{}}},4921:(b,g,r)=>{r.d(g,{Un:()=>_,XW:()=>p,sg:()=>m,wP:()=>R,xk:()=>E});function E(h,C,D=null){const d=h.querySelector(C);return d?Promise.resolve(d):new Promise(a=>{const v=new MutationObserver(f);v.observe(h,{childList:!0,subtree:!0});let o;D&&(o=setTimeout(()=>{v.disconnect(),console.log(`No element found for selector: ${C}`),a(null)},D));function f(){const c=h.querySelector(C);c&&(o&&clearTimeout(o),v.disconnect(),a(c))}})}function T(h,C){return h.querySelector(C)?new Promise(d=>{const a=new MutationObserver(v);a.observe(h,{childList:!0,subtree:!0});function v(){h.querySelector(C)||(a.disconnect(),d())}}):Promise.resolve()}function p(h,C=400){return new Promise(D=>{let d;const a=new MutationObserver(()=>{clearTimeout(d),v()});function v(){d=setTimeout(()=>{a.disconnect(),D()},C)}v(),a.observe(h,{childList:!0,subtree:!0})})}function m(h,C=250){let D;return function(...d){const a=this;clearTimeout(D),D=setTimeout(()=>h.apply(a,d),C)}}async function _(h){document.visibilityState==="visible"?await h():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await h()},{once:!0})}function s(h,C){const D=new IntersectionObserver(d=>{d.forEach(a=>{a.isIntersecting&&(C(),L(h))})});h.intersectionObserver=D,D.observe(h)}function L(h){h.intersectionObserver&&(h.intersectionObserver.disconnect(),h.intersectionObserver=null)}function R(h){h&&(h.disconnect(),h=null)}},3789:(b,g,r)=>{r.d(g,{K:()=>E});class E{constructor(p=Date.now(),m=null,_=null,s={}){this.lastCheckDate=p,this.lowestPrice=m,this.highestPrice=_,this.priceHistory=s}get lowestPriceValue(){return this.lowestPrice?this.lowestPrice.value:0}get highestPriceValue(){return this.highestPrice?this.highestPrice.value:0}updateLastCheckDate=()=>{this.lastCheckDate=Date.now()};static fromObject(p){const{lastCheckDate:m,lowestPrice:_,highestPrice:s,priceHistory:L}=p;return new E(m,_,s,L)}}},6001:(b,g,r)=>{r.d(g,{w:()=>T});var E=r(3789);class T extends E.K{constructor(m=Date.now(),_=null,s=null,L={},R=null){super(m,_,s,L),this.rating=R}static fromObject(m){const{lastCheckDate:_,lowestPrice:s,highestPrice:L,priceHistory:R,rating:h}=m;return new T(_,s,L,R,h)}}},9412:(b,g,r)=>{r.d(g,{nF:()=>C,wq:()=>_,xb:()=>s});var E=r(5539),T=r(6700),p=r(8738);function m(D){let d=0,a=0;D.forEach(o=>{d+=o.rating,a+=1});const v=a>0?d/a:0;return roundToPrecision(v)}function _(D){return function(d){const a=(0,T.b$)(d.productId);d.storedRating!==a&&(d.storedRating=a,d.rating=a??d.originalRating,d.ratingWrap&&D(d.ratingWrap,d.rating),C(a,d.dislikeControls))}}function s(D,d,a,v={}){const{needLabel:o,onDislike:f,onRemoveDislike:c,styles:l={}}=v,w=(0,p.kv)(()=>L(d,f),o,l.link,l.dislikeIcon),F=(0,p.yu)(()=>R(d,c),o,l.link,l.removeDislikeIcon);D.append(w,F);const k={dislikeButton:w,removeDislikeButton:F};return C(a,k),k}async function L(D,d){await h(D,1,d)}async function R(D,d){await h(D,null,d)}async function h(D,d,a){(0,T.v7)(D,d),a&&await a(d)}function C(D,d){const{dislikeButton:a,removeDislikeButton:v}=d,o=D!==1;(0,E.hh)(o,a,v)}},157:(b,g,r)=>{r.d(g,{Fg:()=>E,vx:()=>p});const E=window.GM_setValue,T=window.GM.setValue,p=window.GM_getValue},4214:(b,g,r)=>{r.d(g,{zr:()=>T});function E(s){return s.replace(/\D/g,"")}function T(s){return s.replace(/[^\d.,-]/g,"")}function p(s){return s.replace(/\s/g,"")}function m(s){return s.charAt(0).toUpperCase()+s.slice(1)}function _(s){return s.replace(/\s+/g," ").trim()}},5406:(b,g,r)=>{r.d(g,{$F:()=>s,C$:()=>p,Fc:()=>E,k1:()=>d,y_:()=>L,z2:()=>C});function E(o,f="common",c=!1){const{pathname:l}=window.location;return T(l,o,f,c)}function T(o,f,c,l=!1){const w=o.split("/");f=f<0?w.length+f:f;const F=w[f]||c;return l&&console.log(`Pathname element: ${F}`),F}function p(o,f="common",c=!1){const l=E(o,"",c);return m(l,f,c)}function m(o,f,c){if(!o)return f;const l=o.split("-").at(-1);return c&&console.log(`Pathname element ending: ${l}`),l}function _(o,f,c="common",l=!1){const w=T(o,f,"",l);return m(w,c,l)}function s(o){return new URLSearchParams(window.location.search).get(o)}function L(o){return o.split("?")[0]}function R(o){return window.location.pathname.includes(o)}function h(o){return o.some(f=>R(f))}function C(...o){return window.location.pathname.split("/").some(c=>o.includes(c))}function D(o){try{const f=new URL(window.location.href);Object.entries(o).forEach(([c,l])=>{f.searchParams.set(c,l)}),window.location.href=f.toString()}catch(f){console.error("Failed to redirect:",f)}}function d(o,f=[]){const c=new AbortController;let l=!1;const w=k=>{const x=new URL(k),N={pathname:x.pathname};return f.forEach(Y=>{N[Y]=x.searchParams.get(Y)}),N};let F=w(window.location.href);return window.navigation.addEventListener("navigatesuccess",async()=>{if(l)return;const k=w(window.navigation.currentEntry.url);if(Object.keys(F).some(N=>F[N]!==k[N])){F=k,l=!0;try{await o(k)}catch(N){console.error("URL observer error:",N)}finally{l=!1}}},{signal:c.signal}),()=>c.abort()}function a(o,f=[]){const c={pathname:window.location.pathname};f.forEach(x=>{c[x]=s(x)});let l=!1;async function w(){if(l)return;const x={pathname:window.location.pathname};if(f.forEach(N=>{x[N]=s(N)}),Object.keys(c).some(N=>c[N]!==x[N])){Object.assign(c,x),l=!0;try{await o()}catch(N){console.error("Error in URL observer callback:",N)}finally{l=!1}}}function F(){w().catch(x=>{console.error("Error in URL change handler:",x)})}let k=window.location.href;setInterval(()=>{window.location.href!==k&&(console.log("URL changed:",window.location.href),k=window.location.href,F())},200),window.addEventListener("popstate",F)}function v(o=[]){a(()=>window.location.reload(),o)}},4082:(b,g,r)=>{r.d(g,{A:()=>T});const E=(p,m,_=[])=>{const s=document.createElementNS("http://www.w3.org/2000/svg",p);return Object.keys(m).forEach(L=>{s.setAttribute(L,String(m[L]))}),_.length&&_.forEach(L=>{const R=E(...L);s.appendChild(R)}),s};var T=([p,m,_])=>E(p,m,_)},1426:(b,g,r)=>{r.d(g,{A:()=>E});const E={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"}},9898:(b,g,r)=>{r.d(g,{A:()=>T});var E=r(1426);const T=["svg",E.A,[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}],["path",{d:"M3 3v5h5"}]]]},9319:(b,g,r)=>{r.d(g,{A:()=>T});var E=r(1426);const T=["svg",E.A,[["path",{d:"M17 14V2"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z"}]]]}},ie={};function z(b){var g=ie[b];if(g!==void 0)return g.exports;var r=ie[b]={exports:{}};return ge[b](r,r.exports,z),r.exports}(()=>{var b=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",g=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",r=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",E=p=>{p&&p.d<1&&(p.d=1,p.forEach(m=>m.r--),p.forEach(m=>m.r--?m.r++:m()))},T=p=>p.map(m=>{if(m!==null&&typeof m=="object"){if(m[b])return m;if(m.then){var _=[];_.d=0,m.then(R=>{s[g]=R,E(_)},R=>{s[r]=R,E(_)});var s={};return s[b]=R=>R(_),s}}var L={};return L[b]=R=>{},L[g]=m,L});z.a=(p,m,_)=>{var s;_&&((s=[]).d=-1);var L=new Set,R=p.exports,h,C,D,d=new Promise((a,v)=>{D=v,C=a});d[g]=R,d[b]=a=>(s&&a(s),L.forEach(a),d.catch(v=>{})),p.exports=d,m(a=>{h=T(a);var v,o=()=>h.map(c=>{if(c[r])throw c[r];return c[g]}),f=new Promise(c=>{v=()=>c(o),v.r=0;var l=w=>w!==s&&!L.has(w)&&(L.add(w),w&&!w.d&&(v.r++,w.push(v)));h.map(w=>w[b](l))});return v.r?f:o()},a=>(a?D(d[r]=a):C(R),E(s))),s&&s.d<0&&(s.d=0)}})(),z.d=(b,g)=>{for(var r in g)z.o(g,r)&&!z.o(b,r)&&Object.defineProperty(b,r,{enumerable:!0,get:g[r]})},z.o=(b,g)=>Object.prototype.hasOwnProperty.call(b,g);var Xe=z(9830)})();})();
