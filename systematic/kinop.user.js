// ==UserScript==
// @name         Kinopoisk navigator filter
// @description  Hide movies by filter
// @grant        GM_addStyle
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.kinopoisk.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.77101971
// @icon         https://www.google.com/s2/favicons?sz=64&domain=kinopoisk.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/kinop.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var me={7273:(L,C,f)=>{f.d(C,{S:()=>b});var _=f(5558);function A(v={},g=null){return createElement("span",v,g)}function b(v={},g=null){return(0,_.n)("div",v,g)}},5558:(L,C,f)=>{f.d(C,{n:()=>A});var _=f(6754);function A(b,v,g=null){if(typeof v!="object"||v===null)throw new TypeError("styles should be an object");const a=document.createElement(b);return(0,_.ZM)(a,v),g&&(a.innerHTML=g),a}},573:(L,C,f)=>{f.d(C,{Fi:()=>b,YA:()=>I,fI:()=>v,s$:()=>g});var _=f(4214);function A(u,l=document){return!!l.querySelector(u)}function b(u,l=document,i=!1){const c=l.querySelector(u);return i&&!c&&console.log(`No element found for selector: ${u}`),c}function v(u,l=document,i=!1){const c=l.querySelectorAll(u);return i&&!c.length&&console.log(`No elements found for selector: ${u}`),c}function g(u,l=1){let i=u;for(let c=0;c<l;c++){if(!i.parentElement)return null;i=i.parentElement}return i}function a(u,l,i){return[...u.querySelectorAll(l)].find(c=>c.textContent.trim().includes(i))}function F(u,l,i=!1,c=!1,E=null){const B=b(l,u);return I(B,i,c,E)}function I(u,l=!1,i=!1,c=null){if(!u)return c===null?(console.log("No element found"),null):c;const E=u.innerText;return O(E,l,i)}function p(u,l,i=!1){const c=u[l];return I(c,i)}function S(u,l=!1,i=!1){const c=u.textContent;return O(c,l,i)}function O(u,l,i){l&&(u=(0,_.zr)(u)),i&&(u=u.replace(",","."));const c=Number(u);return Number.isNaN(c)?(console.log(`Invalid number: ${u}`),0):c}function D(u){return[...u.childNodes].find(l=>l.nodeType===Node.TEXT_NODE)}function w(u){const l=i=>i.nodeType===Node.TEXT_NODE&&i.textContent.trim()!==""?[i]:[...i.childNodes].flatMap(l);return l(u)}function R(u){return normalizeSpacing(u.textContent)}},5539:(L,C,f)=>{f.d(C,{Bt:()=>b,UC:()=>O,UE:()=>g,WH:()=>A,kl:()=>p});var _=f(573);function A(o,d){o.parentNode.insertBefore(d,o.nextSibling)}function b(o){o.style.display="none"}function v(o,d=1){const x=document.querySelector(o);x&&g(x,d)}function g(o,d=1){const x=(0,_.s$)(o,d);x&&b(x)}function a(o,d,x){const V=findElementByText(o,d,x);V&&b(V)}function F(o){R(o),b(o)}function I(o){o.intersectionObserver||runOnceOnIntersection(o,()=>b(o))}function p(o){o.style.display=""}function S(o){const d=w(o);o.style.display=d}function O(o,d){d?b(o):p(o)}function D(o,d){d?I(o):(clearIntersectionObserver(o),p(o))}function w(o){return R(o),o.dataset.defaultDisplay}function R(o){if(o.dataset.defaultDisplay)return;const{display:d}=getComputedStyle(o);o.dataset.defaultDisplay=d}function u(){return{show:[],hide:[]}}function l(o,d,x){o?d.hide.push(x):d.show.push(x)}function i(o){o.show.forEach(p),o.hide.forEach(b)}function c(o,d,x=.3){d?B(o,x):E(o)}function E(o){o.style.opacity=""}function B(o,d=.3){o.style.opacity=d}function U(o){o.style.order=""}function m(o,d){o.style.order=d}function h(o,d,x,V="inline-flex"){d.style.display=o?V:"none",x.style.display=o?"none":V}function y(o,d=.3){o.style.transition="opacity 0.3s",o.style.opacity=d,ee(o)}function T(o){o.style.opacity="",X(o)}function q(o){o.style.animation="loading-pulse 2.5s ease-in-out infinite",ee(o)}function z(o){o.style.animation="",X(o)}function ee(o){o.style.pointerEvents="none",o.style.cursor="wait"}function X(o){o.style.pointerEvents="",o.style.cursor=""}function G(o,d){const x=getFirstElement(d);x&&J(o,x)}function J(o,d){const x=createLink();x.href=o,d.parentNode.append(x),x.append(d)}function j(o,d){const x=getFirstElement(d);x&&ne(o,x)}function ne(o,d,x={}){const V=createLink(x);V.href=o,V.append(...d.childNodes),d.append(V)}function pe(){const o=getURLQueryParam("scrollTo");if(!o)return;const d=document.getElementById(o);d?d.scrollIntoView():console.log(`Element with ID "${o}" was not found.`)}function he(o,d,x=null){const V=`${d}-click-passed`,re=x?M=>findElementByText(M,o,x):M=>getFirstElement(o,M);return function(M){if(M.hasAttribute(V))return!1;const se=re(M);return se&&se.click(),M.setAttribute(V,""),!0}}function le(o,d,x="text/plain"){const V=new Blob([o],{type:x}),re=URL.createObjectURL(V),M=document.createElement("a");M.href=re,M.download=d,document.body.appendChild(M),M.click(),document.body.removeChild(M),requestAnimationFrame(()=>URL.revokeObjectURL(re))}},6754:(L,C,f)=>{f.d(C,{ZM:()=>_});function _(g,a){Object.assign(g.style,a)}function A(g,a="custom-global-style"){let F=document.getElementById(a);F||(F=document.createElement("style"),F.id=a,F.type="text/css",document.head.appendChild(F)),F.textContent=g}function b(g){return Object.entries(g).map(([a,F])=>`${a.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${F};`).join(" ")}function v(g){return g?g.split(";").filter(a=>a.trim()!=="").reduce((a,F)=>{const[I,p]=F.split(":").map(O=>O.trim()),S=I.replace(/-([a-z])/g,(O,D)=>D.toUpperCase());return a[S]=p,a},{}):{}}},4921:(L,C,f)=>{f.d(C,{XW:()=>b,sg:()=>v,wP:()=>I});function _(p,S,O=null){const D=p.querySelector(S);return D?Promise.resolve(D):new Promise(w=>{const R=new MutationObserver(l);R.observe(p,{childList:!0,subtree:!0});let u;O&&(u=setTimeout(()=>{R.disconnect(),console.log(`No element found for selector: ${S}`),w(null)},O));function l(){const i=p.querySelector(S);i&&(u&&clearTimeout(u),R.disconnect(),w(i))}})}function A(p,S){return p.querySelector(S)?new Promise(D=>{const w=new MutationObserver(R);w.observe(p,{childList:!0,subtree:!0});function R(){p.querySelector(S)||(w.disconnect(),D())}}):Promise.resolve()}function b(p,S=400){return new Promise(O=>{let D;const w=new MutationObserver(()=>{clearTimeout(D),R()});function R(){D=setTimeout(()=>{w.disconnect(),O()},S)}R(),w.observe(p,{childList:!0,subtree:!0})})}function v(p,S=250){let O;return function(...D){const w=this;clearTimeout(O),O=setTimeout(()=>p.apply(w,D),S)}}async function g(p){document.visibilityState==="visible"?await p():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await p()},{once:!0})}function a(p,S){const O=new IntersectionObserver(D=>{D.forEach(w=>{w.isIntersecting&&(S(),F(p))})});p.intersectionObserver=O,O.observe(p)}function F(p){p.intersectionObserver&&(p.intersectionObserver.disconnect(),p.intersectionObserver=null)}function I(p){p&&(p.disconnect(),p=null)}},4214:(L,C,f)=>{f.d(C,{zr:()=>A});function _(a){return a.replace(/\D/g,"")}function A(a){return a.replace(/[^\d.,-]/g,"")}function b(a){return a.replace(/\s/g,"")}function v(a){return a.charAt(0).toUpperCase()+a.slice(1)}function g(a){return a.replace(/\s+/g," ").trim()}},5406:(L,C,f)=>{f.d(C,{$G:()=>w,z2:()=>S});function _(u,l="common",i=!1){const{pathname:c}=window.location;return A(c,u,l,i)}function A(u,l,i,c=!1){const E=u.split("/");l=l<0?E.length+l:l;const B=E[l]||i;return c&&console.log(`Pathname element: ${B}`),B}function b(u,l="common",i=!1){const c=_(u,"",i);return v(c,l,i)}function v(u,l,i){if(!u)return l;const c=u.split("-").at(-1);return i&&console.log(`Pathname element ending: ${c}`),c}function g(u,l,i="common",c=!1){const E=A(u,l,"",c);return v(E,i,c)}function a(u){return new URLSearchParams(window.location.search).get(u)}function F(u){return u.split("?")[0]}function I(u){return window.location.pathname.includes(u)}function p(u){return u.some(l=>I(l))}function S(...u){return window.location.pathname.split("/").some(i=>u.includes(i))}function O(u){try{const l=new URL(window.location.href);Object.entries(u).forEach(([i,c])=>{l.searchParams.set(i,c)}),window.location.href=l.toString()}catch(l){console.error("Failed to redirect:",l)}}function D(u,l=[]){const i=new AbortController;let c=!1;const E=U=>{const m=new URL(U),h={pathname:m.pathname};return l.forEach(y=>{h[y]=m.searchParams.get(y)}),h};let B=E(window.location.href);return window.navigation.addEventListener("navigatesuccess",async()=>{if(c)return;const U=E(window.navigation.currentEntry.url);if(Object.keys(B).some(h=>B[h]!==U[h])){B=U,c=!0;try{await u(U)}catch(h){console.error("URL observer error:",h)}finally{c=!1}}},{signal:i.signal}),()=>i.abort()}function w(u,l=[]){const i={pathname:window.location.pathname};l.forEach(m=>{i[m]=a(m)});let c=!1;async function E(){if(c)return;const m={pathname:window.location.pathname};if(l.forEach(h=>{m[h]=a(h)}),Object.keys(i).some(h=>i[h]!==m[h])){Object.assign(i,m),c=!0;try{await u()}catch(h){console.error("Error in URL observer callback:",h)}finally{c=!1}}}function B(){E().catch(m=>{console.error("Error in URL change handler:",m)})}let U=window.location.href;setInterval(()=>{window.location.href!==U&&(console.log("URL changed:",window.location.href),U=window.location.href,B())},200),window.addEventListener("popstate",B)}function R(u=[]){w(()=>window.location.reload(),u)}},6275:(L,C,f)=>{f.a(L,async(_,A)=>{try{var b=f(5406),v=f(128),g=f(9397);await a(),(0,b.$G)(async()=>{await a(!0)});async function a(F=!1){(0,b.z2)("navigator")?(0,v.R)(F):(0,b.z2)("film","series")&&await(0,g.g)(F)}A()}catch(a){A(a)}},1)},9397:(L,C,f)=>{f.d(C,{g:()=>R});const _={CONTAINER:{margin:"12px 0 -5px",display:"flex",gap:"8px",alignItems:"center"},BUTTON:{display:"inline-flex",alignItems:"center",padding:"6px 12px",background:"#1a1a1a",border:"1px solid #404040",borderRadius:"6px",color:"#e0e0e0",textDecoration:"none",fontSize:"13px",fontWeight:"500",transition:"all 0.2s ease",cursor:"pointer",transform:"scale(1)"},BUTTON_HOVER:{background:"#2a2a2a",borderColor:"#606060",transform:"scale(1.05)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"}};var A=f(6754),b=f(4921),v=f(5539),g=f(7273),a=f(5558);function F(m={},h=null,y=null){const T=(0,a.n)("a",m,h);return y&&(T.href=y),T}function I(m,h=null,y={}){y.cursor||="pointer";const T=F(y,h);return m&&T.addEventListener("click",m),T}function p(m,h,y=null,T={},q={}){T.display||="inline-flex",T.alignItems||="center",T.gap||="0.25em";const z=I(m,y,T);return z.prepend(createLucideIcon(h,q)),z}function S(m,h,y,T=null,q={},z={},ee="userscript-control"){const X=j=>{j.stopPropagation(),j.preventDefault(),window.confirm(y)&&m()},G=T?`<span>${T}</span>`:null,J=p(X,h,G,q,z);return J.classList.add(ee),J}function O(m,h,y={},T={}){return S(m,ThumbsDown,"\u0412\u044B\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u043D\u0438\u0437\u043A\u0438\u0439 \u0440\u0435\u0439\u0442\u0438\u043D\u0433?",h?"\u0414\u0438\u0437\u043B\u0430\u0439\u043A":null,y,T)}function D(m,h,y={},T={}){return S(m,RotateCcw,"\u0423\u0431\u0440\u0430\u0442\u044C \u043D\u0438\u0437\u043A\u0438\u0439 \u0440\u0435\u0439\u0442\u0438\u043D\u0433?",h?"\u0423\u0431\u0440\u0430\u0442\u044C \u0434\u0438\u0437\u043B\u0430\u0439\u043A":null,y,T)}function w(m={},h=null,y=null){const T=createElement("button",m,h);return y&&T.addEventListener("click",y),T}async function R(m){await(0,b.XW)(document.body),m&&void 0,u(),E()}function u(){window.GM_addStyle(`
        [class*="styles_socialArgument__"],
        div[class*="styles_header__"] div[class*="styles_topText__"] p {
            display: none !important;
        }
    `),l("film-media-posts"),l("today-in-cinema-block"),i(),document.querySelector('div[class^="styles_videoWrapper__"]')?.remove(),document.querySelector("div.ReactModalPortal")?.remove(),c()}function l(m){const h=document.querySelector(`span#${m}`);if(!h)return;(0,v.Bt)(h);const y=h.nextElementSibling;y?.tagName==="DIV"&&(0,v.Bt)(y)}function i(){const m=document.querySelector('p[class^="style_offerName___"]');m&&(0,v.UE)(m,4)}function c(){const m=document.querySelector('div[class^="styles_watchOnlineBlock__"]');if(!m)return;const h=m.querySelector('button[class*="styles_watchOnlineButton__"]');h&&h.innerText.trim().toLowerCase().includes("\u043F\u043E\u0434\u043A\u043B\u044E\u0447\u0438\u0442\u044C")&&m.remove()}function E(){const m=document.querySelector('h1[class^="styles_title__"] > span');if(!m)return;const h=m.textContent.trim(),y=document.querySelector('div[class^="styles_header__"]');if(!y||document.querySelector(".custom-torrent-buttons"))return;const T=(0,g.S)(_.CONTAINER);T.className="custom-torrent-buttons";const z=`https://kinozal.tv/browse.php?s=${encodeURIComponent(h).replace(/%20/g,"+")}&g=0&c=0&v=0&d=0&w=0&t=1&f=0`,X=`https://rutracker.org/forum/tracker.php?nm=${encodeURIComponent(h)}`,G=B("\u041A\u0438\u043D\u043E\u0437\u0430\u043B",z),J=B("\u0420\u0443\u0442\u0440\u0435\u043A\u0435\u0440",X);T.appendChild(G),T.appendChild(J);const j=y.querySelector('div[class^="styles_title__"]');j&&(0,v.WH)(j,T)}function B(m,h){const y=F(_.BUTTON,m,h);return y.target="_blank",y.addEventListener("mouseenter",()=>{(0,A.ZM)(y,_.BUTTON_HOVER)}),y.addEventListener("mouseleave",()=>{(0,A.ZM)(y,_.BUTTON)}),y}function U(){}},128:(L,C,f)=>{f.d(C,{R:()=>Oe});function _(t){if(!t)return[];const n=A(t).flat().filter(r=>r&&!r.isNegative&&r.term).map(r=>r.term);return[...new Set(n)]}function A(t){return t?t.toLowerCase().split(",").map(b).filter(Boolean):[]}function b(t){const e=t.split("/").map(r=>r.trim()).filter(Boolean);if(e.length===0)return null;const n=e.map(v).filter(Boolean);return n.length>0?n:null}function v(t){const e=t.startsWith("!"),n=e?t.slice(1).trim():t;return n?{term:n,isNegative:e}:null}function g(t,e){F(t,n=>n.style.display!=="none",e)}function a(t,e){F(t,n=>n.style.opacity==="",e)}function F(t,e,n){const r=[...t].filter(e).length,s=t.length;I(n,r,s)}function I(t,e,n){t.textContent=`\u041F\u043E\u043A\u0430\u0437\u0430\u043D\u043E: ${e} \u0438\u0437 ${n}`}function p(t,e){return!S(t,e)}function S(t,e){if(!e||!e.value)return!0;const n=A(e.value);return O(t,n)}function O(t,e){if(!e||!e.length)return!0;const n=(t||"").toLowerCase();return e.every(r=>D(n,r))}function D(t,e){return e.some(({term:n,isNegative:r})=>{const s=t.includes(n);return r?!s:s})}function w(t,e){return e.value!=null&&t<e.value}function R(t,e){return e.value!=null&&t>e.value}function u(t,e){return e.value==null?!1:t<parseDateFromISO(e.value)}function l(t,e){return e.value==null?!1:t>parseDateFromISO(e.value)}function i(t,e){return e.value&&t!==e.value}var c=f(5539),E=f(573),B=f(7273);function U(t,e={},n=null){const r=(0,B.S)(e,n);return r.append(t),r}function m(t,e=null,n={},r={}){const s=createActionLink(t,e,r);return U(s,n)}function h(t,e=null,n=null,r={},s={},k={}){const P=createActionLinkWithIcon(t,n,e,s,k);return U(P,r)}var y=f(5558),T=f(4921);function q(t,e,n){const r=G(t,"text",e);return r.value=n,r}function z(t,e,n,r,s,k){const P=G(t,"number",e);return P.value=n,P.step=r,P.min=s,P.max=k,P}function ee(t,e,n){const r=G(t,"date",e);return r.value=n,r}function X(t,e,n){const r=G(t,"checkbox",e);return r.checked=n,r}function G(t={},e=null,n=null){const r=(0,y.n)("input",t);return e&&(r.type=e),n&&(r.addEventListener("keyup",(0,T.sg)(n,200)),r.addEventListener("change",(0,T.sg)(n,100))),r}function J(t,e,n){const r=createElement("select",t);return e&&r.addEventListener("change",e),r.value=n,r}function j(t,e,n={},r={}){const s=q(r,e.updateValueFromEvent,e.value);return U(s,n,t)}function ne(t,e,n,r,s,k={},P={}){const K=z(P,e.updateValueFromEvent,e.value,n,r,s);return U(K,k,t)}function pe(t,e,n={},r={}){const s=createSelect(r,e.updateValueFromEvent,e.value);return createControl(s,n,t)}function he(t,e,n={},r={}){const s=createDateInput(r,e.updateValueFromEvent,e.value);return createControl(s,n,t)}function le(t,e,n={},r={}){const s=X(r,e.updateValueFromEvent,e.value);return U(s,n,t)}function o(t,e={},n={}){return createTextFilterControl("\u041F\u043E\u0438\u0441\u043A: ",t,e,n)}function d(t,e={},n={},r=.1,s=3){return createNumberFilterControl("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",t,r,s,5,e,n)}function x(t,e={},n={},r=.1,s=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",t,r,s,5,e,n)}function V(t,e={},n={}){return M("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",t,e,n)}function re(t,e={},n={}){return M("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",t,e,n)}function M(t,e,n={},r={}){return createNumberFilterControl(t,e,"1","1","999999",n,r)}function se(t,e={},n={}){return createDateFilterControl("\u041C\u0438\u043D. \u0434\u0430\u0442\u0430: ",t,e,n)}function Ve(t,e={},n={}){return ve("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",t,e,n)}function ve(t,e,n={},r={}){return createNumberFilterControl(t,e,"5","0","100",n,r)}function $e(t,e={},n={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",t,"5","0","100",e,n)}function ce(t,e,n={},r={},s="250"){return createNumberFilterControl(t,e,s,"0","1000000",n,r)}function ze(t,e={},n={},r="25"){return ce("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",t,e,n,r)}function Ge(t,e={},n={},r="25"){return ce("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",t,e,n,r)}function je(t,e={},n={}){return Ee("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",t,e,n)}function Ee(t,e,n={},r={}){return createNumberFilterControl(t,e,"1","0","99999",n,r)}function Ke(t,e={},n={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",t,"1","2","8",e,n)}function He(t,e={},n={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",t,1,1,10,e,n)}function Qe(t,e={},n={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",t,e,n)}function Xe(t,e={},n={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",t,e,n)}function Ye(t,e={},n={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",t,e,n)}function Ze(t,e={},n={}){return createCheckboxFilterControl("\u0411\u043E\u043D\u0443\u0441: ",t,e,n)}function qe(t,e={},n={}){return createCheckboxFilterControl("\u0412 \u043D\u0430\u043B\u0438\u0447\u0438\u0438: ",t,e,n)}function be(t,e={},n={}){return le("\u0412\u043A\u043B: ",t,e,n)}function Je(t,e,n={}){const r=[{value:-25,emoji:"\u{1F48E}",tooltip:"\u0421\u0443\u043F\u0435\u0440 \u0446\u0435\u043D\u0430 (-25%)"},{value:-15,emoji:"\u{1F525}",tooltip:"\u041E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-15%)"},{value:-5,emoji:"\u{1F31F}",tooltip:"\u041A\u043B\u0430\u0441\u0441\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-5%)"},{value:5,emoji:"\u{1F44C}",tooltip:"\u0425\u043E\u0440\u043E\u0448\u0430\u044F \u0446\u0435\u043D\u0430 (+5%)"}],s={active:{background:"#e3f2fd",borderColor:"#2196f3",boxShadow:"0 0 0 1px #2196f3"},inactive:{background:"#fff",borderColor:"#ccc",boxShadow:"none"},hover:{background:"#f5f5f5"}},k=createDiv({display:"inline-flex",gap:"4px",marginLeft:"4px"}),P=[],K=()=>e?parseFloat(e.value)||0:t.value,H=()=>{const Q=K();P.forEach(({button:ue,value:ie})=>{const te=ie<=Q?s.active:s.inactive;Object.assign(ue.style,te)})};return r.forEach(({value:Q,emoji:ue,tooltip:ie})=>{const $=createButton({padding:"2px 6px",fontSize:"16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"#fff",transition:"all 0.2s",...n},ue);$.title=ie,$.type="button",$.addEventListener("click",te=>{te.preventDefault(),t.updateValue(Q),e&&(e.value=Q),H()}),$.addEventListener("mouseenter",()=>{Q<=K()||($.style.background=s.hover.background)}),$.addEventListener("mouseleave",()=>{H()}),P.push({button:$,value:Q}),k.appendChild($)}),H(),e&&(e.addEventListener("input",H),e.addEventListener("change",H)),k}const Y={MOVIES_LIST:"#results",MOVIE_CARD:"#itemList > .item",MY_VOTE_WRAP:".myVote",GENRE_WRAP:".gray_text",KP_REVIEWS_WRAP:".numVote > span > span",IMDB_REVIEWS_WRAP:".imdb > span",NAME_WRAP:".name",LENGTH_WRAP:"nobr"},fe={INPUT:{marginLeft:"6px",padding:"4px 8px",fontSize:"12px"}},W={FILTERS_CONTAINER:{display:"flex",gridGap:"12px",marginTop:"10px",flexFlow:"wrap"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...fe.INPUT,width:"120px"},NUMBER_INPUT:{...fe.INPUT,width:"65px"},CHECKBOX_INPUT:{marginLeft:"6px",width:"17px",height:"17px"}};class ge{constructor(e,n){this.value=e,this.onChange=n}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}function ye(t){const{target:e}=t,{type:n}=e;switch(n){case"text":return`"${e.value}"`;case"number":return e.value;case"select-one":return e.value;case"date":return`"${e.value}"`;case"checkbox":return e.checked;default:return console.log(`Unknown input type: ${n}`),null}}function Ce(t){return t===""?null:JSON.parse(t)}const Fe=window.GM_setValue,et=window.GM.setValue,we=window.GM_getValue;class oe extends ge{constructor(e,n=null,r=null){super(we(e,n),r),this.storageKey=e,this.defaultValue=n}static create(e,n=null,r=null){return new oe(e,n,r)}static createWithCompositeKey(e,n,r=null,s=null){const k=`${e}-${n}`;return new oe(k,r,s)}updateValueFromEvent=e=>{const n=ye(e),r=Ce(n);this.updateValue(r)};updateValue(e,n=!0){this.value!==e&&(Fe(this.storageKey,e),this.value=e,n&&this.onChangeIfDefined())}clearValue(e=!1){this.updateValue(null,e)}resetValue(e=!1){this.updateValue(this.defaultValue,e)}}function xe(t,e=null){return{createGlobalFilter(n,r=null,s=t){return oe.create(n,r,s)},createSectionFilter(n,r=null,s=t){if(!e)throw new Error("sectionId must be provided to use createSectionFilter.");return oe.createWithCompositeKey(e,n,r,s)}}}function Te(t,e,n=!1,r="customFiltersContainer"){let s=t.querySelector(`#${r}`);if(s){if(!n)return;s.replaceChildren()}else s=(0,B.S)(),s.id=r;e(s,t)}function Ne(t={}){return(0,B.S)(t,"|")}function Le(t,e={},n="customFiltersContainer"){const r=document.getElementById(n);if(!r)return console.log(`Element with id="${n}" not found.`),null;const s=createButton(e,`${arrowUpIcon}\u041A \u0444\u0438\u043B\u044C\u0442\u0440\u0430\u043C`);return s.addEventListener("mouseenter",()=>{s.style.filter="brightness(0.9)"}),s.addEventListener("mouseleave",()=>{s.style.filter="brightness(1)"}),s.addEventListener("click",()=>{const k=r.getBoundingClientRect();window.scrollTo({top:k.top+window.scrollY-t,behavior:"smooth"})}),new IntersectionObserver(([k])=>{const P=k.boundingClientRect.top<0,K=!k.isIntersecting&&P;s.style.display=K?"flex":"none"},{threshold:.5}).observe(r),s}function tt(t,e={},n=75){const r=Le(n,e);r&&t.appendChild(r)}var Se=f(6754);const N={moviesObserver:null,isFiltersInitialized:!1,filters:{nameFilter:null,genreFilter:null,maxLengthFilter:null,minKpReviewsFilter:null,minImdbReviewsFilter:null,isFinishedFilter:null,filterEnabled:null}};function Oe(t){t&&ke(),Re(),Ie()}function Re(){if(!N.isFiltersInitialized){const{createGlobalFilter:t}=xe(de);N.filters.nameFilter=t("navigator-name-filter"),N.filters.genreFilter=t("navigator-genre-filter"),N.filters.maxLengthFilter=t("navigator-max-length-filter"),N.filters.minKpReviewsFilter=t("navigator-min-kp-reviews-filter"),N.filters.minImdbReviewsFilter=t("navigator-min-imdb-reviews-filter"),N.filters.isFinishedFilter=t("navigator-is-finished-filter",!0),N.filters.filterEnabled=t("navigator-filter-enabled",!0),N.isFiltersInitialized=!0}}function Ie(){const t=(0,E.Fi)(Y.MOVIES_LIST);t&&(N.moviesObserver&&(0,T.wP)(N.moviesObserver),N.moviesObserver=new MutationObserver(()=>De(t)),N.moviesObserver.observe(t,{childList:!0,subtree:!0}))}function De(t){const e=(0,E.Fi)("tr > td",t);Te(e,_e),de()}function _e(t,e){(0,Se.ZM)(t,W.FILTERS_CONTAINER);const n=j("\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435:",N.filters.nameFilter,W.CONTROL,W.TEXT_INPUT),r=j("\u0416\u0430\u043D\u0440:",N.filters.genreFilter,W.CONTROL,W.TEXT_INPUT),s=ne("\u041C\u0430\u043A\u0441. \u043C\u0438\u043D\u0443\u0442:",N.filters.maxLengthFilter,"10","0","500",W.CONTROL,W.NUMBER_INPUT),k=ne("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432 \u041A\u041F:",N.filters.minKpReviewsFilter,"100","0","1000000",W.CONTROL,W.NUMBER_INPUT),P=ne("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432 IMDB:",N.filters.minImdbReviewsFilter,"100","0","1000000",W.CONTROL,W.NUMBER_INPUT),K=le("\u0417\u0430\u0432\u0435\u0440\u0448\u0451\u043D: ",N.filters.isFinishedFilter,W.CONTROL,W.CHECKBOX_INPUT),H=Ne(W.CONTROL),Q=be(N.filters.filterEnabled,W.CONTROL,W.CHECKBOX_INPUT);t.append(n,r,s,k,P,K,H,Q),e.append(t)}function de(){(0,E.fI)(Y.MOVIE_CARD).forEach(Ae)}function Ae(t){if(!N.filters.filterEnabled.value){(0,c.kl)(t);return}const e=(0,E.Fi)(Y.NAME_WRAP,t),n=(0,E.Fi)(Y.MY_VOTE_WRAP,t),r=(0,E.Fi)(Y.GENRE_WRAP,t),s=(0,E.Fi)(Y.LENGTH_WRAP,e),k=(0,E.Fi)(Y.KP_REVIEWS_WRAP,t),P=(0,E.Fi)(Y.IMDB_REVIEWS_WRAP,t);if([e,n,r,s,k,P].some(Me=>!Me)){(0,c.Bt)(t);return}if(n.innerText){(0,c.Bt)(t);return}const H=(0,E.Fi)("a",e)?.innerText??"",ue=!((0,E.Fi)("span",e)?.innerText??"").includes("..."),ie=Be(r),$=(0,E.YA)(s,!0),te=(0,E.YA)(k,!0),Pe=(0,E.YA)(P,!0),Ue=p(H,N.filters.nameFilter)||p(ie,N.filters.genreFilter)||R($,N.filters.maxLengthFilter)||w(te,N.filters.minKpReviewsFilter)||w(Pe,N.filters.minImdbReviewsFilter)||i(ue,N.filters.isFinishedFilter);(0,c.UC)(t,Ue)}function Be(t){return Array.from(t.childNodes).filter(r=>r.nodeType===Node.TEXT_NODE).pop()?.textContent.trim()||""}function ke(){N.isFiltersInitialized=!1,N.filters={nameFilter:null,genreFilter:null,maxLengthFilter:null,minKpReviewsFilter:null,minImdbReviewsFilter:null,isFinishedFilter:null,filterEnabled:null},(0,T.wP)(N.moviesObserver)}}},ae={};function Z(L){var C=ae[L];if(C!==void 0)return C.exports;var f=ae[L]={exports:{}};return me[L](f,f.exports,Z),f.exports}(()=>{var L=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",C=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",f=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",_=b=>{b&&b.d<1&&(b.d=1,b.forEach(v=>v.r--),b.forEach(v=>v.r--?v.r++:v()))},A=b=>b.map(v=>{if(v!==null&&typeof v=="object"){if(v[L])return v;if(v.then){var g=[];g.d=0,v.then(I=>{a[C]=I,_(g)},I=>{a[f]=I,_(g)});var a={};return a[L]=I=>I(g),a}}var F={};return F[L]=I=>{},F[C]=v,F});Z.a=(b,v,g)=>{var a;g&&((a=[]).d=-1);var F=new Set,I=b.exports,p,S,O,D=new Promise((w,R)=>{O=R,S=w});D[C]=I,D[L]=w=>(a&&w(a),F.forEach(w),D.catch(R=>{})),b.exports=D,v(w=>{p=A(w);var R,u=()=>p.map(i=>{if(i[f])throw i[f];return i[C]}),l=new Promise(i=>{R=()=>i(u),R.r=0;var c=E=>E!==a&&!F.has(E)&&(F.add(E),E&&!E.d&&(R.r++,E.push(R)));p.map(E=>E[L](c))});return R.r?l:u()},w=>(w?O(D[f]=w):S(I),_(a))),a&&a.d<0&&(a.d=0)}})(),Z.d=(L,C)=>{for(var f in C)Z.o(C,f)&&!Z.o(L,f)&&Object.defineProperty(L,f,{enumerable:!0,get:C[f]})},Z.o=(L,C)=>Object.prototype.hasOwnProperty.call(L,C);var We=Z(6275)})();})();
