// ==UserScript==
// @name         Kinopoisk navigator filter
// @description  Hide movies by filter
// @grant        GM_addStyle
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.kinopoisk.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.76970372
// @icon         https://www.google.com/s2/favicons?sz=64&domain=kinopoisk.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/kinop.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var ce={7273:(L,F,c)=>{c.d(F,{S:()=>E});var _=c(5558);function A(p={},g=null){return createElement("span",p,g)}function E(p={},g=null){return(0,_.n)("div",p,g)}},5558:(L,F,c)=>{c.d(F,{n:()=>A});var _=c(6754);function A(E,p,g=null){if(typeof p!="object"||p===null)throw new TypeError("styles should be an object");const l=document.createElement(E);return(0,_.ZM)(l,p),g&&(l.innerHTML=g),l}},573:(L,F,c)=>{c.d(F,{Fi:()=>E,YA:()=>N,fI:()=>p,s$:()=>g});var _=c(4214);function A(o,s=document){return!!s.querySelector(o)}function E(o,s=document,i=!1){const f=s.querySelector(o);return i&&!f&&console.log(`No element found for selector: ${o}`),f}function p(o,s=document,i=!1){const f=s.querySelectorAll(o);return i&&!f.length&&console.log(`No elements found for selector: ${o}`),f}function g(o,s=1){let i=o;for(let f=0;f<s;f++){if(!i.parentElement)return null;i=i.parentElement}return i}function l(o,s,i){return[...o.querySelectorAll(s)].find(f=>f.textContent.trim().includes(i))}function C(o,s,i=!1,f=!1,D=null){const U=E(s,o);return N(U,i,f,D)}function N(o,s=!1,i=!1,f=null){if(!o)return f===null?(console.log("No element found"),null):f;const D=o.innerText;return R(D,s,i)}function h(o,s,i=!1){const f=o[s];return N(f,i)}function O(o,s=!1,i=!1){const f=o.textContent;return R(f,s,i)}function R(o,s,i){s&&(o=(0,_.zr)(o)),i&&(o=o.replace(",","."));const f=Number(o);return Number.isNaN(f)?(console.log(`Invalid number: ${o}`),0):f}function T(o){return[...o.childNodes].find(s=>s.nodeType===Node.TEXT_NODE)}function w(o){const s=i=>i.nodeType===Node.TEXT_NODE&&i.textContent.trim()!==""?[i]:[...i.childNodes].flatMap(s);return s(o)}function d(o){return normalizeSpacing(o.textContent)}},5539:(L,F,c)=>{c.d(F,{Bt:()=>E,UC:()=>O,UE:()=>g,WH:()=>A,kl:()=>N});var _=c(573);function A(u,m){u.parentNode.insertBefore(m,u.nextSibling)}function E(u){u.style.display="none"}function p(u,m=1){const y=document.querySelector(u);y&&g(y,m)}function g(u,m=1){const y=(0,_.s$)(u,m);y&&E(y)}function l(u){w(u),E(u)}function C(u){u.intersectionObserver||runOnceOnIntersection(u,()=>E(u))}function N(u){u.style.display=""}function h(u){const m=T(u);u.style.display=m}function O(u,m){m?E(u):N(u)}function R(u,m){m?C(u):(clearIntersectionObserver(u),N(u))}function T(u){return w(u),u.dataset.defaultDisplay}function w(u){if(u.dataset.defaultDisplay)return;const{display:m}=getComputedStyle(u);u.dataset.defaultDisplay=m}function d(){return{show:[],hide:[]}}function o(u,m,y){u?m.hide.push(y):m.show.push(y)}function s(u){u.show.forEach(N),u.hide.forEach(E)}function i(u,m,y=.3){m?D(u,y):f(u)}function f(u){u.style.opacity=""}function D(u,m=.3){u.style.opacity=m}function U(u){u.style.order=""}function W(u,m){u.style.order=m}function v(u,m){u.style.background=m}function S(u,m){const y=getFirstElement(m);y&&b(u,y)}function b(u,m){const y=createLink();y.href=u,m.parentNode.append(y),y.append(m)}function I(u,m){const y=getFirstElement(m);y&&K(u,y)}function K(u,m,y={}){const z=createLink(y);z.href=u,z.append(...m.childNodes),m.append(z)}function H(){const u=getURLQueryParam("scrollTo");if(!u)return;const m=document.getElementById(u);m?m.scrollIntoView():console.log(`Element with ID "${u}" was not found.`)}function J(u,m,y=null){const z=`${m}-click-passed`,q=y?P=>findElementByText(P,u,y):P=>getFirstElement(u,P);return function(P){if(P.hasAttribute(z))return!1;const re=q(P);return re&&re.click(),P.setAttribute(z,""),!0}}function $(u,m,y="text/plain"){const z=new Blob([u],{type:y}),q=URL.createObjectURL(z),P=document.createElement("a");P.href=q,P.download=m,document.body.appendChild(P),P.click(),document.body.removeChild(P),requestAnimationFrame(()=>URL.revokeObjectURL(q))}},6754:(L,F,c)=>{c.d(F,{ZM:()=>_});function _(g,l){Object.assign(g.style,l)}function A(g,l="custom-global-style"){let C=document.getElementById(l);C||(C=document.createElement("style"),C.id=l,C.type="text/css",document.head.appendChild(C)),C.textContent=g}function E(g){return Object.entries(g).map(([l,C])=>`${l.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${C};`).join(" ")}function p(g){return g?g.split(";").filter(l=>l.trim()!=="").reduce((l,C)=>{const[N,h]=C.split(":").map(R=>R.trim()),O=N.replace(/-([a-z])/g,(R,T)=>T.toUpperCase());return l[O]=h,l},{}):{}}},4921:(L,F,c)=>{c.d(F,{XW:()=>E,sg:()=>p,wP:()=>N});function _(h,O,R=null){const T=h.querySelector(O);return T?Promise.resolve(T):new Promise(w=>{const d=new MutationObserver(s);d.observe(h,{childList:!0,subtree:!0});let o;R&&(o=setTimeout(()=>{d.disconnect(),console.log(`No element found for selector: ${O}`),w(null)},R));function s(){const i=h.querySelector(O);i&&(o&&clearTimeout(o),d.disconnect(),w(i))}})}function A(h,O){return h.querySelector(O)?new Promise(T=>{const w=new MutationObserver(d);w.observe(h,{childList:!0,subtree:!0});function d(){h.querySelector(O)||(w.disconnect(),T())}}):Promise.resolve()}function E(h,O=400){return new Promise(R=>{let T;const w=new MutationObserver(()=>{clearTimeout(T),d()});function d(){T=setTimeout(()=>{w.disconnect(),R()},O)}d(),w.observe(h,{childList:!0,subtree:!0})})}function p(h,O=250){let R;return function(...T){const w=this;clearTimeout(R),R=setTimeout(()=>h.apply(w,T),O)}}async function g(h){document.visibilityState==="visible"?await h():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await h()},{once:!0})}function l(h,O){const R=new IntersectionObserver(T=>{T.forEach(w=>{w.isIntersecting&&(O(),C(h))})});h.intersectionObserver=R,R.observe(h)}function C(h){h.intersectionObserver&&(h.intersectionObserver.disconnect(),h.intersectionObserver=null)}function N(h){h&&(h.disconnect(),h=null)}},4214:(L,F,c)=>{c.d(F,{zr:()=>A});function _(l){return l.replace(/\D/g,"")}function A(l){return l.replace(/[^\d.,-]/g,"")}function E(l){return l.replace(/\s/g,"")}function p(l){return l.charAt(0).toUpperCase()+l.slice(1)}function g(l){return l.replace(/\s+/g," ").trim()}},5406:(L,F,c)=>{c.d(F,{k1:()=>T,z2:()=>O});function _(d,o="common",s=!1){const{pathname:i}=window.location;return A(i,d,o,s)}function A(d,o,s,i=!1){const f=d.split("/");o=o<0?f.length+o:o;const D=f[o]||s;return i&&console.log(`Pathname element: ${D}`),D}function E(d,o="common",s=!1){const i=_(d,"",s);return p(i,o,s)}function p(d,o,s){if(!d)return o;const i=d.split("-").at(-1);return s&&console.log(`Pathname element ending: ${i}`),i}function g(d,o,s="common",i=!1){const f=A(d,o,"",i);return p(f,s,i)}function l(d){return new URLSearchParams(window.location.search).get(d)}function C(d){return d.split("?")[0]}function N(d){return window.location.pathname.includes(d)}function h(d){return d.some(o=>N(o))}function O(...d){return window.location.pathname.split("/").some(s=>d.includes(s))}function R(d){try{const o=new URL(window.location.href);Object.entries(d).forEach(([s,i])=>{o.searchParams.set(s,i)}),window.location.href=o.toString()}catch(o){console.error("Failed to redirect:",o)}}function T(d,o=[]){const s={pathname:window.location.pathname};o.forEach(W=>{s[W]=l(W)});let i=!1;async function f(){if(i)return;const W={pathname:window.location.pathname};if(o.forEach(v=>{W[v]=l(v)}),Object.keys(s).some(v=>s[v]!==W[v])){Object.assign(s,W),i=!0;try{await d()}catch(v){console.error("Error in URL observer callback:",v)}finally{i=!1}}}function D(){f().catch(W=>{console.error("Error in URL change handler:",W)})}let U=window.location.href;setInterval(()=>{window.location.href!==U&&(U=window.location.href,D())},200),window.addEventListener("popstate",D)}function w(d=[]){T(()=>window.location.reload(),d)}},6275:(L,F,c)=>{c.a(L,async(_,A)=>{try{var E=c(5406),p=c(128),g=c(9397);await l(),(0,E.k1)(async()=>{await l(!0)});async function l(C=!1){(0,E.z2)("navigator")?(0,p.R)(C):(0,E.z2)("film","series")&&await(0,g.g)(C)}A()}catch(l){A(l)}},1)},9397:(L,F,c)=>{c.d(F,{g:()=>d});const _={CONTAINER:{margin:"12px 0 -5px",display:"flex",gap:"8px",alignItems:"center"},BUTTON:{display:"inline-flex",alignItems:"center",padding:"6px 12px",background:"#1a1a1a",border:"1px solid #404040",borderRadius:"6px",color:"#e0e0e0",textDecoration:"none",fontSize:"13px",fontWeight:"500",transition:"all 0.2s ease",cursor:"pointer",transform:"scale(1)"},BUTTON_HOVER:{background:"#2a2a2a",borderColor:"#606060",transform:"scale(1.05)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"}};var A=c(6754),E=c(4921),p=c(5539),g=c(7273),l=c(5558);function C(v={},S=null,b=null){const I=(0,l.n)("a",v,S);return b&&(I.href=b),I}function N(v,S=null,b={}){b.cursor||="pointer";const I=C(b,S);return v&&I.addEventListener("click",v),I}function h(v,S,b=null,I={},K={}){I.display||="inline-flex",I.alignItems||="center",I.gap||="0.25em";const H=N(v,b,I);return H.prepend(createLucideIcon(S,K)),H}function O(v,S,b,I=null,K={},H={}){const J=m=>{m.stopPropagation(),m.preventDefault(),window.confirm(b)&&v()},$=I?`<span>${I}</span>`:null,u=h(J,S,$,K,H);return u.classList.add("userscript-control"),u}function R(v,S,b={},I={}){return O(v,ThumbsDown,"\u0412\u044B\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u043D\u0438\u0437\u043A\u0438\u0439 \u0440\u0435\u0439\u0442\u0438\u043D\u0433?",S?"\u0414\u0438\u0437\u043B\u0430\u0439\u043A":null,b,I)}function T(v,S,b={},I={}){return O(v,RotateCcw,"\u0423\u0431\u0440\u0430\u0442\u044C \u043D\u0438\u0437\u043A\u0438\u0439 \u0440\u0435\u0439\u0442\u0438\u043D\u0433?",S?"\u0423\u0431\u0440\u0430\u0442\u044C \u0434\u0438\u0437\u043B\u0430\u0439\u043A":null,b,I)}function w(v={},S=null,b=null){const I=createElement("button",v,S);return b&&I.addEventListener("click",b),I}async function d(v){await(0,E.XW)(document.body),v&&void 0,o(),D()}function o(){window.GM_addStyle(`
        [class*="styles_socialArgument__"],
        div[class*="styles_header__"] div[class*="styles_topText__"] p {
            display: none !important;
        }
    `),s("film-media-posts"),s("today-in-cinema-block"),i(),document.querySelector('div[class^="styles_videoWrapper__"]')?.remove(),document.querySelector("div.ReactModalPortal")?.remove(),f()}function s(v){const S=document.querySelector(`span#${v}`);if(!S)return;(0,p.Bt)(S);const b=S.nextElementSibling;b?.tagName==="DIV"&&(0,p.Bt)(b)}function i(){const v=document.querySelector('p[class^="style_offerName___"]');v&&(0,p.UE)(v,4)}function f(){const v=document.querySelector('div[class^="styles_watchOnlineBlock__"]');if(!v)return;const S=v.querySelector('button[class*="styles_watchOnlineButton__"]');S&&S.innerText.trim().toLowerCase().includes("\u043F\u043E\u0434\u043A\u043B\u044E\u0447\u0438\u0442\u044C")&&v.remove()}function D(){const v=document.querySelector('h1[class^="styles_title__"] > span');if(!v)return;const S=v.textContent.trim(),b=document.querySelector('div[class^="styles_header__"]');if(!b||document.querySelector(".custom-torrent-buttons"))return;const I=(0,g.S)(_.CONTAINER);I.className="custom-torrent-buttons";const H=`https://kinozal.tv/browse.php?s=${encodeURIComponent(S).replace(/%20/g,"+")}&g=0&c=0&v=0&d=0&w=0&t=1&f=0`,$=`https://rutracker.org/forum/tracker.php?nm=${encodeURIComponent(S)}`,u=U("\u041A\u0438\u043D\u043E\u0437\u0430\u043B",H),m=U("\u0420\u0443\u0442\u0440\u0435\u043A\u0435\u0440",$);I.appendChild(u),I.appendChild(m);const y=b.querySelector('div[class^="styles_title__"]');y&&(0,p.WH)(y,I)}function U(v,S){const b=C(_.BUTTON,v,S);return b.target="_blank",b.addEventListener("mouseenter",()=>{(0,A.ZM)(b,_.BUTTON_HOVER)}),b.addEventListener("mouseleave",()=>{(0,A.ZM)(b,_.BUTTON)}),b}function W(){}},128:(L,F,c)=>{c.d(F,{R:()=>we});function _(t){if(!t)return[];const n=A(t).flat().filter(r=>r&&!r.isNegative&&r.term).map(r=>r.term);return[...new Set(n)]}function A(t){return t?t.toLowerCase().split(",").map(E).filter(Boolean):[]}function E(t){const e=t.split("/").map(r=>r.trim()).filter(Boolean);if(e.length===0)return null;const n=e.map(p).filter(Boolean);return n.length>0?n:null}function p(t){const e=t.startsWith("!"),n=e?t.slice(1).trim():t;return n?{term:n,isNegative:e}:null}function g(t,e){C(t,n=>n.style.display!=="none",e)}function l(t,e){C(t,n=>n.style.opacity==="",e)}function C(t,e,n){const r=[...t].filter(e).length;n.textContent=`\u041F\u043E\u043A\u0430\u0437\u0430\u043D\u043E: ${r} \u0438\u0437 ${t.length}`}function N(t,e){return!h(t,e)}function h(t,e){if(!e||!e.value)return!0;const n=A(e.value);return O(t,n)}function O(t,e){if(!e||!e.length)return!0;const n=(t||"").toLowerCase();return e.every(r=>R(n,r))}function R(t,e){return e.some(({term:n,isNegative:r})=>{const a=t.includes(n);return r?!a:a})}function T(t,e){return e.value!=null&&t<e.value}function w(t,e){return e.value!=null&&t>e.value}function d(t,e){return e.value==null?!1:t<parseDateFromISO(e.value)}function o(t,e){return e.value==null?!1:t>parseDateFromISO(e.value)}function s(t,e){return e.value&&t!==e.value}var i=c(5539),f=c(573),D=c(7273);function U(t,e={},n=null){const r=(0,D.S)(e,n);return r.append(t),r}function W(t,e=null,n={},r={}){const a=createActionLink(t,e,r);return U(a,n)}function v(t,e=null,n=null,r={},a={},k={}){const B=createActionLinkWithIcon(t,n,e,a,k);return U(B,r)}var S=c(5558),b=c(4921);function I(t,e,n){const r=$(t,"text",e);return r.value=n,r}function K(t,e,n,r,a,k){const B=$(t,"number",e);return B.value=n,B.step=r,B.min=a,B.max=k,B}function H(t,e,n){const r=$(t,"date",e);return r.value=n,r}function J(t,e,n){const r=$(t,"checkbox",e);return r.checked=n,r}function $(t={},e=null,n=null){const r=(0,S.n)("input",t);return e&&(r.type=e),n&&(r.addEventListener("keyup",(0,b.sg)(n,200)),r.addEventListener("change",(0,b.sg)(n,100))),r}function u(t,e,n){const r=createElement("select",t);return e&&r.addEventListener("change",e),r.value=n,r}function m(t,e,n={},r={}){const a=I(r,e.updateValueFromEvent,e.value);return U(a,n,t)}function y(t,e,n,r,a,k={},B={}){const Y=K(B,e.updateValueFromEvent,e.value,n,r,a);return U(Y,k,t)}function z(t,e,n={},r={}){const a=createSelect(r,e.updateValueFromEvent,e.value);return createControl(a,n,t)}function q(t,e,n={},r={}){const a=createDateInput(r,e.updateValueFromEvent,e.value);return createControl(a,n,t)}function P(t,e,n={},r={}){const a=J(r,e.updateValueFromEvent,e.value);return U(a,n,t)}function re(t,e={},n={}){return createTextFilterControl("\u041F\u043E\u0438\u0441\u043A: ",t,e,n)}function ke(t,e={},n={},r=.1,a=3){return createNumberFilterControl("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",t,r,a,5,e,n)}function Be(t,e={},n={},r=.1,a=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",t,r,a,5,e,n)}function Pe(t,e={},n={}){return oe("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",t,e,n)}function Me(t,e={},n={}){return oe("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",t,e,n)}function oe(t,e,n={},r={}){return createNumberFilterControl(t,e,"1","1","999999",n,r)}function Ue(t,e={},n={}){return createDateFilterControl("\u041C\u0438\u043D. \u0434\u0430\u0442\u0430: ",t,e,n)}function We(t,e={},n={}){return ae("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",t,e,n)}function ae(t,e,n={},r={}){return createNumberFilterControl(t,e,"5","0","100",n,r)}function Ve(t,e={},n={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",t,"5","0","100",e,n)}function ie(t,e,n={},r={},a="250"){return createNumberFilterControl(t,e,a,"0","1000000",n,r)}function $e(t,e={},n={},r="25"){return ie("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",t,e,n,r)}function ze(t,e={},n={},r="25"){return ie("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",t,e,n,r)}function je(t,e={},n={}){return fe("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",t,e,n)}function fe(t,e,n={},r={}){return createNumberFilterControl(t,e,"1","0","99999",n,r)}function Ge(t,e={},n={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",t,"1","2","8",e,n)}function Ke(t,e={},n={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",t,1,1,10,e,n)}function He(t,e={},n={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",t,e,n)}function Qe(t,e={},n={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",t,e,n)}function Xe(t,e={},n={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",t,e,n)}function Ye(t,e={},n={}){return createCheckboxFilterControl("\u0411\u043E\u043D\u0443\u0441: ",t,e,n)}function Ze(t,e={},n={}){return createCheckboxFilterControl("\u0412 \u043D\u0430\u043B\u0438\u0447\u0438\u0438: ",t,e,n)}function de(t,e={},n={}){return P("\u0412\u043A\u043B: ",t,e,n)}function Je(t,e,n={}){const r=[{value:-25,emoji:"\u{1F48E}",tooltip:"\u0421\u0443\u043F\u0435\u0440 \u0446\u0435\u043D\u0430 (-25%)"},{value:-15,emoji:"\u{1F525}",tooltip:"\u041E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-15%)"},{value:-5,emoji:"\u{1F31F}",tooltip:"\u041A\u043B\u0430\u0441\u0441\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-5%)"},{value:5,emoji:"\u{1F44C}",tooltip:"\u0425\u043E\u0440\u043E\u0448\u0430\u044F \u0446\u0435\u043D\u0430 (+5%)"}],a={active:{background:"#e3f2fd",borderColor:"#2196f3",boxShadow:"0 0 0 1px #2196f3"},inactive:{background:"#fff",borderColor:"#ccc",boxShadow:"none"},hover:{background:"#f5f5f5"}},k=createDiv({display:"inline-flex",gap:"4px",marginLeft:"4px"}),B=[],Y=()=>e?parseFloat(e.value)||0:t.value,j=()=>{const G=Y();B.forEach(({button:te,value:ne})=>{const Z=ne<=G?a.active:a.inactive;Object.assign(te.style,Z)})};return r.forEach(({value:G,emoji:te,tooltip:ne})=>{const V=createButton({padding:"2px 6px",fontSize:"16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"#fff",transition:"all 0.2s",...n},te);V.title=ne,V.type="button",V.addEventListener("click",Z=>{Z.preventDefault(),t.updateValue(G),e&&(e.value=G),j()}),V.addEventListener("mouseenter",()=>{G<=Y()||(V.style.background=a.hover.background)}),V.addEventListener("mouseleave",()=>{j()}),B.push({button:V,value:G}),k.appendChild(V)}),j(),e&&(e.addEventListener("input",j),e.addEventListener("change",j)),k}const Q={MOVIES_LIST:"#results",MOVIE_CARD:"#itemList > .item",MY_VOTE_WRAP:".myVote",GENRE_WRAP:".gray_text",KP_REVIEWS_WRAP:".numVote > span > span",IMDB_REVIEWS_WRAP:".imdb > span",NAME_WRAP:".name",LENGTH_WRAP:"nobr"},le={INPUT:{marginLeft:"6px",padding:"4px 8px",fontSize:"12px"}},M={FILTERS_CONTAINER:{display:"flex",gridGap:"12px",marginTop:"10px",flexFlow:"wrap"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...le.INPUT,width:"120px"},NUMBER_INPUT:{...le.INPUT,width:"65px"},CHECKBOX_INPUT:{marginLeft:"6px",width:"17px",height:"17px"}};class me{constructor(e,n){this.value=e,this.onChange=n}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}function pe(t){const{target:e}=t,{type:n}=e;switch(n){case"text":return`"${e.value}"`;case"number":return e.value;case"select-one":return e.value;case"date":return`"${e.value}"`;case"checkbox":return e.checked;default:return console.log(`Unknown input type: ${n}`),null}}function ve(t){return t===""?null:JSON.parse(t)}const he=window.GM_setValue,qe=window.GM.setValue,Ee=window.GM_getValue;class ee extends me{constructor(e,n=null,r=null){super(Ee(e,n),r),this.storageKey=e,this.defaultValue=n}static create(e,n=null,r=null){return new ee(e,n,r)}static createWithCompositeKey(e,n,r=null,a=null){const k=`${e}-${n}`;return new ee(k,r,a)}updateValueFromEvent=e=>{const n=pe(e),r=ve(n);this.updateValue(r)};updateValue(e,n=!0){this.value!==e&&(he(this.storageKey,e),this.value=e,n&&this.onChangeIfDefined())}clearValue(e=!1){this.updateValue(null,e)}resetValue(e=!1){this.updateValue(this.defaultValue,e)}}function be(t,e=null){return{createGlobalFilter(n,r=null,a=t){return ee.create(n,r,a)},createSectionFilter(n,r=null,a=t){if(!e)throw new Error("sectionId must be provided to use createSectionFilter.");return ee.createWithCompositeKey(e,n,r,a)}}}function ge(t,e,n=!1,r="customFiltersContainer"){let a=(0,f.Fi)(`#${r}`,t);if(a)if(n)a.remove();else return;a=(0,D.S)(),a.id=r,e(a,t)}function Fe(t={}){return(0,D.S)(t,"|")}function ye(t={},e=75,n="customFiltersContainer"){const r=document.getElementById(n);if(!r)return console.log(`Element with id="${n}" not found.`),null;const a=createButton(t,`${arrowUpIcon}\u041A \u0444\u0438\u043B\u044C\u0442\u0440\u0430\u043C`);return a.addEventListener("mouseenter",()=>{a.style.filter="brightness(0.9)"}),a.addEventListener("mouseleave",()=>{a.style.filter="brightness(1)"}),a.addEventListener("click",()=>{const k=r.getBoundingClientRect();window.scrollTo({top:k.top+window.scrollY-e})}),new IntersectionObserver(([k])=>{a.style.display=k.isIntersecting?"none":"flex"},{threshold:.5}).observe(r),a}function et(t,e={}){const n=ye(e);n&&t.appendChild(n)}var Ce=c(6754);const x={moviesObserver:null,isFiltersInitialized:!1,filters:{nameFilter:null,genreFilter:null,maxLengthFilter:null,minKpReviewsFilter:null,minImdbReviewsFilter:null,isFinishedFilter:null,filterEnabled:null}};function we(t){t&&De(),xe(),Ne()}function xe(){if(!x.isFiltersInitialized){const{createGlobalFilter:t}=be(se);x.filters.nameFilter=t("navigator-name-filter"),x.filters.genreFilter=t("navigator-genre-filter"),x.filters.maxLengthFilter=t("navigator-max-length-filter"),x.filters.minKpReviewsFilter=t("navigator-min-kp-reviews-filter"),x.filters.minImdbReviewsFilter=t("navigator-min-imdb-reviews-filter"),x.filters.isFinishedFilter=t("navigator-is-finished-filter",!0),x.filters.filterEnabled=t("navigator-filter-enabled",!0),x.isFiltersInitialized=!0}}function Ne(){const t=(0,f.Fi)(Q.MOVIES_LIST);t&&(x.moviesObserver&&(0,b.wP)(x.moviesObserver),x.moviesObserver=new MutationObserver(()=>Te(t)),x.moviesObserver.observe(t,{childList:!0,subtree:!0}))}function Te(t){const e=(0,f.Fi)("tr > td",t);ge(e,Se),se()}function Se(t,e){(0,Ce.ZM)(t,M.FILTERS_CONTAINER);const n=m("\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435:",x.filters.nameFilter,M.CONTROL,M.TEXT_INPUT),r=m("\u0416\u0430\u043D\u0440:",x.filters.genreFilter,M.CONTROL,M.TEXT_INPUT),a=y("\u041C\u0430\u043A\u0441. \u043C\u0438\u043D\u0443\u0442:",x.filters.maxLengthFilter,"10","0","500",M.CONTROL,M.NUMBER_INPUT),k=y("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432 \u041A\u041F:",x.filters.minKpReviewsFilter,"100","0","1000000",M.CONTROL,M.NUMBER_INPUT),B=y("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432 IMDB:",x.filters.minImdbReviewsFilter,"100","0","1000000",M.CONTROL,M.NUMBER_INPUT),Y=P("\u0417\u0430\u0432\u0435\u0440\u0448\u0451\u043D: ",x.filters.isFinishedFilter,M.CONTROL,M.CHECKBOX_INPUT),j=Fe(M.CONTROL),G=de(x.filters.filterEnabled,M.CONTROL,M.CHECKBOX_INPUT);t.append(n,r,a,k,B,Y,j,G),e.append(t)}function se(){(0,f.fI)(Q.MOVIE_CARD).forEach(Ie)}function Ie(t){if(!x.filters.filterEnabled.value){(0,i.kl)(t);return}const e=(0,f.Fi)(Q.NAME_WRAP,t),n=(0,f.Fi)(Q.MY_VOTE_WRAP,t),r=(0,f.Fi)(Q.GENRE_WRAP,t),a=(0,f.Fi)(Q.LENGTH_WRAP,e),k=(0,f.Fi)(Q.KP_REVIEWS_WRAP,t),B=(0,f.Fi)(Q.IMDB_REVIEWS_WRAP,t);if([e,n,r,a,k,B].some(_e=>!_e)){(0,i.Bt)(t);return}if(n.innerText){(0,i.Bt)(t);return}const j=(0,f.Fi)("a",e)?.innerText??"",te=!((0,f.Fi)("span",e)?.innerText??"").includes("..."),ne=Oe(r),V=(0,f.YA)(a,!0),Z=(0,f.YA)(k,!0),Le=(0,f.YA)(B,!0),Re=N(j,x.filters.nameFilter)||N(ne,x.filters.genreFilter)||w(V,x.filters.maxLengthFilter)||T(Z,x.filters.minKpReviewsFilter)||T(Le,x.filters.minImdbReviewsFilter)||s(te,x.filters.isFinishedFilter);(0,i.UC)(t,Re)}function Oe(t){return Array.from(t.childNodes).filter(r=>r.nodeType===Node.TEXT_NODE).pop()?.textContent.trim()||""}function De(){x.isFiltersInitialized=!1,x.filters={nameFilter:null,genreFilter:null,maxLengthFilter:null,minKpReviewsFilter:null,minImdbReviewsFilter:null,isFinishedFilter:null,filterEnabled:null},(0,b.wP)(x.moviesObserver)}}},ue={};function X(L){var F=ue[L];if(F!==void 0)return F.exports;var c=ue[L]={exports:{}};return ce[L](c,c.exports,X),c.exports}(()=>{var L=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",F=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",c=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",_=E=>{E&&E.d<1&&(E.d=1,E.forEach(p=>p.r--),E.forEach(p=>p.r--?p.r++:p()))},A=E=>E.map(p=>{if(p!==null&&typeof p=="object"){if(p[L])return p;if(p.then){var g=[];g.d=0,p.then(N=>{l[F]=N,_(g)},N=>{l[c]=N,_(g)});var l={};return l[L]=N=>N(g),l}}var C={};return C[L]=N=>{},C[F]=p,C});X.a=(E,p,g)=>{var l;g&&((l=[]).d=-1);var C=new Set,N=E.exports,h,O,R,T=new Promise((w,d)=>{R=d,O=w});T[F]=N,T[L]=w=>(l&&w(l),C.forEach(w),T.catch(d=>{})),E.exports=T,p(w=>{h=A(w);var d,o=()=>h.map(i=>{if(i[c])throw i[c];return i[F]}),s=new Promise(i=>{d=()=>i(o),d.r=0;var f=D=>D!==l&&!C.has(D)&&(C.add(D),D&&!D.d&&(d.r++,D.push(d)));h.map(D=>D[L](f))});return d.r?s:o()},w=>(w?R(T[c]=w):O(N),_(l))),l&&l.d<0&&(l.d=0)}})(),X.d=(L,F)=>{for(var c in F)X.o(F,c)&&!X.o(L,c)&&Object.defineProperty(L,c,{enumerable:!0,get:F[c]})},X.o=(L,F)=>Object.prototype.hasOwnProperty.call(L,F);var Ae=X(6275)})();})();
