// ==UserScript==
// @name         Kinopoisk navigator filter
// @description  Hide movies by filter
// @grant        GM_addStyle
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.kinopoisk.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.77136793
// @icon         https://www.google.com/s2/favicons?sz=64&domain=kinopoisk.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/kinop.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var me={7273:(L,C,c)=>{c.d(C,{S:()=>h});var R=c(5558);function A(p={},b=null){return createElement("span",p,b)}function h(p={},b=null){return(0,R.n)("div",p,b)}},5558:(L,C,c)=>{c.d(C,{n:()=>A});var R=c(6754);function A(h,p,b=null){if(typeof p!="object"||p===null)throw new TypeError("styles should be an object");const a=document.createElement(h);return(0,R.ZM)(a,p),b&&(a.innerHTML=b),a}},573:(L,C,c)=>{c.d(C,{Fi:()=>h,YA:()=>_,fI:()=>p,s$:()=>b});var R=c(4214);function A(o,i=document){return!!i.querySelector(o)}function h(o,i=document,l=!1){const f=i.querySelector(o);return l&&!f&&console.log(`No element found for selector: ${o}`),f}function p(o,i=document,l=!1){const f=i.querySelectorAll(o);return l&&!f.length&&console.log(`No elements found for selector: ${o}`),f}function b(o,i=1){let l=o;for(let f=0;f<i;f++){if(!l.parentElement)return null;l=l.parentElement}return l}function a(o,i,l){return[...o.querySelectorAll(i)].find(f=>f.textContent.trim().includes(l))}function F(o,i,l=!1,f=!1,v=null){const P=h(i,o);return _(P,l,f,v)}function _(o,i=!1,l=!1,f=null){if(!o)return f===null?(console.log("No element found"),null):f;const v=o.innerText;return S(v,i,l)}function m(o,i,l=!1){const f=o[i];return _(f,l)}function O(o,i=!1,l=!1){const f=o.textContent;return S(f,i,l)}function S(o,i,l){i&&(o=(0,R.zr)(o)),l&&(o=o.replace(",","."));const f=Number(o);return Number.isNaN(f)?(console.log(`Invalid number: ${o}`),0):f}function D(o){return[...o.childNodes].find(i=>i.nodeType===Node.TEXT_NODE)}function w(o){const i=l=>l.nodeType===Node.TEXT_NODE&&l.textContent.trim()!==""?[l]:[...l.childNodes].flatMap(i);return i(o)}function I(o){return normalizeSpacing(o.textContent)}},5539:(L,C,c)=>{c.d(C,{Bt:()=>h,UC:()=>S,UE:()=>b,WH:()=>A,kl:()=>m});var R=c(573);function A(u,d){u.parentNode.insertBefore(d,u.nextSibling)}function h(u){u.style.display="none"}function p(u,d=1){const x=document.querySelector(u);x&&b(x,d)}function b(u,d=1){const x=(0,R.s$)(u,d);x&&h(x)}function a(u,d,x){const W=findElementByText(u,d,x);W&&h(W)}function F(u){I(u),h(u)}function _(u){u.intersectionObserver||runOnceOnIntersection(u,()=>h(u))}function m(u){u.style.display=""}function O(u){const d=w(u);u.style.display=d}function S(u,d){d?h(u):m(u)}function D(u,d){d?_(u):(clearIntersectionObserver(u),m(u))}function w(u){return I(u),u.dataset.defaultDisplay}function I(u){if(u.dataset.defaultDisplay)return;const{display:d}=getComputedStyle(u);u.dataset.defaultDisplay=d}function o(){return{show:[],hide:[]}}function i(u,d,x){u?d.hide.push(x):d.show.push(x)}function l(u){u.show.forEach(m),u.hide.forEach(h)}function f(u,d,x=.3){d?P(u,x):v(u)}function v(u){u.style.opacity=""}function P(u,d=.3){u.style.opacity=d}function V(u){u.style.order=""}function E(u,d){u.style.order=d}function g(u,d,x,W="inline-flex"){d.style.display=u?W:"none",x.style.display=u?"none":W}function y(u,d=.3){u.style.transition="opacity 0.3s",u.style.opacity=d,ee(u)}function T(u){u.style.opacity="",X(u)}function q(u){u.style.animation="loading-pulse 2.5s ease-in-out infinite",ee(u)}function z(u){u.style.animation="",X(u)}function ee(u){u.style.pointerEvents="none",u.style.cursor="wait"}function X(u){u.style.pointerEvents="",u.style.cursor=""}function G(u,d){const x=getFirstElement(d);x&&J(u,x)}function J(u,d){const x=createLink();x.href=u,d.parentNode.append(x),x.append(d)}function K(u,d){const x=getFirstElement(d);x&&ne(u,x)}function ne(u,d,x={}){const W=createLink(x);W.href=u,W.append(...d.childNodes),d.append(W)}function pe(){const u=getURLQueryParam("scrollTo");if(!u)return;const d=document.getElementById(u);d?d.scrollIntoView():console.log(`Element with ID "${u}" was not found.`)}function ve(u,d,x=null){const W=`${d}-click-passed`,re=x?M=>findElementByText(M,u,x):M=>getFirstElement(u,M);return function(M){if(M.hasAttribute(W))return!1;const se=re(M);return se&&se.click(),M.setAttribute(W,""),!0}}function le(u,d,x="text/plain"){const W=new Blob([u],{type:x}),re=URL.createObjectURL(W),M=document.createElement("a");M.href=re,M.download=d,document.body.appendChild(M),M.click(),document.body.removeChild(M),requestAnimationFrame(()=>URL.revokeObjectURL(re))}},6754:(L,C,c)=>{c.d(C,{ZM:()=>R});function R(b,a){Object.assign(b.style,a)}function A(b,a="custom-global-style"){let F=document.getElementById(a);F||(F=document.createElement("style"),F.id=a,F.type="text/css",document.head.appendChild(F)),F.textContent=b}function h(b){return Object.entries(b).map(([a,F])=>`${a.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${F};`).join(" ")}function p(b){return b?b.split(";").filter(a=>a.trim()!=="").reduce((a,F)=>{const[_,m]=F.split(":").map(S=>S.trim()),O=_.replace(/-([a-z])/g,(S,D)=>D.toUpperCase());return a[O]=m,a},{}):{}}},4921:(L,C,c)=>{c.d(C,{XW:()=>h,sg:()=>p,wP:()=>_});function R(m,O,S=null){const D=m.querySelector(O);return D?Promise.resolve(D):new Promise(w=>{const I=new MutationObserver(i);I.observe(m,{childList:!0,subtree:!0});let o;S&&(o=setTimeout(()=>{I.disconnect(),console.log(`No element found for selector: ${O}`),w(null)},S));function i(){const l=m.querySelector(O);l&&(o&&clearTimeout(o),I.disconnect(),w(l))}})}function A(m,O){return m.querySelector(O)?new Promise(D=>{const w=new MutationObserver(I);w.observe(m,{childList:!0,subtree:!0});function I(){m.querySelector(O)||(w.disconnect(),D())}}):Promise.resolve()}function h(m,O=400){return new Promise(S=>{let D;const w=new MutationObserver(()=>{clearTimeout(D),I()});function I(){D=setTimeout(()=>{w.disconnect(),S()},O)}I(),w.observe(m,{childList:!0,subtree:!0})})}function p(m,O=250){let S;return function(...D){const w=this;clearTimeout(S),S=setTimeout(()=>m.apply(w,D),O)}}async function b(m){document.visibilityState==="visible"?await m():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await m()},{once:!0})}function a(m,O){const S=new IntersectionObserver(D=>{D.forEach(w=>{w.isIntersecting&&(O(),F(m))})});m.intersectionObserver=S,S.observe(m)}function F(m){m.intersectionObserver&&(m.intersectionObserver.disconnect(),m.intersectionObserver=null)}function _(m){m&&(m.disconnect(),m=null)}},4214:(L,C,c)=>{c.d(C,{zr:()=>A});function R(a){return a.replace(/\D/g,"")}function A(a){return a.replace(/[^\d.,-]/g,"")}function h(a){return a.replace(/\s/g,"")}function p(a){return a.charAt(0).toUpperCase()+a.slice(1)}function b(a){return a.replace(/\s+/g," ").trim()}},5406:(L,C,c)=>{c.d(C,{k1:()=>w,z2:()=>S});function R(o,i="common",l=!1){const{pathname:f}=window.location;return A(f,o,i,l)}function A(o,i,l,f=!1){const v=o.split("/");i=i<0?v.length+i:i;const P=v[i]||l;return f&&console.log(`Pathname element: ${P}`),P}function h(o,i="common",l=!1){const f=R(o,"",l);return p(f,i,l)}function p(o,i,l){if(!o)return i;const f=o.split("-").at(-1);return l&&console.log(`Pathname element ending: ${f}`),f}function b(o,i,l="common",f=!1){const v=A(o,i,"",f);return p(v,l,f)}function a(o){return new URLSearchParams(window.location.search).get(o)}function F(o){return o.split("?")[0]}function _(o){return window.location.pathname.endsWith(o)}function m(o){return window.location.pathname.includes(o)}function O(o){return o.some(i=>m(i))}function S(...o){return window.location.pathname.split("/").some(l=>o.includes(l))}function D(o){try{const i=new URL(window.location.href);Object.entries(o).forEach(([l,f])=>{i.searchParams.set(l,f)}),window.location.href=i.toString()}catch(i){console.error("Failed to redirect:",i)}}function w(o,i=[]){const l=new AbortController;let f=!1;const v=V=>{const E=new URL(V),g={pathname:E.pathname};return i.forEach(y=>{g[y]=E.searchParams.get(y)}),g};let P=v(window.location.href);return window.navigation.addEventListener("navigatesuccess",async()=>{if(f)return;const V=v(window.navigation.currentEntry.url);if(Object.keys(P).some(g=>P[g]!==V[g])){P=V,f=!0;try{await o(V)}catch(g){console.error("URL observer error:",g)}finally{f=!1}}},{signal:l.signal}),()=>l.abort()}function I(o=[]){w(()=>window.location.reload(),o)}},6275:(L,C,c)=>{c.a(L,async(R,A)=>{try{var h=c(5406),p=c(128),b=c(9397);await a(),(0,h.k1)(async()=>{await a(!0)});async function a(F=!1){(0,h.z2)("navigator")?(0,p.R)(F):(0,h.z2)("film","series")&&await(0,b.g)(F)}A()}catch(a){A(a)}},1)},9397:(L,C,c)=>{c.d(C,{g:()=>I});const R={CONTAINER:{margin:"12px 0 -5px",display:"flex",gap:"8px",alignItems:"center"},BUTTON:{display:"inline-flex",alignItems:"center",padding:"6px 12px",background:"#1a1a1a",border:"1px solid #404040",borderRadius:"6px",color:"#e0e0e0",textDecoration:"none",fontSize:"13px",fontWeight:"500",transition:"all 0.2s ease",cursor:"pointer",transform:"scale(1)"},BUTTON_HOVER:{background:"#2a2a2a",borderColor:"#606060",transform:"scale(1.05)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"}};var A=c(6754),h=c(4921),p=c(5539),b=c(7273),a=c(5558);function F(E={},g=null,y=null){const T=(0,a.n)("a",E,g);return y&&(T.href=y),T}function _(E,g=null,y={}){y.cursor||="pointer";const T=F(y,g);return E&&T.addEventListener("click",E),T}function m(E,g,y=null,T={},q={}){T.display||="inline-flex",T.alignItems||="center",T.gap||="0.25em";const z=_(E,y,T);return z.prepend(createLucideIcon(g,q)),z}function O(E,g,y,T=null,q={},z={},ee="us-control"){const X=K=>{K.stopPropagation(),K.preventDefault(),window.confirm(y)&&E()},G=T?`<span>${T}</span>`:null,J=m(X,g,G,q,z);return J.classList.add(ee),J}function S(E,g,y={},T={}){return O(E,ThumbsDown,"\u0412\u044B\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u043D\u0438\u0437\u043A\u0438\u0439 \u0440\u0435\u0439\u0442\u0438\u043D\u0433?",g?"\u0414\u0438\u0437\u043B\u0430\u0439\u043A":null,y,T)}function D(E,g,y={},T={}){return O(E,RotateCcw,"\u0423\u0431\u0440\u0430\u0442\u044C \u043D\u0438\u0437\u043A\u0438\u0439 \u0440\u0435\u0439\u0442\u0438\u043D\u0433?",g?"\u0423\u0431\u0440\u0430\u0442\u044C \u0434\u0438\u0437\u043B\u0430\u0439\u043A":null,y,T)}function w(E={},g=null,y=null){const T=createElement("button",E,g);return y&&T.addEventListener("click",y),T}async function I(E){await(0,h.XW)(document.body),E&&void 0,o(),v()}function o(){window.GM_addStyle(`
        [class*="styles_socialArgument__"],
        div[class*="styles_header__"] div[class*="styles_topText__"] p {
            display: none !important;
        }
    `),i("film-media-posts"),i("today-in-cinema-block"),l(),document.querySelector('div[class^="styles_videoWrapper__"]')?.remove(),document.querySelector("div.ReactModalPortal")?.remove(),f()}function i(E){const g=document.querySelector(`span#${E}`);if(!g)return;(0,p.Bt)(g);const y=g.nextElementSibling;y?.tagName==="DIV"&&(0,p.Bt)(y)}function l(){const E=document.querySelector('p[class^="style_offerName___"]');E&&(0,p.UE)(E,4)}function f(){const E=document.querySelector('div[class^="styles_watchOnlineBlock__"]');if(!E)return;const g=E.querySelector('button[class*="styles_watchOnlineButton__"]');g&&g.innerText.trim().toLowerCase().includes("\u043F\u043E\u0434\u043A\u043B\u044E\u0447\u0438\u0442\u044C")&&E.remove()}function v(){const E=document.querySelector('h1[class^="styles_title__"] > span');if(!E)return;const g=E.textContent.trim(),y=document.querySelector('div[class^="styles_header__"]');if(!y||document.querySelector(".custom-torrent-buttons"))return;const T=(0,b.S)(R.CONTAINER);T.className="custom-torrent-buttons";const z=`https://kinozal.tv/browse.php?s=${encodeURIComponent(g).replace(/%20/g,"+")}&g=0&c=0&v=0&d=0&w=0&t=1&f=0`,X=`https://rutracker.org/forum/tracker.php?nm=${encodeURIComponent(g)}`,G=P("\u041A\u0438\u043D\u043E\u0437\u0430\u043B",z),J=P("\u0420\u0443\u0442\u0440\u0435\u043A\u0435\u0440",X);T.appendChild(G),T.appendChild(J);const K=y.querySelector('div[class^="styles_title__"]');K&&(0,p.WH)(K,T)}function P(E,g){const y=F(R.BUTTON,E,g);return y.target="_blank",y.addEventListener("mouseenter",()=>{(0,A.ZM)(y,R.BUTTON_HOVER)}),y.addEventListener("mouseleave",()=>{(0,A.ZM)(y,R.BUTTON)}),y}function V(){}},128:(L,C,c)=>{c.d(C,{R:()=>Ie});function R(t){if(!t)return[];const n=A(t).flat().filter(r=>r&&!r.isNegative&&r.term).map(r=>r.term);return[...new Set(n)]}function A(t){return t?t.toLowerCase().split(",").map(h).filter(Boolean):[]}function h(t){const e=t.split("/").map(r=>r.trim()).filter(Boolean);if(e.length===0)return null;const n=e.map(p).filter(Boolean);return n.length>0?n:null}function p(t){const e=t.startsWith("!"),n=e?t.slice(1).trim():t;return n?{term:n,isNegative:e}:null}function b(t,e){F(t,n=>n.style.display!=="none",e)}function a(t,e){F(t,n=>n.style.opacity==="",e)}function F(t,e,n){const r=[...t].filter(e).length,s=t.length;_(n,r,s)}function _(t,e,n){t.textContent=`\u041F\u043E\u043A\u0430\u0437\u0430\u043D\u043E: ${e} \u0438\u0437 ${n}`}function m(t,e){return!O(t,e)}function O(t,e){if(!e||!e.value)return!0;const n=A(e.value);return S(t,n)}function S(t,e){if(!e||!e.length)return!0;const n=(t||"").toLowerCase();return e.every(r=>D(n,r))}function D(t,e){return e.some(({term:n,isNegative:r})=>{const s=t.includes(n);return r?!s:s})}function w(t,e){return e.value!=null&&t<e.value}function I(t,e){return e.value!=null&&t>e.value}function o(t,e){return e.value==null?!1:t<parseDateFromISO(e.value)}function i(t,e){return e.value==null?!1:t>parseDateFromISO(e.value)}function l(t,e){return e.value&&t!==e.value}var f=c(5539),v=c(573),P=c(7273);function V(t,e={},n=null){const r=(0,P.S)(e,n);return r.append(t),r}function E(t,e=null,n={},r={}){const s=createActionLink(t,e,r);return V(s,n)}function g(t,e=null,n=null,r={},s={},k={}){const B=createActionLinkWithIcon(t,n,e,s,k);return V(B,r)}var y=c(5558),T=c(4921);function q(t,e,n){const r=G(t,"text",e);return r.value=n,r}function z(t,e,n,r,s,k){const B=G(t,"number",e);return B.value=n,B.step=r,B.min=s,B.max=k,B}function ee(t,e,n){const r=G(t,"date",e);return r.value=n,r}function X(t,e,n){const r=G(t,"checkbox",e);return r.checked=n,r}function G(t={},e=null,n=null){const r=(0,y.n)("input",t);return e&&(r.type=e),n&&(r.addEventListener("keyup",(0,T.sg)(n,200)),r.addEventListener("change",(0,T.sg)(n,100))),r}function J(t,e,n){const r=createElement("select",t);return e&&r.addEventListener("change",e),r.value=n,r}function K(t,e,n={},r={}){const s=q(r,e.updateValueFromEvent,e.value);return V(s,n,t)}function ne(t,e,n,r,s,k={},B={}){const j=z(B,e.updateValueFromEvent,e.value,n,r,s);return V(j,k,t)}function pe(t,e,n={},r={}){const s=createSelect(r,e.updateValueFromEvent,e.value);return createControl(s,n,t)}function ve(t,e,n={},r={}){const s=createDateInput(r,e.updateValueFromEvent,e.value);return createControl(s,n,t)}function le(t,e,n={},r={}){const s=X(r,e.updateValueFromEvent,e.value);return V(s,n,t)}function u(t,e={},n={}){return createTextFilterControl("\u041F\u043E\u0438\u0441\u043A: ",t,e,n)}function d(t,e={},n={},r=.1,s=3){return createNumberFilterControl("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",t,r,s,5,e,n)}function x(t,e={},n={},r=.1,s=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",t,r,s,5,e,n)}function W(t,e={},n={}){return M("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",t,e,n)}function re(t,e={},n={}){return M("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",t,e,n)}function M(t,e,n={},r={}){return createNumberFilterControl(t,e,"1","1","999999",n,r)}function se(t,e={},n={}){return createDateFilterControl("\u041C\u0438\u043D. \u0434\u0430\u0442\u0430: ",t,e,n)}function Ve(t,e={},n={}){return he("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",t,e,n)}function he(t,e,n={},r={}){return createNumberFilterControl(t,e,"5","0","100",n,r)}function $e(t,e={},n={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",t,"5","0","100",e,n)}function ae(t,e,n={},r={},s="250"){return createNumberFilterControl(t,e,s,"0","1000000",n,r)}function ze(t,e={},n={},r="25"){return ae("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",t,e,n,r)}function Ge(t,e={},n={},r="25"){return ae("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",t,e,n,r)}function Ke(t,e={},n={}){return Ee("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",t,e,n)}function Ee(t,e,n={},r={}){return createNumberFilterControl(t,e,"1","0","99999",n,r)}function je(t,e={},n={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",t,"1","2","8",e,n)}function Qe(t,e={},n={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",t,1,1,10,e,n)}function He(t,e={},n={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",t,e,n)}function Xe(t,e={},n={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",t,e,n)}function Ye(t,e={},n={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",t,e,n)}function Ze(t,e={},n={}){return createCheckboxFilterControl("\u0411\u043E\u043D\u0443\u0441: ",t,e,n)}function qe(t,e={},n={}){return createCheckboxFilterControl("\u0412 \u043D\u0430\u043B\u0438\u0447\u0438\u0438: ",t,e,n)}function be(t,e={},n={}){return le("\u0412\u043A\u043B: ",t,e,n)}function Je(t,e,n={}){const r=[{value:-25,emoji:"\u{1F48E}",tooltip:"\u0421\u0443\u043F\u0435\u0440 \u0446\u0435\u043D\u0430 (-25%)"},{value:-15,emoji:"\u{1F525}",tooltip:"\u041E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-15%)"},{value:-5,emoji:"\u{1F31F}",tooltip:"\u041A\u043B\u0430\u0441\u0441\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-5%)"},{value:5,emoji:"\u{1F44C}",tooltip:"\u0425\u043E\u0440\u043E\u0448\u0430\u044F \u0446\u0435\u043D\u0430 (+5%)"}],s={active:{background:"#e3f2fd",borderColor:"#2196f3",boxShadow:"0 0 0 1px #2196f3"},inactive:{background:"#fff",borderColor:"#ccc",boxShadow:"none"},hover:{background:"#f5f5f5"}},k=createDiv({display:"inline-flex",gap:"4px",marginLeft:"4px"}),B=[],j=()=>e?parseFloat(e.value)||0:t.value,Q=()=>{const H=j();B.forEach(({button:oe,value:ie})=>{const te=ie<=H?s.active:s.inactive;Object.assign(oe.style,te)})};return r.forEach(({value:H,emoji:oe,tooltip:ie})=>{const $=createButton({padding:"2px 6px",fontSize:"16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"#fff",transition:"all 0.2s",...n},oe);$.title=ie,$.type="button",$.addEventListener("click",te=>{te.preventDefault(),t.updateValue(H),e&&(e.value=H),Q()}),$.addEventListener("mouseenter",()=>{H<=j()||($.style.background=s.hover.background)}),$.addEventListener("mouseleave",()=>{Q()}),B.push({button:$,value:H}),k.appendChild($)}),Q(),e&&(e.addEventListener("input",Q),e.addEventListener("change",Q)),k}const Y={MOVIES_LIST:"#results",MOVIE_CARD:"#itemList > .item",MY_VOTE_WRAP:".myVote",GENRE_WRAP:".gray_text",KP_REVIEWS_WRAP:".numVote > span > span",IMDB_REVIEWS_WRAP:".imdb > span",NAME_WRAP:".name",LENGTH_WRAP:"nobr"},fe={INPUT:{marginLeft:"6px",padding:"4px 8px",fontSize:"12px"}},U={FILTERS_CONTAINER:{display:"flex",gridGap:"12px",marginTop:"10px",flexFlow:"wrap"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...fe.INPUT,width:"120px"},NUMBER_INPUT:{...fe.INPUT,width:"65px"},CHECKBOX_INPUT:{marginLeft:"6px",width:"17px",height:"17px"}};class ge{constructor(e,n){this.value=e,this.onChange=n}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}function ye(t){const{target:e}=t,{type:n}=e;switch(n){case"text":return`"${e.value}"`;case"number":return e.value;case"select-one":return e.value;case"date":return`"${e.value}"`;case"checkbox":return e.checked;default:return console.log(`Unknown input type: ${n}`),null}}function Ce(t){return t===""?null:JSON.parse(t)}const Fe=window.GM_setValue,et=window.GM.setValue,we=window.GM_getValue;class ue extends ge{constructor(e,n=null,r=null){super(we(e,n),r),this.storageKey=e,this.defaultValue=n}static create(e,n=null,r=null){return new ue(e,n,r)}static createWithCompositeKey(e,n,r=null,s=null){const k=`${e}-${n}`;return new ue(k,r,s)}updateValueFromEvent=e=>{const n=ye(e),r=Ce(n);this.updateValue(r)};updateValue(e,n=!0){this.value!==e&&(Fe(this.storageKey,e),this.value=e,n&&this.onChangeIfDefined())}clearValue(e=!1){this.updateValue(null,e)}resetValue(e=!1){this.updateValue(this.defaultValue,e)}}function xe(t,e=null){return{createGlobalFilter(n,r=null,s=t){return ue.create(n,r,s)},createSectionFilter(n,r=null,s=t){if(!e)throw new Error("sectionId must be provided to use createSectionFilter.");return ue.createWithCompositeKey(e,n,r,s)}}}function Te(t,e,n=!1,r="customFiltersContainer"){let s=t.querySelector(`#${r}`);if(s){if(!n)return;s.replaceChildren()}else s=(0,P.S)(),s.id=r;e(s,t)}function Ne(t={}){return(0,P.S)(t,"|")}function Se(t,e={},n="customFiltersContainer"){const r=document.getElementById(n);if(!r)return console.log(`Element with id="${n}" not found.`),null;const s=createButton(e,`${arrowUpIcon}\u041A \u0444\u0438\u043B\u044C\u0442\u0440\u0430\u043C`);return s.addEventListener("mouseenter",()=>{s.style.filter="brightness(0.9)"}),s.addEventListener("mouseleave",()=>{s.style.filter="brightness(1)"}),s.addEventListener("click",()=>{const k=r.getBoundingClientRect();window.scrollTo({top:k.top+window.scrollY-t,behavior:"smooth"})}),new IntersectionObserver(([k])=>{const B=k.boundingClientRect.top<0,j=!k.isIntersecting&&B;s.style.display=j?"flex":"none"},{threshold:.5}).observe(r),s}function tt(t,e={},n=75){const r=Se(n,e);r&&t.appendChild(r)}var Le=c(6754);const N={moviesObserver:null,isFiltersInitialized:!1,filters:{nameFilter:null,genreFilter:null,maxLengthFilter:null,minKpReviewsFilter:null,minImdbReviewsFilter:null,isFinishedFilter:null,filterEnabled:null}};function Ie(t){t&&Be(),Oe(),De()}function Oe(){if(!N.isFiltersInitialized){const{createGlobalFilter:t}=xe(de);N.filters.nameFilter=t("navigator-name-filter"),N.filters.genreFilter=t("navigator-genre-filter"),N.filters.maxLengthFilter=t("navigator-max-length-filter"),N.filters.minKpReviewsFilter=t("navigator-min-kp-reviews-filter"),N.filters.minImdbReviewsFilter=t("navigator-min-imdb-reviews-filter"),N.filters.isFinishedFilter=t("navigator-is-finished-filter",!0),N.filters.filterEnabled=t("navigator-filter-enabled",!0),N.isFiltersInitialized=!0}}function De(){const t=(0,v.Fi)(Y.MOVIES_LIST);t&&(N.moviesObserver&&(0,T.wP)(N.moviesObserver),N.moviesObserver=new MutationObserver(()=>Re(t)),N.moviesObserver.observe(t,{childList:!0,subtree:!0}))}function Re(t){const e=(0,v.Fi)("tr > td",t);Te(e,_e),de()}function _e(t,e){(0,Le.ZM)(t,U.FILTERS_CONTAINER);const n=K("\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435:",N.filters.nameFilter,U.CONTROL,U.TEXT_INPUT),r=K("\u0416\u0430\u043D\u0440:",N.filters.genreFilter,U.CONTROL,U.TEXT_INPUT),s=ne("\u041C\u0430\u043A\u0441. \u043C\u0438\u043D\u0443\u0442:",N.filters.maxLengthFilter,"10","0","500",U.CONTROL,U.NUMBER_INPUT),k=ne("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432 \u041A\u041F:",N.filters.minKpReviewsFilter,"100","0","1000000",U.CONTROL,U.NUMBER_INPUT),B=ne("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432 IMDB:",N.filters.minImdbReviewsFilter,"100","0","1000000",U.CONTROL,U.NUMBER_INPUT),j=le("\u0417\u0430\u0432\u0435\u0440\u0448\u0451\u043D: ",N.filters.isFinishedFilter,U.CONTROL,U.CHECKBOX_INPUT),Q=Ne(U.CONTROL),H=be(N.filters.filterEnabled,U.CONTROL,U.CHECKBOX_INPUT);t.append(n,r,s,k,B,j,Q,H),e.append(t)}function de(){(0,v.fI)(Y.MOVIE_CARD).forEach(Ae)}function Ae(t){if(!N.filters.filterEnabled.value){(0,f.kl)(t);return}const e=(0,v.Fi)(Y.NAME_WRAP,t),n=(0,v.Fi)(Y.MY_VOTE_WRAP,t),r=(0,v.Fi)(Y.GENRE_WRAP,t),s=(0,v.Fi)(Y.LENGTH_WRAP,e),k=(0,v.Fi)(Y.KP_REVIEWS_WRAP,t),B=(0,v.Fi)(Y.IMDB_REVIEWS_WRAP,t);if([e,n,r,s,k,B].some(Ue=>!Ue)){(0,f.Bt)(t);return}if(n.innerText){(0,f.Bt)(t);return}const Q=(0,v.Fi)("a",e)?.innerText??"",oe=!((0,v.Fi)("span",e)?.innerText??"").includes("..."),ie=ke(r),$=(0,v.YA)(s,!0),te=(0,v.YA)(k,!0),Pe=(0,v.YA)(B,!0),Me=m(Q,N.filters.nameFilter)||m(ie,N.filters.genreFilter)||I($,N.filters.maxLengthFilter)||w(te,N.filters.minKpReviewsFilter)||w(Pe,N.filters.minImdbReviewsFilter)||l(oe,N.filters.isFinishedFilter);(0,f.UC)(t,Me)}function ke(t){return Array.from(t.childNodes).filter(r=>r.nodeType===Node.TEXT_NODE).pop()?.textContent.trim()||""}function Be(){N.isFiltersInitialized=!1,N.filters={nameFilter:null,genreFilter:null,maxLengthFilter:null,minKpReviewsFilter:null,minImdbReviewsFilter:null,isFinishedFilter:null,filterEnabled:null},(0,T.wP)(N.moviesObserver)}}},ce={};function Z(L){var C=ce[L];if(C!==void 0)return C.exports;var c=ce[L]={exports:{}};return me[L](c,c.exports,Z),c.exports}(()=>{var L=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",C=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",c=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",R=h=>{h&&h.d<1&&(h.d=1,h.forEach(p=>p.r--),h.forEach(p=>p.r--?p.r++:p()))},A=h=>h.map(p=>{if(p!==null&&typeof p=="object"){if(p[L])return p;if(p.then){var b=[];b.d=0,p.then(_=>{a[C]=_,R(b)},_=>{a[c]=_,R(b)});var a={};return a[L]=_=>_(b),a}}var F={};return F[L]=_=>{},F[C]=p,F});Z.a=(h,p,b)=>{var a;b&&((a=[]).d=-1);var F=new Set,_=h.exports,m,O,S,D=new Promise((w,I)=>{S=I,O=w});D[C]=_,D[L]=w=>(a&&w(a),F.forEach(w),D.catch(I=>{})),h.exports=D,p(w=>{m=A(w);var I,o=()=>m.map(l=>{if(l[c])throw l[c];return l[C]}),i=new Promise(l=>{I=()=>l(o),I.r=0;var f=v=>v!==a&&!F.has(v)&&(F.add(v),v&&!v.d&&(I.r++,v.push(I)));m.map(v=>v[L](f))});return I.r?i:o()},w=>(w?S(D[c]=w):O(_),R(a))),a&&a.d<0&&(a.d=0)}})(),Z.d=(L,C)=>{for(var c in C)Z.o(C,c)&&!Z.o(L,c)&&Object.defineProperty(L,c,{enumerable:!0,get:C[c]})},Z.o=(L,C)=>Object.prototype.hasOwnProperty.call(L,C);var We=Z(6275)})();})();
