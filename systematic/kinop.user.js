// ==UserScript==
// @name         Kinopoisk navigator filter
// @description  Hide movies by filter
// @grant        GM_addStyle
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.kinopoisk.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.77032393
// @icon         https://www.google.com/s2/favicons?sz=64&domain=kinopoisk.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/kinop.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var ae={7273:(R,C,f)=>{f.d(C,{S:()=>b});var D=f(5558);function A(v={},g=null){return createElement("span",v,g)}function b(v={},g=null){return(0,D.n)("div",v,g)}},5558:(R,C,f)=>{f.d(C,{n:()=>A});var D=f(6754);function A(b,v,g=null){if(typeof v!="object"||v===null)throw new TypeError("styles should be an object");const a=document.createElement(b);return(0,D.ZM)(a,v),g&&(a.innerHTML=g),a}},573:(R,C,f)=>{f.d(C,{Fi:()=>b,YA:()=>S,fI:()=>v,s$:()=>g});var D=f(4214);function A(u,l=document){return!!l.querySelector(u)}function b(u,l=document,i=!1){const s=l.querySelector(u);return i&&!s&&console.log(`No element found for selector: ${u}`),s}function v(u,l=document,i=!1){const s=l.querySelectorAll(u);return i&&!s.length&&console.log(`No elements found for selector: ${u}`),s}function g(u,l=1){let i=u;for(let s=0;s<l;s++){if(!i.parentElement)return null;i=i.parentElement}return i}function a(u,l,i){return[...u.querySelectorAll(l)].find(s=>s.textContent.trim().includes(i))}function F(u,l,i=!1,s=!1,p=null){const B=b(l,u);return S(B,i,s,p)}function S(u,l=!1,i=!1,s=null){if(!u)return s===null?(console.log("No element found"),null):s;const p=u.innerText;return O(p,l,i)}function E(u,l,i=!1){const s=u[l];return S(s,i)}function L(u,l=!1,i=!1){const s=u.textContent;return O(s,l,i)}function O(u,l,i){l&&(u=(0,D.zr)(u)),i&&(u=u.replace(",","."));const s=Number(u);return Number.isNaN(s)?(console.log(`Invalid number: ${u}`),0):s}function I(u){return[...u.childNodes].find(l=>l.nodeType===Node.TEXT_NODE)}function w(u){const l=i=>i.nodeType===Node.TEXT_NODE&&i.textContent.trim()!==""?[i]:[...i.childNodes].flatMap(l);return l(u)}function _(u){return normalizeSpacing(u.textContent)}},5539:(R,C,f)=>{f.d(C,{Bt:()=>b,UC:()=>L,UE:()=>g,WH:()=>A,kl:()=>S});var D=f(573);function A(o,d){o.parentNode.insertBefore(d,o.nextSibling)}function b(o){o.style.display="none"}function v(o,d=1){const x=document.querySelector(o);x&&g(x,d)}function g(o,d=1){const x=(0,D.s$)(o,d);x&&b(x)}function a(o){w(o),b(o)}function F(o){o.intersectionObserver||runOnceOnIntersection(o,()=>b(o))}function S(o){o.style.display=""}function E(o){const d=I(o);o.style.display=d}function L(o,d){d?b(o):S(o)}function O(o,d){d?F(o):(clearIntersectionObserver(o),S(o))}function I(o){return w(o),o.dataset.defaultDisplay}function w(o){if(o.dataset.defaultDisplay)return;const{display:d}=getComputedStyle(o);o.dataset.defaultDisplay=d}function _(){return{show:[],hide:[]}}function u(o,d,x){o?d.hide.push(x):d.show.push(x)}function l(o){o.show.forEach(S),o.hide.forEach(b)}function i(o,d,x=.3){d?p(o,x):s(o)}function s(o){o.style.opacity=""}function p(o,d=.3){o.style.opacity=d}function B(o){o.style.order=""}function U(o,d){o.style.order=d}function m(o,d,x,V="inline-flex"){d.style.display=o?V:"none",x.style.display=o?"none":V}function h(o,d){o.style.background=d}function y(o,d){const x=getFirstElement(d);x&&N(o,x)}function N(o,d){const x=createLink();x.href=o,d.parentNode.append(x),x.append(d)}function Y(o,d){const x=getFirstElement(d);x&&z(o,x)}function z(o,d,x={}){const V=createLink(x);V.href=o,V.append(...d.childNodes),d.append(V)}function re(){const o=getURLQueryParam("scrollTo");if(!o)return;const d=document.getElementById(o);d?d.scrollIntoView():console.log(`Element with ID "${o}" was not found.`)}function Z(o,d,x=null){const V=`${d}-click-passed`,q=x?M=>findElementByText(M,o,x):M=>getFirstElement(o,M);return function(M){if(M.hasAttribute(V))return!1;const oe=q(M);return oe&&oe.click(),M.setAttribute(V,""),!0}}function G(o,d,x="text/plain"){const V=new Blob([o],{type:x}),q=URL.createObjectURL(V),M=document.createElement("a");M.href=q,M.download=d,document.body.appendChild(M),M.click(),document.body.removeChild(M),requestAnimationFrame(()=>URL.revokeObjectURL(q))}},6754:(R,C,f)=>{f.d(C,{ZM:()=>D});function D(g,a){Object.assign(g.style,a)}function A(g,a="custom-global-style"){let F=document.getElementById(a);F||(F=document.createElement("style"),F.id=a,F.type="text/css",document.head.appendChild(F)),F.textContent=g}function b(g){return Object.entries(g).map(([a,F])=>`${a.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${F};`).join(" ")}function v(g){return g?g.split(";").filter(a=>a.trim()!=="").reduce((a,F)=>{const[S,E]=F.split(":").map(O=>O.trim()),L=S.replace(/-([a-z])/g,(O,I)=>I.toUpperCase());return a[L]=E,a},{}):{}}},4921:(R,C,f)=>{f.d(C,{XW:()=>b,sg:()=>v,wP:()=>S});function D(E,L,O=null){const I=E.querySelector(L);return I?Promise.resolve(I):new Promise(w=>{const _=new MutationObserver(l);_.observe(E,{childList:!0,subtree:!0});let u;O&&(u=setTimeout(()=>{_.disconnect(),console.log(`No element found for selector: ${L}`),w(null)},O));function l(){const i=E.querySelector(L);i&&(u&&clearTimeout(u),_.disconnect(),w(i))}})}function A(E,L){return E.querySelector(L)?new Promise(I=>{const w=new MutationObserver(_);w.observe(E,{childList:!0,subtree:!0});function _(){E.querySelector(L)||(w.disconnect(),I())}}):Promise.resolve()}function b(E,L=400){return new Promise(O=>{let I;const w=new MutationObserver(()=>{clearTimeout(I),_()});function _(){I=setTimeout(()=>{w.disconnect(),O()},L)}_(),w.observe(E,{childList:!0,subtree:!0})})}function v(E,L=250){let O;return function(...I){const w=this;clearTimeout(O),O=setTimeout(()=>E.apply(w,I),L)}}async function g(E){document.visibilityState==="visible"?await E():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await E()},{once:!0})}function a(E,L){const O=new IntersectionObserver(I=>{I.forEach(w=>{w.isIntersecting&&(L(),F(E))})});E.intersectionObserver=O,O.observe(E)}function F(E){E.intersectionObserver&&(E.intersectionObserver.disconnect(),E.intersectionObserver=null)}function S(E){E&&(E.disconnect(),E=null)}},4214:(R,C,f)=>{f.d(C,{zr:()=>A});function D(a){return a.replace(/\D/g,"")}function A(a){return a.replace(/[^\d.,-]/g,"")}function b(a){return a.replace(/\s/g,"")}function v(a){return a.charAt(0).toUpperCase()+a.slice(1)}function g(a){return a.replace(/\s+/g," ").trim()}},5406:(R,C,f)=>{f.d(C,{$G:()=>w,z2:()=>L});function D(u,l="common",i=!1){const{pathname:s}=window.location;return A(s,u,l,i)}function A(u,l,i,s=!1){const p=u.split("/");l=l<0?p.length+l:l;const B=p[l]||i;return s&&console.log(`Pathname element: ${B}`),B}function b(u,l="common",i=!1){const s=D(u,"",i);return v(s,l,i)}function v(u,l,i){if(!u)return l;const s=u.split("-").at(-1);return i&&console.log(`Pathname element ending: ${s}`),s}function g(u,l,i="common",s=!1){const p=A(u,l,"",s);return v(p,i,s)}function a(u){return new URLSearchParams(window.location.search).get(u)}function F(u){return u.split("?")[0]}function S(u){return window.location.pathname.includes(u)}function E(u){return u.some(l=>S(l))}function L(...u){return window.location.pathname.split("/").some(i=>u.includes(i))}function O(u){try{const l=new URL(window.location.href);Object.entries(u).forEach(([i,s])=>{l.searchParams.set(i,s)}),window.location.href=l.toString()}catch(l){console.error("Failed to redirect:",l)}}function I(u,l=[]){const i=new AbortController;let s=!1;const p=U=>{const m=new URL(U),h={pathname:m.pathname};return l.forEach(y=>{h[y]=m.searchParams.get(y)}),h};let B=p(window.location.href);return window.navigation.addEventListener("navigatesuccess",async()=>{if(s)return;const U=p(window.navigation.currentEntry.url);if(Object.keys(B).some(h=>B[h]!==U[h])){B=U,s=!0;try{await u(U)}catch(h){console.error("URL observer error:",h)}finally{s=!1}}},{signal:i.signal}),()=>i.abort()}function w(u,l=[]){const i={pathname:window.location.pathname};l.forEach(m=>{i[m]=a(m)});let s=!1;async function p(){if(s)return;const m={pathname:window.location.pathname};if(l.forEach(h=>{m[h]=a(h)}),Object.keys(i).some(h=>i[h]!==m[h])){Object.assign(i,m),s=!0;try{await u()}catch(h){console.error("Error in URL observer callback:",h)}finally{s=!1}}}function B(){p().catch(m=>{console.error("Error in URL change handler:",m)})}let U=window.location.href;setInterval(()=>{window.location.href!==U&&(console.log("URL changed:",window.location.href),U=window.location.href,B())},200),window.addEventListener("popstate",B)}function _(u=[]){w(()=>window.location.reload(),u)}},6275:(R,C,f)=>{f.a(R,async(D,A)=>{try{var b=f(5406),v=f(128),g=f(9397);await a(),(0,b.$G)(async()=>{await a(!0)});async function a(F=!1){(0,b.z2)("navigator")?(0,v.R)(F):(0,b.z2)("film","series")&&await(0,g.g)(F)}A()}catch(a){A(a)}},1)},9397:(R,C,f)=>{f.d(C,{g:()=>_});const D={CONTAINER:{margin:"12px 0 -5px",display:"flex",gap:"8px",alignItems:"center"},BUTTON:{display:"inline-flex",alignItems:"center",padding:"6px 12px",background:"#1a1a1a",border:"1px solid #404040",borderRadius:"6px",color:"#e0e0e0",textDecoration:"none",fontSize:"13px",fontWeight:"500",transition:"all 0.2s ease",cursor:"pointer",transform:"scale(1)"},BUTTON_HOVER:{background:"#2a2a2a",borderColor:"#606060",transform:"scale(1.05)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"}};var A=f(6754),b=f(4921),v=f(5539),g=f(7273),a=f(5558);function F(m={},h=null,y=null){const N=(0,a.n)("a",m,h);return y&&(N.href=y),N}function S(m,h=null,y={}){y.cursor||="pointer";const N=F(y,h);return m&&N.addEventListener("click",m),N}function E(m,h,y=null,N={},Y={}){N.display||="inline-flex",N.alignItems||="center",N.gap||="0.25em";const z=S(m,y,N);return z.prepend(createLucideIcon(h,Y)),z}function L(m,h,y,N=null,Y={},z={},re="userscript-control"){const Z=d=>{d.stopPropagation(),d.preventDefault(),window.confirm(y)&&m()},G=N?`<span>${N}</span>`:null,o=E(Z,h,G,Y,z);return o.classList.add(re),o}function O(m,h,y={},N={}){return L(m,ThumbsDown,"\u0412\u044B\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u043D\u0438\u0437\u043A\u0438\u0439 \u0440\u0435\u0439\u0442\u0438\u043D\u0433?",h?"\u0414\u0438\u0437\u043B\u0430\u0439\u043A":null,y,N)}function I(m,h,y={},N={}){return L(m,RotateCcw,"\u0423\u0431\u0440\u0430\u0442\u044C \u043D\u0438\u0437\u043A\u0438\u0439 \u0440\u0435\u0439\u0442\u0438\u043D\u0433?",h?"\u0423\u0431\u0440\u0430\u0442\u044C \u0434\u0438\u0437\u043B\u0430\u0439\u043A":null,y,N)}function w(m={},h=null,y=null){const N=createElement("button",m,h);return y&&N.addEventListener("click",y),N}async function _(m){await(0,b.XW)(document.body),m&&void 0,u(),p()}function u(){window.GM_addStyle(`
        [class*="styles_socialArgument__"],
        div[class*="styles_header__"] div[class*="styles_topText__"] p {
            display: none !important;
        }
    `),l("film-media-posts"),l("today-in-cinema-block"),i(),document.querySelector('div[class^="styles_videoWrapper__"]')?.remove(),document.querySelector("div.ReactModalPortal")?.remove(),s()}function l(m){const h=document.querySelector(`span#${m}`);if(!h)return;(0,v.Bt)(h);const y=h.nextElementSibling;y?.tagName==="DIV"&&(0,v.Bt)(y)}function i(){const m=document.querySelector('p[class^="style_offerName___"]');m&&(0,v.UE)(m,4)}function s(){const m=document.querySelector('div[class^="styles_watchOnlineBlock__"]');if(!m)return;const h=m.querySelector('button[class*="styles_watchOnlineButton__"]');h&&h.innerText.trim().toLowerCase().includes("\u043F\u043E\u0434\u043A\u043B\u044E\u0447\u0438\u0442\u044C")&&m.remove()}function p(){const m=document.querySelector('h1[class^="styles_title__"] > span');if(!m)return;const h=m.textContent.trim(),y=document.querySelector('div[class^="styles_header__"]');if(!y||document.querySelector(".custom-torrent-buttons"))return;const N=(0,g.S)(D.CONTAINER);N.className="custom-torrent-buttons";const z=`https://kinozal.tv/browse.php?s=${encodeURIComponent(h).replace(/%20/g,"+")}&g=0&c=0&v=0&d=0&w=0&t=1&f=0`,Z=`https://rutracker.org/forum/tracker.php?nm=${encodeURIComponent(h)}`,G=B("\u041A\u0438\u043D\u043E\u0437\u0430\u043B",z),o=B("\u0420\u0443\u0442\u0440\u0435\u043A\u0435\u0440",Z);N.appendChild(G),N.appendChild(o);const d=y.querySelector('div[class^="styles_title__"]');d&&(0,v.WH)(d,N)}function B(m,h){const y=F(D.BUTTON,m,h);return y.target="_blank",y.addEventListener("mouseenter",()=>{(0,A.ZM)(y,D.BUTTON_HOVER)}),y.addEventListener("mouseleave",()=>{(0,A.ZM)(y,D.BUTTON)}),y}function U(){}},128:(R,C,f)=>{f.d(C,{R:()=>xe});function D(t){if(!t)return[];const n=A(t).flat().filter(r=>r&&!r.isNegative&&r.term).map(r=>r.term);return[...new Set(n)]}function A(t){return t?t.toLowerCase().split(",").map(b).filter(Boolean):[]}function b(t){const e=t.split("/").map(r=>r.trim()).filter(Boolean);if(e.length===0)return null;const n=e.map(v).filter(Boolean);return n.length>0?n:null}function v(t){const e=t.startsWith("!"),n=e?t.slice(1).trim():t;return n?{term:n,isNegative:e}:null}function g(t,e){F(t,n=>n.style.display!=="none",e)}function a(t,e){F(t,n=>n.style.opacity==="",e)}function F(t,e,n){const r=[...t].filter(e).length,c=t.length;S(n,r,c)}function S(t,e,n){t.textContent=`\u041F\u043E\u043A\u0430\u0437\u0430\u043D\u043E: ${e} \u0438\u0437 ${n}`}function E(t,e){return!L(t,e)}function L(t,e){if(!e||!e.value)return!0;const n=A(e.value);return O(t,n)}function O(t,e){if(!e||!e.length)return!0;const n=(t||"").toLowerCase();return e.every(r=>I(n,r))}function I(t,e){return e.some(({term:n,isNegative:r})=>{const c=t.includes(n);return r?!c:c})}function w(t,e){return e.value!=null&&t<e.value}function _(t,e){return e.value!=null&&t>e.value}function u(t,e){return e.value==null?!1:t<parseDateFromISO(e.value)}function l(t,e){return e.value==null?!1:t>parseDateFromISO(e.value)}function i(t,e){return e.value&&t!==e.value}var s=f(5539),p=f(573),B=f(7273);function U(t,e={},n=null){const r=(0,B.S)(e,n);return r.append(t),r}function m(t,e=null,n={},r={}){const c=createActionLink(t,e,r);return U(c,n)}function h(t,e=null,n=null,r={},c={},k={}){const P=createActionLinkWithIcon(t,n,e,c,k);return U(P,r)}var y=f(5558),N=f(4921);function Y(t,e,n){const r=G(t,"text",e);return r.value=n,r}function z(t,e,n,r,c,k){const P=G(t,"number",e);return P.value=n,P.step=r,P.min=c,P.max=k,P}function re(t,e,n){const r=G(t,"date",e);return r.value=n,r}function Z(t,e,n){const r=G(t,"checkbox",e);return r.checked=n,r}function G(t={},e=null,n=null){const r=(0,y.n)("input",t);return e&&(r.type=e),n&&(r.addEventListener("keyup",(0,N.sg)(n,200)),r.addEventListener("change",(0,N.sg)(n,100))),r}function o(t,e,n){const r=createElement("select",t);return e&&r.addEventListener("change",e),r.value=n,r}function d(t,e,n={},r={}){const c=Y(r,e.updateValueFromEvent,e.value);return U(c,n,t)}function x(t,e,n,r,c,k={},P={}){const j=z(P,e.updateValueFromEvent,e.value,n,r,c);return U(j,k,t)}function V(t,e,n={},r={}){const c=createSelect(r,e.updateValueFromEvent,e.value);return createControl(c,n,t)}function q(t,e,n={},r={}){const c=createDateInput(r,e.updateValueFromEvent,e.value);return createControl(c,n,t)}function M(t,e,n={},r={}){const c=Z(r,e.updateValueFromEvent,e.value);return U(c,n,t)}function oe(t,e={},n={}){return createTextFilterControl("\u041F\u043E\u0438\u0441\u043A: ",t,e,n)}function Be(t,e={},n={},r=.1,c=3){return createNumberFilterControl("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",t,r,c,5,e,n)}function Pe(t,e={},n={},r=.1,c=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",t,r,c,5,e,n)}function Ue(t,e={},n={}){return ie("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",t,e,n)}function Me(t,e={},n={}){return ie("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",t,e,n)}function ie(t,e,n={},r={}){return createNumberFilterControl(t,e,"1","1","999999",n,r)}function We(t,e={},n={}){return createDateFilterControl("\u041C\u0438\u043D. \u0434\u0430\u0442\u0430: ",t,e,n)}function Ve(t,e={},n={}){return fe("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",t,e,n)}function fe(t,e,n={},r={}){return createNumberFilterControl(t,e,"5","0","100",n,r)}function $e(t,e={},n={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",t,"5","0","100",e,n)}function le(t,e,n={},r={},c="250"){return createNumberFilterControl(t,e,c,"0","1000000",n,r)}function ze(t,e={},n={},r="25"){return le("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",t,e,n,r)}function Ge(t,e={},n={},r="25"){return le("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",t,e,n,r)}function je(t,e={},n={}){return de("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",t,e,n)}function de(t,e,n={},r={}){return createNumberFilterControl(t,e,"1","0","99999",n,r)}function Ke(t,e={},n={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",t,"1","2","8",e,n)}function He(t,e={},n={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",t,1,1,10,e,n)}function Qe(t,e={},n={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",t,e,n)}function Xe(t,e={},n={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",t,e,n)}function Ye(t,e={},n={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",t,e,n)}function Ze(t,e={},n={}){return createCheckboxFilterControl("\u0411\u043E\u043D\u0443\u0441: ",t,e,n)}function Je(t,e={},n={}){return createCheckboxFilterControl("\u0412 \u043D\u0430\u043B\u0438\u0447\u0438\u0438: ",t,e,n)}function me(t,e={},n={}){return M("\u0412\u043A\u043B: ",t,e,n)}function qe(t,e,n={}){const r=[{value:-25,emoji:"\u{1F48E}",tooltip:"\u0421\u0443\u043F\u0435\u0440 \u0446\u0435\u043D\u0430 (-25%)"},{value:-15,emoji:"\u{1F525}",tooltip:"\u041E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-15%)"},{value:-5,emoji:"\u{1F31F}",tooltip:"\u041A\u043B\u0430\u0441\u0441\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-5%)"},{value:5,emoji:"\u{1F44C}",tooltip:"\u0425\u043E\u0440\u043E\u0448\u0430\u044F \u0446\u0435\u043D\u0430 (+5%)"}],c={active:{background:"#e3f2fd",borderColor:"#2196f3",boxShadow:"0 0 0 1px #2196f3"},inactive:{background:"#fff",borderColor:"#ccc",boxShadow:"none"},hover:{background:"#f5f5f5"}},k=createDiv({display:"inline-flex",gap:"4px",marginLeft:"4px"}),P=[],j=()=>e?parseFloat(e.value)||0:t.value,K=()=>{const H=j();P.forEach(({button:te,value:ne})=>{const J=ne<=H?c.active:c.inactive;Object.assign(te.style,J)})};return r.forEach(({value:H,emoji:te,tooltip:ne})=>{const $=createButton({padding:"2px 6px",fontSize:"16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"#fff",transition:"all 0.2s",...n},te);$.title=ne,$.type="button",$.addEventListener("click",J=>{J.preventDefault(),t.updateValue(H),e&&(e.value=H),K()}),$.addEventListener("mouseenter",()=>{H<=j()||($.style.background=c.hover.background)}),$.addEventListener("mouseleave",()=>{K()}),P.push({button:$,value:H}),k.appendChild($)}),K(),e&&(e.addEventListener("input",K),e.addEventListener("change",K)),k}const Q={MOVIES_LIST:"#results",MOVIE_CARD:"#itemList > .item",MY_VOTE_WRAP:".myVote",GENRE_WRAP:".gray_text",KP_REVIEWS_WRAP:".numVote > span > span",IMDB_REVIEWS_WRAP:".imdb > span",NAME_WRAP:".name",LENGTH_WRAP:"nobr"},se={INPUT:{marginLeft:"6px",padding:"4px 8px",fontSize:"12px"}},W={FILTERS_CONTAINER:{display:"flex",gridGap:"12px",marginTop:"10px",flexFlow:"wrap"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...se.INPUT,width:"120px"},NUMBER_INPUT:{...se.INPUT,width:"65px"},CHECKBOX_INPUT:{marginLeft:"6px",width:"17px",height:"17px"}};class pe{constructor(e,n){this.value=e,this.onChange=n}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}function he(t){const{target:e}=t,{type:n}=e;switch(n){case"text":return`"${e.value}"`;case"number":return e.value;case"select-one":return e.value;case"date":return`"${e.value}"`;case"checkbox":return e.checked;default:return console.log(`Unknown input type: ${n}`),null}}function ve(t){return t===""?null:JSON.parse(t)}const Ee=window.GM_setValue,et=window.GM.setValue,be=window.GM_getValue;class ee extends pe{constructor(e,n=null,r=null){super(be(e,n),r),this.storageKey=e,this.defaultValue=n}static create(e,n=null,r=null){return new ee(e,n,r)}static createWithCompositeKey(e,n,r=null,c=null){const k=`${e}-${n}`;return new ee(k,r,c)}updateValueFromEvent=e=>{const n=he(e),r=ve(n);this.updateValue(r)};updateValue(e,n=!0){this.value!==e&&(Ee(this.storageKey,e),this.value=e,n&&this.onChangeIfDefined())}clearValue(e=!1){this.updateValue(null,e)}resetValue(e=!1){this.updateValue(this.defaultValue,e)}}function ge(t,e=null){return{createGlobalFilter(n,r=null,c=t){return ee.create(n,r,c)},createSectionFilter(n,r=null,c=t){if(!e)throw new Error("sectionId must be provided to use createSectionFilter.");return ee.createWithCompositeKey(e,n,r,c)}}}function ye(t,e,n=!1,r="customFiltersContainer"){let c=(0,p.Fi)(`#${r}`,t);if(c)if(n)c.remove();else return;c=(0,B.S)(),c.id=r,e(c,t)}function Ce(t={}){return(0,B.S)(t,"|")}function Fe(t,e={},n="customFiltersContainer"){const r=document.getElementById(n);if(!r)return console.log(`Element with id="${n}" not found.`),null;const c=createButton(e,`${arrowUpIcon}\u041A \u0444\u0438\u043B\u044C\u0442\u0440\u0430\u043C`);return c.addEventListener("mouseenter",()=>{c.style.filter="brightness(0.9)"}),c.addEventListener("mouseleave",()=>{c.style.filter="brightness(1)"}),c.addEventListener("click",()=>{const k=r.getBoundingClientRect();window.scrollTo({top:k.top+window.scrollY-t,behavior:"smooth"})}),new IntersectionObserver(([k])=>{const P=k.boundingClientRect.top<0,j=!k.isIntersecting&&P;c.style.display=j?"flex":"none"},{threshold:.5}).observe(r),c}function tt(t,e={},n=75){const r=Fe(n,e);r&&t.appendChild(r)}var we=f(6754);const T={moviesObserver:null,isFiltersInitialized:!1,filters:{nameFilter:null,genreFilter:null,maxLengthFilter:null,minKpReviewsFilter:null,minImdbReviewsFilter:null,isFinishedFilter:null,filterEnabled:null}};function xe(t){t&&Oe(),Ne(),Te()}function Ne(){if(!T.isFiltersInitialized){const{createGlobalFilter:t}=ge(ce);T.filters.nameFilter=t("navigator-name-filter"),T.filters.genreFilter=t("navigator-genre-filter"),T.filters.maxLengthFilter=t("navigator-max-length-filter"),T.filters.minKpReviewsFilter=t("navigator-min-kp-reviews-filter"),T.filters.minImdbReviewsFilter=t("navigator-min-imdb-reviews-filter"),T.filters.isFinishedFilter=t("navigator-is-finished-filter",!0),T.filters.filterEnabled=t("navigator-filter-enabled",!0),T.isFiltersInitialized=!0}}function Te(){const t=(0,p.Fi)(Q.MOVIES_LIST);t&&(T.moviesObserver&&(0,N.wP)(T.moviesObserver),T.moviesObserver=new MutationObserver(()=>Se(t)),T.moviesObserver.observe(t,{childList:!0,subtree:!0}))}function Se(t){const e=(0,p.Fi)("tr > td",t);ye(e,Le),ce()}function Le(t,e){(0,we.ZM)(t,W.FILTERS_CONTAINER);const n=d("\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435:",T.filters.nameFilter,W.CONTROL,W.TEXT_INPUT),r=d("\u0416\u0430\u043D\u0440:",T.filters.genreFilter,W.CONTROL,W.TEXT_INPUT),c=x("\u041C\u0430\u043A\u0441. \u043C\u0438\u043D\u0443\u0442:",T.filters.maxLengthFilter,"10","0","500",W.CONTROL,W.NUMBER_INPUT),k=x("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432 \u041A\u041F:",T.filters.minKpReviewsFilter,"100","0","1000000",W.CONTROL,W.NUMBER_INPUT),P=x("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432 IMDB:",T.filters.minImdbReviewsFilter,"100","0","1000000",W.CONTROL,W.NUMBER_INPUT),j=M("\u0417\u0430\u0432\u0435\u0440\u0448\u0451\u043D: ",T.filters.isFinishedFilter,W.CONTROL,W.CHECKBOX_INPUT),K=Ce(W.CONTROL),H=me(T.filters.filterEnabled,W.CONTROL,W.CHECKBOX_INPUT);t.append(n,r,c,k,P,j,K,H),e.append(t)}function ce(){(0,p.fI)(Q.MOVIE_CARD).forEach(Re)}function Re(t){if(!T.filters.filterEnabled.value){(0,s.kl)(t);return}const e=(0,p.Fi)(Q.NAME_WRAP,t),n=(0,p.Fi)(Q.MY_VOTE_WRAP,t),r=(0,p.Fi)(Q.GENRE_WRAP,t),c=(0,p.Fi)(Q.LENGTH_WRAP,e),k=(0,p.Fi)(Q.KP_REVIEWS_WRAP,t),P=(0,p.Fi)(Q.IMDB_REVIEWS_WRAP,t);if([e,n,r,c,k,P].some(Ae=>!Ae)){(0,s.Bt)(t);return}if(n.innerText){(0,s.Bt)(t);return}const K=(0,p.Fi)("a",e)?.innerText??"",te=!((0,p.Fi)("span",e)?.innerText??"").includes("..."),ne=Ie(r),$=(0,p.YA)(c,!0),J=(0,p.YA)(k,!0),De=(0,p.YA)(P,!0),_e=E(K,T.filters.nameFilter)||E(ne,T.filters.genreFilter)||_($,T.filters.maxLengthFilter)||w(J,T.filters.minKpReviewsFilter)||w(De,T.filters.minImdbReviewsFilter)||i(te,T.filters.isFinishedFilter);(0,s.UC)(t,_e)}function Ie(t){return Array.from(t.childNodes).filter(r=>r.nodeType===Node.TEXT_NODE).pop()?.textContent.trim()||""}function Oe(){T.isFiltersInitialized=!1,T.filters={nameFilter:null,genreFilter:null,maxLengthFilter:null,minKpReviewsFilter:null,minImdbReviewsFilter:null,isFinishedFilter:null,filterEnabled:null},(0,N.wP)(T.moviesObserver)}}},ue={};function X(R){var C=ue[R];if(C!==void 0)return C.exports;var f=ue[R]={exports:{}};return ae[R](f,f.exports,X),f.exports}(()=>{var R=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",C=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",f=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",D=b=>{b&&b.d<1&&(b.d=1,b.forEach(v=>v.r--),b.forEach(v=>v.r--?v.r++:v()))},A=b=>b.map(v=>{if(v!==null&&typeof v=="object"){if(v[R])return v;if(v.then){var g=[];g.d=0,v.then(S=>{a[C]=S,D(g)},S=>{a[f]=S,D(g)});var a={};return a[R]=S=>S(g),a}}var F={};return F[R]=S=>{},F[C]=v,F});X.a=(b,v,g)=>{var a;g&&((a=[]).d=-1);var F=new Set,S=b.exports,E,L,O,I=new Promise((w,_)=>{O=_,L=w});I[C]=S,I[R]=w=>(a&&w(a),F.forEach(w),I.catch(_=>{})),b.exports=I,v(w=>{E=A(w);var _,u=()=>E.map(i=>{if(i[f])throw i[f];return i[C]}),l=new Promise(i=>{_=()=>i(u),_.r=0;var s=p=>p!==a&&!F.has(p)&&(F.add(p),p&&!p.d&&(_.r++,p.push(_)));E.map(p=>p[R](s))});return _.r?l:u()},w=>(w?O(I[f]=w):L(S),D(a))),a&&a.d<0&&(a.d=0)}})(),X.d=(R,C)=>{for(var f in C)X.o(C,f)&&!X.o(R,f)&&Object.defineProperty(R,f,{enumerable:!0,get:C[f]})},X.o=(R,C)=>Object.prototype.hasOwnProperty.call(R,C);var ke=X(6275)})();})();
