// ==UserScript==
// @name         Kinopoisk navigator filter
// @description  Hide movies by filter
// @grant        GM_addStyle
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.kinopoisk.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.76963183
// @icon         https://www.google.com/s2/favicons?sz=64&domain=kinopoisk.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/kinop.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var ce={7273:(I,F,s)=>{s.d(F,{S:()=>E});var R=s(5558);function _(p={},b=null){return createElement("span",p,b)}function E(p={},b=null){return(0,R.n)("div",p,b)}},5558:(I,F,s)=>{s.d(F,{n:()=>_});var R=s(6754);function _(E,p,b=null){if(typeof p!="object"||p===null)throw new TypeError("styles should be an object");const l=document.createElement(E);return(0,R.ZM)(l,p),b&&(l.innerHTML=b),l}},573:(I,F,s)=>{s.d(F,{Fi:()=>E,YA:()=>S,fI:()=>p,s$:()=>b});var R=s(4214);function _(u,c=document){return!!c.querySelector(u)}function E(u,c=document,i=!1){const f=c.querySelector(u);return i&&!f&&console.log(`No element found for selector: ${u}`),f}function p(u,c=document,i=!1){const f=c.querySelectorAll(u);return i&&!f.length&&console.log(`No elements found for selector: ${u}`),f}function b(u,c=1){let i=u;for(let f=0;f<c;f++){if(!i.parentElement)return null;i=i.parentElement}return i}function l(u,c,i){return[...u.querySelectorAll(c)].find(f=>f.textContent.trim().includes(i))}function y(u,c,i=!1,f=!1,O=null){const h=E(c,u);return S(h,i,f,O)}function S(u,c=!1,i=!1,f=null){if(!u)return f===null?(console.log("No element found"),null):f;const O=u.innerText;return D(O,c,i)}function v(u,c,i=!1){const f=u[c];return S(f,i)}function L(u,c=!1,i=!1){const f=u.textContent;return D(f,c,i)}function D(u,c,i){c&&(u=(0,R.zr)(u)),i&&(u=u.replace(",","."));const f=Number(u);return Number.isNaN(f)?(console.log(`Invalid number: ${u}`),0):f}function N(u){return[...u.childNodes].find(c=>c.nodeType===Node.TEXT_NODE)}function w(u){const c=i=>i.nodeType===Node.TEXT_NODE&&i.textContent.trim()!==""?[i]:[...i.childNodes].flatMap(c);return c(u)}function d(u){return normalizeSpacing(u.textContent)}},5539:(I,F,s)=>{s.d(F,{Bt:()=>E,UC:()=>L,UE:()=>b,WH:()=>_,kl:()=>S});var R=s(573);function _(o,m){o.parentNode.insertBefore(m,o.nextSibling)}function E(o){o.style.display="none"}function p(o,m=1){const x=document.querySelector(o);x&&b(x,m)}function b(o,m=1){const x=(0,R.s$)(o,m);x&&E(x)}function l(o){w(o),E(o)}function y(o){o.intersectionObserver||runOnceOnIntersection(o,()=>E(o))}function S(o){o.style.display=""}function v(o){const m=N(o);o.style.display=m}function L(o,m){m?E(o):S(o)}function D(o,m){m?y(o):(clearIntersectionObserver(o),S(o))}function N(o){return w(o),o.defaultDisplay}function w(o){if(o.defaultDisplay)return;const{display:m}=getComputedStyle(o);o.defaultDisplay=m}function d(){return{show:[],hide:[]}}function u(o,m,x){o?m.hide.push(x):m.show.push(x)}function c(o){o.show.forEach(S),o.hide.forEach(E)}function i(o,m,x=.3){m?O(o,x):f(o)}function f(o){o.style.opacity=""}function O(o,m=.3){o.style.opacity=m}function h(o){o.style.order=""}function C(o,m){o.style.order=m}function g(o,m){o.style.background=m}function k(o,m){const x=getFirstElement(m);x&&U(o,x)}function U(o,m){const x=createLink();x.href=o,m.parentNode.append(x),x.append(m)}function V(o,m){const x=getFirstElement(m);x&&H(o,x)}function H(o,m,x={}){const $=createLink(x);$.href=o,$.append(...m.childNodes),m.append($)}function Y(){const o=getURLQueryParam("scrollTo");if(!o)return;const m=document.getElementById(o);m?m.scrollIntoView():console.log(`Element with ID "${o}" was not found.`)}function ne(o,m,x=null){const $=`${m}-click-passed`,J=x?P=>findElementByText(P,o,x):P=>getFirstElement(o,P);return function(P){if(P.hasAttribute($))return!1;const re=J(P);return re&&re.click(),P.setAttribute($,""),!0}}function Q(o,m,x="text/plain"){const $=new Blob([o],{type:x}),J=URL.createObjectURL($),P=document.createElement("a");P.href=J,P.download=m,document.body.appendChild(P),P.click(),document.body.removeChild(P),requestAnimationFrame(()=>URL.revokeObjectURL(J))}},6754:(I,F,s)=>{s.d(F,{ZM:()=>R});function R(b,l){Object.assign(b.style,l)}function _(b,l="custom-global-style"){let y=document.getElementById(l);y||(y=document.createElement("style"),y.id=l,y.type="text/css",document.head.appendChild(y)),y.textContent=b}function E(b){return Object.entries(b).map(([l,y])=>`${l.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${y};`).join(" ")}function p(b){return b?b.split(";").filter(l=>l.trim()!=="").reduce((l,y)=>{const[S,v]=y.split(":").map(D=>D.trim()),L=S.replace(/-([a-z])/g,(D,N)=>N.toUpperCase());return l[L]=v,l},{}):{}}},4921:(I,F,s)=>{s.d(F,{XW:()=>E,sg:()=>p,wP:()=>S});function R(v,L,D=null){const N=v.querySelector(L);return N?Promise.resolve(N):new Promise(w=>{const d=new MutationObserver(c);d.observe(v,{childList:!0,subtree:!0});let u;D&&(u=setTimeout(()=>{d.disconnect(),console.log(`No element found for selector: ${L}`),w(null)},D));function c(){const i=v.querySelector(L);i&&(u&&clearTimeout(u),d.disconnect(),w(i))}})}function _(v,L){return v.querySelector(L)?new Promise(N=>{const w=new MutationObserver(d);w.observe(v,{childList:!0,subtree:!0});function d(){v.querySelector(L)||(w.disconnect(),N())}}):Promise.resolve()}function E(v,L=400){return new Promise(D=>{let N;const w=new MutationObserver(()=>{clearTimeout(N),d()});function d(){N=setTimeout(()=>{w.disconnect(),D()},L)}d(),w.observe(v,{childList:!0,subtree:!0})})}function p(v,L=250){let D;return function(...N){const w=this;clearTimeout(D),D=setTimeout(()=>v.apply(w,N),L)}}async function b(v){document.visibilityState==="visible"?await v():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await v()},{once:!0})}function l(v,L){const D=new IntersectionObserver(N=>{N.forEach(w=>{w.isIntersecting&&(L(),y(v))})});v.intersectionObserver=D,D.observe(v)}function y(v){v.intersectionObserver&&(v.intersectionObserver.disconnect(),v.intersectionObserver=null)}function S(v){v&&(v.disconnect(),v=null)}},4214:(I,F,s)=>{s.d(F,{zr:()=>_});function R(l){return l.replace(/\D/g,"")}function _(l){return l.replace(/[^\d.,-]/g,"")}function E(l){return l.replace(/\s/g,"")}function p(l){return l.charAt(0).toUpperCase()+l.slice(1)}function b(l){return l.replace(/\s+/g," ").trim()}},5406:(I,F,s)=>{s.d(F,{k1:()=>N,z2:()=>L});function R(d,u="common",c=!1){const{pathname:i}=window.location;return _(i,d,u,c)}function _(d,u,c,i=!1){const f=d.split("/");u=u<0?f.length+u:u;const O=f[u]||c;return i&&console.log(`Pathname element: ${O}`),O}function E(d,u="common",c=!1){const i=R(d,"",c);return p(i,u,c)}function p(d,u,c){if(!d)return u;const i=d.split("-").at(-1);return c&&console.log(`Pathname element ending: ${i}`),i}function b(d,u,c="common",i=!1){const f=_(d,u,"",i);return p(f,c,i)}function l(d){return new URLSearchParams(window.location.search).get(d)}function y(d){return d.split("?")[0]}function S(d){return window.location.pathname.includes(d)}function v(d){return d.some(u=>S(u))}function L(...d){return window.location.pathname.split("/").some(c=>d.includes(c))}function D(d){try{const u=new URL(window.location.href);Object.entries(d).forEach(([c,i])=>{u.searchParams.set(c,i)}),window.location.href=u.toString()}catch(u){console.error("Failed to redirect:",u)}}function N(d,u=[]){const c={pathname:window.location.pathname};u.forEach(C=>{c[C]=l(C)});let i=!1;async function f(){if(i)return;const C={pathname:window.location.pathname};if(u.forEach(g=>{C[g]=l(g)}),Object.keys(c).some(g=>c[g]!==C[g])){Object.assign(c,C),i=!0;try{await d()}catch(g){console.error("Error in URL observer callback:",g)}finally{i=!1}}}function O(){f().catch(C=>{console.error("Error in URL change handler:",C)})}let h=window.location.href;setInterval(()=>{window.location.href!==h&&(h=window.location.href,O())},200),window.addEventListener("popstate",O)}function w(d=[]){N(()=>window.location.reload(),d)}},6275:(I,F,s)=>{s.a(I,async(R,_)=>{try{var E=s(5406),p=s(128),b=s(9397);await l(),(0,E.k1)(async()=>{await l(!0)});async function l(y=!1){(0,E.z2)("navigator")?(0,p.R)(y):(0,E.z2)("film","series")&&await(0,b.g)(y)}_()}catch(l){_(l)}},1)},9397:(I,F,s)=>{s.d(F,{g:()=>N});const R={CONTAINER:{margin:"12px 0 -5px",display:"flex",gap:"8px",alignItems:"center"},BUTTON:{display:"inline-flex",alignItems:"center",padding:"6px 12px",background:"#1a1a1a",border:"1px solid #404040",borderRadius:"6px",color:"#e0e0e0",textDecoration:"none",fontSize:"13px",fontWeight:"500",transition:"all 0.2s ease",cursor:"pointer",transform:"scale(1)"},BUTTON_HOVER:{background:"#2a2a2a",borderColor:"#606060",transform:"scale(1.05)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"}};var _=s(6754),E=s(4921),p=s(5539),b=s(7273),l=s(5558);function y(h={},C=null,g=null){const k=(0,l.n)("a",h,C);return g&&(k.href=g),k}function S(h,C=null,g={}){g.cursor||="pointer";const k=y(g,C);return h&&k.addEventListener("click",h),k}function v(h,C,g=null,k={},U={}){k.display||="inline-flex",k.alignItems||="center",k.gap||="0.25em";const V=S(h,g,k);return V.prepend(createLucideIcon(C,U)),V}function L(h,C,g={},k={}){const U=Y=>{Y.stopPropagation(),Y.preventDefault(),window.confirm("\u0412\u044B\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u043D\u0438\u0437\u043A\u0438\u0439 \u0440\u0435\u0439\u0442\u0438\u043D\u0433?")&&h()},V=C?"<span>\u0414\u0438\u0437\u043B\u0430\u0439\u043A</span>":null,H=v(U,ThumbsDown,V,g,k);return H.classList.add("userscript-control"),H}function D(h={},C=null,g=null){const k=createElement("button",h,C);return g&&k.addEventListener("click",g),k}async function N(h){await(0,E.XW)(document.body),h&&void 0,w(),i()}function w(){window.GM_addStyle(`
        [class*="styles_socialArgument__"],
        div[class*="styles_header__"] div[class*="styles_topText__"] p {
            display: none !important;
        }
    `),d("film-media-posts"),d("today-in-cinema-block"),u(),document.querySelector('div[class^="styles_videoWrapper__"]')?.remove(),document.querySelector("div.ReactModalPortal")?.remove(),c()}function d(h){const C=document.querySelector(`span#${h}`);if(!C)return;(0,p.Bt)(C);const g=C.nextElementSibling;g?.tagName==="DIV"&&(0,p.Bt)(g)}function u(){const h=document.querySelector('p[class^="style_offerName___"]');h&&(0,p.UE)(h,4)}function c(){const h=document.querySelector('div[class^="styles_watchOnlineBlock__"]');if(!h)return;const C=h.querySelector('button[class*="styles_watchOnlineButton__"]');C&&C.innerText.trim().toLowerCase().includes("\u043F\u043E\u0434\u043A\u043B\u044E\u0447\u0438\u0442\u044C")&&h.remove()}function i(){const h=document.querySelector('h1[class^="styles_title__"] > span');if(!h)return;const C=h.textContent.trim(),g=document.querySelector('div[class^="styles_header__"]');if(!g||document.querySelector(".custom-torrent-buttons"))return;const k=(0,b.S)(R.CONTAINER);k.className="custom-torrent-buttons";const V=`https://kinozal.tv/browse.php?s=${encodeURIComponent(C).replace(/%20/g,"+")}&g=0&c=0&v=0&d=0&w=0&t=1&f=0`,Y=`https://rutracker.org/forum/tracker.php?nm=${encodeURIComponent(C)}`,ne=f("\u041A\u0438\u043D\u043E\u0437\u0430\u043B",V),Q=f("\u0420\u0443\u0442\u0440\u0435\u043A\u0435\u0440",Y);k.appendChild(ne),k.appendChild(Q);const o=g.querySelector('div[class^="styles_title__"]');o&&(0,p.WH)(o,k)}function f(h,C){const g=y(R.BUTTON,h,C);return g.target="_blank",g.addEventListener("mouseenter",()=>{(0,_.ZM)(g,R.BUTTON_HOVER)}),g.addEventListener("mouseleave",()=>{(0,_.ZM)(g,R.BUTTON)}),g}function O(){}},128:(I,F,s)=>{s.d(F,{R:()=>we});function R(t){if(!t)return[];const n=_(t).flat().filter(r=>r&&!r.isNegative&&r.term).map(r=>r.term);return[...new Set(n)]}function _(t){return t?t.toLowerCase().split(",").map(E).filter(Boolean):[]}function E(t){const e=t.split("/").map(r=>r.trim()).filter(Boolean);if(e.length===0)return null;const n=e.map(p).filter(Boolean);return n.length>0?n:null}function p(t){const e=t.startsWith("!"),n=e?t.slice(1).trim():t;return n?{term:n,isNegative:e}:null}function b(t,e){y(t,n=>n.style.display!=="none",e)}function l(t,e){y(t,n=>n.style.opacity==="",e)}function y(t,e,n){const r=[...t].filter(e).length;n.textContent=`\u041F\u043E\u043A\u0430\u0437\u0430\u043D\u043E: ${r} \u0438\u0437 ${t.length}`}function S(t,e){return!v(t,e)}function v(t,e){if(!e||!e.value)return!0;const n=_(e.value);return L(t,n)}function L(t,e){if(!e||!e.length)return!0;const n=(t||"").toLowerCase();return e.every(r=>D(n,r))}function D(t,e){return e.some(({term:n,isNegative:r})=>{const a=t.includes(n);return r?!a:a})}function N(t,e){return e.value!=null&&t<e.value}function w(t,e){return e.value!=null&&t>e.value}function d(t,e){return e.value==null?!1:t<parseDateFromISO(e.value)}function u(t,e){return e.value==null?!1:t>parseDateFromISO(e.value)}function c(t,e){return e.value&&t!==e.value}var i=s(5539),f=s(573),O=s(7273);function h(t,e={},n=null){const r=(0,O.S)(e,n);return r.append(t),r}function C(t,e=null,n={},r={}){const a=createActionLink(t,e,r);return h(a,n)}function g(t,e=null,n=null,r={},a={},A={}){const B=createActionLinkWithIcon(t,n,e,a,A);return h(B,r)}var k=s(5558),U=s(4921);function V(t,e,n){const r=Q(t,"text",e);return r.value=n,r}function H(t,e,n,r,a,A){const B=Q(t,"number",e);return B.value=n,B.step=r,B.min=a,B.max=A,B}function Y(t,e,n){const r=Q(t,"date",e);return r.value=n,r}function ne(t,e,n){const r=Q(t,"checkbox",e);return r.checked=n,r}function Q(t={},e=null,n=null){const r=(0,k.n)("input",t);return e&&(r.type=e),n&&(r.addEventListener("keyup",(0,U.sg)(n,200)),r.addEventListener("change",(0,U.sg)(n,100))),r}function o(t,e,n){const r=createElement("select",t);return e&&r.addEventListener("change",e),r.value=n,r}function m(t,e,n={},r={}){const a=V(r,e.updateValueFromEvent,e.value);return h(a,n,t)}function x(t,e,n,r,a,A={},B={}){const X=H(B,e.updateValueFromEvent,e.value,n,r,a);return h(X,A,t)}function $(t,e,n={},r={}){const a=createSelect(r,e.updateValueFromEvent,e.value);return createControl(a,n,t)}function J(t,e,n={},r={}){const a=createDateInput(r,e.updateValueFromEvent,e.value);return createControl(a,n,t)}function P(t,e,n={},r={}){const a=ne(r,e.updateValueFromEvent,e.value);return h(a,n,t)}function re(t,e={},n={}){return createTextFilterControl("\u041F\u043E\u0438\u0441\u043A: ",t,e,n)}function Ae(t,e={},n={},r=.1,a=3){return createNumberFilterControl("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",t,r,a,5,e,n)}function Be(t,e={},n={},r=.1,a=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",t,r,a,5,e,n)}function Pe(t,e={},n={}){return ue("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",t,e,n)}function Me(t,e={},n={}){return ue("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",t,e,n)}function ue(t,e,n={},r={}){return createNumberFilterControl(t,e,"1","1","999999",n,r)}function Ue(t,e={},n={}){return createDateFilterControl("\u041C\u0438\u043D. \u0434\u0430\u0442\u0430: ",t,e,n)}function We(t,e={},n={}){return ae("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",t,e,n)}function ae(t,e,n={},r={}){return createNumberFilterControl(t,e,"5","0","100",n,r)}function Ve(t,e={},n={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",t,"5","0","100",e,n)}function ie(t,e,n={},r={},a="250"){return createNumberFilterControl(t,e,a,"0","1000000",n,r)}function $e(t,e={},n={},r="25"){return ie("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",t,e,n,r)}function ze(t,e={},n={},r="25"){return ie("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",t,e,n,r)}function je(t,e={},n={}){return fe("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",t,e,n)}function fe(t,e,n={},r={}){return createNumberFilterControl(t,e,"1","0","99999",n,r)}function Ge(t,e={},n={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",t,"1","2","8",e,n)}function Ke(t,e={},n={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",t,1,1,10,e,n)}function He(t,e={},n={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",t,e,n)}function Qe(t,e={},n={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",t,e,n)}function Xe(t,e={},n={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",t,e,n)}function Ye(t,e={},n={}){return createCheckboxFilterControl("\u0411\u043E\u043D\u0443\u0441: ",t,e,n)}function Ze(t,e={},n={}){return createCheckboxFilterControl("\u0412 \u043D\u0430\u043B\u0438\u0447\u0438\u0438: ",t,e,n)}function de(t,e={},n={}){return P("\u0412\u043A\u043B: ",t,e,n)}function Je(t,e,n={}){const r=[{value:-25,emoji:"\u{1F48E}",tooltip:"\u0421\u0443\u043F\u0435\u0440 \u0446\u0435\u043D\u0430 (-25%)"},{value:-15,emoji:"\u{1F525}",tooltip:"\u041E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-15%)"},{value:-5,emoji:"\u{1F31F}",tooltip:"\u041A\u043B\u0430\u0441\u0441\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-5%)"},{value:5,emoji:"\u{1F44C}",tooltip:"\u0425\u043E\u0440\u043E\u0448\u0430\u044F \u0446\u0435\u043D\u0430 (+5%)"}],a={active:{background:"#e3f2fd",borderColor:"#2196f3",boxShadow:"0 0 0 1px #2196f3"},inactive:{background:"#fff",borderColor:"#ccc",boxShadow:"none"},hover:{background:"#f5f5f5"}},A=createDiv({display:"inline-flex",gap:"4px",marginLeft:"4px"}),B=[],X=()=>e?parseFloat(e.value)||0:t.value,z=()=>{const j=X();B.forEach(({button:ee,value:te})=>{const Z=te<=j?a.active:a.inactive;Object.assign(ee.style,Z)})};return r.forEach(({value:j,emoji:ee,tooltip:te})=>{const W=createButton({padding:"2px 6px",fontSize:"16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"#fff",transition:"all 0.2s",...n},ee);W.title=te,W.type="button",W.addEventListener("click",Z=>{Z.preventDefault(),t.updateValue(j),e&&(e.value=j),z()}),W.addEventListener("mouseenter",()=>{j<=X()||(W.style.background=a.hover.background)}),W.addEventListener("mouseleave",()=>{z()}),B.push({button:W,value:j}),A.appendChild(W)}),z(),e&&(e.addEventListener("input",z),e.addEventListener("change",z)),A}const G={MOVIES_LIST:"#results",MOVIE_CARD:"#itemList > .item",MY_VOTE_WRAP:".myVote",GENRE_WRAP:".gray_text",KP_REVIEWS_WRAP:".numVote > span > span",IMDB_REVIEWS_WRAP:".imdb > span",NAME_WRAP:".name",LENGTH_WRAP:"nobr"},le={INPUT:{marginLeft:"6px",padding:"4px 8px",fontSize:"12px"}},M={FILTERS_CONTAINER:{display:"flex",gridGap:"12px",marginTop:"10px",flexFlow:"wrap"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...le.INPUT,width:"120px"},NUMBER_INPUT:{...le.INPUT,width:"65px"},CHECKBOX_INPUT:{marginLeft:"6px",width:"17px",height:"17px"}};class me{constructor(e,n){this.value=e,this.onChange=n}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}function pe(t){const{target:e}=t,{type:n}=e;switch(n){case"text":return`"${e.value}"`;case"number":return e.value;case"select-one":return e.value;case"date":return`"${e.value}"`;case"checkbox":return e.checked;default:return console.log(`Unknown input type: ${n}`),null}}function ve(t){return t===""?null:JSON.parse(t)}const he=window.GM_setValue,qe=window.GM.setValue,Ee=window.GM_getValue;class q extends me{constructor(e,n=null,r=null){super(Ee(e,n),r),this.storageKey=e,this.defaultValue=n}static create(e,n=null,r=null){return new q(e,n,r)}static createWithCompositeKey(e,n,r=null,a=null){const A=`${e}-${n}`;return new q(A,r,a)}updateValueFromEvent=e=>{const n=pe(e),r=ve(n);this.updateValue(r)};updateValue(e,n=!0){this.value!==e&&(he(this.storageKey,e),this.value=e,n&&this.onChangeIfDefined())}clearValue(e=!1){this.updateValue(null,e)}resetValue(e=!1){this.updateValue(this.defaultValue,e)}}function be(t,e=null){return{createGlobalFilter(n,r=null,a=t){return q.create(n,r,a)},createSectionFilter(n,r=null,a=t){if(!e)throw new Error("sectionId must be provided to use createSectionFilter.");return q.createWithCompositeKey(e,n,r,a)}}}function ge(t,e,n=!1,r="customFiltersContainer"){let a=(0,f.Fi)(`#${r}`,t);if(a)if(n)a.remove();else return;a=(0,O.S)(),a.id=r,e(a,t)}function Fe(t={}){return(0,O.S)(t,"|")}function ye(t={},e=75,n="customFiltersContainer"){const r=document.getElementById(n);if(!r)return console.log(`Element with id="${n}" not found.`),null;const a=createButton(t,`${arrowUpIcon}\u041A \u0444\u0438\u043B\u044C\u0442\u0440\u0430\u043C`);return a.addEventListener("mouseenter",()=>{a.style.filter="brightness(0.9)"}),a.addEventListener("mouseleave",()=>{a.style.filter="brightness(1)"}),a.addEventListener("click",()=>{const A=r.getBoundingClientRect();window.scrollTo({top:A.top+window.scrollY-e})}),new IntersectionObserver(([A])=>{a.style.display=A.isIntersecting?"none":"flex"},{threshold:.5}).observe(r),a}function et(t,e={}){const n=ye(e);n&&t.appendChild(n)}var Ce=s(6754);const T={moviesObserver:null,isFiltersInitialized:!1,filters:{nameFilter:null,genreFilter:null,maxLengthFilter:null,minKpReviewsFilter:null,minImdbReviewsFilter:null,isFinishedFilter:null,filterEnabled:null}};function we(t){t&&Le(),xe(),Ne()}function xe(){if(!T.isFiltersInitialized){const{createGlobalFilter:t}=be(se);T.filters.nameFilter=t("navigator-name-filter"),T.filters.genreFilter=t("navigator-genre-filter"),T.filters.maxLengthFilter=t("navigator-max-length-filter"),T.filters.minKpReviewsFilter=t("navigator-min-kp-reviews-filter"),T.filters.minImdbReviewsFilter=t("navigator-min-imdb-reviews-filter"),T.filters.isFinishedFilter=t("navigator-is-finished-filter",!0),T.filters.filterEnabled=t("navigator-filter-enabled",!0),T.isFiltersInitialized=!0}}function Ne(){const t=(0,f.Fi)(G.MOVIES_LIST);t&&(T.moviesObserver&&(0,U.wP)(T.moviesObserver),T.moviesObserver=new MutationObserver(()=>Te(t)),T.moviesObserver.observe(t,{childList:!0,subtree:!0}))}function Te(t){const e=(0,f.Fi)("tr > td",t);ge(e,Se),se()}function Se(t,e){(0,Ce.ZM)(t,M.FILTERS_CONTAINER);const n=m("\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435:",T.filters.nameFilter,M.CONTROL,M.TEXT_INPUT),r=m("\u0416\u0430\u043D\u0440:",T.filters.genreFilter,M.CONTROL,M.TEXT_INPUT),a=x("\u041C\u0430\u043A\u0441. \u043C\u0438\u043D\u0443\u0442:",T.filters.maxLengthFilter,"10","0","500",M.CONTROL,M.NUMBER_INPUT),A=x("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432 \u041A\u041F:",T.filters.minKpReviewsFilter,"100","0","1000000",M.CONTROL,M.NUMBER_INPUT),B=x("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432 IMDB:",T.filters.minImdbReviewsFilter,"100","0","1000000",M.CONTROL,M.NUMBER_INPUT),X=P("\u0417\u0430\u0432\u0435\u0440\u0448\u0451\u043D: ",T.filters.isFinishedFilter,M.CONTROL,M.CHECKBOX_INPUT),z=Fe(M.CONTROL),j=de(T.filters.filterEnabled,M.CONTROL,M.CHECKBOX_INPUT);t.append(n,r,a,A,B,X,z,j),e.append(t)}function se(){(0,f.fI)(G.MOVIE_CARD).forEach(Ie)}function Ie(t){if(!T.filters.filterEnabled.value){(0,i.kl)(t);return}const e=(0,f.Fi)(G.NAME_WRAP,t),n=(0,f.Fi)(G.MY_VOTE_WRAP,t),r=(0,f.Fi)(G.GENRE_WRAP,t),a=(0,f.Fi)(G.LENGTH_WRAP,e),A=(0,f.Fi)(G.KP_REVIEWS_WRAP,t),B=(0,f.Fi)(G.IMDB_REVIEWS_WRAP,t);if([e,n,r,a,A,B].some(_e=>!_e)){(0,i.Bt)(t);return}if(n.innerText){(0,i.Bt)(t);return}const z=(0,f.Fi)("a",e)?.innerText??"",ee=!((0,f.Fi)("span",e)?.innerText??"").includes("..."),te=Oe(r),W=(0,f.YA)(a,!0),Z=(0,f.YA)(A,!0),De=(0,f.YA)(B,!0),Re=S(z,T.filters.nameFilter)||S(te,T.filters.genreFilter)||w(W,T.filters.maxLengthFilter)||N(Z,T.filters.minKpReviewsFilter)||N(De,T.filters.minImdbReviewsFilter)||c(ee,T.filters.isFinishedFilter);(0,i.UC)(t,Re)}function Oe(t){return Array.from(t.childNodes).filter(r=>r.nodeType===Node.TEXT_NODE).pop()?.textContent.trim()||""}function Le(){T.isFiltersInitialized=!1,T.filters={nameFilter:null,genreFilter:null,maxLengthFilter:null,minKpReviewsFilter:null,minImdbReviewsFilter:null,isFinishedFilter:null,filterEnabled:null},(0,U.wP)(T.moviesObserver)}}},oe={};function K(I){var F=oe[I];if(F!==void 0)return F.exports;var s=oe[I]={exports:{}};return ce[I](s,s.exports,K),s.exports}(()=>{var I=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",F=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",s=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",R=E=>{E&&E.d<1&&(E.d=1,E.forEach(p=>p.r--),E.forEach(p=>p.r--?p.r++:p()))},_=E=>E.map(p=>{if(p!==null&&typeof p=="object"){if(p[I])return p;if(p.then){var b=[];b.d=0,p.then(S=>{l[F]=S,R(b)},S=>{l[s]=S,R(b)});var l={};return l[I]=S=>S(b),l}}var y={};return y[I]=S=>{},y[F]=p,y});K.a=(E,p,b)=>{var l;b&&((l=[]).d=-1);var y=new Set,S=E.exports,v,L,D,N=new Promise((w,d)=>{D=d,L=w});N[F]=S,N[I]=w=>(l&&w(l),y.forEach(w),N.catch(d=>{})),E.exports=N,p(w=>{v=_(w);var d,u=()=>v.map(i=>{if(i[s])throw i[s];return i[F]}),c=new Promise(i=>{d=()=>i(u),d.r=0;var f=O=>O!==l&&!y.has(O)&&(y.add(O),O&&!O.d&&(d.r++,O.push(d)));v.map(O=>O[I](f))});return d.r?c:u()},w=>(w?D(N[s]=w):L(S),R(l))),l&&l.d<0&&(l.d=0)}})(),K.d=(I,F)=>{for(var s in F)K.o(F,s)&&!K.o(I,s)&&Object.defineProperty(I,s,{enumerable:!0,get:F[s]})},K.o=(I,F)=>Object.prototype.hasOwnProperty.call(I,F);var ke=K(6275)})();})();
