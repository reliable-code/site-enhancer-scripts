// ==UserScript==
// @name         MegaMarket product cards & offers filter
// @description  Hide product cards & offers by filter
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://megamarket.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.77116688
// @icon         https://www.google.com/s2/favicons?sz=64&domain=megamarket.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/mgmkt.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var z={7273:(A,m,e)=>{e.d(m,{S:()=>E});var d=e(5558);function l(f={},p=null){return createElement("span",f,p)}function E(f={},p=null){return(0,d.n)("div",f,p)}},5467:(A,m,e)=>{e.d(m,{E2:()=>l});var d=e(7273);function l(p,i={},s=null){const a=(0,d.S)(i,s);return a.append(p),a}function E(p,i=null,s={},a={}){const t=createActionLink(p,i,a);return l(t,s)}function f(p,i=null,s=null,a={},t={},c={}){const o=createActionLinkWithIcon(p,s,i,t,c);return l(o,a)}},5558:(A,m,e)=>{e.d(m,{n:()=>l});var d=e(6754);function l(E,f,p=null){if(typeof f!="object"||f===null)throw new TypeError("styles should be an object");const i=document.createElement(E);return(0,d.ZM)(i,f),p&&(i.innerHTML=p),i}},740:(A,m,e)=>{e.d(m,{S:()=>i,kU:()=>E,o5:()=>f});var d=e(5558),l=e(4921);function E(t,c,o){const n=s(t,"text",c);return n.value=o,n}function f(t,c,o,n,v,R){const u=s(t,"number",c);return u.value=o,u.step=n,u.min=v,u.max=R,u}function p(t,c,o){const n=s(t,"date",c);return n.value=o,n}function i(t,c,o){const n=s(t,"checkbox",c);return n.checked=o,n}function s(t={},c=null,o=null){const n=(0,d.n)("input",t);return c&&(n.type=c),o&&(n.addEventListener("keyup",(0,l.sg)(o,200)),n.addEventListener("change",(0,l.sg)(o,100))),n}function a(t,c,o){const n=createElement("select",t);return c&&n.addEventListener("change",c),n.value=o,n}},573:(A,m,e)=>{e.d(m,{Fi:()=>E,YA:()=>a,fI:()=>f});var d=e(4214);function l(u,C=document){return!!C.querySelector(u)}function E(u,C=document,h=!1){const g=C.querySelector(u);return h&&!g&&console.log(`No element found for selector: ${u}`),g}function f(u,C=document,h=!1){const g=C.querySelectorAll(u);return h&&!g.length&&console.log(`No elements found for selector: ${u}`),g}function p(u,C=1){let h=u;for(let g=0;g<C;g++){if(!h.parentElement)return null;h=h.parentElement}return h}function i(u,C,h){return[...u.querySelectorAll(C)].find(g=>g.textContent.trim().includes(h))}function s(u,C,h=!1,g=!1,y=null){const U=E(C,u);return a(U,h,g,y)}function a(u,C=!1,h=!1,g=null){if(!u)return g===null?(console.log("No element found"),null):g;const y=u.innerText;return o(y,C,h)}function t(u,C,h=!1){const g=u[C];return a(g,h)}function c(u,C=!1,h=!1){const g=u.textContent;return o(g,C,h)}function o(u,C,h){C&&(u=(0,d.zr)(u)),h&&(u=u.replace(",","."));const g=Number(u);return Number.isNaN(g)?(console.log(`Invalid number: ${u}`),0):g}function n(u){return[...u.childNodes].find(C=>C.nodeType===Node.TEXT_NODE)}function v(u){const C=h=>h.nodeType===Node.TEXT_NODE&&h.textContent.trim()!==""?[h]:[...h.childNodes].flatMap(C);return C(u)}function R(u){return normalizeSpacing(u.textContent)}},5539:(A,m,e)=>{e.d(m,{Bt:()=>l,UC:()=>c,kl:()=>a});function d(r,D){r.parentNode.insertBefore(D,r.nextSibling)}function l(r){r.style.display="none"}function E(r,D=1){const P=document.querySelector(r);P&&f(P,D)}function f(r,D=1){const P=getElementAncestor(r,D);P&&l(P)}function p(r,D,P){const N=findElementByText(r,D,P);N&&l(N)}function i(r){v(r),l(r)}function s(r){r.intersectionObserver||runOnceOnIntersection(r,()=>l(r))}function a(r){r.style.display=""}function t(r){const D=n(r);r.style.display=D}function c(r,D){D?l(r):a(r)}function o(r,D){D?s(r):(clearIntersectionObserver(r),a(r))}function n(r){return v(r),r.dataset.defaultDisplay}function v(r){if(r.dataset.defaultDisplay)return;const{display:D}=getComputedStyle(r);r.dataset.defaultDisplay=D}function R(){return{show:[],hide:[]}}function u(r,D,P){r?D.hide.push(P):D.show.push(P)}function C(r){r.show.forEach(a),r.hide.forEach(l)}function h(r,D,P=.3){D?y(r,P):g(r)}function g(r){r.style.opacity=""}function y(r,D=.3){r.style.opacity=D}function U(r){r.style.order=""}function w(r,D){r.style.order=D}function S(r,D,P,N="inline-flex"){D.style.display=r?N:"none",P.style.display=r?"none":N}function I(r,D=.3){r.style.transition="opacity 0.3s",r.style.opacity=D,b(r)}function V(r){r.style.opacity="",O(r)}function $(r){r.style.animation="loading-pulse 2.5s ease-in-out infinite",b(r)}function _(r){r.style.animation="",O(r)}function b(r){r.style.pointerEvents="none",r.style.cursor="wait"}function O(r){r.style.pointerEvents="",r.style.cursor=""}function L(r,D){const P=getFirstElement(D);P&&F(r,P)}function F(r,D){const P=createLink();P.href=r,D.parentNode.append(P),P.append(D)}function T(r,D){const P=getFirstElement(D);P&&x(r,P)}function x(r,D,P={}){const N=createLink(P);N.href=r,N.append(...D.childNodes),D.append(N)}function W(){const r=getURLQueryParam("scrollTo");if(!r)return;const D=document.getElementById(r);D?D.scrollIntoView():console.log(`Element with ID "${r}" was not found.`)}function M(r,D,P=null){const N=`${D}-click-passed`,K=P?k=>findElementByText(k,r,P):k=>getFirstElement(r,k);return function(k){if(k.hasAttribute(N))return!1;const G=K(k);return G&&G.click(),k.setAttribute(N,""),!0}}function B(r,D,P="text/plain"){const N=new Blob([r],{type:P}),K=URL.createObjectURL(N),k=document.createElement("a");k.href=K,k.download=D,document.body.appendChild(k),k.click(),document.body.removeChild(k),requestAnimationFrame(()=>URL.revokeObjectURL(K))}},6754:(A,m,e)=>{e.d(m,{ZM:()=>d});function d(p,i){Object.assign(p.style,i)}function l(p,i="custom-global-style"){let s=document.getElementById(i);s||(s=document.createElement("style"),s.id=i,s.type="text/css",document.head.appendChild(s)),s.textContent=p}function E(p){return Object.entries(p).map(([i,s])=>`${i.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${s};`).join(" ")}function f(p){return p?p.split(";").filter(i=>i.trim()!=="").reduce((i,s)=>{const[a,t]=s.split(":").map(o=>o.trim()),c=a.replace(/-([a-z])/g,(o,n)=>n.toUpperCase());return i[c]=t,i},{}):{}}},4921:(A,m,e)=>{e.d(m,{sg:()=>f,xk:()=>d});function d(t,c,o=null){const n=t.querySelector(c);return n?Promise.resolve(n):new Promise(v=>{const R=new MutationObserver(C);R.observe(t,{childList:!0,subtree:!0});let u;o&&(u=setTimeout(()=>{R.disconnect(),console.log(`No element found for selector: ${c}`),v(null)},o));function C(){const h=t.querySelector(c);h&&(u&&clearTimeout(u),R.disconnect(),v(h))}})}function l(t,c){return t.querySelector(c)?new Promise(n=>{const v=new MutationObserver(R);v.observe(t,{childList:!0,subtree:!0});function R(){t.querySelector(c)||(v.disconnect(),n())}}):Promise.resolve()}function E(t,c=400){return new Promise(o=>{let n;const v=new MutationObserver(()=>{clearTimeout(n),R()});function R(){n=setTimeout(()=>{v.disconnect(),o()},c)}R(),v.observe(t,{childList:!0,subtree:!0})})}function f(t,c=250){let o;return function(...n){const v=this;clearTimeout(o),o=setTimeout(()=>t.apply(v,n),c)}}async function p(t){document.visibilityState==="visible"?await t():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await t()},{once:!0})}function i(t,c){const o=new IntersectionObserver(n=>{n.forEach(v=>{v.isIntersecting&&(c(),s(t))})});t.intersectionObserver=o,o.observe(t)}function s(t){t.intersectionObserver&&(t.intersectionObserver.disconnect(),t.intersectionObserver=null)}function a(t){t&&(t.disconnect(),t=null)}},3829:(A,m,e)=>{e.d(m,{Ay:()=>l,JE:()=>i,iG:()=>s});var d=e(8355);function l(o,n){return!E(o,n)}function E(o,n){if(!n||!n.value)return!0;const v=(0,d._7)(n.value);return f(o,v)}function f(o,n){if(!n||!n.length)return!0;const v=(o||"").toLowerCase();return n.every(R=>p(v,R))}function p(o,n){return n.some(({term:v,isNegative:R})=>{const u=o.includes(v);return R?!u:u})}function i(o,n){return n.value!=null&&o<n.value}function s(o,n){return n.value!=null&&o>n.value}function a(o,n){return n.value==null?!1:o<parseDateFromISO(n.value)}function t(o,n){return n.value==null?!1:o>parseDateFromISO(n.value)}function c(o,n){return n.value&&o!==n.value}},4521:(A,m,e)=>{e.d(m,{z:()=>l});var d=e(3048);function l(E,f=null){return{createGlobalFilter(p,i=null,s=E){return d.V.create(p,i,s)},createSectionFilter(p,i=null,s=E){if(!f)throw new Error("sectionId must be provided to use createSectionFilter.");return d.V.createWithCompositeKey(f,p,i,s)}}}},5884:(A,m,e)=>{e.d(m,{Hw:()=>s,Nm:()=>E,nW:()=>f});var d=e(5467),l=e(740);function E(a,t,c={},o={}){const n=(0,l.kU)(o,t.updateValueFromEvent,t.value);return(0,d.E2)(n,c,a)}function f(a,t,c,o,n,v={},R={}){const u=(0,l.o5)(R,t.updateValueFromEvent,t.value,c,o,n);return(0,d.E2)(u,v,a)}function p(a,t,c={},o={}){const n=createSelect(o,t.updateValueFromEvent,t.value);return createControl(n,c,a)}function i(a,t,c={},o={}){const n=createDateInput(o,t.updateValueFromEvent,t.value);return createControl(n,c,a)}function s(a,t,c={},o={}){const n=(0,l.S)(o,t.updateValueFromEvent,t.value);return(0,d.E2)(n,c,a)}},7877:(A,m,e)=>{e.d(m,{Ch:()=>o,E9:()=>l,H1:()=>R,HX:()=>E,VD:()=>t,Zi:()=>n,pW:()=>V});var d=e(5884);function l(_,b={},O={}){return(0,d.Nm)("\u041F\u043E\u0438\u0441\u043A: ",_,b,O)}function E(_,b={},O={},L=.1,F=3){return(0,d.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",_,L,F,5,b,O)}function f(_,b={},O={},L=.1,F=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",_,L,F,5,b,O)}function p(_,b={},O={}){return s("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",_,b,O)}function i(_,b={},O={}){return s("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",_,b,O)}function s(_,b,O={},L={}){return createNumberFilterControl(_,b,"1","1","999999",O,L)}function a(_,b={},O={}){return createDateFilterControl("\u041C\u0438\u043D. \u0434\u0430\u0442\u0430: ",_,b,O)}function t(_,b={},O={}){return c("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",_,b,O)}function c(_,b,O={},L={}){return(0,d.nW)(_,b,"5","0","100",O,L)}function o(_,b={},O={}){return(0,d.nW)("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",_,"5","0","100",b,O)}function n(_,b,O={},L={},F="250"){return(0,d.nW)(_,b,F,"0","1000000",O,L)}function v(_,b={},O={},L="25"){return n("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",_,b,O,L)}function R(_,b={},O={},L="25"){return n("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",_,b,O,L)}function u(_,b={},O={}){return C("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",_,b,O)}function C(_,b,O={},L={}){return createNumberFilterControl(_,b,"1","0","99999",O,L)}function h(_,b={},O={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",_,"1","2","8",b,O)}function g(_,b={},O={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",_,1,1,10,b,O)}function y(_,b={},O={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",_,b,O)}function U(_,b={},O={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",_,b,O)}function w(_,b={},O={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",_,b,O)}function S(_,b={},O={}){return createCheckboxFilterControl("\u0411\u043E\u043D\u0443\u0441: ",_,b,O)}function I(_,b={},O={}){return createCheckboxFilterControl("\u0412 \u043D\u0430\u043B\u0438\u0447\u0438\u0438: ",_,b,O)}function V(_,b={},O={}){return(0,d.Hw)("\u0412\u043A\u043B: ",_,b,O)}function $(_,b,O={}){const L=[{value:-25,emoji:"\u{1F48E}",tooltip:"\u0421\u0443\u043F\u0435\u0440 \u0446\u0435\u043D\u0430 (-25%)"},{value:-15,emoji:"\u{1F525}",tooltip:"\u041E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-15%)"},{value:-5,emoji:"\u{1F31F}",tooltip:"\u041A\u043B\u0430\u0441\u0441\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-5%)"},{value:5,emoji:"\u{1F44C}",tooltip:"\u0425\u043E\u0440\u043E\u0448\u0430\u044F \u0446\u0435\u043D\u0430 (+5%)"}],F={active:{background:"#e3f2fd",borderColor:"#2196f3",boxShadow:"0 0 0 1px #2196f3"},inactive:{background:"#fff",borderColor:"#ccc",boxShadow:"none"},hover:{background:"#f5f5f5"}},T=createDiv({display:"inline-flex",gap:"4px",marginLeft:"4px"}),x=[],W=()=>b?parseFloat(b.value)||0:_.value,M=()=>{const B=W();x.forEach(({button:r,value:D})=>{const N=D<=B?F.active:F.inactive;Object.assign(r.style,N)})};return L.forEach(({value:B,emoji:r,tooltip:D})=>{const P=createButton({padding:"2px 6px",fontSize:"16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"#fff",transition:"all 0.2s",...O},r);P.title=D,P.type="button",P.addEventListener("click",N=>{N.preventDefault(),_.updateValue(B),b&&(b.value=B),M()}),P.addEventListener("mouseenter",()=>{B<=W()||(P.style.background=F.hover.background)}),P.addEventListener("mouseleave",()=>{M()}),x.push({button:P,value:B}),T.appendChild(P)}),M(),b&&(b.addEventListener("input",M),b.addEventListener("change",M)),T}},8355:(A,m,e)=>{e.d(m,{_7:()=>l});function d(t){if(!t)return[];const o=l(t).flat().filter(n=>n&&!n.isNegative&&n.term).map(n=>n.term);return[...new Set(o)]}function l(t){return t?t.toLowerCase().split(",").map(E).filter(Boolean):[]}function E(t){const c=t.split("/").map(n=>n.trim()).filter(Boolean);if(c.length===0)return null;const o=c.map(f).filter(Boolean);return o.length>0?o:null}function f(t){const c=t.startsWith("!"),o=c?t.slice(1).trim():t;return o?{term:o,isNegative:c}:null}function p(t,c){s(t,o=>o.style.display!=="none",c)}function i(t,c){s(t,o=>o.style.opacity==="",c)}function s(t,c,o){const n=[...t].filter(c).length,v=t.length;a(o,n,v)}function a(t,c,o){t.textContent=`\u041F\u043E\u043A\u0430\u0437\u0430\u043D\u043E: ${c} \u0438\u0437 ${o}`}},5213:(A,m,e)=>{e.d(m,{b:()=>l});var d=e(7273);function l(E,f,p=!1,i="customFiltersContainer"){let s=E.querySelector(`#${i}`);if(s){if(!p)return;s.replaceChildren()}else s=(0,d.S)(),s.id=i;f(s,E)}},4444:(A,m,e)=>{e.d(m,{s:()=>d});function d(l){let p=2166136261;for(let i=0;i<l.length;i+=1){const s=l.charCodeAt(i);p^=s,p=Math.imul(p,16777619)}return p>>>0}},5081:(A,m,e)=>{e.d(m,{B:()=>E});var d=e(4444);function l(f){return(0,d.s)(f).toString(16).padStart(8,"0")}function E(f,p="common"){return f?l(f):p}},8200:(A,m,e)=>{e.d(m,{s:()=>d});function d(l){const{target:E}=l,{type:f}=E;switch(f){case"text":return`"${E.value}"`;case"number":return E.value;case"select-one":return E.value;case"date":return`"${E.value}"`;case"checkbox":return E.checked;default:return console.log(`Unknown input type: ${f}`),null}}},157:(A,m,e)=>{e.d(m,{Fg:()=>d,vx:()=>E});const d=window.GM_setValue,l=window.GM.setValue,E=window.GM_getValue},4639:(A,m,e)=>{e.d(m,{a:()=>f});var d=e(1870),l=e(8200),E=e(3976);class f extends d.j{constructor(i=null,s=null){super(i,s)}updateValueFromEvent=i=>{const s=(0,E.$)((0,l.s)(i));this.value!==s&&(this.value=s,this.onChangeIfDefined())}}},1870:(A,m,e)=>{e.d(m,{j:()=>d});class d{constructor(E,f){this.value=E,this.onChange=f}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(A,m,e)=>{e.d(m,{V:()=>p});var d=e(1870),l=e(8200),E=e(3976),f=e(157);class p extends d.j{constructor(s,a=null,t=null){super((0,f.vx)(s,a),t),this.storageKey=s,this.defaultValue=a}static create(s,a=null,t=null){return new p(s,a,t)}static createWithCompositeKey(s,a,t=null,c=null){const o=`${s}-${a}`;return new p(o,t,c)}updateValueFromEvent=s=>{const a=(0,l.s)(s),t=(0,E.$)(a);this.updateValue(t)};updateValue(s,a=!0){this.value!==s&&((0,f.Fg)(this.storageKey,s),this.value=s,a&&this.onChangeIfDefined())}clearValue(s=!1){this.updateValue(null,s)}resetValue(s=!1){this.updateValue(this.defaultValue,s)}}},3976:(A,m,e)=>{e.d(m,{$:()=>d});function d(l){return l===""?null:JSON.parse(l)}},4214:(A,m,e)=>{e.d(m,{zr:()=>l});function d(i){return i.replace(/\D/g,"")}function l(i){return i.replace(/[^\d.,-]/g,"")}function E(i){return i.replace(/\s/g,"")}function f(i){return i.charAt(0).toUpperCase()+i.slice(1)}function p(i){return i.replace(/\s+/g," ").trim()}},5406:(A,m,e)=>{e.d(m,{C$:()=>E,Fc:()=>d,W2:()=>a});function d(u,C="common",h=!1){const{pathname:g}=window.location;return l(g,u,C,h)}function l(u,C,h,g=!1){const y=u.split("/");C=C<0?y.length+C:C;const U=y[C]||h;return g&&console.log(`Pathname element: ${U}`),U}function E(u,C="common",h=!1){const g=d(u,"",h);return f(g,C,h)}function f(u,C,h){if(!u)return C;const g=u.split("-").at(-1);return h&&console.log(`Pathname element ending: ${g}`),g}function p(u,C,h="common",g=!1){const y=l(u,C,"",g);return f(y,h,g)}function i(u){return new URLSearchParams(window.location.search).get(u)}function s(u){return u.split("?")[0]}function a(u){return window.location.pathname.includes(u)}function t(u){return u.some(C=>a(C))}function c(...u){return window.location.pathname.split("/").some(h=>u.includes(h))}function o(u){try{const C=new URL(window.location.href);Object.entries(u).forEach(([h,g])=>{C.searchParams.set(h,g)}),window.location.href=C.toString()}catch(C){console.error("Failed to redirect:",C)}}function n(u,C=[]){const h=new AbortController;let g=!1;const y=w=>{const S=new URL(w),I={pathname:S.pathname};return C.forEach(V=>{I[V]=S.searchParams.get(V)}),I};let U=y(window.location.href);return window.navigation.addEventListener("navigatesuccess",async()=>{if(g)return;const w=y(window.navigation.currentEntry.url);if(Object.keys(U).some(I=>U[I]!==w[I])){U=w,g=!0;try{await u(w)}catch(I){console.error("URL observer error:",I)}finally{g=!1}}},{signal:h.signal}),()=>h.abort()}function v(u,C=[]){const h={pathname:window.location.pathname};C.forEach(S=>{h[S]=i(S)});let g=!1;async function y(){if(g)return;const S={pathname:window.location.pathname};if(C.forEach(I=>{S[I]=i(I)}),Object.keys(h).some(I=>h[I]!==S[I])){Object.assign(h,S),g=!0;try{await u()}catch(I){console.error("Error in URL observer callback:",I)}finally{g=!1}}}function U(){y().catch(S=>{console.error("Error in URL change handler:",S)})}let w=window.location.href;setInterval(()=>{window.location.href!==w&&(console.log("URL changed:",window.location.href),w=window.location.href,U())},200),window.addEventListener("popstate",U)}function R(u=[]){v(()=>window.location.reload(),u)}},4010:(A,m,e)=>{e.a(A,async(d,l)=>{try{let i=function(){return(0,p.W2)("details")};var E=e(1901),f=e(2344),p=e(5406);i()?await(0,E.K)():await(0,f.P)(),l()}catch(i){l(i)}},1)},1926:(A,m,e)=>{e.d(m,{i:()=>d});const d={PRICE:"price",BALANCED_CASHBACK_PRICE:"balanced-cashback-price",COUPON:"applied-coupon",OBSERVED:"observed"}},1319:(A,m,e)=>{e.d(m,{Z:()=>E});var d=e(573),l=e(1926);function E(a,t,c,o){const n=(0,d.Fi)(t,a);return(f(n,o)||!n.hasAttribute(l.i.BALANCED_CASHBACK_PRICE))&&p(n,c,o),n}function f(a,t){if(a.hasAttribute(l.i.COUPON)){const c=+a.getAttribute(l.i.COUPON);return t!==c}return!!t}function p(a,t,c){let o=i(a);a.setAttribute(l.i.PRICE,o),c?(c<1?o=(o*(1-c)).toFixed():o-=c,a.setAttribute(l.i.COUPON,c)):a.removeAttribute(l.i.COUPON);const n=s(o,t),v=o-n;a.setAttribute(l.i.BALANCED_CASHBACK_PRICE,v);const R=`${o.toLocaleString()} (${v.toLocaleString()}) \u20BD`;a.innerText=R,a.title=`-${n.toLocaleString()}`}function i(a){return a.hasAttribute(l.i.PRICE)?+a.getAttribute(l.i.PRICE):(0,d.YA)(a,!0)}function s(a,t){const c=t/100;return(a*c/(1+c)).toFixed(0)}},4633:(A,m,e)=>{e.d(m,{r:()=>l});const d={INPUT:{border:"1px solid #e4ebf0",fontSize:"14px",borderRadius:"8px",marginLeft:"7px",padding:"8px 14px"}},l={CONTAINER:{display:"flex",gridGap:"15px",padding:"14px 5px"},CONTROL:{display:"flex",alignItems:"center",fontSize:"14px"},TEXT_INPUT:{...d.INPUT,width:"180px"},NUMBER_INPUT:{...d.INPUT},CHECKBOX_INPUT:{marginLeft:"7px",width:"23px",height:"23px"}}},2344:(A,m,e)=>{e.d(m,{P:()=>$});var d=e(4921),l=e(5213),E=e(1319),f=e(5406),p=e(4639),i=e(3829),s=e(5884),a=e(5539),t=e(573),c=e(7877),o=e(1926),n=e(4633),v=e(4521),R=e(5081);const u={PRODUCT_CARD_LIST_HEADER:".catalog-listing-controls",PRODUCT_CARD:".catalog-item-desktop",PRODUCT_CARD_PRICE:".catalog-item-regular-desktop__price",PRODUCT_CARD_CASHBACK:".bonus-percent",PRODUCT_CARD_TITLE:".catalog-item-regular-desktop__title-link",PRODUCT_CARD_DISCOUNT:".discount-percentage__value",PRODUCT_CARD_SELLER_NAME:".merchant-info__name"};var C=e(6754);const h=(0,R.B)((0,f.Fc)(2)),{createSectionFilter:g}=(0,v.z)(O,h),y=g("name-filter"),U=g("min-cashback-filter"),w=g("max-price-filter"),S=g("min-discount-filter"),I=g("seller-name-filter"),V=new p.a(!1,O);async function $(){await _();const F=await(0,d.xk)(document,"#app");new MutationObserver((0,d.sg)(_)).observe(F,{childList:!0,subtree:!0})}async function _(){const F=await(0,d.xk)(document,u.PRODUCT_CARD_LIST_HEADER);(0,l.b)(F,b);const T=F.parentNode;if(T.hasAttribute(o.i.OBSERVED))return;new MutationObserver((0,d.sg)(O,50)).observe(T,{childList:!0,subtree:!0}),T.setAttribute(o.i.OBSERVED,"")}function b(F,T){(0,C.ZM)(F,n.r.CONTAINER);const x=(0,c.E9)(y,n.r.CONTROL,n.r.TEXT_INPUT),W=(0,c.Ch)(U,n.r.CONTROL,n.r.NUMBER_INPUT),M=(0,c.H1)(w,n.r.CONTROL,n.r.NUMBER_INPUT,"250"),B=(0,c.VD)(S,n.r.CONTROL,n.r.NUMBER_INPUT),r=(0,s.Nm)("\u041F\u0440\u043E\u0434\u0430\u0432\u0435\u0446: ",I,n.r.CONTROL,n.r.TEXT_INPUT),D=(0,c.pW)(V,n.r.CONTROL,n.r.CHECKBOX_INPUT);F.append(x,W,M,B,r,D),T.append(F)}function O(){(0,t.fI)(u.PRODUCT_CARD).forEach(L)}function L(F){if(!V.value){(0,a.kl)(F);return}const T=(0,t.Fi)(u.PRODUCT_CARD_TITLE,F),x=(0,t.Fi)(u.PRODUCT_CARD_CASHBACK,F),W=(0,t.Fi)(u.PRODUCT_CARD_DISCOUNT,F);if(!T){(0,a.Bt)(F);return}const M=T.innerText,B=(0,t.YA)(x,!0,!1,0),r=Math.abs((0,t.YA)(W,!0,!1,0)),P=+(0,E.Z)(F,u.PRODUCT_CARD_PRICE,B).getAttribute(o.i.BALANCED_CASHBACK_PRICE),N=(0,t.Fi)(u.PRODUCT_CARD_SELLER_NAME,F),K=N?(0,i.Ay)(N.innerText,I):!1,k=(0,i.Ay)(M,y)||(0,i.JE)(B,U)||(0,i.iG)(P,w)||(0,i.JE)(r,S)||K;(0,a.UC)(F,k)}},1901:(A,m,e)=>{e.d(m,{K:()=>_});var d=e(4921),l=e(5081),E=e(5406),f=e(5213),p=e(4639),i=e(3829),s=e(5539),a=e(573),t=e(7877),c=e(5884),o=e(1319),n=e(1926),v=e(4633),R=e(4521);const u={APP:"#app",OFFERS_FILTER:".pdp-prices-filter",OFFERS_CONTAINER:".pdp-prices",OFFER:".pdp-prices .product-offer",PRICE:".product-offer-price__amount",CASHBACK:".bonus-percent",SELLER_RATING:".pdp-merchant-rating-block__rating"};var C=e(6754);const h=(0,l.B)((0,E.C$)(3)),{createGlobalFilter:g,createSectionFilter:y}=(0,R.z)(L,h),U=y("min-cashback-filter"),w=y("max-price-filter"),S=y("max-discounted-price-filter"),I=g("min-seller-rating-filter"),V=new p.a(null,L),$=g("filter-enabled",!1);async function _(){await b();const T=await(0,d.xk)(document,u.APP);new MutationObserver((0,d.sg)(b)).observe(T,{childList:!0})}async function b(){const T=await(0,d.xk)(document,u.OFFERS_FILTER);(0,f.b)(T,O),L();const x=(0,a.Fi)(u.OFFERS_CONTAINER);if(x.hasAttribute(n.i.OBSERVED))return;new MutationObserver((0,d.sg)(L,50)).observe(x,{childList:!0,subtree:!0}),x.setAttribute(n.i.OBSERVED,"")}function O(T,x){(0,C.ZM)(T,v.r.CONTAINER);const W=(0,t.Ch)(U,v.r.CONTROL,v.r.NUMBER_INPUT),M=(0,t.H1)(w,v.r.CONTROL,v.r.NUMBER_INPUT,"250"),B=(0,t.Zi)("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430 \u0441\u043E \u0441\u043A\u0438\u0434\u043A\u043E\u0439: ",S,v.r.CONTROL,v.r.NUMBER_INPUT),r=(0,t.HX)(I,v.r.CONTROL,v.r.NUMBER_INPUT),D=(0,c.nW)("\u041A\u0443\u043F\u043E\u043D: ",V,"500","0","100000",v.r.CONTROL,v.r.NUMBER_INPUT),P=(0,t.pW)($,v.r.CONTROL,v.r.CHECKBOX_INPUT);T.append(W,M,B,r,D,P),x.append(T)}function L(){(0,a.fI)(u.OFFER).forEach(F)}function F(T){if(!$.value){(0,s.kl)(T);return}const x=(0,a.Fi)(u.PRICE,T),W=(0,a.Fi)(u.CASHBACK,T),M=(0,a.Fi)(u.SELLER_RATING,T);if(!x||!W||!M){(0,s.Bt)(T);return}const B=(0,a.YA)(W,!0),r=(0,o.Z)(T,u.PRICE,B,V.value),D=+r.getAttribute(n.i.PRICE),P=+r.getAttribute(n.i.BALANCED_CASHBACK_PRICE),N=(0,a.YA)(M,!0),K=(0,i.JE)(B,U)||(0,i.iG)(D,w)||(0,i.iG)(P,S)||(0,i.JE)(N,I);(0,s.UC)(T,K)}}},j={};function H(A){var m=j[A];if(m!==void 0)return m.exports;var e=j[A]={exports:{}};return z[A](e,e.exports,H),e.exports}(()=>{var A=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",m=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",e=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",d=E=>{E&&E.d<1&&(E.d=1,E.forEach(f=>f.r--),E.forEach(f=>f.r--?f.r++:f()))},l=E=>E.map(f=>{if(f!==null&&typeof f=="object"){if(f[A])return f;if(f.then){var p=[];p.d=0,f.then(a=>{i[m]=a,d(p)},a=>{i[e]=a,d(p)});var i={};return i[A]=a=>a(p),i}}var s={};return s[A]=a=>{},s[m]=f,s});H.a=(E,f,p)=>{var i;p&&((i=[]).d=-1);var s=new Set,a=E.exports,t,c,o,n=new Promise((v,R)=>{o=R,c=v});n[m]=a,n[A]=v=>(i&&v(i),s.forEach(v),n.catch(R=>{})),E.exports=n,f(v=>{t=l(v);var R,u=()=>t.map(h=>{if(h[e])throw h[e];return h[m]}),C=new Promise(h=>{R=()=>h(u),R.r=0;var g=y=>y!==i&&!s.has(y)&&(s.add(y),y&&!y.d&&(R.r++,y.push(R)));t.map(y=>y[A](g))});return R.r?C:u()},v=>(v?o(n[e]=v):c(a),d(i))),i&&i.d<0&&(i.d=0)}})(),H.d=(A,m)=>{for(var e in m)H.o(m,e)&&!H.o(A,e)&&Object.defineProperty(A,e,{enumerable:!0,get:m[e]})},H.o=(A,m)=>Object.prototype.hasOwnProperty.call(A,m);var Q=H(4010)})();})();
