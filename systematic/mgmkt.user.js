// ==UserScript==
// @name         MegaMarket product cards & offers filter
// @description  Hide product cards & offers by filter
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://megamarket.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.76072887
// @icon         https://www.google.com/s2/favicons?sz=64&domain=megamarket.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/mgmkt.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var j={5467:(F,m,e)=>{e.d(m,{E2:()=>l});var s=e(9928);function l(h,o={},n=null){const t=(0,s.Sw)(o,n);return t.append(h),t}function C(h,o=null,n={},t={}){const i=createActionLink(h,o,t);return l(i,n)}function d(h,o=null,n=null,t={},i={}){const A=createActionLinkWithIcon(h,n,o,i);return l(A,t)}},9928:(F,m,e)=>{e.d(m,{S:()=>h,Sw:()=>v,kU:()=>C,o5:()=>d});var s=e(4921),l=e(6754);function C(c,u,f){const b=o(c,"text",u);return b.value=f,b}function d(c,u,f,b,U,I){const y=o(c,"number",u);return y.value=f,y.step=b,y.min=U,y.max=I,y}function h(c,u,f){const b=o(c,"checkbox",u);return b.checked=f,b}function o(c={},u=null,f=null){const b=r("input",c);return u&&(b.type=u),f&&(b.addEventListener("keyup",(0,s.sg)(f,200)),b.addEventListener("change",(0,s.sg)(f,100))),b}function n(c={},u=null){return r("span",c,u)}function t(c={},u=null,f=null){const b=r("a",c,u);return f&&(b.href=f),b}function i(c,u=null,f={}){f.cursor||="pointer";const b=t(f,u);return c&&b.addEventListener("click",c),b}function A(c,u,f=null,b={},U={}){b.display||="inline-flex",b.alignItems||="center",b.gap||="0.25em";const I=i(c,f,b);return I.prepend(g(u,U)),I}function D(c={},u=null,f=null){const b=r("button",c,u);return f&&b.addEventListener("click",f),b}function v(c={},u=null){return r("div",c,u)}function O(c={}){return r("i",c)}function g(c,u={}){u.width||="1em",u.height||="1em",u.paddingBottom||="1px";const f=O(u);return f.setAttribute("data-lucide",c),f}function r(c,u,f=null){if(typeof u!="object"||u===null)throw new TypeError("styles should be an object");const b=document.createElement(c);return(0,l.ZM)(b,u),f&&(b.innerHTML=f),b}},573:(F,m,e)=>{e.d(m,{Fi:()=>C,YA:()=>t,fI:()=>d});var s=e(4214);function l(r,c=document){return!!c.querySelector(r)}function C(r,c=document,u=!1){const f=c.querySelector(r);return u&&!f&&console.log(`No element found for selector: ${r}`),f}function d(r,c=document,u=!1){const f=c.querySelectorAll(r);return u&&!f.length&&console.log(`No elements found for selector: ${r}`),f}function h(r,c=1){let u=r;for(let f=0;f<c;f++){if(!u.parentElement)return null;u=u.parentElement}return u}function o(r,c,u){return[...r.querySelectorAll(c)].find(f=>f.textContent.trim().includes(u))}function n(r,c,u=!1,f=!1,b=null){const U=C(c,r);return t(U,u,f,b)}function t(r,c=!1,u=!1,f=null){if(!r)return f===null?(console.log("No element found"),null):f;const b=r.innerText;return D(b,c,u)}function i(r,c,u=!1){const f=r[c];return t(f,u)}function A(r,c=!1,u=!1){const f=r.textContent;return D(f,c,u)}function D(r,c,u){c&&(r=(0,s.zr)(r)),u&&(r=r.replace(",","."));const f=Number(r);return Number.isNaN(f)?(console.log(`Invalid number: ${r}`),0):f}function v(r){return[...r.childNodes].find(c=>c.nodeType===Node.TEXT_NODE)}function O(r){const c=u=>u.nodeType===Node.TEXT_NODE&&u.textContent.trim()!==""?[u]:[...u.childNodes].flatMap(c);return c(r)}function g(r){return normalizeSpacing(r.textContent)}},5539:(F,m,e)=>{e.d(m,{Bt:()=>l,UC:()=>i,kl:()=>n});function s(a,E){a.parentNode.insertBefore(E,a.nextSibling)}function l(a){a.style.display="none"}function C(a,E=1){const p=document.querySelector(a);p&&d(p,E)}function d(a,E=1){const p=getElementAncestor(a,E);p&&l(p)}function h(a){v(a),l(a)}function o(a){a.intersectionObserver||runOnceOnIntersection(a,()=>l(a))}function n(a){a.style.display=""}function t(a){const E=D(a);a.style.display=E}function i(a,E){E?l(a):n(a)}function A(a,E){E?o(a):(clearIntersectionObserver(a),n(a))}function D(a){return v(a),a.defaultDisplay}function v(a){if(a.defaultDisplay)return;const{display:E}=getComputedStyle(a);a.defaultDisplay=E}function O(){return{show:[],hide:[]}}function g(a,E,p){a?E.hide.push(p):E.show.push(p)}function r(a){a.show.forEach(n),a.hide.forEach(l)}function c(a,E,p=.3){E?f(a,p):u(a)}function u(a){a.style.opacity=""}function f(a,E=.3){a.style.opacity=E}function b(a){a.style.order=""}function U(a,E){a.style.order=E}function I(a,E){a.style.background=E}function y(a,E){const p=getFirstElement(E);p&&M(a,p)}function M(a,E){const p=createLink();p.href=a,E.parentNode.append(p),p.append(E)}function R(a,E){const p=getFirstElement(E);p&&P(a,p)}function P(a,E){const p=createLink();p.href=a,p.append(...E.childNodes),E.append(p)}function _(){const a=getURLQueryParam("scrollTo");if(!a)return;const E=document.getElementById(a);E?E.scrollIntoView():console.log(`Element with ID "${a}" was not found.`)}function L(a,E,p=null){const N=`${E}-click-passed`,S=p?T=>findElementByText(T,a,p):T=>getFirstElement(a,T);return function(T){if(T.hasAttribute(N))return!1;const x=S(T);return x&&x.click(),T.setAttribute(N,""),!0}}function w(a,E,p="text/plain"){const N=new Blob([a],{type:p}),S=URL.createObjectURL(N),T=document.createElement("a");T.href=S,T.download=E,document.body.appendChild(T),T.click(),document.body.removeChild(T),requestAnimationFrame(()=>URL.revokeObjectURL(S))}},6754:(F,m,e)=>{e.d(m,{ZM:()=>s});function s(h,o){Object.assign(h.style,o)}function l(h,o="custom-global-style"){let n=document.getElementById(o);n||(n=document.createElement("style"),n.id=o,n.type="text/css",document.head.appendChild(n)),n.textContent=h}function C(h){return Object.entries(h).map(([o,n])=>`${o.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${n};`).join(" ")}function d(h){return h?h.split(";").filter(o=>o.trim()!=="").reduce((o,n)=>{const[t,i]=n.split(":").map(D=>D.trim()),A=t.replace(/-([a-z])/g,(D,v)=>v.toUpperCase());return o[A]=i,o},{}):{}}},4921:(F,m,e)=>{e.d(m,{sg:()=>d,xk:()=>s});function s(i,A,D=null){const v=i.querySelector(A);return v?Promise.resolve(v):new Promise(O=>{const g=new MutationObserver(c);g.observe(i,{childList:!0,subtree:!0});let r;D&&(r=setTimeout(()=>{g.disconnect(),console.log(`No element found for selector: ${A}`),O(null)},D));function c(){const u=i.querySelector(A);u&&(r&&clearTimeout(r),g.disconnect(),O(u))}})}function l(i,A){return i.querySelector(A)?new Promise(v=>{const O=new MutationObserver(g);O.observe(i,{childList:!0,subtree:!0});function g(){i.querySelector(A)||(O.disconnect(),v())}}):Promise.resolve()}function C(i,A=400){return new Promise(D=>{let v;const O=new MutationObserver(()=>{clearTimeout(v),g()});function g(){v=setTimeout(()=>{O.disconnect(),D()},A)}g(),O.observe(i,{childList:!0,subtree:!0})})}function d(i,A=250){let D;return(...v)=>{clearTimeout(D),D=setTimeout(()=>i(...v),A)}}async function h(i){document.visibilityState==="visible"?await i():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await i()},{once:!0})}function o(i,A){const D=new IntersectionObserver(v=>{v.forEach(O=>{O.isIntersecting&&(A(),n(i))})});i.intersectionObserver=D,D.observe(i)}function n(i){i.intersectionObserver&&(i.intersectionObserver.disconnect(),i.intersectionObserver=null)}function t(i){i&&(i.disconnect(),i=null)}},3829:(F,m,e)=>{e.d(m,{Ay:()=>l,JE:()=>d,iG:()=>h});var s=e(8355);function l(n,t){return!C(n,t)}function C(n,t){if(!t.value)return!0;const i=n.toLowerCase(),A=(0,s.R)(t),D=[],v=[];return A.forEach(O=>{if(O.startsWith("!")){const g=O.substring(1);g&&v.push(g)}else D.push(O)}),D.every(O=>i.includes(O))&&v.every(O=>!i.includes(O))}function d(n,t){return t.value!=null&&n<t.value}function h(n,t){return t.value!=null&&n>t.value}function o(n,t){return t.value&&n!==t.value}},4521:(F,m,e)=>{e.d(m,{z:()=>l});var s=e(3048);function l(C,d=null){return{createGlobalFilter(h,o=null,n=C){return s.V.create(h,o,n)},createSectionFilter(h,o=null,n=C){if(!d)throw new Error("sectionId must be provided to use createSectionFilter.");return s.V.createWithCompositeKey(d,h,o,n)}}}},5884:(F,m,e)=>{e.d(m,{Hw:()=>h,Nm:()=>C,nW:()=>d});var s=e(9928),l=e(5467);function C(o,n,t={},i={}){const A=(0,s.kU)(i,n.updateValueFromEvent,n.value);return(0,l.E2)(A,t,o)}function d(o,n,t,i,A,D={},v={}){const O=(0,s.o5)(v,n.updateValueFromEvent,n.value,t,i,A);return(0,l.E2)(O,D,o)}function h(o,n,t={},i={}){const A=(0,s.S)(i,n.updateValueFromEvent,n.value);return(0,l.E2)(A,t,o)}},7877:(F,m,e)=>{e.d(m,{Ch:()=>A,E9:()=>l,H1:()=>O,HX:()=>C,VD:()=>t,Zi:()=>D,pW:()=>y});var s=e(5884);function l(R,P={},_={}){return(0,s.Nm)("\u041F\u043E\u0438\u0441\u043A: ",R,P,_)}function C(R,P={},_={},L=.1,w=3){return(0,s.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",R,L,w,5,P,_)}function d(R,P={},_={},L=.1,w=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",R,L,w,5,P,_)}function h(R,P={},_={}){return n("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",R,P,_)}function o(R,P={},_={}){return n("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",R,P,_)}function n(R,P,_={},L={}){return createNumberFilterControl(R,P,"1","1","999999",_,L)}function t(R,P={},_={}){return i("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",R,P,_)}function i(R,P,_={},L={}){return(0,s.nW)(R,P,"5","0","100",_,L)}function A(R,P={},_={}){return(0,s.nW)("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",R,"5","0","100",P,_)}function D(R,P,_={},L={},w="250"){return(0,s.nW)(R,P,w,"0","1000000",_,L)}function v(R,P={},_={},L="25"){return D("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",R,P,_,L)}function O(R,P={},_={},L="25"){return D("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",R,P,_,L)}function g(R,P={},_={}){return r("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",R,P,_)}function r(R,P,_={},L={}){return createNumberFilterControl(R,P,"1","0","99999",_,L)}function c(R,P={},_={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",R,"1","2","7",P,_)}function u(R,P={},_={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",R,1,1,10,P,_)}function f(R,P={},_={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",R,P,_)}function b(R,P={},_={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",R,P,_)}function U(R,P={},_={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",R,P,_)}function I(R,P={},_={}){return createCheckboxFilterControl("\u0411\u0430\u043B\u043B\u044B: ",R,P,_)}function y(R,P={},_={}){return(0,s.Hw)("\u0412\u043A\u043B: ",R,P,_)}function M(R,P,_={}){const L=[{value:-25,emoji:"\u{1F48E}",tooltip:"\u0421\u0443\u043F\u0435\u0440 \u0446\u0435\u043D\u0430 (-25%)"},{value:-15,emoji:"\u{1F525}",tooltip:"\u041E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-15%)"},{value:-5,emoji:"\u{1F44D}",tooltip:"\u041A\u043B\u0430\u0441\u0441\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-5%)"},{value:5,emoji:"\u{1F44C}",tooltip:"\u0425\u043E\u0440\u043E\u0448\u0430\u044F \u0446\u0435\u043D\u0430 (+5%)"}],w=createDiv({display:"inline-flex",gap:"4px",marginLeft:"4px"}),a=[],E=()=>{const p=P?parseFloat(P.value)||0:R.value;a.forEach(({button:N,value:S})=>{S<=p?(N.style.background="#e3f2fd",N.style.borderColor="#2196f3",N.style.boxShadow="0 0 0 1px #2196f3"):(N.style.background="#fff",N.style.borderColor="#ccc",N.style.boxShadow="none")})};return L.forEach(({value:p,emoji:N,tooltip:S})=>{const T=createButton({padding:"2px 6px",fontSize:"16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"#fff",transition:"all 0.2s",..._},N);T.title=S,T.type="button",T.addEventListener("click",x=>{x.preventDefault(),R.updateValue(p),P&&(P.value=p),E()}),T.addEventListener("mouseenter",()=>{const x=P?parseFloat(P.value)||0:R.value;p<=x||(T.style.background="#f5f5f5")}),T.addEventListener("mouseleave",()=>{E()}),a.push({button:T,value:p}),w.appendChild(T)}),E(),P&&(P.addEventListener("input",E),P.addEventListener("change",E)),w}},8355:(F,m,e)=>{e.d(m,{R:()=>s});function s(C){return C.value.toLowerCase().split(",").map(d=>d.trim()).filter(d=>d!=="")}function l(C){return s(C).filter(d=>!d.startsWith("!"))}},5213:(F,m,e)=>{e.d(m,{b:()=>C});var s=e(9928),l=e(573);function C(d,h,o=!1,n="customFiltersContainer"){let t=(0,l.Fi)(`#${n}`,d);if(t)if(o)t.remove();else return;t=(0,s.Sw)(),t.id=n,h(t,d)}},4444:(F,m,e)=>{e.d(m,{s:()=>s});function s(l){let h=2166136261;for(let o=0;o<l.length;o+=1){const n=l.charCodeAt(o);h^=n,h=Math.imul(h,16777619)}return h>>>0}},5081:(F,m,e)=>{e.d(m,{B:()=>C});var s=e(4444);function l(d){return(0,s.s)(d).toString(16).padStart(8,"0")}function C(d,h="common"){return d?l(d):h}},8200:(F,m,e)=>{e.d(m,{s:()=>s});function s(l){const{target:C}=l,{type:d}=C;switch(d){case"text":return`"${C.value}"`;case"number":return C.value;case"checkbox":return C.checked;default:return console.log(`Unknown input type: ${d}`),null}}},157:(F,m,e)=>{e.d(m,{Fg:()=>s,vx:()=>C});const s=window.GM_setValue,l=window.GM.setValue,C=window.GM_getValue},4639:(F,m,e)=>{e.d(m,{a:()=>d});var s=e(1870),l=e(8200),C=e(3976);class d extends s.j{constructor(o=null,n=null){super(o,n)}updateValueFromEvent=o=>{const n=(0,C.$)((0,l.s)(o));this.value!==n&&(this.value=n,this.onChangeIfDefined())}}},1870:(F,m,e)=>{e.d(m,{j:()=>s});class s{constructor(C,d){this.value=C,this.onChange=d}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(F,m,e)=>{e.d(m,{V:()=>h});var s=e(1870),l=e(8200),C=e(3976),d=e(157);class h extends s.j{constructor(n,t=null,i=null){super((0,d.vx)(n,t),i),this.storageKey=n,this.defaultValue=t}static create(n,t=null,i=null){return new h(n,t,i)}static createWithCompositeKey(n,t,i=null,A=null){const D=`${n}-${t}`;return new h(D,i,A)}updateValueFromEvent=n=>{const t=(0,l.s)(n),i=(0,C.$)(t);this.updateValue(i)};updateValue(n,t=!0){this.value!==n&&((0,d.Fg)(this.storageKey,n),this.value=n,t&&this.onChangeIfDefined())}clearValue(n=!1){this.updateValue(null,n)}resetValue(n=!1){this.updateValue(this.defaultValue,n)}}},3976:(F,m,e)=>{e.d(m,{$:()=>s});function s(l){return l===""?null:JSON.parse(l)}},4214:(F,m,e)=>{e.d(m,{zr:()=>l});function s(o){return o.replace(/\D/g,"")}function l(o){return o.replace(/[^\d.,-]/g,"")}function C(o){return o.replace(/\s/g,"")}function d(o){return o.charAt(0).toUpperCase()+o.slice(1)}function h(o){return o.replace(/\s+/g," ").trim()}},5406:(F,m,e)=>{e.d(m,{C$:()=>C,Fc:()=>s,W2:()=>t});function s(g,r="common",c=!1){const{pathname:u}=window.location;return l(u,g,r,c)}function l(g,r,c,u=!1){const f=g.split("/");r=r<0?f.length+r:r;const b=f[r]||c;return u&&console.log(`Pathname element: ${b}`),b}function C(g,r="common",c=!1){const u=s(g,"",c);return d(u,r,c)}function d(g,r,c){if(!g)return r;const u=g.split("-").at(-1);return c&&console.log(`Pathname element ending: ${u}`),u}function h(g,r,c="common",u=!1){const f=l(g,r,"",u);return d(f,c,u)}function o(g){return new URLSearchParams(window.location.search).get(g)}function n(g){return g.split("?")[0]}function t(g){return window.location.pathname.includes(g)}function i(g){return g.some(r=>t(r))}function A(g){return window.location.pathname.split("/").some(c=>c===g)}function D(g){try{const r=new URL(window.location.href);Object.entries(g).forEach(([c,u])=>{r.searchParams.set(c,u)}),window.location.href=r.toString()}catch(r){console.error("Failed to redirect:",r)}}function v(g,r=[]){const c={pathname:window.location.pathname};r.forEach(I=>{c[I]=o(I)});let u=!1;async function f(){if(u)return;const I={pathname:window.location.pathname};if(r.forEach(y=>{I[y]=o(y)}),Object.keys(c).some(y=>c[y]!==I[y])){Object.assign(c,I),u=!0;try{await g()}catch(y){console.error("Error in URL observer callback:",y)}finally{u=!1}}}function b(){f().catch(I=>{console.error("Error in URL change handler:",I)})}let U=window.location.href;setInterval(()=>{window.location.href!==U&&(U=window.location.href,b())},200),window.addEventListener("popstate",b)}function O(g=[]){v(()=>window.location.reload(),g)}},4010:(F,m,e)=>{e.a(F,async(s,l)=>{try{let o=function(){return(0,h.W2)("details")};var C=e(1901),d=e(2344),h=e(5406);o()?await(0,C.K)():await(0,d.P)(),l()}catch(o){l(o)}},1)},1926:(F,m,e)=>{e.d(m,{i:()=>s});const s={PRICE:"price",BALANCED_CASHBACK_PRICE:"balanced-cashback-price",COUPON:"applied-coupon",OBSERVED:"observed"}},1319:(F,m,e)=>{e.d(m,{Z:()=>C});var s=e(573),l=e(1926);function C(t,i,A,D){const v=(0,s.Fi)(i,t);return(d(v,D)||!v.hasAttribute(l.i.BALANCED_CASHBACK_PRICE))&&h(v,A,D),v}function d(t,i){if(t.hasAttribute(l.i.COUPON)){const A=+t.getAttribute(l.i.COUPON);return i!==A}return!!i}function h(t,i,A){let D=o(t);t.setAttribute(l.i.PRICE,D),A?(A<1?D=(D*(1-A)).toFixed():D-=A,t.setAttribute(l.i.COUPON,A)):t.removeAttribute(l.i.COUPON);const v=n(D,i),O=D-v;t.setAttribute(l.i.BALANCED_CASHBACK_PRICE,O);const g=`${D.toLocaleString()} (${O.toLocaleString()}) \u20BD`;t.innerText=g,t.title=`-${v.toLocaleString()}`}function o(t){return t.hasAttribute(l.i.PRICE)?+t.getAttribute(l.i.PRICE):(0,s.YA)(t,!0)}function n(t,i){const A=i/100;return(t*A/(1+A)).toFixed(0)}},4633:(F,m,e)=>{e.d(m,{r:()=>l});const s={INPUT:{border:"1px solid #e4ebf0",fontSize:"14px",borderRadius:"8px",marginLeft:"7px",padding:"8px 14px"}},l={CONTAINER:{display:"flex",gridGap:"15px",padding:"14px 5px"},CONTROL:{display:"flex",alignItems:"center",fontSize:"14px"},TEXT_INPUT:{...s.INPUT,width:"180px"},NUMBER_INPUT:{...s.INPUT},CHECKBOX_INPUT:{marginLeft:"7px",width:"23px",height:"23px"}}},2344:(F,m,e)=>{e.d(m,{P:()=>P});var s=e(4921),l=e(5213),C=e(1319),d=e(5406),h=e(4639),o=e(3829),n=e(5884),t=e(5539),i=e(573),A=e(7877),D=e(1926),v=e(4633),O=e(4521),g=e(5081);const r={PRODUCT_CARD_LIST_HEADER:".catalog-listing-controls",PRODUCT_CARD:".catalog-item-desktop",PRODUCT_CARD_PRICE:".catalog-item-regular-desktop__price",PRODUCT_CARD_CASHBACK:".bonus-percent",PRODUCT_CARD_TITLE:".catalog-item-regular-desktop__title-link",PRODUCT_CARD_DISCOUNT:".discount-percentage__value",PRODUCT_CARD_SELLER_NAME:".merchant-info__name"};var c=e(6754);const u=(0,g.B)((0,d.Fc)(2)),{createSectionFilter:f}=(0,O.z)(w,u),b=f("name-filter"),U=f("min-cashback-filter"),I=f("max-price-filter"),y=f("min-discount-filter"),M=f("seller-name-filter"),R=new h.a(!1,w);async function P(){await _();const E=await(0,s.xk)(document,"#app");new MutationObserver((0,s.sg)(_)).observe(E,{childList:!0,subtree:!0})}async function _(){const E=await(0,s.xk)(document,r.PRODUCT_CARD_LIST_HEADER);(0,l.b)(E,L);const p=E.parentNode;if(p.hasAttribute(D.i.OBSERVED))return;new MutationObserver((0,s.sg)(w,50)).observe(p,{childList:!0,subtree:!0}),p.setAttribute(D.i.OBSERVED,"")}function L(E,p){(0,c.ZM)(E,v.r.CONTAINER);const N=(0,A.E9)(b,v.r.CONTROL,v.r.TEXT_INPUT),S=(0,A.Ch)(U,v.r.CONTROL,v.r.NUMBER_INPUT),T=(0,A.H1)(I,v.r.CONTROL,v.r.NUMBER_INPUT,"250"),x=(0,A.VD)(y,v.r.CONTROL,v.r.NUMBER_INPUT),B=(0,n.Nm)("\u041F\u0440\u043E\u0434\u0430\u0432\u0435\u0446: ",M,v.r.CONTROL,v.r.TEXT_INPUT),W=(0,A.pW)(R,v.r.CONTROL,v.r.CHECKBOX_INPUT);E.append(N,S,T,x,B,W),p.append(E)}function w(){(0,i.fI)(r.PRODUCT_CARD).forEach(a)}function a(E){if(!R.value){(0,t.kl)(E);return}const p=(0,i.Fi)(r.PRODUCT_CARD_TITLE,E),N=(0,i.Fi)(r.PRODUCT_CARD_CASHBACK,E),S=(0,i.Fi)(r.PRODUCT_CARD_DISCOUNT,E);if(!p){(0,t.Bt)(E);return}const T=p.innerText,x=(0,i.YA)(N,!0,!1,0),B=Math.abs((0,i.YA)(S,!0,!1,0)),V=+(0,C.Z)(E,r.PRODUCT_CARD_PRICE,x).getAttribute(D.i.BALANCED_CASHBACK_PRICE),K=(0,i.Fi)(r.PRODUCT_CARD_SELLER_NAME,E),H=K?(0,o.Ay)(K.innerText,M):!1,G=(0,o.Ay)(T,b)||(0,o.JE)(x,U)||(0,o.iG)(V,I)||(0,o.JE)(B,y)||H;(0,t.UC)(E,G)}},1901:(F,m,e)=>{e.d(m,{K:()=>_});var s=e(4921),l=e(5081),C=e(5406),d=e(5213),h=e(4639),o=e(3829),n=e(5539),t=e(573),i=e(7877),A=e(5884),D=e(1319),v=e(1926),O=e(4633),g=e(4521);const r={APP:"#app",OFFERS_FILTER:".pdp-prices-filter",OFFERS_CONTAINER:".pdp-prices",OFFER:".pdp-prices .product-offer",PRICE:".product-offer-price__amount",CASHBACK:".bonus-percent",SELLER_RATING:".pdp-merchant-rating-block__rating"};var c=e(6754);const u=(0,l.B)((0,C.C$)(3)),{createGlobalFilter:f,createSectionFilter:b}=(0,g.z)(a,u),U=b("min-cashback-filter"),I=b("max-price-filter"),y=b("max-discounted-price-filter"),M=f("min-seller-rating-filter"),R=new h.a(null,a),P=f("filter-enabled",!1);async function _(){await L();const p=await(0,s.xk)(document,r.APP);new MutationObserver((0,s.sg)(L)).observe(p,{childList:!0})}async function L(){const p=await(0,s.xk)(document,r.OFFERS_FILTER);(0,d.b)(p,w),a();const N=(0,t.Fi)(r.OFFERS_CONTAINER);if(N.hasAttribute(v.i.OBSERVED))return;new MutationObserver((0,s.sg)(a,50)).observe(N,{childList:!0,subtree:!0}),N.setAttribute(v.i.OBSERVED,"")}function w(p,N){(0,c.ZM)(p,O.r.CONTAINER);const S=(0,i.Ch)(U,O.r.CONTROL,O.r.NUMBER_INPUT),T=(0,i.H1)(I,O.r.CONTROL,O.r.NUMBER_INPUT,"250"),x=(0,i.Zi)("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430 \u0441\u043E \u0441\u043A\u0438\u0434\u043A\u043E\u0439: ",y,O.r.CONTROL,O.r.NUMBER_INPUT),B=(0,i.HX)(M,O.r.CONTROL,O.r.NUMBER_INPUT),W=(0,A.nW)("\u041A\u0443\u043F\u043E\u043D: ",R,"500","0","100000",O.r.CONTROL,O.r.NUMBER_INPUT),V=(0,i.pW)(P,O.r.CONTROL,O.r.CHECKBOX_INPUT);p.append(S,T,x,B,W,V),N.append(p)}function a(){(0,t.fI)(r.OFFER).forEach(E)}function E(p){if(!P.value){(0,n.kl)(p);return}const N=(0,t.Fi)(r.PRICE,p),S=(0,t.Fi)(r.CASHBACK,p),T=(0,t.Fi)(r.SELLER_RATING,p);if(!N||!S||!T){(0,n.Bt)(p);return}const x=(0,t.YA)(S,!0),B=(0,D.Z)(p,r.PRICE,x,R.value),W=+B.getAttribute(v.i.PRICE),V=+B.getAttribute(v.i.BALANCED_CASHBACK_PRICE),K=(0,t.YA)(T,!0),H=(0,o.JE)(x,U)||(0,o.iG)(W,I)||(0,o.iG)(V,y)||(0,o.JE)(K,M);(0,n.UC)(p,H)}}},$={};function k(F){var m=$[F];if(m!==void 0)return m.exports;var e=$[F]={exports:{}};return j[F](e,e.exports,k),e.exports}(()=>{var F=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",m=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",e=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",s=C=>{C&&C.d<1&&(C.d=1,C.forEach(d=>d.r--),C.forEach(d=>d.r--?d.r++:d()))},l=C=>C.map(d=>{if(d!==null&&typeof d=="object"){if(d[F])return d;if(d.then){var h=[];h.d=0,d.then(t=>{o[m]=t,s(h)},t=>{o[e]=t,s(h)});var o={};return o[F]=t=>t(h),o}}var n={};return n[F]=t=>{},n[m]=d,n});k.a=(C,d,h)=>{var o;h&&((o=[]).d=-1);var n=new Set,t=C.exports,i,A,D,v=new Promise((O,g)=>{D=g,A=O});v[m]=t,v[F]=O=>(o&&O(o),n.forEach(O),v.catch(g=>{})),C.exports=v,d(O=>{i=l(O);var g,r=()=>i.map(u=>{if(u[e])throw u[e];return u[m]}),c=new Promise(u=>{g=()=>u(r),g.r=0;var f=b=>b!==o&&!n.has(b)&&(n.add(b),b&&!b.d&&(g.r++,b.push(g)));i.map(b=>b[F](f))});return g.r?c:r()},O=>(O?D(v[e]=O):A(t),s(o))),o&&o.d<0&&(o.d=0)}})(),k.d=(F,m)=>{for(var e in m)k.o(m,e)&&!k.o(F,e)&&Object.defineProperty(F,e,{enumerable:!0,get:m[e]})},k.o=(F,m)=>Object.prototype.hasOwnProperty.call(F,m);var z=k(4010)})();})();
