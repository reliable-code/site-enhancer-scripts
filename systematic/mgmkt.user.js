// ==UserScript==
// @name         MegaMarket product cards & offers filter
// @description  Hide product cards & offers by filter
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://megamarket.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.75784579
// @icon         https://www.google.com/s2/favicons?sz=64&domain=megamarket.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/mgmkt.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var j={5467:(T,m,e)=>{e.d(m,{E2:()=>s});var c=e(9928);function s(C,r={},t=null){const n=(0,c.Sw)(r,t);return n.append(C),n}function p(C,r=null,t={},n={}){const f=createActionLink(C,r,n);return s(f,t)}function l(C,r=null,t=null,n={},f={}){const b=createActionLinkWithIcon(C,t,r,f);return s(b,n)}},9928:(T,m,e)=>{e.d(m,{S:()=>C,Sw:()=>v,kU:()=>p,o5:()=>l});var c=e(4921),s=e(6754);function p(i,u,d){const h=r(i,"text",u);return h.value=d,h}function l(i,u,d,h,y,N){const F=r(i,"number",u);return F.value=d,F.step=h,F.min=y,F.max=N,F}function C(i,u,d){const h=r(i,"checkbox",u);return h.checked=d,h}function r(i={},u=null,d=null){const h=o("input",i);return u&&(h.type=u),d&&(h.addEventListener("keyup",(0,c.sg)(d,200)),h.addEventListener("change",(0,c.sg)(d,100))),h}function t(i={},u=null){return o("span",i,u)}function n(i={},u=null,d=null){const h=o("a",i,u);return d&&(h.href=d),h}function f(i,u=null,d={}){d.cursor||="pointer";const h=n(d,u);return i&&h.addEventListener("click",i),h}function b(i,u,d=null,h={},y={}){h.display||="inline-flex",h.alignItems||="center",h.gap||="0.25em";const N=f(i,d,h);return N.prepend(O(u,y)),N}function g(i={},u=null,d=null){const h=o("button",i,u);return d&&h.addEventListener("click",d),h}function v(i={},u=null){return o("div",i,u)}function R(i={}){return o("i",i)}function O(i,u={}){u.width||="1em",u.height||="1em",u.paddingBottom||="1px";const d=R(u);return d.setAttribute("data-lucide",i),d}function o(i,u,d=null){if(typeof u!="object"||u===null)throw new TypeError("styles should be an object");const h=document.createElement(i);return(0,s.ZM)(h,u),d&&(h.innerHTML=d),h}},573:(T,m,e)=>{e.d(m,{Fi:()=>p,YA:()=>n,fI:()=>l});var c=e(4214);function s(o,i=document){return!!i.querySelector(o)}function p(o,i=document,u=!1){const d=i.querySelector(o);return u&&!d&&console.log(`No element found for selector: ${o}`),d}function l(o,i=document,u=!1){const d=i.querySelectorAll(o);return u&&!d.length&&console.log(`No elements found for selector: ${o}`),d}function C(o,i=1){let u=o;for(let d=0;d<i;d++){if(!u.parentElement)return null;u=u.parentElement}return u}function r(o,i,u){return[...o.querySelectorAll(i)].find(d=>d.textContent.trim().includes(u))}function t(o,i,u=!1,d=!1,h=null){const y=p(i,o);return n(y,u,d,h)}function n(o,i=!1,u=!1,d=null){if(!o)return d===null?(console.log("No element found"),null):d;const h=o.innerText;return g(h,i,u)}function f(o,i,u=!1){const d=o[i];return n(d,u)}function b(o,i=!1,u=!1){const d=o.textContent;return g(d,i,u)}function g(o,i,u){i&&(o=(0,c.zr)(o)),u&&(o=o.replace(",","."));const d=Number(o);return Number.isNaN(d)?(console.log(`Invalid number: ${o}`),0):d}function v(o){return[...o.childNodes].find(i=>i.nodeType===Node.TEXT_NODE)}function R(o){const i=u=>u.nodeType===Node.TEXT_NODE&&u.textContent.trim()!==""?[u]:[...u.childNodes].flatMap(i);return i(o)}function O(o){return normalizeSpacing(o.textContent)}},5539:(T,m,e)=>{e.d(m,{Bt:()=>s,UC:()=>f,kl:()=>t});function c(a,E){a.parentNode.insertBefore(E,a.nextSibling)}function s(a){a.style.display="none"}function p(a,E=1){const P=document.querySelector(a);P&&l(P,E)}function l(a,E=1){const P=getElementAncestor(a,E);P&&s(P)}function C(a){v(a),s(a)}function r(a){a.intersectionObserver||runOnceOnIntersection(a,()=>s(a))}function t(a){a.style.display=""}function n(a){const E=g(a);a.style.display=E}function f(a,E){E?s(a):t(a)}function b(a,E){E?r(a):(clearIntersectionObserver(a),t(a))}function g(a){return v(a),a.defaultDisplay}function v(a){if(a.defaultDisplay)return;const{display:E}=getComputedStyle(a);a.defaultDisplay=E}function R(){return{show:[],hide:[]}}function O(a,E,P){a?E.hide.push(P):E.show.push(P)}function o(a){a.show.forEach(t),a.hide.forEach(s)}function i(a,E,P=.3){E?d(a,P):u(a)}function u(a){a.style.opacity=""}function d(a,E=.3){a.style.opacity=E}function h(a){a.style.order=""}function y(a,E){a.style.order=E}function N(a,E){a.style.background=E}function F(a,E){const P=getFirstElement(E);P&&A(a,P)}function A(a,E){const P=createLink();P.href=a,E.parentNode.append(P),P.append(E)}function _(a,E){const P=getFirstElement(E);P&&D(a,P)}function D(a,E){const P=createLink();P.href=a,P.append(...E.childNodes),E.append(P)}function I(){const a=getURLQueryParam("scrollTo");if(!a)return;const E=document.getElementById(a);E?E.scrollIntoView():console.log(`Element with ID "${a}" was not found.`)}function w(a,E,P){const L=`${P}-click-passed`;return function(U){if(U.hasAttribute(L))return;const S=findElementByText(U,a,E);S&&S.click(),U.setAttribute(L,"")}}function k(a,E,P="text/plain"){const L=new Blob([a],{type:P}),U=URL.createObjectURL(L),S=document.createElement("a");S.href=U,S.download=E,document.body.appendChild(S),S.click(),document.body.removeChild(S),requestAnimationFrame(()=>URL.revokeObjectURL(U))}},6754:(T,m,e)=>{e.d(m,{ZM:()=>c});function c(C,r){Object.assign(C.style,r)}function s(C,r="custom-global-style"){let t=document.getElementById(r);t||(t=document.createElement("style"),t.id=r,t.type="text/css",document.head.appendChild(t)),t.textContent=C}function p(C){return Object.entries(C).map(([r,t])=>`${r.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${t};`).join(" ")}function l(C){return C?C.split(";").filter(r=>r.trim()!=="").reduce((r,t)=>{const[n,f]=t.split(":").map(g=>g.trim()),b=n.replace(/-([a-z])/g,(g,v)=>v.toUpperCase());return r[b]=f,r},{}):{}}},4921:(T,m,e)=>{e.d(m,{sg:()=>l,xk:()=>c});function c(t,n,f=null){const b=t.querySelector(n);return b?Promise.resolve(b):new Promise(g=>{const v=new MutationObserver(O);v.observe(t,{childList:!0,subtree:!0});let R;f&&(R=setTimeout(()=>{v.disconnect(),console.log(`No element found for selector: ${n}`),g(null)},f));function O(){const o=t.querySelector(n);o&&(R&&clearTimeout(R),v.disconnect(),g(o))}})}function s(t,n){return t.querySelector(n)?new Promise(b=>{const g=new MutationObserver(v);g.observe(t,{childList:!0,subtree:!0});function v(){t.querySelector(n)||(g.disconnect(),b())}}):Promise.resolve()}function p(t,n=400){return new Promise(f=>{let b;const g=new MutationObserver(()=>{clearTimeout(b),v()});function v(){b=setTimeout(()=>{g.disconnect(),f()},n)}v(),g.observe(t,{childList:!0,subtree:!0})})}function l(t,n=250){let f;return(...b)=>{clearTimeout(f),f=setTimeout(()=>t(...b),n)}}function C(t,n){const f=new IntersectionObserver(b=>{b.forEach(g=>{g.isIntersecting&&(n(),r(t))})});t.intersectionObserver=f,f.observe(t)}function r(t){t.intersectionObserver&&(t.intersectionObserver.disconnect(),t.intersectionObserver=null)}},3829:(T,m,e)=>{e.d(m,{Ay:()=>s,JE:()=>l,iG:()=>C});var c=e(8355);function s(t,n){return!p(t,n)}function p(t,n){if(!n.value)return!0;const f=t.toLowerCase(),b=(0,c.R)(n),g=[],v=[];return b.forEach(R=>{if(R.startsWith("!")){const O=R.substring(1);O&&v.push(O)}else g.push(R)}),g.every(R=>f.includes(R))&&v.every(R=>!f.includes(R))}function l(t,n){return n.value!=null&&t<n.value}function C(t,n){return n.value!=null&&t>n.value}function r(t,n){return n.value&&t!==n.value}},4521:(T,m,e)=>{e.d(m,{z:()=>s});var c=e(3048);function s(p,l=null){return{createGlobalFilter(C,r=null,t=p){return c.V.create(C,r,t)},createSectionFilter(C,r=null,t=p){if(!l)throw new Error("sectionId must be provided to use createSectionFilter.");return c.V.createWithCompositeKey(l,C,r,t)}}}},5884:(T,m,e)=>{e.d(m,{Hw:()=>C,Nm:()=>p,nW:()=>l});var c=e(9928),s=e(5467);function p(r,t,n={},f={}){const b=(0,c.kU)(f,t.updateValueFromEvent,t.value);return(0,s.E2)(b,n,r)}function l(r,t,n,f,b,g={},v={}){const R=(0,c.o5)(v,t.updateValueFromEvent,t.value,n,f,b);return(0,s.E2)(R,g,r)}function C(r,t,n={},f={}){const b=(0,c.S)(f,t.updateValueFromEvent,t.value);return(0,s.E2)(b,n,r)}},7877:(T,m,e)=>{e.d(m,{Ch:()=>b,E9:()=>s,H1:()=>R,HX:()=>p,VD:()=>n,Zi:()=>g,pW:()=>F});var c=e(5884);function s(A,_={},D={}){return(0,c.Nm)("\u041F\u043E\u0438\u0441\u043A: ",A,_,D)}function p(A,_={},D={},I=.1,w=3){return(0,c.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",A,I,w,5,_,D)}function l(A,_={},D={},I=.1,w=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",A,I,w,5,_,D)}function C(A,_={},D={}){return t("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",A,_,D)}function r(A,_={},D={}){return t("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",A,_,D)}function t(A,_,D={},I={}){return createNumberFilterControl(A,_,"1","1","999999",D,I)}function n(A,_={},D={}){return f("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",A,_,D)}function f(A,_,D={},I={}){return(0,c.nW)(A,_,"5","0","100",D,I)}function b(A,_={},D={}){return(0,c.nW)("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",A,"5","0","100",_,D)}function g(A,_,D={},I={},w="250"){return(0,c.nW)(A,_,w,"0","1000000",D,I)}function v(A,_={},D={},I="25"){return g("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",A,_,D,I)}function R(A,_={},D={},I="25"){return g("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",A,_,D,I)}function O(A,_={},D={}){return o("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",A,_,D)}function o(A,_,D={},I={}){return createNumberFilterControl(A,_,"1","0","99999",D,I)}function i(A,_={},D={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",A,"1","2","7",_,D)}function u(A,_={},D={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",A,1,1,10,_,D)}function d(A,_={},D={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",A,_,D)}function h(A,_={},D={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",A,_,D)}function y(A,_={},D={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",A,_,D)}function N(A,_={},D={}){return createCheckboxFilterControl("\u0411\u0430\u043B\u043B\u044B: ",A,_,D)}function F(A,_={},D={}){return(0,c.Hw)("\u0412\u043A\u043B: ",A,_,D)}},8355:(T,m,e)=>{e.d(m,{R:()=>c});function c(p){return p.value.toLowerCase().split(",").map(l=>l.trim()).filter(l=>l!=="")}function s(p){return c(p).filter(l=>!l.startsWith("!"))}},5213:(T,m,e)=>{e.d(m,{b:()=>p});var c=e(9928),s=e(573);function p(l,C,r=!1,t="customFiltersContainer"){let n=(0,s.Fi)(`#${t}`,l);if(n)if(r)n.remove();else return;n=(0,c.Sw)(),n.id=t,C(n,l)}},4444:(T,m,e)=>{e.d(m,{s:()=>c});function c(s){let C=2166136261;for(let r=0;r<s.length;r+=1){const t=s.charCodeAt(r);C^=t,C=Math.imul(C,16777619)}return C>>>0}},5081:(T,m,e)=>{e.d(m,{B:()=>p});var c=e(4444);function s(l){return(0,c.s)(l).toString(16).padStart(8,"0")}function p(l,C="common"){return l?s(l):C}},8200:(T,m,e)=>{e.d(m,{s:()=>c});function c(s){const{target:p}=s,{type:l}=p;switch(l){case"text":return`"${p.value}"`;case"number":return p.value;case"checkbox":return p.checked;default:return console.log(`Unknown input type: ${l}`),null}}},157:(T,m,e)=>{e.d(m,{Fg:()=>c,vx:()=>p});const c=window.GM_setValue,s=window.GM.setValue,p=window.GM_getValue},4639:(T,m,e)=>{e.d(m,{a:()=>l});var c=e(1870),s=e(8200),p=e(3976);class l extends c.j{constructor(r=null,t=null){super(r,t)}updateValueFromEvent=r=>{const t=(0,p.$)((0,s.s)(r));this.value!==t&&(this.value=t,this.onChangeIfDefined())}}},1870:(T,m,e)=>{e.d(m,{j:()=>c});class c{constructor(p,l){this.value=p,this.onChange=l}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(T,m,e)=>{e.d(m,{V:()=>C});var c=e(1870),s=e(8200),p=e(3976),l=e(157);class C extends c.j{constructor(t,n=null,f=null){super((0,l.vx)(t,n),f),this.storageKey=t,this.defaultValue=n}static create(t,n=null,f=null){return new C(t,n,f)}static createWithCompositeKey(t,n,f=null,b=null){const g=`${t}-${n}`;return new C(g,f,b)}updateValueFromEvent=t=>{const n=(0,s.s)(t),f=(0,p.$)(n);this.updateValue(f)};updateValue(t,n=!0){this.value!==t&&((0,l.Fg)(this.storageKey,t),this.value=t,n&&this.onChangeIfDefined())}clearValue(t=!1){this.updateValue(null,t)}resetValue(t=!1){this.updateValue(this.defaultValue,t)}}},3976:(T,m,e)=>{e.d(m,{$:()=>c});function c(s){return s===""?null:JSON.parse(s)}},4214:(T,m,e)=>{e.d(m,{zr:()=>s});function c(r){return r.replace(/\D/g,"")}function s(r){return r.replace(/[^\d.,-]/g,"")}function p(r){return r.replace(/\s/g,"")}function l(r){return r.charAt(0).toUpperCase()+r.slice(1)}function C(r){return r.replace(/\s+/g," ").trim()}},5406:(T,m,e)=>{e.d(m,{C$:()=>p,Fc:()=>c,W2:()=>n});function c(O,o="common",i=!1){const{pathname:u}=window.location;return s(u,O,o,i)}function s(O,o,i,u=!1){const d=O.split("/");o=o<0?d.length+o:o;const h=d[o]||i;return u&&console.log(`Pathname element: ${h}`),h}function p(O,o="common",i=!1){const u=c(O,"",i);return l(u,o,i)}function l(O,o,i){if(!O)return o;const u=O.split("-").at(-1);return i&&console.log(`Pathname element ending: ${u}`),u}function C(O,o,i="common",u=!1){const d=s(O,o,"",u);return l(d,i,u)}function r(O){return new URLSearchParams(window.location.search).get(O)}function t(O){return O.split("?")[0]}function n(O){return window.location.pathname.includes(O)}function f(O){return O.some(o=>n(o))}function b(O){return window.location.pathname.split("/").some(i=>i===O)}function g(O){try{const o=new URL(window.location.href);Object.entries(O).forEach(([i,u])=>{o.searchParams.set(i,u)}),window.location.href=o.toString()}catch(o){console.error("Failed to redirect:",o)}}function v(O,o=[]){const i={pathname:window.location.pathname};o.forEach(N=>{i[N]=r(N)});let u=!1;async function d(){if(u)return;const N={pathname:window.location.pathname};if(o.forEach(F=>{N[F]=r(F)}),Object.keys(i).some(F=>i[F]!==N[F])){Object.assign(i,N),u=!0;try{await O()}catch(F){console.error("Error in URL observer callback:",F)}finally{u=!1}}}function h(){d().catch(N=>{console.error("Error in URL change handler:",N)})}let y=window.location.href;setInterval(()=>{window.location.href!==y&&(y=window.location.href,h())},200),window.addEventListener("popstate",h)}function R(O=[]){v(()=>window.location.reload(),O)}},4010:(T,m,e)=>{e.a(T,async(c,s)=>{try{let r=function(){return(0,C.W2)("details")};var p=e(1901),l=e(2344),C=e(5406);r()?await(0,p.K)():await(0,l.P)(),s()}catch(r){s(r)}},1)},1926:(T,m,e)=>{e.d(m,{i:()=>c});const c={PRICE:"price",BALANCED_CASHBACK_PRICE:"balanced-cashback-price",COUPON:"applied-coupon",OBSERVED:"observed"}},1319:(T,m,e)=>{e.d(m,{Z:()=>p});var c=e(573),s=e(1926);function p(n,f,b,g){const v=(0,c.Fi)(f,n);return(l(v,g)||!v.hasAttribute(s.i.BALANCED_CASHBACK_PRICE))&&C(v,b,g),v}function l(n,f){if(n.hasAttribute(s.i.COUPON)){const b=+n.getAttribute(s.i.COUPON);return f!==b}return!!f}function C(n,f,b){let g=r(n);n.setAttribute(s.i.PRICE,g),b?(b<1?g=(g*(1-b)).toFixed():g-=b,n.setAttribute(s.i.COUPON,b)):n.removeAttribute(s.i.COUPON);const v=t(g,f),R=g-v;n.setAttribute(s.i.BALANCED_CASHBACK_PRICE,R);const O=`${g.toLocaleString()} (${R.toLocaleString()}) \u20BD`;n.innerText=O,n.title=`-${v.toLocaleString()}`}function r(n){return n.hasAttribute(s.i.PRICE)?+n.getAttribute(s.i.PRICE):(0,c.YA)(n,!0)}function t(n,f){const b=f/100;return(n*b/(1+b)).toFixed(0)}},4633:(T,m,e)=>{e.d(m,{r:()=>s});const c={INPUT:{border:"1px solid #e4ebf0",fontSize:"14px",borderRadius:"8px",marginLeft:"7px",padding:"8px 14px"}},s={CONTAINER:{display:"flex",gridGap:"15px",padding:"14px 5px"},CONTROL:{display:"flex",alignItems:"center",fontSize:"14px"},TEXT_INPUT:{...c.INPUT,width:"180px"},NUMBER_INPUT:{...c.INPUT},CHECKBOX_INPUT:{marginLeft:"7px",width:"23px",height:"23px"}}},2344:(T,m,e)=>{e.d(m,{P:()=>D});var c=e(4921),s=e(5213),p=e(1319),l=e(5406),C=e(4639),r=e(3829),t=e(5884),n=e(5539),f=e(573),b=e(7877),g=e(1926),v=e(4633),R=e(4521),O=e(5081);const o={PRODUCT_CARD_LIST_HEADER:".catalog-listing-controls",PRODUCT_CARD:".catalog-item-desktop",PRODUCT_CARD_PRICE:".catalog-item-regular-desktop__price",PRODUCT_CARD_CASHBACK:".bonus-percent",PRODUCT_CARD_TITLE:".catalog-item-regular-desktop__title-link",PRODUCT_CARD_DISCOUNT:".discount-percentage__value",PRODUCT_CARD_SELLER_NAME:".merchant-info__name"};var i=e(6754);const u=(0,O.B)((0,l.Fc)(2)),{createSectionFilter:d}=(0,R.z)(k,u),h=d("name-filter"),y=d("min-cashback-filter"),N=d("max-price-filter"),F=d("min-discount-filter"),A=d("seller-name-filter"),_=new C.a(!1,k);async function D(){await I();const E=await(0,c.xk)(document,"#app");new MutationObserver((0,c.sg)(I)).observe(E,{childList:!0,subtree:!0})}async function I(){const E=await(0,c.xk)(document,o.PRODUCT_CARD_LIST_HEADER);(0,s.b)(E,w);const P=E.parentNode;if(P.hasAttribute(g.i.OBSERVED))return;new MutationObserver((0,c.sg)(k,50)).observe(P,{childList:!0,subtree:!0}),P.setAttribute(g.i.OBSERVED,"")}function w(E,P){(0,i.ZM)(E,v.r.CONTAINER);const L=(0,b.E9)(h,v.r.CONTROL,v.r.TEXT_INPUT),U=(0,b.Ch)(y,v.r.CONTROL,v.r.NUMBER_INPUT),S=(0,b.H1)(N,v.r.CONTROL,v.r.NUMBER_INPUT,"250"),M=(0,b.VD)(F,v.r.CONTROL,v.r.NUMBER_INPUT),x=(0,t.Nm)("\u041F\u0440\u043E\u0434\u0430\u0432\u0435\u0446: ",A,v.r.CONTROL,v.r.TEXT_INPUT),W=(0,b.pW)(_,v.r.CONTROL,v.r.CHECKBOX_INPUT);E.append(L,U,S,M,x,W),P.append(E)}function k(){(0,f.fI)(o.PRODUCT_CARD).forEach(a)}function a(E){if(!_.value){(0,n.kl)(E);return}const P=(0,f.Fi)(o.PRODUCT_CARD_TITLE,E),L=(0,f.Fi)(o.PRODUCT_CARD_CASHBACK,E),U=(0,f.Fi)(o.PRODUCT_CARD_DISCOUNT,E);if(!P){(0,n.Bt)(E);return}const S=P.innerText,M=(0,f.YA)(L,!0,!1,0),x=Math.abs((0,f.YA)(U,!0,!1,0)),K=+(0,p.Z)(E,o.PRODUCT_CARD_PRICE,M).getAttribute(g.i.BALANCED_CASHBACK_PRICE),V=(0,f.Fi)(o.PRODUCT_CARD_SELLER_NAME,E),H=V?(0,r.Ay)(V.innerText,A):!1,G=(0,r.Ay)(S,h)||(0,r.JE)(M,y)||(0,r.iG)(K,N)||(0,r.JE)(x,F)||H;(0,n.UC)(E,G)}},1901:(T,m,e)=>{e.d(m,{K:()=>I});var c=e(4921),s=e(5081),p=e(5406),l=e(5213),C=e(4639),r=e(3829),t=e(5539),n=e(573),f=e(7877),b=e(5884),g=e(1319),v=e(1926),R=e(4633),O=e(4521);const o={APP:"#app",OFFERS_FILTER:".pdp-prices-filter",OFFERS_CONTAINER:".pdp-prices",OFFER:".pdp-prices .product-offer",PRICE:".product-offer-price__amount",CASHBACK:".bonus-percent",SELLER_RATING:".pdp-merchant-rating-block__rating"};var i=e(6754);const u=(0,s.B)((0,p.C$)(3)),{createGlobalFilter:d,createSectionFilter:h}=(0,O.z)(a,u),y=h("min-cashback-filter"),N=h("max-price-filter"),F=h("max-discounted-price-filter"),A=d("min-seller-rating-filter"),_=new C.a(null,a),D=d("filter-enabled",!1);async function I(){await w();const P=await(0,c.xk)(document,o.APP);new MutationObserver((0,c.sg)(w)).observe(P,{childList:!0})}async function w(){const P=await(0,c.xk)(document,o.OFFERS_FILTER);(0,l.b)(P,k),a();const L=(0,n.Fi)(o.OFFERS_CONTAINER);if(L.hasAttribute(v.i.OBSERVED))return;new MutationObserver((0,c.sg)(a,50)).observe(L,{childList:!0,subtree:!0}),L.setAttribute(v.i.OBSERVED,"")}function k(P,L){(0,i.ZM)(P,R.r.CONTAINER);const U=(0,f.Ch)(y,R.r.CONTROL,R.r.NUMBER_INPUT),S=(0,f.H1)(N,R.r.CONTROL,R.r.NUMBER_INPUT,"250"),M=(0,f.Zi)("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430 \u0441\u043E \u0441\u043A\u0438\u0434\u043A\u043E\u0439: ",F,R.r.CONTROL,R.r.NUMBER_INPUT),x=(0,f.HX)(A,R.r.CONTROL,R.r.NUMBER_INPUT),W=(0,b.nW)("\u041A\u0443\u043F\u043E\u043D: ",_,"500","0","100000",R.r.CONTROL,R.r.NUMBER_INPUT),K=(0,f.pW)(D,R.r.CONTROL,R.r.CHECKBOX_INPUT);P.append(U,S,M,x,W,K),L.append(P)}function a(){(0,n.fI)(o.OFFER).forEach(E)}function E(P){if(!D.value){(0,t.kl)(P);return}const L=(0,n.Fi)(o.PRICE,P),U=(0,n.Fi)(o.CASHBACK,P),S=(0,n.Fi)(o.SELLER_RATING,P);if(!L||!U||!S){(0,t.Bt)(P);return}const M=(0,n.YA)(U,!0),x=(0,g.Z)(P,o.PRICE,M,_.value),W=+x.getAttribute(v.i.PRICE),K=+x.getAttribute(v.i.BALANCED_CASHBACK_PRICE),V=(0,n.YA)(S,!0),H=(0,r.JE)(M,y)||(0,r.iG)(W,N)||(0,r.iG)(K,F)||(0,r.JE)(V,A);(0,t.UC)(P,H)}}},$={};function B(T){var m=$[T];if(m!==void 0)return m.exports;var e=$[T]={exports:{}};return j[T](e,e.exports,B),e.exports}(()=>{var T=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",m=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",e=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",c=p=>{p&&p.d<1&&(p.d=1,p.forEach(l=>l.r--),p.forEach(l=>l.r--?l.r++:l()))},s=p=>p.map(l=>{if(l!==null&&typeof l=="object"){if(l[T])return l;if(l.then){var C=[];C.d=0,l.then(n=>{r[m]=n,c(C)},n=>{r[e]=n,c(C)});var r={};return r[T]=n=>n(C),r}}var t={};return t[T]=n=>{},t[m]=l,t});B.a=(p,l,C)=>{var r;C&&((r=[]).d=-1);var t=new Set,n=p.exports,f,b,g,v=new Promise((R,O)=>{g=O,b=R});v[m]=n,v[T]=R=>(r&&R(r),t.forEach(R),v.catch(O=>{})),p.exports=v,l(R=>{f=s(R);var O,o=()=>f.map(u=>{if(u[e])throw u[e];return u[m]}),i=new Promise(u=>{O=()=>u(o),O.r=0;var d=h=>h!==r&&!t.has(h)&&(t.add(h),h&&!h.d&&(O.r++,h.push(O)));f.map(h=>h[T](d))});return O.r?i:o()},R=>(R?g(v[e]=R):b(n),c(r))),r&&r.d<0&&(r.d=0)}})(),B.d=(T,m)=>{for(var e in m)B.o(m,e)&&!B.o(T,e)&&Object.defineProperty(T,e,{enumerable:!0,get:m[e]})},B.o=(T,m)=>Object.prototype.hasOwnProperty.call(T,m);var z=B(4010)})();})();
