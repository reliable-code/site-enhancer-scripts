// ==UserScript==
// @name         MegaMarket product cards & offers filter
// @description  Hide product cards & offers by filter
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://megamarket.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.76081468
// @icon         https://www.google.com/s2/favicons?sz=64&domain=megamarket.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/mgmkt.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var j={5467:(T,m,e)=>{e.d(m,{E2:()=>l});var s=e(9928);function l(C,o={},n=null){const t=(0,s.Sw)(o,n);return t.append(C),t}function p(C,o=null,n={},t={}){const i=createActionLink(C,o,t);return l(i,n)}function d(C,o=null,n=null,t={},i={}){const P=createActionLinkWithIcon(C,n,o,i);return l(P,t)}},9928:(T,m,e)=>{e.d(m,{S:()=>C,Sw:()=>h,kU:()=>p,o5:()=>d});var s=e(4921),l=e(6754);function p(c,u,f){const v=o(c,"text",u);return v.value=f,v}function d(c,u,f,v,x,I){const S=o(c,"number",u);return S.value=f,S.step=v,S.min=x,S.max=I,S}function C(c,u,f){const v=o(c,"checkbox",u);return v.checked=f,v}function o(c={},u=null,f=null){const v=r("input",c);return u&&(v.type=u),f&&(v.addEventListener("keyup",(0,s.sg)(f,200)),v.addEventListener("change",(0,s.sg)(f,100))),v}function n(c={},u=null){return r("span",c,u)}function t(c={},u=null,f=null){const v=r("a",c,u);return f&&(v.href=f),v}function i(c,u=null,f={}){f.cursor||="pointer";const v=t(f,u);return c&&v.addEventListener("click",c),v}function P(c,u,f=null,v={},x={}){v.display||="inline-flex",v.alignItems||="center",v.gap||="0.25em";const I=i(c,f,v);return I.prepend(g(u,x)),I}function D(c={},u=null,f=null){const v=r("button",c,u);return f&&v.addEventListener("click",f),v}function h(c={},u=null){return r("div",c,u)}function O(c={}){return r("i",c)}function g(c,u={}){u.width||="1em",u.height||="1em",u.paddingBottom||="1px";const f=O(u);return f.setAttribute("data-lucide",c),f}function r(c,u,f=null){if(typeof u!="object"||u===null)throw new TypeError("styles should be an object");const v=document.createElement(c);return(0,l.ZM)(v,u),f&&(v.innerHTML=f),v}},573:(T,m,e)=>{e.d(m,{Fi:()=>p,YA:()=>t,fI:()=>d});var s=e(4214);function l(r,c=document){return!!c.querySelector(r)}function p(r,c=document,u=!1){const f=c.querySelector(r);return u&&!f&&console.log(`No element found for selector: ${r}`),f}function d(r,c=document,u=!1){const f=c.querySelectorAll(r);return u&&!f.length&&console.log(`No elements found for selector: ${r}`),f}function C(r,c=1){let u=r;for(let f=0;f<c;f++){if(!u.parentElement)return null;u=u.parentElement}return u}function o(r,c,u){return[...r.querySelectorAll(c)].find(f=>f.textContent.trim().includes(u))}function n(r,c,u=!1,f=!1,v=null){const x=p(c,r);return t(x,u,f,v)}function t(r,c=!1,u=!1,f=null){if(!r)return f===null?(console.log("No element found"),null):f;const v=r.innerText;return D(v,c,u)}function i(r,c,u=!1){const f=r[c];return t(f,u)}function P(r,c=!1,u=!1){const f=r.textContent;return D(f,c,u)}function D(r,c,u){c&&(r=(0,s.zr)(r)),u&&(r=r.replace(",","."));const f=Number(r);return Number.isNaN(f)?(console.log(`Invalid number: ${r}`),0):f}function h(r){return[...r.childNodes].find(c=>c.nodeType===Node.TEXT_NODE)}function O(r){const c=u=>u.nodeType===Node.TEXT_NODE&&u.textContent.trim()!==""?[u]:[...u.childNodes].flatMap(c);return c(r)}function g(r){return normalizeSpacing(r.textContent)}},5539:(T,m,e)=>{e.d(m,{Bt:()=>l,UC:()=>i,kl:()=>n});function s(a,E){a.parentNode.insertBefore(E,a.nextSibling)}function l(a){a.style.display="none"}function p(a,E=1){const b=document.querySelector(a);b&&d(b,E)}function d(a,E=1){const b=getElementAncestor(a,E);b&&l(b)}function C(a){h(a),l(a)}function o(a){a.intersectionObserver||runOnceOnIntersection(a,()=>l(a))}function n(a){a.style.display=""}function t(a){const E=D(a);a.style.display=E}function i(a,E){E?l(a):n(a)}function P(a,E){E?o(a):(clearIntersectionObserver(a),n(a))}function D(a){return h(a),a.defaultDisplay}function h(a){if(a.defaultDisplay)return;const{display:E}=getComputedStyle(a);a.defaultDisplay=E}function O(){return{show:[],hide:[]}}function g(a,E,b){a?E.hide.push(b):E.show.push(b)}function r(a){a.show.forEach(n),a.hide.forEach(l)}function c(a,E,b=.3){E?f(a,b):u(a)}function u(a){a.style.opacity=""}function f(a,E=.3){a.style.opacity=E}function v(a){a.style.order=""}function x(a,E){a.style.order=E}function I(a,E){a.style.background=E}function S(a,E){const b=getFirstElement(E);b&&k(a,b)}function k(a,E){const b=createLink();b.href=a,E.parentNode.append(b),b.append(E)}function R(a,E){const b=getFirstElement(E);b&&A(a,b)}function A(a,E){const b=createLink();b.href=a,b.append(...E.childNodes),E.append(b)}function _(){const a=getURLQueryParam("scrollTo");if(!a)return;const E=document.getElementById(a);E?E.scrollIntoView():console.log(`Element with ID "${a}" was not found.`)}function L(a,E,b=null){const N=`${E}-click-passed`,y=b?F=>findElementByText(F,a,b):F=>getFirstElement(a,F);return function(F){if(F.hasAttribute(N))return!1;const B=y(F);return B&&B.click(),F.setAttribute(N,""),!0}}function w(a,E,b="text/plain"){const N=new Blob([a],{type:b}),y=URL.createObjectURL(N),F=document.createElement("a");F.href=y,F.download=E,document.body.appendChild(F),F.click(),document.body.removeChild(F),requestAnimationFrame(()=>URL.revokeObjectURL(y))}},6754:(T,m,e)=>{e.d(m,{ZM:()=>s});function s(C,o){Object.assign(C.style,o)}function l(C,o="custom-global-style"){let n=document.getElementById(o);n||(n=document.createElement("style"),n.id=o,n.type="text/css",document.head.appendChild(n)),n.textContent=C}function p(C){return Object.entries(C).map(([o,n])=>`${o.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${n};`).join(" ")}function d(C){return C?C.split(";").filter(o=>o.trim()!=="").reduce((o,n)=>{const[t,i]=n.split(":").map(D=>D.trim()),P=t.replace(/-([a-z])/g,(D,h)=>h.toUpperCase());return o[P]=i,o},{}):{}}},4921:(T,m,e)=>{e.d(m,{sg:()=>d,xk:()=>s});function s(i,P,D=null){const h=i.querySelector(P);return h?Promise.resolve(h):new Promise(O=>{const g=new MutationObserver(c);g.observe(i,{childList:!0,subtree:!0});let r;D&&(r=setTimeout(()=>{g.disconnect(),console.log(`No element found for selector: ${P}`),O(null)},D));function c(){const u=i.querySelector(P);u&&(r&&clearTimeout(r),g.disconnect(),O(u))}})}function l(i,P){return i.querySelector(P)?new Promise(h=>{const O=new MutationObserver(g);O.observe(i,{childList:!0,subtree:!0});function g(){i.querySelector(P)||(O.disconnect(),h())}}):Promise.resolve()}function p(i,P=400){return new Promise(D=>{let h;const O=new MutationObserver(()=>{clearTimeout(h),g()});function g(){h=setTimeout(()=>{O.disconnect(),D()},P)}g(),O.observe(i,{childList:!0,subtree:!0})})}function d(i,P=250){let D;return(...h)=>{clearTimeout(D),D=setTimeout(()=>i(...h),P)}}async function C(i){document.visibilityState==="visible"?await i():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await i()},{once:!0})}function o(i,P){const D=new IntersectionObserver(h=>{h.forEach(O=>{O.isIntersecting&&(P(),n(i))})});i.intersectionObserver=D,D.observe(i)}function n(i){i.intersectionObserver&&(i.intersectionObserver.disconnect(),i.intersectionObserver=null)}function t(i){i&&(i.disconnect(),i=null)}},3829:(T,m,e)=>{e.d(m,{Ay:()=>l,JE:()=>d,iG:()=>C});var s=e(8355);function l(n,t){return!p(n,t)}function p(n,t){if(!t.value)return!0;const i=n.toLowerCase(),P=(0,s.R)(t),D=[],h=[];return P.forEach(O=>{if(O.startsWith("!")){const g=O.substring(1);g&&h.push(g)}else D.push(O)}),D.every(O=>i.includes(O))&&h.every(O=>!i.includes(O))}function d(n,t){return t.value!=null&&n<t.value}function C(n,t){return t.value!=null&&n>t.value}function o(n,t){return t.value&&n!==t.value}},4521:(T,m,e)=>{e.d(m,{z:()=>l});var s=e(3048);function l(p,d=null){return{createGlobalFilter(C,o=null,n=p){return s.V.create(C,o,n)},createSectionFilter(C,o=null,n=p){if(!d)throw new Error("sectionId must be provided to use createSectionFilter.");return s.V.createWithCompositeKey(d,C,o,n)}}}},5884:(T,m,e)=>{e.d(m,{Hw:()=>C,Nm:()=>p,nW:()=>d});var s=e(9928),l=e(5467);function p(o,n,t={},i={}){const P=(0,s.kU)(i,n.updateValueFromEvent,n.value);return(0,l.E2)(P,t,o)}function d(o,n,t,i,P,D={},h={}){const O=(0,s.o5)(h,n.updateValueFromEvent,n.value,t,i,P);return(0,l.E2)(O,D,o)}function C(o,n,t={},i={}){const P=(0,s.S)(i,n.updateValueFromEvent,n.value);return(0,l.E2)(P,t,o)}},7877:(T,m,e)=>{e.d(m,{Ch:()=>P,E9:()=>l,H1:()=>O,HX:()=>p,VD:()=>t,Zi:()=>D,pW:()=>S});var s=e(5884);function l(R,A={},_={}){return(0,s.Nm)("\u041F\u043E\u0438\u0441\u043A: ",R,A,_)}function p(R,A={},_={},L=.1,w=3){return(0,s.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",R,L,w,5,A,_)}function d(R,A={},_={},L=.1,w=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",R,L,w,5,A,_)}function C(R,A={},_={}){return n("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",R,A,_)}function o(R,A={},_={}){return n("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",R,A,_)}function n(R,A,_={},L={}){return createNumberFilterControl(R,A,"1","1","999999",_,L)}function t(R,A={},_={}){return i("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",R,A,_)}function i(R,A,_={},L={}){return(0,s.nW)(R,A,"5","0","100",_,L)}function P(R,A={},_={}){return(0,s.nW)("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",R,"5","0","100",A,_)}function D(R,A,_={},L={},w="250"){return(0,s.nW)(R,A,w,"0","1000000",_,L)}function h(R,A={},_={},L="25"){return D("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",R,A,_,L)}function O(R,A={},_={},L="25"){return D("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",R,A,_,L)}function g(R,A={},_={}){return r("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",R,A,_)}function r(R,A,_={},L={}){return createNumberFilterControl(R,A,"1","0","99999",_,L)}function c(R,A={},_={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",R,"1","2","7",A,_)}function u(R,A={},_={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",R,1,1,10,A,_)}function f(R,A={},_={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",R,A,_)}function v(R,A={},_={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",R,A,_)}function x(R,A={},_={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",R,A,_)}function I(R,A={},_={}){return createCheckboxFilterControl("\u0411\u0430\u043B\u043B\u044B: ",R,A,_)}function S(R,A={},_={}){return(0,s.Hw)("\u0412\u043A\u043B: ",R,A,_)}function k(R,A,_={}){const L=[{value:-25,emoji:"\u{1F48E}",tooltip:"\u0421\u0443\u043F\u0435\u0440 \u0446\u0435\u043D\u0430 (-25%)"},{value:-15,emoji:"\u{1F525}",tooltip:"\u041E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-15%)"},{value:-5,emoji:"\u{1F31F}",tooltip:"\u041A\u043B\u0430\u0441\u0441\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-5%)"},{value:5,emoji:"\u{1F44C}",tooltip:"\u0425\u043E\u0440\u043E\u0448\u0430\u044F \u0446\u0435\u043D\u0430 (+5%)"}],w={active:{background:"#e3f2fd",borderColor:"#2196f3",boxShadow:"0 0 0 1px #2196f3"},inactive:{background:"#fff",borderColor:"#ccc",boxShadow:"none"},hover:{background:"#f5f5f5"}},a=createDiv({display:"inline-flex",gap:"4px",marginLeft:"4px"}),E=[],b=()=>A?parseFloat(A.value)||0:R.value,N=()=>{const y=b();E.forEach(({button:F,value:B})=>{const M=B<=y?w.active:w.inactive;Object.assign(F.style,M)})};return L.forEach(({value:y,emoji:F,tooltip:B})=>{const U=createButton({padding:"2px 6px",fontSize:"16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"#fff",transition:"all 0.2s",..._},F);U.title=B,U.type="button",U.addEventListener("click",M=>{M.preventDefault(),R.updateValue(y),A&&(A.value=y),N()}),U.addEventListener("mouseenter",()=>{y<=b()||(U.style.background=w.hover.background)}),U.addEventListener("mouseleave",()=>{N()}),E.push({button:U,value:y}),a.appendChild(U)}),N(),A&&(A.addEventListener("input",N),A.addEventListener("change",N)),a}},8355:(T,m,e)=>{e.d(m,{R:()=>s});function s(p){return p.value.toLowerCase().split(",").map(d=>d.trim()).filter(d=>d!=="")}function l(p){return s(p).filter(d=>!d.startsWith("!"))}},5213:(T,m,e)=>{e.d(m,{b:()=>p});var s=e(9928),l=e(573);function p(d,C,o=!1,n="customFiltersContainer"){let t=(0,l.Fi)(`#${n}`,d);if(t)if(o)t.remove();else return;t=(0,s.Sw)(),t.id=n,C(t,d)}},4444:(T,m,e)=>{e.d(m,{s:()=>s});function s(l){let C=2166136261;for(let o=0;o<l.length;o+=1){const n=l.charCodeAt(o);C^=n,C=Math.imul(C,16777619)}return C>>>0}},5081:(T,m,e)=>{e.d(m,{B:()=>p});var s=e(4444);function l(d){return(0,s.s)(d).toString(16).padStart(8,"0")}function p(d,C="common"){return d?l(d):C}},8200:(T,m,e)=>{e.d(m,{s:()=>s});function s(l){const{target:p}=l,{type:d}=p;switch(d){case"text":return`"${p.value}"`;case"number":return p.value;case"checkbox":return p.checked;default:return console.log(`Unknown input type: ${d}`),null}}},157:(T,m,e)=>{e.d(m,{Fg:()=>s,vx:()=>p});const s=window.GM_setValue,l=window.GM.setValue,p=window.GM_getValue},4639:(T,m,e)=>{e.d(m,{a:()=>d});var s=e(1870),l=e(8200),p=e(3976);class d extends s.j{constructor(o=null,n=null){super(o,n)}updateValueFromEvent=o=>{const n=(0,p.$)((0,l.s)(o));this.value!==n&&(this.value=n,this.onChangeIfDefined())}}},1870:(T,m,e)=>{e.d(m,{j:()=>s});class s{constructor(p,d){this.value=p,this.onChange=d}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(T,m,e)=>{e.d(m,{V:()=>C});var s=e(1870),l=e(8200),p=e(3976),d=e(157);class C extends s.j{constructor(n,t=null,i=null){super((0,d.vx)(n,t),i),this.storageKey=n,this.defaultValue=t}static create(n,t=null,i=null){return new C(n,t,i)}static createWithCompositeKey(n,t,i=null,P=null){const D=`${n}-${t}`;return new C(D,i,P)}updateValueFromEvent=n=>{const t=(0,l.s)(n),i=(0,p.$)(t);this.updateValue(i)};updateValue(n,t=!0){this.value!==n&&((0,d.Fg)(this.storageKey,n),this.value=n,t&&this.onChangeIfDefined())}clearValue(n=!1){this.updateValue(null,n)}resetValue(n=!1){this.updateValue(this.defaultValue,n)}}},3976:(T,m,e)=>{e.d(m,{$:()=>s});function s(l){return l===""?null:JSON.parse(l)}},4214:(T,m,e)=>{e.d(m,{zr:()=>l});function s(o){return o.replace(/\D/g,"")}function l(o){return o.replace(/[^\d.,-]/g,"")}function p(o){return o.replace(/\s/g,"")}function d(o){return o.charAt(0).toUpperCase()+o.slice(1)}function C(o){return o.replace(/\s+/g," ").trim()}},5406:(T,m,e)=>{e.d(m,{C$:()=>p,Fc:()=>s,W2:()=>t});function s(g,r="common",c=!1){const{pathname:u}=window.location;return l(u,g,r,c)}function l(g,r,c,u=!1){const f=g.split("/");r=r<0?f.length+r:r;const v=f[r]||c;return u&&console.log(`Pathname element: ${v}`),v}function p(g,r="common",c=!1){const u=s(g,"",c);return d(u,r,c)}function d(g,r,c){if(!g)return r;const u=g.split("-").at(-1);return c&&console.log(`Pathname element ending: ${u}`),u}function C(g,r,c="common",u=!1){const f=l(g,r,"",u);return d(f,c,u)}function o(g){return new URLSearchParams(window.location.search).get(g)}function n(g){return g.split("?")[0]}function t(g){return window.location.pathname.includes(g)}function i(g){return g.some(r=>t(r))}function P(g){return window.location.pathname.split("/").some(c=>c===g)}function D(g){try{const r=new URL(window.location.href);Object.entries(g).forEach(([c,u])=>{r.searchParams.set(c,u)}),window.location.href=r.toString()}catch(r){console.error("Failed to redirect:",r)}}function h(g,r=[]){const c={pathname:window.location.pathname};r.forEach(I=>{c[I]=o(I)});let u=!1;async function f(){if(u)return;const I={pathname:window.location.pathname};if(r.forEach(S=>{I[S]=o(S)}),Object.keys(c).some(S=>c[S]!==I[S])){Object.assign(c,I),u=!0;try{await g()}catch(S){console.error("Error in URL observer callback:",S)}finally{u=!1}}}function v(){f().catch(I=>{console.error("Error in URL change handler:",I)})}let x=window.location.href;setInterval(()=>{window.location.href!==x&&(x=window.location.href,v())},200),window.addEventListener("popstate",v)}function O(g=[]){h(()=>window.location.reload(),g)}},4010:(T,m,e)=>{e.a(T,async(s,l)=>{try{let o=function(){return(0,C.W2)("details")};var p=e(1901),d=e(2344),C=e(5406);o()?await(0,p.K)():await(0,d.P)(),l()}catch(o){l(o)}},1)},1926:(T,m,e)=>{e.d(m,{i:()=>s});const s={PRICE:"price",BALANCED_CASHBACK_PRICE:"balanced-cashback-price",COUPON:"applied-coupon",OBSERVED:"observed"}},1319:(T,m,e)=>{e.d(m,{Z:()=>p});var s=e(573),l=e(1926);function p(t,i,P,D){const h=(0,s.Fi)(i,t);return(d(h,D)||!h.hasAttribute(l.i.BALANCED_CASHBACK_PRICE))&&C(h,P,D),h}function d(t,i){if(t.hasAttribute(l.i.COUPON)){const P=+t.getAttribute(l.i.COUPON);return i!==P}return!!i}function C(t,i,P){let D=o(t);t.setAttribute(l.i.PRICE,D),P?(P<1?D=(D*(1-P)).toFixed():D-=P,t.setAttribute(l.i.COUPON,P)):t.removeAttribute(l.i.COUPON);const h=n(D,i),O=D-h;t.setAttribute(l.i.BALANCED_CASHBACK_PRICE,O);const g=`${D.toLocaleString()} (${O.toLocaleString()}) \u20BD`;t.innerText=g,t.title=`-${h.toLocaleString()}`}function o(t){return t.hasAttribute(l.i.PRICE)?+t.getAttribute(l.i.PRICE):(0,s.YA)(t,!0)}function n(t,i){const P=i/100;return(t*P/(1+P)).toFixed(0)}},4633:(T,m,e)=>{e.d(m,{r:()=>l});const s={INPUT:{border:"1px solid #e4ebf0",fontSize:"14px",borderRadius:"8px",marginLeft:"7px",padding:"8px 14px"}},l={CONTAINER:{display:"flex",gridGap:"15px",padding:"14px 5px"},CONTROL:{display:"flex",alignItems:"center",fontSize:"14px"},TEXT_INPUT:{...s.INPUT,width:"180px"},NUMBER_INPUT:{...s.INPUT},CHECKBOX_INPUT:{marginLeft:"7px",width:"23px",height:"23px"}}},2344:(T,m,e)=>{e.d(m,{P:()=>A});var s=e(4921),l=e(5213),p=e(1319),d=e(5406),C=e(4639),o=e(3829),n=e(5884),t=e(5539),i=e(573),P=e(7877),D=e(1926),h=e(4633),O=e(4521),g=e(5081);const r={PRODUCT_CARD_LIST_HEADER:".catalog-listing-controls",PRODUCT_CARD:".catalog-item-desktop",PRODUCT_CARD_PRICE:".catalog-item-regular-desktop__price",PRODUCT_CARD_CASHBACK:".bonus-percent",PRODUCT_CARD_TITLE:".catalog-item-regular-desktop__title-link",PRODUCT_CARD_DISCOUNT:".discount-percentage__value",PRODUCT_CARD_SELLER_NAME:".merchant-info__name"};var c=e(6754);const u=(0,g.B)((0,d.Fc)(2)),{createSectionFilter:f}=(0,O.z)(w,u),v=f("name-filter"),x=f("min-cashback-filter"),I=f("max-price-filter"),S=f("min-discount-filter"),k=f("seller-name-filter"),R=new C.a(!1,w);async function A(){await _();const E=await(0,s.xk)(document,"#app");new MutationObserver((0,s.sg)(_)).observe(E,{childList:!0,subtree:!0})}async function _(){const E=await(0,s.xk)(document,r.PRODUCT_CARD_LIST_HEADER);(0,l.b)(E,L);const b=E.parentNode;if(b.hasAttribute(D.i.OBSERVED))return;new MutationObserver((0,s.sg)(w,50)).observe(b,{childList:!0,subtree:!0}),b.setAttribute(D.i.OBSERVED,"")}function L(E,b){(0,c.ZM)(E,h.r.CONTAINER);const N=(0,P.E9)(v,h.r.CONTROL,h.r.TEXT_INPUT),y=(0,P.Ch)(x,h.r.CONTROL,h.r.NUMBER_INPUT),F=(0,P.H1)(I,h.r.CONTROL,h.r.NUMBER_INPUT,"250"),B=(0,P.VD)(S,h.r.CONTROL,h.r.NUMBER_INPUT),U=(0,n.Nm)("\u041F\u0440\u043E\u0434\u0430\u0432\u0435\u0446: ",k,h.r.CONTROL,h.r.TEXT_INPUT),M=(0,P.pW)(R,h.r.CONTROL,h.r.CHECKBOX_INPUT);E.append(N,y,F,B,U,M),b.append(E)}function w(){(0,i.fI)(r.PRODUCT_CARD).forEach(a)}function a(E){if(!R.value){(0,t.kl)(E);return}const b=(0,i.Fi)(r.PRODUCT_CARD_TITLE,E),N=(0,i.Fi)(r.PRODUCT_CARD_CASHBACK,E),y=(0,i.Fi)(r.PRODUCT_CARD_DISCOUNT,E);if(!b){(0,t.Bt)(E);return}const F=b.innerText,B=(0,i.YA)(N,!0,!1,0),U=Math.abs((0,i.YA)(y,!0,!1,0)),V=+(0,p.Z)(E,r.PRODUCT_CARD_PRICE,B).getAttribute(D.i.BALANCED_CASHBACK_PRICE),K=(0,i.Fi)(r.PRODUCT_CARD_SELLER_NAME,E),H=K?(0,o.Ay)(K.innerText,k):!1,G=(0,o.Ay)(F,v)||(0,o.JE)(B,x)||(0,o.iG)(V,I)||(0,o.JE)(U,S)||H;(0,t.UC)(E,G)}},1901:(T,m,e)=>{e.d(m,{K:()=>_});var s=e(4921),l=e(5081),p=e(5406),d=e(5213),C=e(4639),o=e(3829),n=e(5539),t=e(573),i=e(7877),P=e(5884),D=e(1319),h=e(1926),O=e(4633),g=e(4521);const r={APP:"#app",OFFERS_FILTER:".pdp-prices-filter",OFFERS_CONTAINER:".pdp-prices",OFFER:".pdp-prices .product-offer",PRICE:".product-offer-price__amount",CASHBACK:".bonus-percent",SELLER_RATING:".pdp-merchant-rating-block__rating"};var c=e(6754);const u=(0,l.B)((0,p.C$)(3)),{createGlobalFilter:f,createSectionFilter:v}=(0,g.z)(a,u),x=v("min-cashback-filter"),I=v("max-price-filter"),S=v("max-discounted-price-filter"),k=f("min-seller-rating-filter"),R=new C.a(null,a),A=f("filter-enabled",!1);async function _(){await L();const b=await(0,s.xk)(document,r.APP);new MutationObserver((0,s.sg)(L)).observe(b,{childList:!0})}async function L(){const b=await(0,s.xk)(document,r.OFFERS_FILTER);(0,d.b)(b,w),a();const N=(0,t.Fi)(r.OFFERS_CONTAINER);if(N.hasAttribute(h.i.OBSERVED))return;new MutationObserver((0,s.sg)(a,50)).observe(N,{childList:!0,subtree:!0}),N.setAttribute(h.i.OBSERVED,"")}function w(b,N){(0,c.ZM)(b,O.r.CONTAINER);const y=(0,i.Ch)(x,O.r.CONTROL,O.r.NUMBER_INPUT),F=(0,i.H1)(I,O.r.CONTROL,O.r.NUMBER_INPUT,"250"),B=(0,i.Zi)("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430 \u0441\u043E \u0441\u043A\u0438\u0434\u043A\u043E\u0439: ",S,O.r.CONTROL,O.r.NUMBER_INPUT),U=(0,i.HX)(k,O.r.CONTROL,O.r.NUMBER_INPUT),M=(0,P.nW)("\u041A\u0443\u043F\u043E\u043D: ",R,"500","0","100000",O.r.CONTROL,O.r.NUMBER_INPUT),V=(0,i.pW)(A,O.r.CONTROL,O.r.CHECKBOX_INPUT);b.append(y,F,B,U,M,V),N.append(b)}function a(){(0,t.fI)(r.OFFER).forEach(E)}function E(b){if(!A.value){(0,n.kl)(b);return}const N=(0,t.Fi)(r.PRICE,b),y=(0,t.Fi)(r.CASHBACK,b),F=(0,t.Fi)(r.SELLER_RATING,b);if(!N||!y||!F){(0,n.Bt)(b);return}const B=(0,t.YA)(y,!0),U=(0,D.Z)(b,r.PRICE,B,R.value),M=+U.getAttribute(h.i.PRICE),V=+U.getAttribute(h.i.BALANCED_CASHBACK_PRICE),K=(0,t.YA)(F,!0),H=(0,o.JE)(B,x)||(0,o.iG)(M,I)||(0,o.iG)(V,S)||(0,o.JE)(K,k);(0,n.UC)(b,H)}}},$={};function W(T){var m=$[T];if(m!==void 0)return m.exports;var e=$[T]={exports:{}};return j[T](e,e.exports,W),e.exports}(()=>{var T=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",m=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",e=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",s=p=>{p&&p.d<1&&(p.d=1,p.forEach(d=>d.r--),p.forEach(d=>d.r--?d.r++:d()))},l=p=>p.map(d=>{if(d!==null&&typeof d=="object"){if(d[T])return d;if(d.then){var C=[];C.d=0,d.then(t=>{o[m]=t,s(C)},t=>{o[e]=t,s(C)});var o={};return o[T]=t=>t(C),o}}var n={};return n[T]=t=>{},n[m]=d,n});W.a=(p,d,C)=>{var o;C&&((o=[]).d=-1);var n=new Set,t=p.exports,i,P,D,h=new Promise((O,g)=>{D=g,P=O});h[m]=t,h[T]=O=>(o&&O(o),n.forEach(O),h.catch(g=>{})),p.exports=h,d(O=>{i=l(O);var g,r=()=>i.map(u=>{if(u[e])throw u[e];return u[m]}),c=new Promise(u=>{g=()=>u(r),g.r=0;var f=v=>v!==o&&!n.has(v)&&(n.add(v),v&&!v.d&&(g.r++,v.push(g)));i.map(v=>v[T](f))});return g.r?c:r()},O=>(O?D(h[e]=O):P(t),s(o))),o&&o.d<0&&(o.d=0)}})(),W.d=(T,m)=>{for(var e in m)W.o(m,e)&&!W.o(T,e)&&Object.defineProperty(T,e,{enumerable:!0,get:m[e]})},W.o=(T,m)=>Object.prototype.hasOwnProperty.call(T,m);var z=W(4010)})();})();
