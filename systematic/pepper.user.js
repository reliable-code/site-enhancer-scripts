// ==UserScript==
// @name         Pepper product cards filter
// @description  Hide product cards by filter
// @grant        GM_addStyle
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.pepper.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.77032510
// @icon         https://www.google.com/s2/favicons?sz=64&domain=pepper.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/pepper.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var se={7273:(w,v,t)=>{t.d(v,{S:()=>O,V:()=>f});var c=t(5558);function f(T={},S=null){return(0,c.n)("span",T,S)}function O(T={},S=null){return(0,c.n)("div",T,S)}},5467:(w,v,t)=>{t.d(v,{E2:()=>f});var c=t(7273);function f(S,m={},s=null){const g=(0,c.S)(m,s);return g.append(S),g}function O(S,m=null,s={},g={}){const i=createActionLink(S,m,g);return f(i,s)}function T(S,m=null,s=null,g={},i={},d={}){const a=createActionLinkWithIcon(S,s,m,i,d);return f(a,g)}},5558:(w,v,t)=>{t.d(v,{n:()=>f});var c=t(6754);function f(O,T,S=null){if(typeof T!="object"||T===null)throw new TypeError("styles should be an object");const m=document.createElement(O);return(0,c.ZM)(m,T),S&&(m.innerHTML=S),m}},740:(w,v,t)=>{t.d(v,{Hn:()=>g,S:()=>m,kU:()=>O,o5:()=>T});var c=t(5558),f=t(4921);function O(i,d,a){const n=s(i,"text",d);return n.value=a,n}function T(i,d,a,n,_,P){const o=s(i,"number",d);return o.value=a,o.step=n,o.min=_,o.max=P,o}function S(i,d,a){const n=s(i,"date",d);return n.value=a,n}function m(i,d,a){const n=s(i,"checkbox",d);return n.checked=a,n}function s(i={},d=null,a=null){const n=(0,c.n)("input",i);return d&&(n.type=d),a&&(n.addEventListener("keyup",(0,f.sg)(a,200)),n.addEventListener("change",(0,f.sg)(a,100))),n}function g(i,d,a){const n=(0,c.n)("select",i);return d&&n.addEventListener("change",d),n.value=a,n}},573:(w,v,t)=>{t.d(v,{Fi:()=>O,YA:()=>g,fI:()=>T});var c=t(4214);function f(o,r=document){return!!r.querySelector(o)}function O(o,r=document,h=!1){const b=r.querySelector(o);return h&&!b&&console.log(`No element found for selector: ${o}`),b}function T(o,r=document,h=!1){const b=r.querySelectorAll(o);return h&&!b.length&&console.log(`No elements found for selector: ${o}`),b}function S(o,r=1){let h=o;for(let b=0;b<r;b++){if(!h.parentElement)return null;h=h.parentElement}return h}function m(o,r,h){return[...o.querySelectorAll(r)].find(b=>b.textContent.trim().includes(h))}function s(o,r,h=!1,b=!1,A=null){const H=O(r,o);return g(H,h,b,A)}function g(o,r=!1,h=!1,b=null){if(!o)return b===null?(console.log("No element found"),null):b;const A=o.innerText;return a(A,r,h)}function i(o,r,h=!1){const b=o[r];return g(b,h)}function d(o,r=!1,h=!1){const b=o.textContent;return a(b,r,h)}function a(o,r,h){r&&(o=(0,c.zr)(o)),h&&(o=o.replace(",","."));const b=Number(o);return Number.isNaN(b)?(console.log(`Invalid number: ${o}`),0):b}function n(o){return[...o.childNodes].find(r=>r.nodeType===Node.TEXT_NODE)}function _(o){const r=h=>h.nodeType===Node.TEXT_NODE&&h.textContent.trim()!==""?[h]:[...h.childNodes].flatMap(r);return r(o)}function P(o){return normalizeSpacing(o.textContent)}},5539:(w,v,t)=>{t.d(v,{D9:()=>r,iV:()=>b,vJ:()=>h});function c(e,I){e.parentNode.insertBefore(I,e.nextSibling)}function f(e){e.style.display="none"}function O(e,I=1){const L=document.querySelector(e);L&&T(L,I)}function T(e,I=1){const L=getElementAncestor(e,I);L&&f(L)}function S(e){n(e),f(e)}function m(e){e.intersectionObserver||runOnceOnIntersection(e,()=>f(e))}function s(e){e.style.display=""}function g(e){const I=a(e);e.style.display=I}function i(e,I){I?f(e):s(e)}function d(e,I){I?m(e):(clearIntersectionObserver(e),s(e))}function a(e){return n(e),e.dataset.defaultDisplay}function n(e){if(e.dataset.defaultDisplay)return;const{display:I}=getComputedStyle(e);e.dataset.defaultDisplay=I}function _(){return{show:[],hide:[]}}function P(e,I,L){e?I.hide.push(L):I.show.push(L)}function o(e){e.show.forEach(s),e.hide.forEach(f)}function r(e,I,L=.3){I?b(e,L):h(e)}function h(e){e.style.opacity=""}function b(e,I=.3){e.style.opacity=I}function A(e){e.style.order=""}function H(e,I){e.style.order=I}function z(e,I,L,C="inline-flex"){I.style.display=e?C:"none",L.style.display=e?"none":C}function V(e,I){e.style.background=I}function B(e,I){const L=getFirstElement(I);L&&X(e,L)}function X(e,I){const L=createLink();L.href=e,I.parentNode.append(L),L.append(I)}function ee(e,I){const L=getFirstElement(I);L&&x(e,L)}function x(e,I,L={}){const C=createLink(L);C.href=e,C.append(...I.childNodes),I.append(C)}function N(){const e=getURLQueryParam("scrollTo");if(!e)return;const I=document.getElementById(e);I?I.scrollIntoView():console.log(`Element with ID "${e}" was not found.`)}function R(e,I,L=null){const C=`${I}-click-passed`,y=L?D=>findElementByText(D,e,L):D=>getFirstElement(e,D);return function(D){if(D.hasAttribute(C))return!1;const k=y(D);return k&&k.click(),D.setAttribute(C,""),!0}}function U(e,I,L="text/plain"){const C=new Blob([e],{type:L}),y=URL.createObjectURL(C),D=document.createElement("a");D.href=y,D.download=I,document.body.appendChild(D),D.click(),document.body.removeChild(D),requestAnimationFrame(()=>URL.revokeObjectURL(y))}},6754:(w,v,t)=>{t.d(v,{ZM:()=>c});function c(S,m){Object.assign(S.style,m)}function f(S,m="custom-global-style"){let s=document.getElementById(m);s||(s=document.createElement("style"),s.id=m,s.type="text/css",document.head.appendChild(s)),s.textContent=S}function O(S){return Object.entries(S).map(([m,s])=>`${m.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${s};`).join(" ")}function T(S){return S?S.split(";").filter(m=>m.trim()!=="").reduce((m,s)=>{const[g,i]=s.split(":").map(a=>a.trim()),d=g.replace(/-([a-z])/g,(a,n)=>n.toUpperCase());return m[d]=i,m},{}):{}}},4921:(w,v,t)=>{t.d(v,{Un:()=>S,sg:()=>T,wP:()=>g,xk:()=>c});function c(i,d,a=null){const n=i.querySelector(d);return n?Promise.resolve(n):new Promise(_=>{const P=new MutationObserver(r);P.observe(i,{childList:!0,subtree:!0});let o;a&&(o=setTimeout(()=>{P.disconnect(),console.log(`No element found for selector: ${d}`),_(null)},a));function r(){const h=i.querySelector(d);h&&(o&&clearTimeout(o),P.disconnect(),_(h))}})}function f(i,d){return i.querySelector(d)?new Promise(n=>{const _=new MutationObserver(P);_.observe(i,{childList:!0,subtree:!0});function P(){i.querySelector(d)||(_.disconnect(),n())}}):Promise.resolve()}function O(i,d=400){return new Promise(a=>{let n;const _=new MutationObserver(()=>{clearTimeout(n),P()});function P(){n=setTimeout(()=>{_.disconnect(),a()},d)}P(),_.observe(i,{childList:!0,subtree:!0})})}function T(i,d=250){let a;return function(...n){const _=this;clearTimeout(a),a=setTimeout(()=>i.apply(_,n),d)}}async function S(i){document.visibilityState==="visible"?await i():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await i()},{once:!0})}function m(i,d){const a=new IntersectionObserver(n=>{n.forEach(_=>{_.isIntersecting&&(d(),s(i))})});i.intersectionObserver=a,a.observe(i)}function s(i){i.intersectionObserver&&(i.intersectionObserver.disconnect(),i.intersectionObserver=null)}function g(i){i&&(i.disconnect(),i=null)}},3829:(w,v,t)=>{t.d(v,{Ay:()=>f,JE:()=>m,iG:()=>s});var c=t(8355);function f(a,n){return!O(a,n)}function O(a,n){if(!n||!n.value)return!0;const _=(0,c._7)(n.value);return T(a,_)}function T(a,n){if(!n||!n.length)return!0;const _=(a||"").toLowerCase();return n.every(P=>S(_,P))}function S(a,n){return n.some(({term:_,isNegative:P})=>{const o=a.includes(_);return P?!o:o})}function m(a,n){return n.value!=null&&a<n.value}function s(a,n){return n.value!=null&&a>n.value}function g(a,n){return n.value==null?!1:a<parseDateFromISO(n.value)}function i(a,n){return n.value==null?!1:a>parseDateFromISO(n.value)}function d(a,n){return n.value&&a!==n.value}},4521:(w,v,t)=>{t.d(v,{z:()=>f});var c=t(3048);function f(O,T=null){return{createGlobalFilter(S,m=null,s=O){return c.V.create(S,m,s)},createSectionFilter(S,m=null,s=O){if(!T)throw new Error("sectionId must be provided to use createSectionFilter.");return c.V.createWithCompositeKey(T,S,m,s)}}}},5884:(w,v,t)=>{t.d(v,{Hw:()=>s,Nm:()=>O,SA:()=>S,nW:()=>T});var c=t(5467),f=t(740);function O(g,i,d={},a={}){const n=(0,f.kU)(a,i.updateValueFromEvent,i.value);return(0,c.E2)(n,d,g)}function T(g,i,d,a,n,_={},P={}){const o=(0,f.o5)(P,i.updateValueFromEvent,i.value,d,a,n);return(0,c.E2)(o,_,g)}function S(g,i,d={},a={}){const n=(0,f.Hn)(a,i.updateValueFromEvent,i.value);return(0,c.E2)(n,d,g)}function m(g,i,d={},a={}){const n=createDateInput(a,i.updateValueFromEvent,i.value);return createControl(n,d,g)}function s(g,i,d={},a={}){const n=(0,f.S)(a,i.updateValueFromEvent,i.value);return(0,c.E2)(n,d,g)}},7877:(w,v,t)=>{t.d(v,{E9:()=>f,H1:()=>P,pW:()=>X});var c=t(5884);function f(x,N={},R={}){return(0,c.Nm)("\u041F\u043E\u0438\u0441\u043A: ",x,N,R)}function O(x,N={},R={},U=.1,e=3){return createNumberFilterControl("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",x,U,e,5,N,R)}function T(x,N={},R={},U=.1,e=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",x,U,e,5,N,R)}function S(x,N={},R={}){return s("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",x,N,R)}function m(x,N={},R={}){return s("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",x,N,R)}function s(x,N,R={},U={}){return createNumberFilterControl(x,N,"1","1","999999",R,U)}function g(x,N={},R={}){return createDateFilterControl("\u041C\u0438\u043D. \u0434\u0430\u0442\u0430: ",x,N,R)}function i(x,N={},R={}){return d("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",x,N,R)}function d(x,N,R={},U={}){return createNumberFilterControl(x,N,"5","0","100",R,U)}function a(x,N={},R={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",x,"5","0","100",N,R)}function n(x,N,R={},U={},e="250"){return(0,c.nW)(x,N,e,"0","1000000",R,U)}function _(x,N={},R={},U="25"){return n("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",x,N,R,U)}function P(x,N={},R={},U="25"){return n("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",x,N,R,U)}function o(x,N={},R={}){return r("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",x,N,R)}function r(x,N,R={},U={}){return createNumberFilterControl(x,N,"1","0","99999",R,U)}function h(x,N={},R={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",x,"1","2","8",N,R)}function b(x,N={},R={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",x,1,1,10,N,R)}function A(x,N={},R={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",x,N,R)}function H(x,N={},R={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",x,N,R)}function z(x,N={},R={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",x,N,R)}function V(x,N={},R={}){return createCheckboxFilterControl("\u0411\u043E\u043D\u0443\u0441: ",x,N,R)}function B(x,N={},R={}){return createCheckboxFilterControl("\u0412 \u043D\u0430\u043B\u0438\u0447\u0438\u0438: ",x,N,R)}function X(x,N={},R={}){return(0,c.Hw)("\u0412\u043A\u043B: ",x,N,R)}function ee(x,N,R={}){const U=[{value:-25,emoji:"\u{1F48E}",tooltip:"\u0421\u0443\u043F\u0435\u0440 \u0446\u0435\u043D\u0430 (-25%)"},{value:-15,emoji:"\u{1F525}",tooltip:"\u041E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-15%)"},{value:-5,emoji:"\u{1F31F}",tooltip:"\u041A\u043B\u0430\u0441\u0441\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-5%)"},{value:5,emoji:"\u{1F44C}",tooltip:"\u0425\u043E\u0440\u043E\u0448\u0430\u044F \u0446\u0435\u043D\u0430 (+5%)"}],e={active:{background:"#e3f2fd",borderColor:"#2196f3",boxShadow:"0 0 0 1px #2196f3"},inactive:{background:"#fff",borderColor:"#ccc",boxShadow:"none"},hover:{background:"#f5f5f5"}},I=createDiv({display:"inline-flex",gap:"4px",marginLeft:"4px"}),L=[],C=()=>N?parseFloat(N.value)||0:x.value,y=()=>{const D=C();L.forEach(({button:k,value:K})=>{const j=K<=D?e.active:e.inactive;Object.assign(k.style,j)})};return U.forEach(({value:D,emoji:k,tooltip:K})=>{const W=createButton({padding:"2px 6px",fontSize:"16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"#fff",transition:"all 0.2s",...R},k);W.title=K,W.type="button",W.addEventListener("click",j=>{j.preventDefault(),x.updateValue(D),N&&(N.value=D),y()}),W.addEventListener("mouseenter",()=>{D<=C()||(W.style.background=e.hover.background)}),W.addEventListener("mouseleave",()=>{y()}),L.push({button:W,value:D}),I.appendChild(W)}),y(),N&&(N.addEventListener("input",y),N.addEventListener("change",y)),I}},8355:(w,v,t)=>{t.d(v,{Vk:()=>g,_7:()=>f,fO:()=>c});function c(i){if(!i)return[];const a=f(i).flat().filter(n=>n&&!n.isNegative&&n.term).map(n=>n.term);return[...new Set(a)]}function f(i){return i?i.toLowerCase().split(",").map(O).filter(Boolean):[]}function O(i){const d=i.split("/").map(n=>n.trim()).filter(Boolean);if(d.length===0)return null;const a=d.map(T).filter(Boolean);return a.length>0?a:null}function T(i){const d=i.startsWith("!"),a=d?i.slice(1).trim():i;return a?{term:a,isNegative:d}:null}function S(i,d){s(i,a=>a.style.display!=="none",d)}function m(i,d){s(i,a=>a.style.opacity==="",d)}function s(i,d,a){const n=[...i].filter(d).length,_=i.length;g(a,n,_)}function g(i,d,a){i.textContent=`\u041F\u043E\u043A\u0430\u0437\u0430\u043D\u043E: ${d} \u0438\u0437 ${a}`}},5213:(w,v,t)=>{t.d(v,{b:()=>O});var c=t(573),f=t(7273);function O(T,S,m=!1,s="customFiltersContainer"){let g=(0,c.Fi)(`#${s}`,T);if(g)if(m)g.remove();else return;g=(0,f.S)(),g.id=s,S(g,T)}},8200:(w,v,t)=>{t.d(v,{s:()=>c});function c(f){const{target:O}=f,{type:T}=O;switch(T){case"text":return`"${O.value}"`;case"number":return O.value;case"select-one":return O.value;case"date":return`"${O.value}"`;case"checkbox":return O.checked;default:return console.log(`Unknown input type: ${T}`),null}}},157:(w,v,t)=>{t.d(v,{Fg:()=>c,vx:()=>O});const c=window.GM_setValue,f=window.GM.setValue,O=window.GM_getValue},1870:(w,v,t)=>{t.d(v,{j:()=>c});class c{constructor(O,T){this.value=O,this.onChange=T}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(w,v,t)=>{t.d(v,{V:()=>S});var c=t(1870),f=t(8200),O=t(3976),T=t(157);class S extends c.j{constructor(s,g=null,i=null){super((0,T.vx)(s,g),i),this.storageKey=s,this.defaultValue=g}static create(s,g=null,i=null){return new S(s,g,i)}static createWithCompositeKey(s,g,i=null,d=null){const a=`${s}-${g}`;return new S(a,i,d)}updateValueFromEvent=s=>{const g=(0,f.s)(s),i=(0,O.$)(g);this.updateValue(i)};updateValue(s,g=!0){this.value!==s&&((0,T.Fg)(this.storageKey,s),this.value=s,g&&this.onChangeIfDefined())}clearValue(s=!1){this.updateValue(null,s)}resetValue(s=!1){this.updateValue(this.defaultValue,s)}}},3976:(w,v,t)=>{t.d(v,{$:()=>c});function c(f){return f===""?null:JSON.parse(f)}},4214:(w,v,t)=>{t.d(v,{zr:()=>f});function c(m){return m.replace(/\D/g,"")}function f(m){return m.replace(/[^\d.,-]/g,"")}function O(m){return m.replace(/\s/g,"")}function T(m){return m.charAt(0).toUpperCase()+m.slice(1)}function S(m){return m.replace(/\s+/g," ").trim()}},5406:(w,v,t)=>{t.d(v,{z2:()=>d});function c(o,r="common",h=!1){const{pathname:b}=window.location;return f(b,o,r,h)}function f(o,r,h,b=!1){const A=o.split("/");r=r<0?A.length+r:r;const H=A[r]||h;return b&&console.log(`Pathname element: ${H}`),H}function O(o,r="common",h=!1){const b=c(o,"",h);return T(b,r,h)}function T(o,r,h){if(!o)return r;const b=o.split("-").at(-1);return h&&console.log(`Pathname element ending: ${b}`),b}function S(o,r,h="common",b=!1){const A=f(o,r,"",b);return T(A,h,b)}function m(o){return new URLSearchParams(window.location.search).get(o)}function s(o){return o.split("?")[0]}function g(o){return window.location.pathname.includes(o)}function i(o){return o.some(r=>g(r))}function d(...o){return window.location.pathname.split("/").some(h=>o.includes(h))}function a(o){try{const r=new URL(window.location.href);Object.entries(o).forEach(([h,b])=>{r.searchParams.set(h,b)}),window.location.href=r.toString()}catch(r){console.error("Failed to redirect:",r)}}function n(o,r=[]){const h=new AbortController;let b=!1;const A=z=>{const V=new URL(z),B={pathname:V.pathname};return r.forEach(X=>{B[X]=V.searchParams.get(X)}),B};let H=A(window.location.href);return window.navigation.addEventListener("navigatesuccess",async()=>{if(b)return;const z=A(window.navigation.currentEntry.url);if(Object.keys(H).some(B=>H[B]!==z[B])){H=z,b=!0;try{await o(z)}catch(B){console.error("URL observer error:",B)}finally{b=!1}}},{signal:h.signal}),()=>h.abort()}function _(o,r=[]){const h={pathname:window.location.pathname};r.forEach(V=>{h[V]=m(V)});let b=!1;async function A(){if(b)return;const V={pathname:window.location.pathname};if(r.forEach(B=>{V[B]=m(B)}),Object.keys(h).some(B=>h[B]!==V[B])){Object.assign(h,V),b=!0;try{await o()}catch(B){console.error("Error in URL observer callback:",B)}finally{b=!1}}}function H(){A().catch(V=>{console.error("Error in URL change handler:",V)})}let z=window.location.href;setInterval(()=>{window.location.href!==z&&(console.log("URL changed:",window.location.href),z=window.location.href,H())},200),window.addEventListener("popstate",H)}function P(o=[]){_(()=>window.location.reload(),o)}},7926:(w,v,t)=>{t.d(v,{sV:()=>n,CU:()=>g,Jm:()=>P,Fr:()=>d,nd:()=>_,MB:()=>a,Su:()=>s,X0:()=>i});var c=t(157);function f(o,r=1e3){return Math.round((o+Number.EPSILON)*r)/r}function O(o){const r=o.slice().sort((b,A)=>b-A),h=Math.floor(r.length/2);return r.length%2!==0?r[h]:(r[h-1]+r[h])/2}function T(o,r){return Math.random()*(r-o)+o}const S="preferred-comment-counts",m=50;function s(o){(0,c.Fg)("newest-seen-product-id",o)}function g(){return(0,c.vx)("newest-seen-product-id")}function i(o){(0,c.Fg)("prev-newest-seen-product-id",o)}function d(){return(0,c.vx)("prev-newest-seen-product-id")}function a(){(0,c.Fg)("last-newest-seen-product-update",Date.now())}function n(){return(0,c.vx)("last-newest-seen-product-update")}function _(o){const r=(0,c.vx)(S,[]);r.push(o),r.length>m&&r.shift(),(0,c.Fg)(S,r)}function P(){const o=(0,c.vx)(S,[]);return o.length===0?null:O(o)}},9374:(w,v,t)=>{t.a(w,async(c,f)=>{try{var O=t(5406),T=t(468),S=t(3854),m=t(2043);(0,m.a)(),await s();async function s(){(0,O.z2)("new","search_result")?await(0,T.P)():(0,O.z2)("deals","coupons")&&await(0,S.O)()}f()}catch(s){f(s)}},1)},3854:(w,v,t)=>{t.d(v,{O:()=>I});var c=t(573);const f={HIDE_TOP_COMMENTS_BUTTON:"#top-comments-open-close",OFFER:".text-2xl.font-bold.text-primary.mr-2",STICKY_HEADER:"#header-sticky-scroll",STICKY_HEADER_TITLE_CONTAINER:":scope > div.container > div:first-of-type",STICKY_HEADER_BUTTONS_CONTAINER:":scope > div.container > div:last-of-type",COMMENTS_CONTAINER:"#comments",COMMENTS_LIST:"#comment-list",POST_BODY:'div[data-name="post[body]"]',MORE_REPLIES_LINK:"a.more-replies",COMMENT:'div[id^="post_"][id$="_new"]',COMMENT_TEXT_WRAP:'div[id^="parent_comment_"]',COMMENT_REACTIONS_CONTAINER:'[class^="given_reactions_"]',COMMENT_REACTION:"span.text-sm.text-secondary-text-light",SCROLL_TOP_BUTTON:"#scroll-top"};var O=t(4521),T=t(5213),S=t(6754),m=t(5013);const s={INPUT:{marginLeft:"7px",border:"2px solid #b3bcc5",borderRadius:"6px",padding:"7px 14px"},CONTROL:{display:"flex",alignItems:"center",fontSize:"15px"}},g={DISLIKE_CONTROL:{marginLeft:"auto",gap:"8px"},DISLIKE_BUTTON_ICON_SM:{height:"0.9em",marginTop:"2px"},DISLIKE_BUTTON_ICON_MD:{marginBottom:"1px"},REMOVE_DISLIKE_BUTTON_ICON_SM:{height:"0.9em"},REMOVE_DISLIKE_BUTTON_ICON_MD:{marginBottom:"2px"},FILTERS_CONTAINER:{display:"flex",flexFlow:"wrap",gap:"12px 16px",paddingBottom:"14px"},NUMBER_INPUT_SM:{...s.INPUT,width:"70px"},NUMBER_INPUT_MD:{...s.INPUT,width:"80px"},NUMBER_INPUT_LG:{...s.INPUT,width:"90px"},TEXT_INPUT:{...s.INPUT,width:"260px"},CHECKBOX_INPUT:{marginLeft:"7px",width:"26px",height:"26px"},CONTROL:s.CONTROL,PUSHED_RIGHT_CONTROL:{...s.CONTROL,marginLeft:"auto"}},i={SCROLL_TO_FILTERS_BUTTON:{position:"fixed",bottom:"20px",right:"20px",padding:"10px 20px 10px 14px",backgroundColor:"#005bff",color:"white",border:"none",borderRadius:"8px",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.2)",cursor:"pointer",fontSize:"14px",transition:"background-color 0.3s",display:"none",gap:"4px",zIndex:5},CLONED_PRODUCT_CARDS_WRAP:{display:"grid",gridTemplateColumns:"repeat(12, 1fr)"}},d={...m.B,FILTERS_CONTAINER:{...m.B.FILTERS_CONTAINER,padding:"15px 0px 12px",borderBottomWidth:"1px",top:"50px",zIndex:"9"},PUSHED_RIGHT_CONTROL:{...s.CONTROL,marginLeft:"auto"}};var a=t(7877),n=t(5884),_=t(5539),P=t(3829),o=t(4921);function r(u,l){u.forEach(E=>h(l,E))}function h(u,l){if(!l)return;const E=new RegExp(`(${l})`,"gi"),p=document.createTreeWalker(u,NodeFilter.SHOW_TEXT,null);let F=p.nextNode();const M=[];for(;F;){const{textContent:$}=F;if(E.test($)){const Y=document.createDocumentFragment();let G=0;$.replace(E,(Z,q,J)=>{J>G&&Y.appendChild(document.createTextNode($.slice(G,J)));const ne=document.createElement("span");ne.className="highlightedSubstring",ne.style.backgroundColor="yellow",ne.textContent=Z,Y.appendChild(ne),G=J+Z.length}),G<$.length&&Y.appendChild(document.createTextNode($.slice(G))),M.push({node:F,fragment:Y})}F=p.nextNode()}M.forEach(({node:$,fragment:Y})=>{$.parentNode.replaceChild(Y,$)})}function b(u){(0,c.fI)(".highlightedSubstring",u).forEach(E=>{const{parentNode:p}=E;E.replaceWith(E.textContent),p.normalize()})}var A=t(8355);function H(u,l){const E=(0,A.fO)(u.value);r(E,l)}function z(u,l){const E=getIncludedSearchStrings(u.value);l.forEach(p=>highlightSubstrings(E,p))}var V=t(7926),B=t(7273);const X=.56;function ee(u,l){if(!l?.length)return;const E=x(l,u);let p=null;if(E){const F=u==="next"?E.index+1:E.index-1;F>=0&&F<l.length&&(p=l[F])}else p=N(l,u);p&&R(p,u)}function x(u,l){const E=U(l);for(let p=0;p<u.length;p++){const F=u[p].getBoundingClientRect();if(F.top>E)break;if(F.bottom>=E)return{element:u[p],index:p}}return null}function N(u,l){const E=U(l);if(l==="next"){for(let p=0;p<u.length;p++)if(u[p].getBoundingClientRect().top>E)return u[p]}else for(let p=u.length-1;p>=0;p--)if(u[p].getBoundingClientRect().bottom<E)return u[p];return null}function R(u,l){const E=u.getBoundingClientRect(),p=E.top+E.height/2,F=U(l),M=p-F;window.scrollBy({top:M,behavior:"smooth"})}function U(u){const l=u==="next"?X:1-X;return window.innerHeight*l}const e={commentsContainer:null,commentsObserver:null,isFiltersInitialized:!1,filters:{commentTextFilter:null,minReactionsFilter:null,filterEnabled:null,autoExpandFilter:null},minReactionsSelect:null,lastStatsSnapshot:"",isMinReactionsAutoSelectActive:!0,commentsInfo:null,commentsCache:new WeakMap,visibleComments:[]};async function I(){L(),y(),await C(),await(0,o.Un)(D),he()}function L(){(0,c.Fi)(f.HIDE_TOP_COMMENTS_BUTTON)?.click()}async function C(){const u=(0,c.Fi)(f.OFFER);if(!u)return;const l=(0,c.Fi)(f.STICKY_HEADER);if(!l)return;const E=await(0,o.xk)(l,f.STICKY_HEADER_TITLE_CONTAINER);if(!E)return;const p=await(0,o.xk)(l,f.STICKY_HEADER_BUTTONS_CONTAINER);if(!p)return;E.classList.remove("md:w-[calc(100%-280px)]","w-[calc(100%-40px)]"),E.classList.add("flex-1","min-w-0"),p.classList.remove("md:w-[270px]","w-[40px]"),p.classList.add("w-auto","pl-2","pr-1");const F=(0,B.S)({whiteSpace:"nowrap"},u.textContent);F.classList.add("font-bold","text-primary","mr-3"),p.prepend(F)}function y(){if(!e.isFiltersInitialized){const{createGlobalFilter:u}=(0,O.z)(K);e.filters.commentTextFilter=u("comments-text-filter"),e.filters.minReactionsFilter=u("comments-min-reactions-filter",0),e.filters.filterEnabled=u("comments-filter-enabled",!0),e.filters.autoExpandFilter=u("comments-auto-expand",!1),e.isFiltersInitialized=!0}}function D(){if(e.commentsContainer=(0,c.Fi)(f.COMMENTS_CONTAINER),!e.commentsContainer)return;(0,T.b)(e.commentsContainer,k),K(),e.commentsObserver&&(0,o.wP)(e.commentsObserver),e.commentsObserver=new MutationObserver(l=>{for(const E of l)for(const p of E.addedNodes)if(p.nodeType===1&&(p.matches(f.COMMENT)||p.querySelector(f.COMMENT))){K();return}});const u=(0,c.Fi)(f.COMMENTS_LIST);e.commentsObserver.observe(u,{childList:!0,subtree:!0})}function k(u,l){(0,S.ZM)(u,d.FILTERS_CONTAINER);const E=(0,n.Nm)("\u0422\u0435\u043A\u0441\u0442:",e.filters.commentTextFilter,d.CONTROL,d.TEXT_INPUT),p=(0,n.SA)("\u0420\u0435\u0430\u043A\u0446\u0438\u0439: ",e.filters.minReactionsFilter,d.CONTROL,d.SELECT_INPUT),F=(0,a.pW)(e.filters.filterEnabled,d.CONTROL,d.CHECKBOX_INPUT),M=(0,n.Hw)("\u0410\u0432\u0442\u043E\u0440\u0430\u0441\u043A\u0440\u044B\u0442\u0438\u0435",e.filters.autoExpandFilter,d.CONTROL,d.CHECKBOX_INPUT);e.minReactionsSelect=p.querySelector("select"),e.commentsInfo=(0,B.S)(d.PUSHED_RIGHT_CONTROL),e.minReactionsSelect.addEventListener("change",Y=>{if(e.isMinReactionsAutoSelectActive=!1,parseInt(Y.target.value,10)===0)return;const Z=Y.target.options[Y.target.selectedIndex],q=parseInt(Z.dataset.count,10);Number.isNaN(q)||(0,V.nd)(q)}),u.append(E,p,F,M,e.commentsInfo);const $=(0,c.Fi)(f.POST_BODY,l);l.insertBefore(u,$)}function K(){e.filters.autoExpandFilter.value&&W();const u=(0,c.fI)(f.COMMENT,e.commentsContainer),l={visible:[],collapsed:[]};u.forEach(E=>{(j(E)?l.collapsed:l.visible).push(E)}),te(l),e.visibleComments=l.visible,(0,A.Vk)(e.commentsInfo,e.visibleComments.length,u.length),ae(u)}function W(){(0,c.fI)(f.MORE_REPLIES_LINK,e.commentsContainer).forEach(l=>l.click())}function j(u){if(!e.filters.filterEnabled.value)return!1;b(u);let l=e.commentsCache.get(u);if(!l){const p=(0,c.Fi)(f.COMMENT_TEXT_WRAP,u);if(!p)return!1;const F=p.innerText,M=ce(u);l={commentText:F,commentTextWrap:p,reactionsCount:M},e.commentsCache.set(u,l)}return e.filters.commentTextFilter.value&&H(e.filters.commentTextFilter,l.commentTextWrap),(0,P.Ay)(l.commentText,e.filters.commentTextFilter)||(0,P.JE)(l.reactionsCount,e.filters.minReactionsFilter)}function te(u){u.visible.forEach(l=>{re(l),ie(l,!1)}),u.collapsed.forEach(l=>{oe(l),ie(l,!0)})}function re(u){(0,_.vJ)(u),u.style.maxHeight="",u.style.overflow=""}function oe(u){(0,_.iV)(u),u.style.maxHeight="83px",u.style.overflow="hidden"}function ie(u,l){const E=e.commentsCache.get(u);if(E?.lastHoverState!==l){if(l){let p=null;u.onmouseenter=()=>{clearTimeout(p),p=setTimeout(()=>re(u),250)},u.onmouseleave=()=>{clearTimeout(p),oe(u)}}else u.onmouseenter=null,u.onmouseleave=null;E&&(E.lastHoverState=l)}}function ce(u){const l=(0,c.Fi)(f.COMMENT_REACTIONS_CONTAINER,u);if(!l)return 0;const E=(0,c.fI)(f.COMMENT_REACTION,l);let p=0;return E.forEach(F=>{const M=parseInt(F.textContent.trim(),10);Number.isNaN(M)||(p+=M)}),p}function ae(u){if(!e.minReactionsSelect)return;const l=le(u),E=de(l),p=JSON.stringify(E);if(e.lastStatsSnapshot===p)return;e.lastStatsSnapshot=p,e.minReactionsSelect.innerHTML="";const F=document.createDocumentFragment();E.forEach(M=>{const $=document.createElement("option");$.value=M.value,$.textContent=M.label,$.dataset.count=M.count,F.appendChild($)}),e.minReactionsSelect.appendChild(F),e.isMinReactionsAutoSelectActive&&fe(E),e.minReactionsSelect.value=e.filters.minReactionsFilter.value}function le(u){const l=new Map;return u.forEach(E=>{const p=e.commentsCache.get(E);if(!p)return;const F=p.reactionsCount;l.set(F,(l.get(F)||0)+1)}),l.size===0&&l.set(0,0),l}function de(u){const l=Array.from(u.keys()).sort((F,M)=>F-M),E=new Array(l.length);let p=0;for(let F=l.length-1;F>=0;F--){const M=l[F];p+=u.get(M),E[F]={value:M,label:`${M}+ (${p})`,count:p}}return E}function fe(u){const l=(0,V.Jm)();if(l===null||u.length===0)return;let E=u[0],p=1/0;for(const F of u){const M=me(F.count,l);M<p?(p=M,E=F):Math.abs(M-p)<.01&&F.count>E.count&&(E=F)}E.value===0&&(E=pe(E,u)),e.filters.minReactionsFilter.value!==E.value&&e.filters.minReactionsFilter.updateValue(E.value)}function me(u,l){const E=u-l,p=1.8;return E>=0?E:Math.abs(E)*p}function pe(u,l){const E=l.find(F=>F.value>0&&F.count>0);return E&&Ee(u.count,E.count)?E:u}function Ee(u,l){return u<=3?!1:u>=9?l>=1:u>=7?l>=2:l>=3}function he(){const u=(0,c.Fi)(f.SCROLL_TOP_BUTTON);if(!u)return;const l=40,E=10,p=55;F("\u0421\u043B\u0435\u0434.",1,"next"),F("\u041F\u0440\u0435\u0434.",2,"prev");function F(M,$,Y){const G=u.cloneNode(!0);G.removeAttribute("id"),G.classList.remove("hidden");const Z=p+(l+E)*$;G.style.bottom=`${Z}px`;const q=G.querySelector("span");if(q&&(q.innerText=M),Y==="next"){const J=G.querySelector("use");if(J){const Ce=J.getAttribute("xlink:href").replace("#up-arrow","#down-arrow");J.setAttribute("xlink:href",Ce)}}G.onclick=J=>{J.stopPropagation(),ee(Y,e.visibleComments)},u.parentNode.insertBefore(G,u)}}function ve(){e.commentsContainer=null,e.isFiltersInitialized=!1,e.filters={commentTextFilter:null,minReactionsFilter:null,filterEnabled:null,autoExpandFilter:null},e.minReactionsSelect=null,e.lastStatsSnapshot="",e.isMinReactionsAutoSelectActive=!0,e.commentsInfo=null,e.commentsCache=new WeakMap,e.visibleComments=[],clearObserver(e.commentsObserver)}},2043:(w,v,t)=>{t.d(v,{a:()=>c});function c(){window.GM_addStyle(`
        div#footer-show,
        div.card:has(div#deal-alert-form-content) {
            display: none !important;
        }
    `)}},5013:(w,v,t)=>{t.d(v,{B:()=>f});const c={INPUT:{border:"1px solid #d1d5db",borderRadius:"8px",marginLeft:"7px"}},f={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",marginBottom:".5rem",backgroundColor:"#fff",borderColor:"rgb(229, 229, 229)",position:"sticky"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...c.INPUT,width:"180px",padding:"7px 14px",backgroundColor:"#fff"},NUMBER_INPUT:{...c.INPUT,width:"90px",padding:"7px 14px",backgroundColor:"#fff"},SELECT_INPUT:{...c.INPUT,width:"100px",padding:"7px 14px",backgroundColor:"#fff"},CHECKBOX_INPUT:{...c.INPUT,width:"24px",height:"24px"}}},468:(w,v,t)=>{t.d(v,{P:()=>h});var c=t(573);const f={DISCUSSIONS:"div.md\\:block.hidden.common-box:nth-of-type(3)",PRODUCT_CARD:".deal-card",PRODUCT_CARD_RATING:".common-box span",PRODUCT_NAME:".custom-card-title",PRODUCT_CARD_LINK:".custom-card-title > a",PRODUCT_PRICE:"div.md\\:text-xll.text-lg.font-bold.text-primary.mr-2"};var O=t(4521),T=t(5213),S=t(6754),m=t(5013);const s={...m.B,FILTERS_CONTAINER:{...m.B.FILTERS_CONTAINER,padding:"11px 19px",borderWidth:"1px",borderRadius:"10px",top:"-1px",zIndex:"11"}};var g=t(7877),i=t(5884),d=t(5539),a=t(3829),n=t(7926);const _={ID_BADGE_APPENDED:"idBadgeAppended",SEEN_PRODUCT_CARD:"seenProductCard",MARK_AS_NEWEST_SEEN_APPENDED:"markAsNewestSeenAppended"};var P=t(4921),o=t(7273);const r={productListObserver:null,isFiltersInitialized:!1,filters:{nameFilter:null,minVotesFilter:null,maxPriceFilter:null,showExpiredFilter:null,filterEnabled:null},prevNewestSeenProductId:null};async function h(){b(),A(),await H(),await I()}function b(){r.prevNewestSeenProductId=(0,n.Fr)()}function A(){if(!r.isFiltersInitialized){const{createGlobalFilter:C}=(0,O.z)(H);r.filters.nameFilter=C("name-filter"),r.filters.minVotesFilter=C("min-votes-filter",50),r.filters.maxPriceFilter=C("max-price-filter"),r.filters.showExpiredFilter=C("show-expired-filter",!1),r.filters.filterEnabled=C("filter-enabled",!0),r.isFiltersInitialized=!0}}function H(){const C=(0,c.fI)(f.PRODUCT_CARD);if(C.length){const y=C[0].parentElement;(0,T.b)(y,z),V(),r.productListObserver&&(0,P.wP)(r.productListObserver),r.productListObserver=new MutationObserver(V),r.productListObserver.observe(y,{childList:!0,subtree:!0})}}function z(C,y){(0,S.ZM)(C,s.FILTERS_CONTAINER);const D=(0,g.E9)(r.filters.nameFilter,s.CONTROL,s.TEXT_INPUT),k=(0,i.nW)("\u041C\u0438\u043D. \u0433\u043E\u043B\u043E\u0441\u043E\u0432: ",r.filters.minVotesFilter,"50","0","10000",s.CONTROL,s.NUMBER_INPUT),K=(0,g.H1)(r.filters.maxPriceFilter,s.CONTROL,s.NUMBER_INPUT),W=(0,i.Hw)("\u0417\u0430\u0432\u0435\u0440\u0448\u0451\u043D\u043D\u044B\u0435: ",r.filters.showExpiredFilter,s.CONTROL,s.CHECKBOX_INPUT),j=(0,g.pW)(r.filters.filterEnabled,s.CONTROL,s.CHECKBOX_INPUT);C.append(D,k,K,W,j),y.prepend(C)}function V(){(0,c.fI)(f.PRODUCT_CARD).forEach(B);const y=(0,c.Fi)(`[${_.SEEN_PRODUCT_CARD}]`);y&&(y.style.marginTop="45px")}function B(C){const y=(0,c.Fi)(f.PRODUCT_CARD_LINK,C),D=X(y);if(ee(C,D),x(D,C),N(C,D),!r.filters.filterEnabled.value){(0,d.vJ)(C);return}if(C.classList.contains("expired-view")&&!r.filters.showExpiredFilter.value){(0,d.iV)(C);return}const K=(0,c.Fi)(f.PRODUCT_CARD_RATING,C);if(K.innerText.includes("\u041D\u043E\u0432\u043E\u0435"))return;const W=(0,c.Fi)(f.PRODUCT_NAME,C),j=(0,c.Fi)(f.PRODUCT_PRICE,C),te=W.innerText,re=(0,c.YA)(K,!0),oe=(0,c.YA)(j,!0),ie=(0,a.Ay)(te,r.filters.nameFilter)||(0,a.JE)(re,r.filters.minVotesFilter)||(0,a.iG)(oe,r.filters.maxPriceFilter);(0,d.D9)(C,ie)}function X(C){return+C.getAttribute("href").split("-").pop()}function ee(C,y){if(C.hasAttribute(_.ID_BADGE_APPENDED))return;const D=C.querySelector(".md\\:col-start-2.row-start-1 .flex.items-center");if(!D)return;const k=(0,o.V)({marginRight:"10px"},`#${y}`);k.className="product-id-badge text-secondary-text-light dark:text-secondary-text-dark text-xs",C.addEventListener("mouseenter",()=>{const K=y-r.prevNewestSeenProductId,W=K>0?"+":"";k.textContent=`#${y} (${W}${K})`}),C.addEventListener("mouseleave",()=>{k.textContent=`#${y}`}),D.insertBefore(k,D.firstChild),C.setAttribute(_.ID_BADGE_APPENDED,"")}function x(C,y){y.style.removeProperty("margin-top"),C>r.prevNewestSeenProductId?(y.style.border="3px solid #8ab854",y.removeAttribute(_.SEEN_PRODUCT_CARD)):(y.style.removeProperty("border"),y.setAttribute(_.SEEN_PRODUCT_CARD,""))}function N(C,y){C.hasAttribute(_.MARK_AS_NEWEST_SEEN_APPENDED)||(C.addEventListener("mousedown",D=>{if(D.button===1&&!D.target.closest("a")){const k=y-(0,n.CU)(),K=(0,n.sV)(),W=R(K),j=["\u041F\u043E\u043C\u0435\u0442\u0438\u0442\u044C \u043A\u0430\u043A \u043D\u043E\u0432\u043E\u0435?","",`\u041D\u043E\u0432\u044B\u0445 \u0442\u043E\u0432\u0430\u0440\u043E\u0432: ~${k}`];W&&j.push(`\u0421 \u043F\u0440\u043E\u0448\u043B\u043E\u0433\u043E \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u043F\u0440\u043E\u0448\u043B\u043E: ${W}`);const te=j.join(`
`);confirm(te)&&(e(y),D.preventDefault())}}),C.setAttribute(_.MARK_AS_NEWEST_SEEN_APPENDED,""))}function R(C){const y=C?new Date(C):null;if(!y)return null;const D=Math.floor((Date.now()-y.getTime())/6e4);return U(D)}function U(C){const y=Math.floor(C/1440),D=Math.floor(C%1440/60),k=C%60;return y>0?`${y} \u0434. ${D} \u0447. ${k} \u043C.`:D>0?`${D} \u0447. ${k} \u043C.`:`${k} \u043C.`}function e(C){const y=(0,n.CU)();(0,n.X0)(y),(0,n.Su)(C),(0,n.MB)(),r.prevNewestSeenProductId=y,V()}async function I(){const C=(0,c.Fi)(f.DISCUSSIONS);C&&(C.style.position="sticky",C.style.top="0")}function L(){r.isFiltersInitialized=!1,r.filters={nameFilter:null,minVotesFilter:null,maxPriceFilter:null,showExpiredFilter:null,filterEnabled:null},r.prevNewestSeenProductId=null,clearObserver(r.productListObserver)}}},ue={};function Q(w){var v=ue[w];if(v!==void 0)return v.exports;var t=ue[w]={exports:{}};return se[w](t,t.exports,Q),t.exports}(()=>{var w=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",v=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",t=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",c=O=>{O&&O.d<1&&(O.d=1,O.forEach(T=>T.r--),O.forEach(T=>T.r--?T.r++:T()))},f=O=>O.map(T=>{if(T!==null&&typeof T=="object"){if(T[w])return T;if(T.then){var S=[];S.d=0,T.then(g=>{m[v]=g,c(S)},g=>{m[t]=g,c(S)});var m={};return m[w]=g=>g(S),m}}var s={};return s[w]=g=>{},s[v]=T,s});Q.a=(O,T,S)=>{var m;S&&((m=[]).d=-1);var s=new Set,g=O.exports,i,d,a,n=new Promise((_,P)=>{a=P,d=_});n[v]=g,n[w]=_=>(m&&_(m),s.forEach(_),n.catch(P=>{})),O.exports=n,T(_=>{i=f(_);var P,o=()=>i.map(h=>{if(h[t])throw h[t];return h[v]}),r=new Promise(h=>{P=()=>h(o),P.r=0;var b=A=>A!==m&&!s.has(A)&&(s.add(A),A&&!A.d&&(P.r++,A.push(P)));i.map(A=>A[w](b))});return P.r?r:o()},_=>(_?a(n[t]=_):d(g),c(m))),m&&m.d<0&&(m.d=0)}})(),Q.d=(w,v)=>{for(var t in v)Q.o(v,t)&&!Q.o(w,t)&&Object.defineProperty(w,t,{enumerable:!0,get:v[t]})},Q.o=(w,v)=>Object.prototype.hasOwnProperty.call(w,v);var ge=Q(9374)})();})();
