// ==UserScript==
// @name         Pepper product cards filter
// @description  Hide product cards by filter
// @grant        GM_addStyle
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.pepper.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.77136792
// @icon         https://www.google.com/s2/favicons?sz=64&domain=pepper.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/pepper.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var se={7273:(P,C,e)=>{e.d(C,{S:()=>O,V:()=>d});var c=e(5558);function d(g={},N=null){return(0,c.n)("span",g,N)}function O(g={},N=null){return(0,c.n)("div",g,N)}},5467:(P,C,e)=>{e.d(C,{E2:()=>d});var c=e(7273);function d(N,m={},s=null){const v=(0,c.S)(m,s);return v.append(N),v}function O(N,m=null,s={},v={}){const o=createActionLink(N,m,v);return d(o,s)}function g(N,m=null,s=null,v={},o={},f={}){const a=createActionLinkWithIcon(N,s,m,o,f);return d(a,v)}},5558:(P,C,e)=>{e.d(C,{n:()=>d});var c=e(6754);function d(O,g,N=null){if(typeof g!="object"||g===null)throw new TypeError("styles should be an object");const m=document.createElement(O);return(0,c.ZM)(m,g),N&&(m.innerHTML=N),m}},740:(P,C,e)=>{e.d(C,{Hn:()=>v,S:()=>m,kU:()=>O,o5:()=>g});var c=e(5558),d=e(4921);function O(o,f,a){const n=s(o,"text",f);return n.value=a,n}function g(o,f,a,n,_,L){const r=s(o,"number",f);return r.value=a,r.step=n,r.min=_,r.max=L,r}function N(o,f,a){const n=s(o,"date",f);return n.value=a,n}function m(o,f,a){const n=s(o,"checkbox",f);return n.checked=a,n}function s(o={},f=null,a=null){const n=(0,c.n)("input",o);return f&&(n.type=f),a&&(n.addEventListener("keyup",(0,d.sg)(a,200)),n.addEventListener("change",(0,d.sg)(a,100))),n}function v(o,f,a){const n=(0,c.n)("select",o);return f&&n.addEventListener("change",f),n.value=a,n}},573:(P,C,e)=>{e.d(C,{Fi:()=>O,YA:()=>v,fI:()=>g});var c=e(4214);function d(r,i=document){return!!i.querySelector(r)}function O(r,i=document,T=!1){const R=i.querySelector(r);return T&&!R&&console.log(`No element found for selector: ${r}`),R}function g(r,i=document,T=!1){const R=i.querySelectorAll(r);return T&&!R.length&&console.log(`No elements found for selector: ${r}`),R}function N(r,i=1){let T=r;for(let R=0;R<i;R++){if(!T.parentElement)return null;T=T.parentElement}return T}function m(r,i,T){return[...r.querySelectorAll(i)].find(R=>R.textContent.trim().includes(T))}function s(r,i,T=!1,R=!1,A=null){const H=O(i,r);return v(H,T,R,A)}function v(r,i=!1,T=!1,R=null){if(!r)return R===null?(console.log("No element found"),null):R;const A=r.innerText;return a(A,i,T)}function o(r,i,T=!1){const R=r[i];return v(R,T)}function f(r,i=!1,T=!1){const R=r.textContent;return a(R,i,T)}function a(r,i,T){i&&(r=(0,c.zr)(r)),T&&(r=r.replace(",","."));const R=Number(r);return Number.isNaN(R)?(console.log(`Invalid number: ${r}`),0):R}function n(r){return[...r.childNodes].find(i=>i.nodeType===Node.TEXT_NODE)}function _(r){const i=T=>T.nodeType===Node.TEXT_NODE&&T.textContent.trim()!==""?[T]:[...T.childNodes].flatMap(i);return i(r)}function L(r){return normalizeSpacing(r.textContent)}},5539:(P,C,e)=>{e.d(C,{D9:()=>T,iV:()=>A,vJ:()=>R});function c(t,S){t.parentNode.insertBefore(S,t.nextSibling)}function d(t){t.style.display="none"}function O(t,S=1){const F=document.querySelector(t);F&&g(F,S)}function g(t,S=1){const F=getElementAncestor(t,S);F&&d(F)}function N(t,S,F){const B=findElementByText(t,S,F);B&&d(B)}function m(t){_(t),d(t)}function s(t){t.intersectionObserver||runOnceOnIntersection(t,()=>d(t))}function v(t){t.style.display=""}function o(t){const S=n(t);t.style.display=S}function f(t,S){S?d(t):v(t)}function a(t,S){S?s(t):(clearIntersectionObserver(t),v(t))}function n(t){return _(t),t.dataset.defaultDisplay}function _(t){if(t.dataset.defaultDisplay)return;const{display:S}=getComputedStyle(t);t.dataset.defaultDisplay=S}function L(){return{show:[],hide:[]}}function r(t,S,F){t?S.hide.push(F):S.show.push(F)}function i(t){t.show.forEach(v),t.hide.forEach(d)}function T(t,S,F=.3){S?A(t,F):R(t)}function R(t){t.style.opacity=""}function A(t,S=.3){t.style.opacity=S}function H(t){t.style.order=""}function Y(t,S){t.style.order=S}function G(t,S,F,B="inline-flex"){S.style.display=t?B:"none",F.style.display=t?"none":B}function K(t,S=.3){t.style.transition="opacity 0.3s",t.style.opacity=S,x(t)}function j(t){t.style.opacity="",y(t)}function re(t){t.style.animation="loading-pulse 2.5s ease-in-out infinite",x(t)}function I(t){t.style.animation="",y(t)}function x(t){t.style.pointerEvents="none",t.style.cursor="wait"}function y(t){t.style.pointerEvents="",t.style.cursor=""}function k(t,S){const F=getFirstElement(S);F&&p(t,F)}function p(t,S){const F=createLink();F.href=t,S.parentNode.append(F),F.append(S)}function Z(t,S){const F=getFirstElement(S);F&&q(t,F)}function q(t,S,F={}){const B=createLink(F);B.href=t,B.append(...S.childNodes),S.append(B)}function b(){const t=getURLQueryParam("scrollTo");if(!t)return;const S=document.getElementById(t);S?S.scrollIntoView():console.log(`Element with ID "${t}" was not found.`)}function w(t,S,F=null){const B=`${S}-click-passed`,X=F?V=>findElementByText(V,t,F):V=>getFirstElement(t,V);return function(V){if(V.hasAttribute(B))return!1;const ee=X(V);return ee&&ee.click(),V.setAttribute(B,""),!0}}function M(t,S,F="text/plain"){const B=new Blob([t],{type:F}),X=URL.createObjectURL(B),V=document.createElement("a");V.href=X,V.download=S,document.body.appendChild(V),V.click(),document.body.removeChild(V),requestAnimationFrame(()=>URL.revokeObjectURL(X))}},6754:(P,C,e)=>{e.d(C,{ZM:()=>c});function c(N,m){Object.assign(N.style,m)}function d(N,m="custom-global-style"){let s=document.getElementById(m);s||(s=document.createElement("style"),s.id=m,s.type="text/css",document.head.appendChild(s)),s.textContent=N}function O(N){return Object.entries(N).map(([m,s])=>`${m.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${s};`).join(" ")}function g(N){return N?N.split(";").filter(m=>m.trim()!=="").reduce((m,s)=>{const[v,o]=s.split(":").map(a=>a.trim()),f=v.replace(/-([a-z])/g,(a,n)=>n.toUpperCase());return m[f]=o,m},{}):{}}},4921:(P,C,e)=>{e.d(C,{Un:()=>N,sg:()=>g,wP:()=>v,xk:()=>c});function c(o,f,a=null){const n=o.querySelector(f);return n?Promise.resolve(n):new Promise(_=>{const L=new MutationObserver(i);L.observe(o,{childList:!0,subtree:!0});let r;a&&(r=setTimeout(()=>{L.disconnect(),console.log(`No element found for selector: ${f}`),_(null)},a));function i(){const T=o.querySelector(f);T&&(r&&clearTimeout(r),L.disconnect(),_(T))}})}function d(o,f){return o.querySelector(f)?new Promise(n=>{const _=new MutationObserver(L);_.observe(o,{childList:!0,subtree:!0});function L(){o.querySelector(f)||(_.disconnect(),n())}}):Promise.resolve()}function O(o,f=400){return new Promise(a=>{let n;const _=new MutationObserver(()=>{clearTimeout(n),L()});function L(){n=setTimeout(()=>{_.disconnect(),a()},f)}L(),_.observe(o,{childList:!0,subtree:!0})})}function g(o,f=250){let a;return function(...n){const _=this;clearTimeout(a),a=setTimeout(()=>o.apply(_,n),f)}}async function N(o){document.visibilityState==="visible"?await o():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await o()},{once:!0})}function m(o,f){const a=new IntersectionObserver(n=>{n.forEach(_=>{_.isIntersecting&&(f(),s(o))})});o.intersectionObserver=a,a.observe(o)}function s(o){o.intersectionObserver&&(o.intersectionObserver.disconnect(),o.intersectionObserver=null)}function v(o){o&&(o.disconnect(),o=null)}},3829:(P,C,e)=>{e.d(C,{Ay:()=>d,JE:()=>m,iG:()=>s});var c=e(8355);function d(a,n){return!O(a,n)}function O(a,n){if(!n||!n.value)return!0;const _=(0,c._7)(n.value);return g(a,_)}function g(a,n){if(!n||!n.length)return!0;const _=(a||"").toLowerCase();return n.every(L=>N(_,L))}function N(a,n){return n.some(({term:_,isNegative:L})=>{const r=a.includes(_);return L?!r:r})}function m(a,n){return n.value!=null&&a<n.value}function s(a,n){return n.value!=null&&a>n.value}function v(a,n){return n.value==null?!1:a<parseDateFromISO(n.value)}function o(a,n){return n.value==null?!1:a>parseDateFromISO(n.value)}function f(a,n){return n.value&&a!==n.value}},4521:(P,C,e)=>{e.d(C,{z:()=>d});var c=e(3048);function d(O,g=null){return{createGlobalFilter(N,m=null,s=O){return c.V.create(N,m,s)},createSectionFilter(N,m=null,s=O){if(!g)throw new Error("sectionId must be provided to use createSectionFilter.");return c.V.createWithCompositeKey(g,N,m,s)}}}},5884:(P,C,e)=>{e.d(C,{Hw:()=>s,Nm:()=>O,SA:()=>N,nW:()=>g});var c=e(5467),d=e(740);function O(v,o,f={},a={}){const n=(0,d.kU)(a,o.updateValueFromEvent,o.value);return(0,c.E2)(n,f,v)}function g(v,o,f,a,n,_={},L={}){const r=(0,d.o5)(L,o.updateValueFromEvent,o.value,f,a,n);return(0,c.E2)(r,_,v)}function N(v,o,f={},a={}){const n=(0,d.Hn)(a,o.updateValueFromEvent,o.value);return(0,c.E2)(n,f,v)}function m(v,o,f={},a={}){const n=createDateInput(a,o.updateValueFromEvent,o.value);return createControl(n,f,v)}function s(v,o,f={},a={}){const n=(0,d.S)(a,o.updateValueFromEvent,o.value);return(0,c.E2)(n,f,v)}},7877:(P,C,e)=>{e.d(C,{E9:()=>d,H1:()=>L,pW:()=>j});var c=e(5884);function d(I,x={},y={}){return(0,c.Nm)("\u041F\u043E\u0438\u0441\u043A: ",I,x,y)}function O(I,x={},y={},k=.1,p=3){return createNumberFilterControl("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",I,k,p,5,x,y)}function g(I,x={},y={},k=.1,p=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",I,k,p,5,x,y)}function N(I,x={},y={}){return s("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",I,x,y)}function m(I,x={},y={}){return s("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",I,x,y)}function s(I,x,y={},k={}){return createNumberFilterControl(I,x,"1","1","999999",y,k)}function v(I,x={},y={}){return createDateFilterControl("\u041C\u0438\u043D. \u0434\u0430\u0442\u0430: ",I,x,y)}function o(I,x={},y={}){return f("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",I,x,y)}function f(I,x,y={},k={}){return createNumberFilterControl(I,x,"5","0","100",y,k)}function a(I,x={},y={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",I,"5","0","100",x,y)}function n(I,x,y={},k={},p="250"){return(0,c.nW)(I,x,p,"0","1000000",y,k)}function _(I,x={},y={},k="25"){return n("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",I,x,y,k)}function L(I,x={},y={},k="25"){return n("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",I,x,y,k)}function r(I,x={},y={}){return i("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",I,x,y)}function i(I,x,y={},k={}){return createNumberFilterControl(I,x,"1","0","99999",y,k)}function T(I,x={},y={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",I,"1","2","8",x,y)}function R(I,x={},y={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",I,1,1,10,x,y)}function A(I,x={},y={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",I,x,y)}function H(I,x={},y={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",I,x,y)}function Y(I,x={},y={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",I,x,y)}function G(I,x={},y={}){return createCheckboxFilterControl("\u0411\u043E\u043D\u0443\u0441: ",I,x,y)}function K(I,x={},y={}){return createCheckboxFilterControl("\u0412 \u043D\u0430\u043B\u0438\u0447\u0438\u0438: ",I,x,y)}function j(I,x={},y={}){return(0,c.Hw)("\u0412\u043A\u043B: ",I,x,y)}function re(I,x,y={}){const k=[{value:-25,emoji:"\u{1F48E}",tooltip:"\u0421\u0443\u043F\u0435\u0440 \u0446\u0435\u043D\u0430 (-25%)"},{value:-15,emoji:"\u{1F525}",tooltip:"\u041E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-15%)"},{value:-5,emoji:"\u{1F31F}",tooltip:"\u041A\u043B\u0430\u0441\u0441\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-5%)"},{value:5,emoji:"\u{1F44C}",tooltip:"\u0425\u043E\u0440\u043E\u0448\u0430\u044F \u0446\u0435\u043D\u0430 (+5%)"}],p={active:{background:"#e3f2fd",borderColor:"#2196f3",boxShadow:"0 0 0 1px #2196f3"},inactive:{background:"#fff",borderColor:"#ccc",boxShadow:"none"},hover:{background:"#f5f5f5"}},Z=createDiv({display:"inline-flex",gap:"4px",marginLeft:"4px"}),q=[],b=()=>x?parseFloat(x.value)||0:I.value,w=()=>{const M=b();q.forEach(({button:t,value:S})=>{const B=S<=M?p.active:p.inactive;Object.assign(t.style,B)})};return k.forEach(({value:M,emoji:t,tooltip:S})=>{const F=createButton({padding:"2px 6px",fontSize:"16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"#fff",transition:"all 0.2s",...y},t);F.title=S,F.type="button",F.addEventListener("click",B=>{B.preventDefault(),I.updateValue(M),x&&(x.value=M),w()}),F.addEventListener("mouseenter",()=>{M<=b()||(F.style.background=p.hover.background)}),F.addEventListener("mouseleave",()=>{w()}),q.push({button:F,value:M}),Z.appendChild(F)}),w(),x&&(x.addEventListener("input",w),x.addEventListener("change",w)),Z}},8355:(P,C,e)=>{e.d(C,{Vk:()=>v,_7:()=>d,fO:()=>c});function c(o){if(!o)return[];const a=d(o).flat().filter(n=>n&&!n.isNegative&&n.term).map(n=>n.term);return[...new Set(a)]}function d(o){return o?o.toLowerCase().split(",").map(O).filter(Boolean):[]}function O(o){const f=o.split("/").map(n=>n.trim()).filter(Boolean);if(f.length===0)return null;const a=f.map(g).filter(Boolean);return a.length>0?a:null}function g(o){const f=o.startsWith("!"),a=f?o.slice(1).trim():o;return a?{term:a,isNegative:f}:null}function N(o,f){s(o,a=>a.style.display!=="none",f)}function m(o,f){s(o,a=>a.style.opacity==="",f)}function s(o,f,a){const n=[...o].filter(f).length,_=o.length;v(a,n,_)}function v(o,f,a){o.textContent=`\u041F\u043E\u043A\u0430\u0437\u0430\u043D\u043E: ${f} \u0438\u0437 ${a}`}},5213:(P,C,e)=>{e.d(C,{b:()=>d});var c=e(7273);function d(O,g,N=!1,m="customFiltersContainer"){let s=O.querySelector(`#${m}`);if(s){if(!N)return;s.replaceChildren()}else s=(0,c.S)(),s.id=m;g(s,O)}},8200:(P,C,e)=>{e.d(C,{s:()=>c});function c(d){const{target:O}=d,{type:g}=O;switch(g){case"text":return`"${O.value}"`;case"number":return O.value;case"select-one":return O.value;case"date":return`"${O.value}"`;case"checkbox":return O.checked;default:return console.log(`Unknown input type: ${g}`),null}}},157:(P,C,e)=>{e.d(C,{Fg:()=>c,vx:()=>O});const c=window.GM_setValue,d=window.GM.setValue,O=window.GM_getValue},1870:(P,C,e)=>{e.d(C,{j:()=>c});class c{constructor(O,g){this.value=O,this.onChange=g}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(P,C,e)=>{e.d(C,{V:()=>N});var c=e(1870),d=e(8200),O=e(3976),g=e(157);class N extends c.j{constructor(s,v=null,o=null){super((0,g.vx)(s,v),o),this.storageKey=s,this.defaultValue=v}static create(s,v=null,o=null){return new N(s,v,o)}static createWithCompositeKey(s,v,o=null,f=null){const a=`${s}-${v}`;return new N(a,o,f)}updateValueFromEvent=s=>{const v=(0,d.s)(s),o=(0,O.$)(v);this.updateValue(o)};updateValue(s,v=!0){this.value!==s&&((0,g.Fg)(this.storageKey,s),this.value=s,v&&this.onChangeIfDefined())}clearValue(s=!1){this.updateValue(null,s)}resetValue(s=!1){this.updateValue(this.defaultValue,s)}}},3976:(P,C,e)=>{e.d(C,{$:()=>c});function c(d){return d===""?null:JSON.parse(d)}},4214:(P,C,e)=>{e.d(C,{zr:()=>d});function c(m){return m.replace(/\D/g,"")}function d(m){return m.replace(/[^\d.,-]/g,"")}function O(m){return m.replace(/\s/g,"")}function g(m){return m.charAt(0).toUpperCase()+m.slice(1)}function N(m){return m.replace(/\s+/g," ").trim()}},5406:(P,C,e)=>{e.d(C,{z2:()=>a});function c(r,i="common",T=!1){const{pathname:R}=window.location;return d(R,r,i,T)}function d(r,i,T,R=!1){const A=r.split("/");i=i<0?A.length+i:i;const H=A[i]||T;return R&&console.log(`Pathname element: ${H}`),H}function O(r,i="common",T=!1){const R=c(r,"",T);return g(R,i,T)}function g(r,i,T){if(!r)return i;const R=r.split("-").at(-1);return T&&console.log(`Pathname element ending: ${R}`),R}function N(r,i,T="common",R=!1){const A=d(r,i,"",R);return g(A,T,R)}function m(r){return new URLSearchParams(window.location.search).get(r)}function s(r){return r.split("?")[0]}function v(r){return window.location.pathname.endsWith(r)}function o(r){return window.location.pathname.includes(r)}function f(r){return r.some(i=>o(i))}function a(...r){return window.location.pathname.split("/").some(T=>r.includes(T))}function n(r){try{const i=new URL(window.location.href);Object.entries(r).forEach(([T,R])=>{i.searchParams.set(T,R)}),window.location.href=i.toString()}catch(i){console.error("Failed to redirect:",i)}}function _(r,i=[]){const T=new AbortController;let R=!1;const A=Y=>{const G=new URL(Y),K={pathname:G.pathname};return i.forEach(j=>{K[j]=G.searchParams.get(j)}),K};let H=A(window.location.href);return window.navigation.addEventListener("navigatesuccess",async()=>{if(R)return;const Y=A(window.navigation.currentEntry.url);if(Object.keys(H).some(K=>H[K]!==Y[K])){H=Y,R=!0;try{await r(Y)}catch(K){console.error("URL observer error:",K)}finally{R=!1}}},{signal:T.signal}),()=>T.abort()}function L(r=[]){_(()=>window.location.reload(),r)}},7926:(P,C,e)=>{e.d(C,{sV:()=>n,CU:()=>v,Jm:()=>L,Fr:()=>f,nd:()=>_,MB:()=>a,Su:()=>s,X0:()=>o});var c=e(157);function d(r,i=1e3){return Math.round((r+Number.EPSILON)*i)/i}function O(r){const i=r.slice().sort((R,A)=>R-A),T=Math.floor(i.length/2);return i.length%2!==0?i[T]:(i[T-1]+i[T])/2}function g(r,i){return Math.random()*(i-r)+r}const N="preferred-comment-counts",m=50;function s(r){(0,c.Fg)("newest-seen-product-id",r)}function v(){return(0,c.vx)("newest-seen-product-id")}function o(r){(0,c.Fg)("prev-newest-seen-product-id",r)}function f(){return(0,c.vx)("prev-newest-seen-product-id")}function a(){(0,c.Fg)("last-newest-seen-product-update",Date.now())}function n(){return(0,c.vx)("last-newest-seen-product-update")}function _(r){const i=(0,c.vx)(N,[]);i.push(r),i.length>m&&i.shift(),(0,c.Fg)(N,i)}function L(){const r=(0,c.vx)(N,[]);return r.length===0?null:O(r)}},9374:(P,C,e)=>{e.a(P,async(c,d)=>{try{var O=e(5406),g=e(468),N=e(3854),m=e(2043);(0,m.a)(),await s();async function s(){(0,O.z2)("new","search_result")?await(0,g.P)():(0,O.z2)("deals","coupons")&&await(0,N.O)()}d()}catch(s){d(s)}},1)},3854:(P,C,e)=>{e.d(C,{O:()=>Z});var c=e(573);const d={HIDE_TOP_COMMENTS_BUTTON:"#top-comments-open-close",OFFER:".text-2xl.font-bold.text-primary.mr-2",STICKY_HEADER:"#header-sticky-scroll",STICKY_HEADER_TITLE_CONTAINER:":scope > div.container > div:first-of-type",STICKY_HEADER_BUTTONS_CONTAINER:":scope > div.container > div:last-of-type",COMMENTS_CONTAINER:"#comments",COMMENTS_LIST:"#comment-list",POST_BODY:'div[data-name="post[body]"]',MORE_REPLIES_LINK:"a.more-replies",COMMENT:'div[id^="post_"][id$="_new"]',COMMENT_TEXT_WRAP:'div[id^="parent_comment_"]',COMMENT_REACTIONS_CONTAINER:'[class^="given_reactions_"]',COMMENT_REACTION:"span.text-sm.text-secondary-text-light",SCROLL_TOP_BUTTON:"#scroll-top"};var O=e(4521),g=e(5213),N=e(6754),m=e(5013);const s={INPUT:{marginLeft:"7px",border:"2px solid #b3bcc5",borderRadius:"6px",padding:"7px 14px"},CONTROL:{display:"flex",alignItems:"center",fontSize:"15px"}},v={DISLIKE_CONTROL:{marginLeft:"auto",gap:"8px"},DISLIKE_BUTTON_ICON_SM:{height:"0.9em",marginTop:"2px"},DISLIKE_BUTTON_ICON_MD:{marginBottom:"2px"},REMOVE_DISLIKE_BUTTON_ICON_SM:{height:"0.9em"},REMOVE_DISLIKE_BUTTON_ICON_MD:{marginBottom:"3px"},FILTERS_CONTAINER:{display:"flex",flexFlow:"wrap",gap:"12px 16px",paddingBottom:"14px"},NUMBER_INPUT_SM:{...s.INPUT,width:"70px"},NUMBER_INPUT_MD:{...s.INPUT,width:"80px"},NUMBER_INPUT_LG:{...s.INPUT,width:"90px"},TEXT_INPUT:{...s.INPUT,width:"260px"},CHECKBOX_INPUT:{marginLeft:"7px",width:"26px",height:"26px"},CONTROL:s.CONTROL,PUSHED_RIGHT_CONTROL:{...s.CONTROL,marginLeft:"auto"}},o={SCROLL_TO_FILTERS_BUTTON:{position:"fixed",bottom:"20px",right:"20px",padding:"10px 20px 10px 14px",backgroundColor:"#005bff",color:"white",border:"none",borderRadius:"8px",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.2)",cursor:"pointer",fontSize:"14px",transition:"background-color 0.3s",display:"none",gap:"4px",zIndex:5},CLONED_PRODUCT_CARDS_WRAP:{display:"grid",gridTemplateColumns:"repeat(12, 1fr)"}},f={...m.B,FILTERS_CONTAINER:{...m.B.FILTERS_CONTAINER,padding:"15px 0px 12px",borderBottomWidth:"1px",top:"50px",zIndex:"9"},PUSHED_RIGHT_CONTROL:{...s.CONTROL,marginLeft:"auto"}};var a=e(7877),n=e(5884),_=e(5539),L=e(3829),r=e(4921);function i(u,l){u.forEach(h=>T(l,h))}function T(u,l){if(!l)return;const h=new RegExp(`(${l})`,"gi"),E=document.createTreeWalker(u,NodeFilter.SHOW_TEXT,null);let D=E.nextNode();const U=[];for(;D;){const{textContent:W}=D;if(h.test(W)){const z=document.createDocumentFragment();let $=0;W.replace(h,(te,ne,Q)=>{Q>$&&z.appendChild(document.createTextNode(W.slice($,Q)));const oe=document.createElement("span");oe.className="highlightedSubstring",oe.style.backgroundColor="yellow",oe.textContent=te,z.appendChild(oe),$=Q+te.length}),$<W.length&&z.appendChild(document.createTextNode(W.slice($))),U.push({node:D,fragment:z})}D=E.nextNode()}U.forEach(({node:W,fragment:z})=>{W.parentNode.replaceChild(z,W)})}function R(u){(0,c.fI)(".highlightedSubstring",u).forEach(h=>{const{parentNode:E}=h;h.replaceWith(h.textContent),E.normalize()})}var A=e(8355);function H(u,l){const h=(0,A.fO)(u.value);i(h,l)}function Y(u,l){const h=getIncludedSearchStrings(u.value);l.forEach(E=>highlightSubstrings(h,E))}var G=e(7926),K=e(7273);const j=.56;function re(u,l){if(!l?.length)return;const h=I(l,u);let E=null;if(h){const D=u==="next"?h.index+1:h.index-1;D>=0&&D<l.length&&(E=l[D])}else E=x(l,u);E&&y(E,u)}function I(u,l){const h=k(l);for(let E=0;E<u.length;E++){const D=u[E].getBoundingClientRect();if(D.top>h)break;if(D.bottom>=h)return{element:u[E],index:E}}return null}function x(u,l){const h=k(l);if(l==="next"){for(let E=0;E<u.length;E++)if(u[E].getBoundingClientRect().top>h)return u[E]}else for(let E=u.length-1;E>=0;E--)if(u[E].getBoundingClientRect().bottom<h)return u[E];return null}function y(u,l){const h=u.getBoundingClientRect(),E=h.top+h.height/2,D=k(l),U=E-D;window.scrollBy({top:U,behavior:"smooth"})}function k(u){const l=u==="next"?j:1-j;return window.innerHeight*l}const p={commentsContainer:null,commentsObserver:null,isFiltersInitialized:!1,filters:{commentTextFilter:null,minReactionsFilter:null,filterEnabled:null,autoExpandFilter:null},minReactionsSelect:null,lastStatsSnapshot:"",isMinReactionsAutoSelectActive:!0,commentsInfo:null,commentsCache:new WeakMap,visibleComments:[]};async function Z(){q(),w(),await b(),await(0,r.Un)(M),he()}function q(){(0,c.Fi)(d.HIDE_TOP_COMMENTS_BUTTON)?.click()}async function b(){const u=(0,c.Fi)(d.OFFER);if(!u)return;const l=(0,c.Fi)(d.STICKY_HEADER);if(!l)return;const h=await(0,r.xk)(l,d.STICKY_HEADER_TITLE_CONTAINER);if(!h)return;const E=await(0,r.xk)(l,d.STICKY_HEADER_BUTTONS_CONTAINER);if(!E)return;h.classList.remove("md:w-[calc(100%-280px)]","w-[calc(100%-40px)]"),h.classList.add("flex-1","min-w-0"),E.classList.remove("md:w-[270px]","w-[40px]"),E.classList.add("w-auto","pl-2","pr-1");const D=(0,K.S)({whiteSpace:"nowrap"},u.textContent);D.classList.add("font-bold","text-primary","mr-3"),E.prepend(D)}function w(){if(!p.isFiltersInitialized){const{createGlobalFilter:u}=(0,O.z)(S);p.filters.commentTextFilter=u("comments-text-filter"),p.filters.minReactionsFilter=u("comments-min-reactions-filter",0),p.filters.filterEnabled=u("comments-filter-enabled",!0),p.filters.autoExpandFilter=u("comments-auto-expand",!1),p.isFiltersInitialized=!0}}function M(){if(p.commentsContainer=(0,c.Fi)(d.COMMENTS_CONTAINER),!p.commentsContainer)return;(0,g.b)(p.commentsContainer,t),S(),p.commentsObserver&&(0,r.wP)(p.commentsObserver),p.commentsObserver=new MutationObserver(l=>{for(const h of l)for(const E of h.addedNodes)if(E.nodeType===1&&(E.matches(d.COMMENT)||E.querySelector(d.COMMENT))){S();return}});const u=(0,c.Fi)(d.COMMENTS_LIST);p.commentsObserver.observe(u,{childList:!0,subtree:!0})}function t(u,l){(0,N.ZM)(u,f.FILTERS_CONTAINER);const h=(0,n.Nm)("\u0422\u0435\u043A\u0441\u0442:",p.filters.commentTextFilter,f.CONTROL,f.TEXT_INPUT),E=(0,n.SA)("\u0420\u0435\u0430\u043A\u0446\u0438\u0439: ",p.filters.minReactionsFilter,f.CONTROL,f.SELECT_INPUT),D=(0,a.pW)(p.filters.filterEnabled,f.CONTROL,f.CHECKBOX_INPUT),U=(0,n.Hw)("\u0410\u0432\u0442\u043E\u0440\u0430\u0441\u043A\u0440\u044B\u0442\u0438\u0435",p.filters.autoExpandFilter,f.CONTROL,f.CHECKBOX_INPUT);p.minReactionsSelect=E.querySelector("select"),p.commentsInfo=(0,K.S)(f.PUSHED_RIGHT_CONTROL),p.minReactionsSelect.addEventListener("change",z=>{if(p.isMinReactionsAutoSelectActive=!1,parseInt(z.target.value,10)===0)return;const te=z.target.options[z.target.selectedIndex],ne=parseInt(te.dataset.count,10);Number.isNaN(ne)||(0,G.nd)(ne)}),u.append(h,E,D,U,p.commentsInfo);const W=(0,c.Fi)(d.POST_BODY,l);l.insertBefore(u,W)}function S(){p.filters.autoExpandFilter.value&&F();const u=(0,c.fI)(d.COMMENT,p.commentsContainer),l={visible:[],collapsed:[]};u.forEach(h=>{(B(h)?l.collapsed:l.visible).push(h)}),X(l),p.visibleComments=l.visible,(0,A.Vk)(p.commentsInfo,p.visibleComments.length,u.length),ae(u)}function F(){(0,c.fI)(d.MORE_REPLIES_LINK,p.commentsContainer).forEach(l=>l.click())}function B(u){if(!p.filters.filterEnabled.value)return!1;R(u);let l=p.commentsCache.get(u);if(!l){const E=(0,c.Fi)(d.COMMENT_TEXT_WRAP,u);if(!E)return!1;const D=E.innerText,U=ce(u);l={commentText:D,commentTextWrap:E,reactionsCount:U},p.commentsCache.set(u,l)}return p.filters.commentTextFilter.value&&H(p.filters.commentTextFilter,l.commentTextWrap),(0,L.Ay)(l.commentText,p.filters.commentTextFilter)||(0,L.JE)(l.reactionsCount,p.filters.minReactionsFilter)}function X(u){u.visible.forEach(l=>{V(l),ie(l,!1)}),u.collapsed.forEach(l=>{ee(l),ie(l,!0)})}function V(u){(0,_.vJ)(u),u.style.maxHeight="",u.style.overflow=""}function ee(u){(0,_.iV)(u),u.style.maxHeight="83px",u.style.overflow="hidden"}function ie(u,l){const h=p.commentsCache.get(u);if(h?.lastHoverState!==l){if(l){let E=null;u.onmouseenter=()=>{clearTimeout(E),E=setTimeout(()=>V(u),250)},u.onmouseleave=()=>{clearTimeout(E),ee(u)}}else u.onmouseenter=null,u.onmouseleave=null;h&&(h.lastHoverState=l)}}function ce(u){const l=(0,c.Fi)(d.COMMENT_REACTIONS_CONTAINER,u);if(!l)return 0;const h=(0,c.fI)(d.COMMENT_REACTION,l);let E=0;return h.forEach(D=>{const U=parseInt(D.textContent.trim(),10);Number.isNaN(U)||(E+=U)}),E}function ae(u){if(!p.minReactionsSelect)return;const l=le(u),h=de(l),E=JSON.stringify(h);if(p.lastStatsSnapshot===E)return;p.lastStatsSnapshot=E,p.minReactionsSelect.innerHTML="";const D=document.createDocumentFragment();h.forEach(U=>{const W=document.createElement("option");W.value=U.value,W.textContent=U.label,W.dataset.count=U.count,D.appendChild(W)}),p.minReactionsSelect.appendChild(D),p.isMinReactionsAutoSelectActive&&fe(h),p.minReactionsSelect.value=p.filters.minReactionsFilter.value}function le(u){const l=new Map;return u.forEach(h=>{const E=p.commentsCache.get(h);if(!E)return;const D=E.reactionsCount;l.set(D,(l.get(D)||0)+1)}),l.size===0&&l.set(0,0),l}function de(u){const l=Array.from(u.keys()).sort((D,U)=>D-U),h=new Array(l.length);let E=0;for(let D=l.length-1;D>=0;D--){const U=l[D];E+=u.get(U),h[D]={value:U,label:`${U}+ (${E})`,count:E}}return h}function fe(u){const l=(0,G.Jm)();if(l===null||u.length===0)return;let h=u[0],E=1/0;for(const D of u){const U=me(D.count,l);U<E?(E=U,h=D):Math.abs(U-E)<.01&&D.count>h.count&&(h=D)}h.value===0&&(h=pe(h,u)),p.filters.minReactionsFilter.value!==h.value&&p.filters.minReactionsFilter.updateValue(h.value)}function me(u,l){const h=u-l,E=1.8;return h>=0?h:Math.abs(h)*E}function pe(u,l){const h=l.find(D=>D.value>0&&D.count>0);return h&&Ee(u.count,h.count)?h:u}function Ee(u,l){return u<=3?!1:u>=9?l>=1:u>=7?l>=2:l>=3}function he(){const u=(0,c.Fi)(d.SCROLL_TOP_BUTTON);if(!u)return;const l=40,h=10,E=55;D("\u0421\u043B\u0435\u0434.",1,"next"),D("\u041F\u0440\u0435\u0434.",2,"prev");function D(U,W,z){const $=u.cloneNode(!0);$.removeAttribute("id"),$.classList.remove("hidden");const te=E+(l+h)*W;$.style.bottom=`${te}px`;const ne=$.querySelector("span");if(ne&&(ne.innerText=U),z==="next"){const Q=$.querySelector("use");if(Q){const Ce=Q.getAttribute("xlink:href").replace("#up-arrow","#down-arrow");Q.setAttribute("xlink:href",Ce)}}$.onclick=Q=>{Q.stopPropagation(),re(z,p.visibleComments)},u.parentNode.insertBefore($,u)}}function ve(){p.commentsContainer=null,p.isFiltersInitialized=!1,p.filters={commentTextFilter:null,minReactionsFilter:null,filterEnabled:null,autoExpandFilter:null},p.minReactionsSelect=null,p.lastStatsSnapshot="",p.isMinReactionsAutoSelectActive=!0,p.commentsInfo=null,p.commentsCache=new WeakMap,p.visibleComments=[],clearObserver(p.commentsObserver)}},2043:(P,C,e)=>{e.d(C,{a:()=>c});function c(){window.GM_addStyle(`
        div#footer-show,
        div.card:has(div#deal-alert-form-content) {
            display: none !important;
        }
    `)}},5013:(P,C,e)=>{e.d(C,{B:()=>d});const c={INPUT:{border:"1px solid #d1d5db",borderRadius:"8px",marginLeft:"7px"}},d={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",marginBottom:".5rem",backgroundColor:"#fff",borderColor:"rgb(229, 229, 229)",position:"sticky"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...c.INPUT,width:"180px",padding:"7px 14px",backgroundColor:"#fff"},NUMBER_INPUT:{...c.INPUT,width:"90px",padding:"7px 14px",backgroundColor:"#fff"},SELECT_INPUT:{...c.INPUT,width:"100px",padding:"7px 14px",backgroundColor:"#fff"},CHECKBOX_INPUT:{...c.INPUT,width:"24px",height:"24px"}}},468:(P,C,e)=>{e.d(C,{P:()=>T});var c=e(573);const d={DISCUSSIONS:"div.md\\:block.hidden.common-box:nth-of-type(3)",PRODUCT_CARD:".deal-card",PRODUCT_CARD_RATING:".common-box span",PRODUCT_NAME:".custom-card-title",PRODUCT_CARD_LINK:".custom-card-title > a",PRODUCT_PRICE:"div.md\\:text-xll.text-lg.font-bold.text-primary.mr-2"};var O=e(4521),g=e(5213),N=e(6754),m=e(5013);const s={...m.B,FILTERS_CONTAINER:{...m.B.FILTERS_CONTAINER,padding:"11px 19px",borderWidth:"1px",borderRadius:"10px",top:"-1px",zIndex:"11"}};var v=e(7877),o=e(5884),f=e(5539),a=e(3829),n=e(7926);const _={ID_BADGE_APPENDED:"idBadgeAppended",SEEN_PRODUCT_CARD:"seenProductCard",MARK_AS_NEWEST_SEEN_APPENDED:"markAsNewestSeenAppended"};var L=e(4921),r=e(7273);const i={productListObserver:null,isFiltersInitialized:!1,filters:{nameFilter:null,minVotesFilter:null,maxPriceFilter:null,showExpiredFilter:null,filterEnabled:null},prevNewestSeenProductId:null};async function T(){R(),A(),await H(),await Z()}function R(){i.prevNewestSeenProductId=(0,n.Fr)()}function A(){if(!i.isFiltersInitialized){const{createGlobalFilter:b}=(0,O.z)(H);i.filters.nameFilter=b("name-filter"),i.filters.minVotesFilter=b("min-votes-filter",50),i.filters.maxPriceFilter=b("max-price-filter"),i.filters.showExpiredFilter=b("show-expired-filter",!1),i.filters.filterEnabled=b("filter-enabled",!0),i.isFiltersInitialized=!0}}function H(){const b=(0,c.fI)(d.PRODUCT_CARD);if(b.length){const w=b[0].parentElement;(0,g.b)(w,Y),G(),i.productListObserver&&(0,L.wP)(i.productListObserver),i.productListObserver=new MutationObserver(G),i.productListObserver.observe(w,{childList:!0,subtree:!0})}}function Y(b,w){(0,N.ZM)(b,s.FILTERS_CONTAINER);const M=(0,v.E9)(i.filters.nameFilter,s.CONTROL,s.TEXT_INPUT),t=(0,o.nW)("\u041C\u0438\u043D. \u0433\u043E\u043B\u043E\u0441\u043E\u0432: ",i.filters.minVotesFilter,"50","0","10000",s.CONTROL,s.NUMBER_INPUT),S=(0,v.H1)(i.filters.maxPriceFilter,s.CONTROL,s.NUMBER_INPUT),F=(0,o.Hw)("\u0417\u0430\u0432\u0435\u0440\u0448\u0451\u043D\u043D\u044B\u0435: ",i.filters.showExpiredFilter,s.CONTROL,s.CHECKBOX_INPUT),B=(0,v.pW)(i.filters.filterEnabled,s.CONTROL,s.CHECKBOX_INPUT);b.append(M,t,S,F,B),w.prepend(b)}function G(){(0,c.fI)(d.PRODUCT_CARD).forEach(K);const w=(0,c.Fi)(`[${_.SEEN_PRODUCT_CARD}]`);w&&(w.style.marginTop="45px")}function K(b){const w=(0,c.Fi)(d.PRODUCT_CARD_LINK,b),M=j(w);if(re(b,M),I(M,b),x(b,M),!i.filters.filterEnabled.value){(0,f.vJ)(b);return}if(b.classList.contains("expired-view")&&!i.filters.showExpiredFilter.value){(0,f.iV)(b);return}const S=(0,c.Fi)(d.PRODUCT_CARD_RATING,b);if(S.innerText.includes("\u041D\u043E\u0432\u043E\u0435"))return;const F=(0,c.Fi)(d.PRODUCT_NAME,b),B=(0,c.Fi)(d.PRODUCT_PRICE,b),X=F.innerText,V=(0,c.YA)(S,!0),ee=(0,c.YA)(B,!0),ie=(0,a.Ay)(X,i.filters.nameFilter)||(0,a.JE)(V,i.filters.minVotesFilter)||(0,a.iG)(ee,i.filters.maxPriceFilter);(0,f.D9)(b,ie)}function j(b){return+b.getAttribute("href").split("-").pop()}function re(b,w){if(b.hasAttribute(_.ID_BADGE_APPENDED))return;const M=b.querySelector(".md\\:col-start-2.row-start-1 .flex.items-center");if(!M)return;const t=(0,r.V)({marginRight:"10px"},`#${w}`);t.className="product-id-badge text-secondary-text-light dark:text-secondary-text-dark text-xs",b.addEventListener("mouseenter",()=>{const S=w-i.prevNewestSeenProductId,F=S>0?"+":"";t.textContent=`#${w} (${F}${S})`}),b.addEventListener("mouseleave",()=>{t.textContent=`#${w}`}),M.insertBefore(t,M.firstChild),b.setAttribute(_.ID_BADGE_APPENDED,"")}function I(b,w){w.style.removeProperty("margin-top"),b>i.prevNewestSeenProductId?(w.style.border="3px solid #8ab854",w.removeAttribute(_.SEEN_PRODUCT_CARD)):(w.style.removeProperty("border"),w.setAttribute(_.SEEN_PRODUCT_CARD,""))}function x(b,w){b.hasAttribute(_.MARK_AS_NEWEST_SEEN_APPENDED)||(b.addEventListener("mousedown",M=>{if(M.button===1&&!M.target.closest("a")){const t=w-(0,n.CU)(),S=(0,n.sV)(),F=y(S),B=["\u041F\u043E\u043C\u0435\u0442\u0438\u0442\u044C \u043A\u0430\u043A \u043D\u043E\u0432\u043E\u0435?","",`\u041D\u043E\u0432\u044B\u0445 \u0442\u043E\u0432\u0430\u0440\u043E\u0432: ~${t}`];F&&B.push(`\u0421 \u043F\u0440\u043E\u0448\u043B\u043E\u0433\u043E \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u043F\u0440\u043E\u0448\u043B\u043E: ${F}`);const X=B.join(`
`);confirm(X)&&(p(w),M.preventDefault())}}),b.setAttribute(_.MARK_AS_NEWEST_SEEN_APPENDED,""))}function y(b){const w=b?new Date(b):null;if(!w)return null;const M=Math.floor((Date.now()-w.getTime())/6e4);return k(M)}function k(b){const w=Math.floor(b/1440),M=Math.floor(b%1440/60),t=b%60;return w>0?`${w} \u0434. ${M} \u0447. ${t} \u043C.`:M>0?`${M} \u0447. ${t} \u043C.`:`${t} \u043C.`}function p(b){const w=(0,n.CU)();(0,n.X0)(w),(0,n.Su)(b),(0,n.MB)(),i.prevNewestSeenProductId=w,G()}async function Z(){const b=(0,c.Fi)(d.DISCUSSIONS);b&&(b.style.position="sticky",b.style.top="0")}function q(){i.isFiltersInitialized=!1,i.filters={nameFilter:null,minVotesFilter:null,maxPriceFilter:null,showExpiredFilter:null,filterEnabled:null},i.prevNewestSeenProductId=null,clearObserver(i.productListObserver)}}},ue={};function J(P){var C=ue[P];if(C!==void 0)return C.exports;var e=ue[P]={exports:{}};return se[P](e,e.exports,J),e.exports}(()=>{var P=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",C=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",e=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",c=O=>{O&&O.d<1&&(O.d=1,O.forEach(g=>g.r--),O.forEach(g=>g.r--?g.r++:g()))},d=O=>O.map(g=>{if(g!==null&&typeof g=="object"){if(g[P])return g;if(g.then){var N=[];N.d=0,g.then(v=>{m[C]=v,c(N)},v=>{m[e]=v,c(N)});var m={};return m[P]=v=>v(N),m}}var s={};return s[P]=v=>{},s[C]=g,s});J.a=(O,g,N)=>{var m;N&&((m=[]).d=-1);var s=new Set,v=O.exports,o,f,a,n=new Promise((_,L)=>{a=L,f=_});n[C]=v,n[P]=_=>(m&&_(m),s.forEach(_),n.catch(L=>{})),O.exports=n,g(_=>{o=d(_);var L,r=()=>o.map(T=>{if(T[e])throw T[e];return T[C]}),i=new Promise(T=>{L=()=>T(r),L.r=0;var R=A=>A!==m&&!s.has(A)&&(s.add(A),A&&!A.d&&(L.r++,A.push(L)));o.map(A=>A[P](R))});return L.r?i:r()},_=>(_?a(n[e]=_):f(v),c(m))),m&&m.d<0&&(m.d=0)}})(),J.d=(P,C)=>{for(var e in C)J.o(C,e)&&!J.o(P,e)&&Object.defineProperty(P,e,{enumerable:!0,get:C[e]})},J.o=(P,C)=>Object.prototype.hasOwnProperty.call(P,C);var ge=J(9374)})();})();
