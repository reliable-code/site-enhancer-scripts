// ==UserScript==
// @name         Prodoc enhancer
// @description  Hide doctor cards by filter, enhance doctor page
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://prodoctorov.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      2.0.76953891
// @icon         https://www.google.com/s2/favicons?sz=64&domain=prodoctorov.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/prodoc.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var te={5467:(S,g,e)=>{e.d(g,{E2:()=>o});var p=e(9928);function o(R,m={},u=null){const i=(0,p.Sw)(m,u);return i.append(R),i}function f(R,m=null,u={},i={}){const t=createActionLink(R,m,i);return o(t,u)}function v(R,m=null,u=null,i={},t={},s={}){const r=createActionLinkWithIcon(R,u,m,t,s);return o(r,i)}},9928:(S,g,e)=>{e.d(g,{S:()=>m,Sw:()=>T,d:()=>s,kU:()=>f,o5:()=>v});var p=e(4921),o=e(6754);function f(E,c,I){const a=u(E,"text",c);return a.value=I,a}function v(E,c,I,a,x,V){const U=u(E,"number",c);return U.value=I,U.step=a,U.min=x,U.max=V,U}function R(E,c,I){const a=u(E,"date",c);return a.value=I,a}function m(E,c,I){const a=u(E,"checkbox",c);return a.checked=I,a}function u(E={},c=null,I=null){const a=h("input",E);return c&&(a.type=c),I&&(a.addEventListener("keyup",(0,p.sg)(I,200)),a.addEventListener("change",(0,p.sg)(I,100))),a}function i(E,c,I){const a=h("select",E);return c&&a.addEventListener("change",c),a.value=I,a}function t(E={},c=null){return h("span",E,c)}function s(E={},c=null,I=null){const a=h("a",E,c);return I&&(a.href=I),a}function r(E,c=null,I={}){I.cursor||="pointer";const a=s(I,c);return E&&a.addEventListener("click",E),a}function l(E,c,I=null,a={},x={}){a.display||="inline-flex",a.alignItems||="center",a.gap||="0.25em";const V=r(E,I,a);return V.prepend(L(c,x)),V}function w(E={},c=null,I=null){const a=h("button",E,c);return I&&a.addEventListener("click",I),a}function T(E={},c=null){return h("div",E,c)}function d(E={},c=null){return h("i",E,c)}function L(E,c={}){c.width||="1em",c.height||="1em";const I=createLucideSvg(E);return applyStyles(I,c),I}function h(E,c,I=null){if(typeof c!="object"||c===null)throw new TypeError("styles should be an object");const a=document.createElement(E);return(0,o.ZM)(a,c),I&&(a.innerHTML=I),a}},573:(S,g,e)=>{e.d(g,{Fi:()=>f,YA:()=>i,fI:()=>v});var p=e(4214);function o(d,L=document){return!!L.querySelector(d)}function f(d,L=document,h=!1){const E=L.querySelector(d);return h&&!E&&console.log(`No element found for selector: ${d}`),E}function v(d,L=document,h=!1){const E=L.querySelectorAll(d);return h&&!E.length&&console.log(`No elements found for selector: ${d}`),E}function R(d,L=1){let h=d;for(let E=0;E<L;E++){if(!h.parentElement)return null;h=h.parentElement}return h}function m(d,L,h){return[...d.querySelectorAll(L)].find(E=>E.textContent.trim().includes(h))}function u(d,L,h=!1,E=!1,c=null){const I=f(L,d);return i(I,h,E,c)}function i(d,L=!1,h=!1,E=null){if(!d)return E===null?(console.log("No element found"),null):E;const c=d.innerText;return r(c,L,h)}function t(d,L,h=!1){const E=d[L];return i(E,h)}function s(d,L=!1,h=!1){const E=d.textContent;return r(E,L,h)}function r(d,L,h){L&&(d=(0,p.zr)(d)),h&&(d=d.replace(",","."));const E=Number(d);return Number.isNaN(E)?(console.log(`Invalid number: ${d}`),0):E}function l(d){return[...d.childNodes].find(L=>L.nodeType===Node.TEXT_NODE)}function w(d){const L=h=>h.nodeType===Node.TEXT_NODE&&h.textContent.trim()!==""?[h]:[...h.childNodes].flatMap(L);return L(d)}function T(d){return normalizeSpacing(d.textContent)}},5539:(S,g,e)=>{e.d(g,{Bt:()=>o,UC:()=>t,WH:()=>p,kl:()=>u});function p(n,O){n.parentNode.insertBefore(O,n.nextSibling)}function o(n){n.style.display="none"}function f(n,O=1){const _=document.querySelector(n);_&&v(_,O)}function v(n,O=1){const _=getElementAncestor(n,O);_&&o(_)}function R(n){l(n),o(n)}function m(n){n.intersectionObserver||runOnceOnIntersection(n,()=>o(n))}function u(n){n.style.display=""}function i(n){const O=r(n);n.style.display=O}function t(n,O){O?o(n):u(n)}function s(n,O){O?m(n):(clearIntersectionObserver(n),u(n))}function r(n){return l(n),n.defaultDisplay}function l(n){if(n.defaultDisplay)return;const{display:O}=getComputedStyle(n);n.defaultDisplay=O}function w(){return{show:[],hide:[]}}function T(n,O,_){n?O.hide.push(_):O.show.push(_)}function d(n){n.show.forEach(u),n.hide.forEach(o)}function L(n,O,_=.3){O?E(n,_):h(n)}function h(n){n.style.opacity=""}function E(n,O=.3){n.style.opacity=O}function c(n){n.style.order=""}function I(n,O){n.style.order=O}function a(n,O){n.style.background=O}function x(n,O){const _=getFirstElement(O);_&&V(n,_)}function V(n,O){const _=createLink();_.href=n,O.parentNode.append(_),_.append(O)}function U(n,O){const _=getFirstElement(O);_&&z(n,_)}function z(n,O,_={}){const $=createLink(_);$.href=n,$.append(...O.childNodes),O.append($)}function N(){const n=getURLQueryParam("scrollTo");if(!n)return;const O=document.getElementById(n);O?O.scrollIntoView():console.log(`Element with ID "${n}" was not found.`)}function C(n,O,_=null){const $=`${O}-click-passed`,G=_?P=>findElementByText(P,n,_):P=>getFirstElement(n,P);return function(P){if(P.hasAttribute($))return!1;const D=G(P);return D&&D.click(),P.setAttribute($,""),!0}}function b(n,O,_="text/plain"){const $=new Blob([n],{type:_}),G=URL.createObjectURL($),P=document.createElement("a");P.href=G,P.download=O,document.body.appendChild(P),P.click(),document.body.removeChild(P),requestAnimationFrame(()=>URL.revokeObjectURL(G))}},6754:(S,g,e)=>{e.d(g,{ZM:()=>p});function p(R,m){Object.assign(R.style,m)}function o(R,m="custom-global-style"){let u=document.getElementById(m);u||(u=document.createElement("style"),u.id=m,u.type="text/css",document.head.appendChild(u)),u.textContent=R}function f(R){return Object.entries(R).map(([m,u])=>`${m.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${u};`).join(" ")}function v(R){return R?R.split(";").filter(m=>m.trim()!=="").reduce((m,u)=>{const[i,t]=u.split(":").map(r=>r.trim()),s=i.replace(/-([a-z])/g,(r,l)=>l.toUpperCase());return m[s]=t,m},{}):{}}},4921:(S,g,e)=>{e.d(g,{sg:()=>v,xk:()=>p});function p(t,s,r=null){const l=t.querySelector(s);return l?Promise.resolve(l):new Promise(w=>{const T=new MutationObserver(L);T.observe(t,{childList:!0,subtree:!0});let d;r&&(d=setTimeout(()=>{T.disconnect(),console.log(`No element found for selector: ${s}`),w(null)},r));function L(){const h=t.querySelector(s);h&&(d&&clearTimeout(d),T.disconnect(),w(h))}})}function o(t,s){return t.querySelector(s)?new Promise(l=>{const w=new MutationObserver(T);w.observe(t,{childList:!0,subtree:!0});function T(){t.querySelector(s)||(w.disconnect(),l())}}):Promise.resolve()}function f(t,s=400){return new Promise(r=>{let l;const w=new MutationObserver(()=>{clearTimeout(l),T()});function T(){l=setTimeout(()=>{w.disconnect(),r()},s)}T(),w.observe(t,{childList:!0,subtree:!0})})}function v(t,s=250){let r;return(...l)=>{clearTimeout(r),r=setTimeout(()=>t(...l),s)}}async function R(t){document.visibilityState==="visible"?await t():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await t()},{once:!0})}function m(t,s){const r=new IntersectionObserver(l=>{l.forEach(w=>{w.isIntersecting&&(s(),u(t))})});t.intersectionObserver=r,r.observe(t)}function u(t){t.intersectionObserver&&(t.intersectionObserver.disconnect(),t.intersectionObserver=null)}function i(t){t&&(t.disconnect(),t=null)}},3829:(S,g,e)=>{e.d(g,{Ay:()=>o,JE:()=>m,iG:()=>u});var p=e(8355);function o(r,l){return!f(r,l)}function f(r,l){if(!l||!l.value)return!0;const w=(0,p._7)(l.value);return v(r,w)}function v(r,l){if(!l||!l.length)return!0;const w=(r||"").toLowerCase();return l.every(T=>R(w,T))}function R(r,l){return l.some(({term:w,isNegative:T})=>{const d=r.includes(w);return T?!d:d})}function m(r,l){return l.value!=null&&r<l.value}function u(r,l){return l.value!=null&&r>l.value}function i(r,l){return l.value==null?!1:r<parseDateFromISO(l.value)}function t(r,l){return l.value==null?!1:r>parseDateFromISO(l.value)}function s(r,l){return l.value&&r!==l.value}},4521:(S,g,e)=>{e.d(g,{z:()=>o});var p=e(3048);function o(f,v=null){return{createGlobalFilter(R,m=null,u=f){return p.V.create(R,m,u)},createSectionFilter(R,m=null,u=f){if(!v)throw new Error("sectionId must be provided to use createSectionFilter.");return p.V.createWithCompositeKey(v,R,m,u)}}}},5884:(S,g,e)=>{e.d(g,{Hw:()=>u,Nm:()=>f,nW:()=>v});var p=e(9928),o=e(5467);function f(i,t,s={},r={}){const l=(0,p.kU)(r,t.updateValueFromEvent,t.value);return(0,o.E2)(l,s,i)}function v(i,t,s,r,l,w={},T={}){const d=(0,p.o5)(T,t.updateValueFromEvent,t.value,s,r,l);return(0,o.E2)(d,w,i)}function R(i,t,s={},r={}){const l=createSelect(r,t.updateValueFromEvent,t.value);return createControl(l,s,i)}function m(i,t,s={},r={}){const l=createDateInput(r,t.updateValueFromEvent,t.value);return createControl(l,s,i)}function u(i,t,s={},r={}){const l=(0,p.S)(r,t.updateValueFromEvent,t.value);return(0,o.E2)(l,s,i)}},7877:(S,g,e)=>{e.d(g,{E9:()=>o,FR:()=>v,HX:()=>f,X0:()=>R,pW:()=>U});var p=e(5884);function o(N,C={},b={}){return(0,p.Nm)("\u041F\u043E\u0438\u0441\u043A: ",N,C,b)}function f(N,C={},b={},n=.1,O=3){return(0,p.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",N,n,O,5,C,b)}function v(N,C={},b={},n=.1,O=3){return(0,p.nW)("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",N,n,O,5,C,b)}function R(N,C={},b={}){return u("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",N,C,b)}function m(N,C={},b={}){return u("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",N,C,b)}function u(N,C,b={},n={}){return(0,p.nW)(N,C,"1","1","999999",b,n)}function i(N,C={},b={}){return createDateFilterControl("\u041C\u0438\u043D. \u0434\u0430\u0442\u0430: ",N,C,b)}function t(N,C={},b={}){return s("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",N,C,b)}function s(N,C,b={},n={}){return createNumberFilterControl(N,C,"5","0","100",b,n)}function r(N,C={},b={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",N,"5","0","100",C,b)}function l(N,C,b={},n={},O="250"){return createNumberFilterControl(N,C,O,"0","1000000",b,n)}function w(N,C={},b={},n="25"){return l("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",N,C,b,n)}function T(N,C={},b={},n="25"){return l("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",N,C,b,n)}function d(N,C={},b={}){return L("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",N,C,b)}function L(N,C,b={},n={}){return createNumberFilterControl(N,C,"1","0","99999",b,n)}function h(N,C={},b={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",N,"1","2","8",C,b)}function E(N,C={},b={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",N,1,1,10,C,b)}function c(N,C={},b={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",N,C,b)}function I(N,C={},b={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",N,C,b)}function a(N,C={},b={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",N,C,b)}function x(N,C={},b={}){return createCheckboxFilterControl("\u0411\u043E\u043D\u0443\u0441: ",N,C,b)}function V(N,C={},b={}){return createCheckboxFilterControl("\u0412 \u043D\u0430\u043B\u0438\u0447\u0438\u0438: ",N,C,b)}function U(N,C={},b={}){return(0,p.Hw)("\u0412\u043A\u043B: ",N,C,b)}function z(N,C,b={}){const n=[{value:-25,emoji:"\u{1F48E}",tooltip:"\u0421\u0443\u043F\u0435\u0440 \u0446\u0435\u043D\u0430 (-25%)"},{value:-15,emoji:"\u{1F525}",tooltip:"\u041E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-15%)"},{value:-5,emoji:"\u{1F31F}",tooltip:"\u041A\u043B\u0430\u0441\u0441\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-5%)"},{value:5,emoji:"\u{1F44C}",tooltip:"\u0425\u043E\u0440\u043E\u0448\u0430\u044F \u0446\u0435\u043D\u0430 (+5%)"}],O={active:{background:"#e3f2fd",borderColor:"#2196f3",boxShadow:"0 0 0 1px #2196f3"},inactive:{background:"#fff",borderColor:"#ccc",boxShadow:"none"},hover:{background:"#f5f5f5"}},_=createDiv({display:"inline-flex",gap:"4px",marginLeft:"4px"}),$=[],G=()=>C?parseFloat(C.value)||0:N.value,P=()=>{const D=G();$.forEach(({button:B,value:K})=>{const F=K<=D?O.active:O.inactive;Object.assign(B.style,F)})};return n.forEach(({value:D,emoji:B,tooltip:K})=>{const k=createButton({padding:"2px 6px",fontSize:"16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"#fff",transition:"all 0.2s",...b},B);k.title=K,k.type="button",k.addEventListener("click",F=>{F.preventDefault(),N.updateValue(D),C&&(C.value=D),P()}),k.addEventListener("mouseenter",()=>{D<=G()||(k.style.background=O.hover.background)}),k.addEventListener("mouseleave",()=>{P()}),$.push({button:k,value:D}),_.appendChild(k)}),P(),C&&(C.addEventListener("input",P),C.addEventListener("change",P)),_}},8355:(S,g,e)=>{e.d(g,{_7:()=>o,fO:()=>p});function p(i){if(!i)return[];const s=o(i).flat().filter(r=>r&&!r.isNegative&&r.term).map(r=>r.term);return[...new Set(s)]}function o(i){return i?i.toLowerCase().split(",").map(f).filter(Boolean):[]}function f(i){const t=i.split("/").map(r=>r.trim()).filter(Boolean);if(t.length===0)return null;const s=t.map(v).filter(Boolean);return s.length>0?s:null}function v(i){const t=i.startsWith("!"),s=t?i.slice(1).trim():i;return s?{term:s,isNegative:t}:null}function R(i,t){u(i,s=>s.style.display!=="none",t)}function m(i,t){u(i,s=>s.style.opacity==="",t)}function u(i,t,s){const r=[...i].filter(t).length;s.textContent=`\u041F\u043E\u043A\u0430\u0437\u0430\u043D\u043E: ${r} \u0438\u0437 ${i.length}`}},5213:(S,g,e)=>{e.d(g,{b:()=>f});var p=e(9928),o=e(573);function f(v,R,m=!1,u="customFiltersContainer"){let i=(0,o.Fi)(`#${u}`,v);if(i)if(m)i.remove();else return;i=(0,p.Sw)(),i.id=u,R(i,v)}},8200:(S,g,e)=>{e.d(g,{s:()=>p});function p(o){const{target:f}=o,{type:v}=f;switch(v){case"text":return`"${f.value}"`;case"number":return f.value;case"select-one":return f.value;case"date":return`"${f.value}"`;case"checkbox":return f.checked;default:return console.log(`Unknown input type: ${v}`),null}}},157:(S,g,e)=>{e.d(g,{Fg:()=>p,vx:()=>f});const p=window.GM_setValue,o=window.GM.setValue,f=window.GM_getValue},1870:(S,g,e)=>{e.d(g,{j:()=>p});class p{constructor(f,v){this.value=f,this.onChange=v}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(S,g,e)=>{e.d(g,{V:()=>R});var p=e(1870),o=e(8200),f=e(3976),v=e(157);class R extends p.j{constructor(u,i=null,t=null){super((0,v.vx)(u,i),t),this.storageKey=u,this.defaultValue=i}static create(u,i=null,t=null){return new R(u,i,t)}static createWithCompositeKey(u,i,t=null,s=null){const r=`${u}-${i}`;return new R(r,t,s)}updateValueFromEvent=u=>{const i=(0,o.s)(u),t=(0,f.$)(i);this.updateValue(t)};updateValue(u,i=!0){this.value!==u&&((0,v.Fg)(this.storageKey,u),this.value=u,i&&this.onChangeIfDefined())}clearValue(u=!1){this.updateValue(null,u)}resetValue(u=!1){this.updateValue(this.defaultValue,u)}}},3976:(S,g,e)=>{e.d(g,{$:()=>p});function p(o){return o===""?null:JSON.parse(o)}},4214:(S,g,e)=>{e.d(g,{$z:()=>p,zr:()=>o});function p(m){return m.replace(/\D/g,"")}function o(m){return m.replace(/[^\d.,-]/g,"")}function f(m){return m.replace(/\s/g,"")}function v(m){return m.charAt(0).toUpperCase()+m.slice(1)}function R(m){return m.replace(/\s+/g," ").trim()}},5406:(S,g,e)=>{e.d(g,{$F:()=>m,Fc:()=>p,bn:()=>o,z2:()=>s});function p(T,d="common",L=!1){const{pathname:h}=window.location;return o(h,T,d,L)}function o(T,d,L,h=!1){const E=T.split("/");d=d<0?E.length+d:d;const c=E[d]||L;return h&&console.log(`Pathname element: ${c}`),c}function f(T,d="common",L=!1){const h=p(T,"",L);return v(h,d,L)}function v(T,d,L){if(!T)return d;const h=T.split("-").at(-1);return L&&console.log(`Pathname element ending: ${h}`),h}function R(T,d,L="common",h=!1){const E=o(T,d,"",h);return v(E,L,h)}function m(T){return new URLSearchParams(window.location.search).get(T)}function u(T){return T.split("?")[0]}function i(T){return window.location.pathname.includes(T)}function t(T){return T.some(d=>i(d))}function s(...T){return window.location.pathname.split("/").some(L=>T.includes(L))}function r(T){try{const d=new URL(window.location.href);Object.entries(T).forEach(([L,h])=>{d.searchParams.set(L,h)}),window.location.href=d.toString()}catch(d){console.error("Failed to redirect:",d)}}function l(T,d=[]){const L={pathname:window.location.pathname};d.forEach(a=>{L[a]=m(a)});let h=!1;async function E(){if(h)return;const a={pathname:window.location.pathname};if(d.forEach(x=>{a[x]=m(x)}),Object.keys(L).some(x=>L[x]!==a[x])){Object.assign(L,a),h=!0;try{await T()}catch(x){console.error("Error in URL observer callback:",x)}finally{h=!1}}}function c(){E().catch(a=>{console.error("Error in URL change handler:",a)})}let I=window.location.href;setInterval(()=>{window.location.href!==I&&(I=window.location.href,c())},200),window.addEventListener("popstate",c)}function w(T=[]){l(()=>window.location.reload(),T)}},2524:(S,g,e)=>{e.d(g,{d5:()=>f,vX:()=>u,ft:()=>v});var p=e(157);class o{constructor(s=Date.now(),r=[]){this.lastCheckDate=s,this.reviewsData=r}updateLastCheckDate=()=>{this.lastCheckDate=Date.now()};static fromObject(s){const{lastCheckDate:r,reviewsData:l}=s;return new o(r,l)}}const f={LAST_DOCTOR_UPDATE:"last-doctor-update"};function v(t,s){const r=R(t),l=(0,p.vx)(r),w=m(l);w.reviewsData=s,w.updateLastCheckDate(),(0,p.Fg)(r,w),(0,p.Fg)(f.LAST_DOCTOR_UPDATE,Date.now())}function R(t){return`doctor-${t}`}function m(t){return t?o.fromObject(t):new o}function u(t){return i(t)?.reviewsData??null}function i(t){const s=R(t);return(0,p.vx)(s)}},1753:(S,g,e)=>{e.a(S,async(p,o)=>{try{var f=e(573),v=e(7858),R=e(4231),m=e(5406),u=e(5072);const t=(0,f.Fi)(".appointments_page");t?(0,R.$)(t):(0,m.z2)("otzivi")?await(0,u.N)():(0,m.z2)("vrach")&&(0,v.O)(),o()}catch(i){o(i)}},1)},7653:(S,g,e)=>{e.d(g,{NI:()=>t,z1:()=>l,Np:()=>L,pR:()=>w,sp:()=>E,rd:()=>h});var p=e(9928),o=e(573);const f={DOCTOR_CARD_NAME:'.b-doctor-intro__title-first-line [itemprop="name"]',DOCTOR_INTRO_LEFT:".b-doctor-intro__left-side",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]'};var v=e(8586),R=e(5406),m=e(4214);const u="additionalLinksAppended",i=["\u042F\u043D\u0434\u0435\u043A\u0441","\u041D\u0430\u041F\u043E\u043F\u0440\u0430\u0432\u043A\u0443","DocDoc","\u0414\u043E\u043A\u0442\u0443"];function t(c,I){I.classList.contains(u)||(i.forEach(a=>{s(c,I,a)}),I.classList.add(u))}function s(c,I,a){const x=r(c,a),V=(0,p.d)({},a,x),U=document.createElement("br");I.append(U,V)}function r(c,I){const a=`${c} ${I}`;return`https://www.google.com/search?q=${encodeURIComponent(a)}&btnI`}function l(){const c=(0,o.Fi)(f.DOCTOR_CARD_NAME,document,!0);if(!c)return;const I=c.innerText.trim(),a=(0,p.Sw)();a.style.textAlign="center",(0,o.Fi)(f.DOCTOR_INTRO_LEFT).append(a),t(I,a)}function w(c,I,a=!1){const x=(0,p.Sw)(v.r.REVIEWS_INFO);a&&(x.style.justifyContent="center"),x.classList.add("v-application");const V=(0,p.Sw)(v.r.REVIEWS_INFO_BLOCK);return V.style.height=a?"10px":"23px",V.append(x),c.slice(a?1:0).forEach(U=>{const{category:z,title:N,count:C,bgClassSuffix:b}=U,n=`${I}?rates_category=${z}`,O=a?C:`${N} ${C}`,_=(0,p.d)(v.r.REVIEW_INFO,O,n);_.classList=T(b),x.append(_),a&&d(_,N)}),V}function T(c){return`text-caption text--text px-2 py-1 rounded-sm bg-${c}`}function d(c,I){let a=null;c.addEventListener("mouseenter",()=>{a=(0,p.Sw)(v.r.REVIEW_INFO_TOOLTIP,I),document.body.appendChild(a);const x=c.getBoundingClientRect();a.style.left=`${(x.left+x.right)/2-a.offsetWidth/2+window.scrollX+2}px`,a.style.top=`${x.top+window.scrollY-a.offsetHeight-4}px`}),c.addEventListener("mouseleave",()=>{a&&(a.remove(),a=null)})}function L(c){const I=(0,o.Fi)(f.NAME_SPAN_HOLDER,document,!0);if(!I)return;const a=(0,o.Fi)(f.NAME_SPAN,I,!0);a&&a.append(c)}function h(){const c=(0,R.Fc)(3,"unknown");return(0,m.$z)(c)}function E(c){const I=(0,R.bn)(c,5,"");return(0,m.$z)(I)}},8586:(S,g,e)=>{e.d(g,{r:()=>o});const p={INPUT:{border:"1px solid #c7d3d9",borderRadius:"10px",padding:"7px 14px",marginLeft:"6px"}},o={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",flexFlow:"wrap"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...p.INPUT,width:"195px"},NUMBER_INPUT:{...p.INPUT,width:"70px"},CHECKBOX_INPUT:{...p.INPUT,width:"20px",height:"20px"},REVIEWS_INFO:{gridGap:"6px"},REVIEWS_INFO_BLOCK:{marginTop:"5px"},REVIEW_INFO:{textDecoration:"none",flexShrink:0},REVIEW_INFO_TOOLTIP:{position:"absolute",backgroundColor:"#333",color:"#fff",padding:"4px 8px",borderRadius:"8px",fontSize:"12px",zIndex:"1000",pointerEvents:"none",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"}}},4231:(S,g,e)=>{e.d(g,{$:()=>N});var p=e(5406),o=e(573),f=e(5539),v=e(3829),R=e(7653),m=e(5213),u=e(5884),i=e(7877);const t={LIST_HEADER:".h2_rating",DOCTOR_FILTERS:".vue-the-doctors-filters > .b-container",DOCTOR_CARD:".b-doctor-card",DOCTOR_CARD_NAME:".b-doctor-card__name-surname",PROFILE_CARD:".b-profile-card",REVIEWS_LINK:":scope > a",EXPERIENCE_WRAP:".b-doctor-card__experience .text-subtitle-1",SPEC_WRAP:".b-doctor-card__spec",CLINIC_CONTAINER:"div.b-doctor-card__lpu-select",CLINIC_WRAP:".b-select__trigger-main-text"};var s=e(4521),r=e(2524),l=e(4921),w=e(8586),T=e(6754);const d=window.GM_addValueChangeListener,L=(0,p.Fc)(2),{createGlobalFilter:h,createSectionFilter:E}=(0,s.z)(n,L),c=E("spec-filter"),I=E("clinic-filter"),a=E("min-reviews-filter",10),x=E("min-experience-filter",5,P),V=E("max-experience-filter",40),U=h("filter-enabled",!0),z={doctorCardsCache:new WeakMap};function N(D){P(),C();const B=(0,o.Fi)(t.DOCTOR_FILTERS);(0,m.b)(B,b),n(),d(r.d5.LAST_DOCTOR_UPDATE,n),new MutationObserver((0,l.sg)(n)).observe(D,{childList:!0})}function C(){const D=(0,o.Fi)(t.LIST_HEADER);D&&D.remove()}function b(D,B){(0,T.ZM)(D,w.r.FILTERS_CONTAINER),D.style.marginTop="6px";const K=(0,u.Nm)("\u0421\u043F\u0435\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F:",c,w.r.CONTROL,w.r.TEXT_INPUT),k=(0,u.Nm)("\u041A\u043B\u0438\u043D\u0438\u043A\u0430:",I,w.r.CONTROL,w.r.TEXT_INPUT),F=(0,i.X0)(a,w.r.CONTROL,w.r.NUMBER_INPUT),A=(0,u.nW)("\u041C\u0438\u043D. \u043E\u043F\u044B\u0442: ",x,"1","0","100",w.r.CONTROL,w.r.NUMBER_INPUT),y=(0,u.nW)("\u041C\u0430\u043A\u0441. \u043E\u043F\u044B\u0442: ",V,"1","0","100",w.r.CONTROL,w.r.NUMBER_INPUT),W=(0,i.pW)(U,w.r.CONTROL,w.r.CHECKBOX_INPUT);D.append(K,k,F,A,y,W),B.append(D)}function n(){(0,o.fI)(t.DOCTOR_CARD).forEach(O)}function O(D){if(!U.value){(0,f.kl)(D);return}let B=z.doctorCardsCache.get(D);if(!B){const k=(0,o.Fi)(t.PROFILE_CARD,D),F=(0,o.Fi)(t.REVIEWS_LINK,k),A=(0,o.Fi)(t.EXPERIENCE_WRAP,D);if(!F||!A){(0,f.Bt)(D);return}const W=(0,o.Fi)(t.SPEC_WRAP,D,!0).innerText.trim(),M=(0,o.Fi)(t.CLINIC_CONTAINER,D,!0),H=(0,o.Fi)(t.CLINIC_WRAP,M,!0).innerText.trim(),X=(0,o.YA)(F,!0),Q=(0,o.YA)(A,!0),J=_(F);F.href=J,(0,R.NI)($(D),k),B={specInfo:W,clinicName:H,reviewsLinkNumber:X,experienceNumber:Q,reviewsLink:F,reviewInfoAppended:!1},z.doctorCardsCache.set(D,B)}G(B);const K=(0,v.Ay)(B.specInfo,c)||(0,v.Ay)(B.clinicName,I)||(0,v.JE)(B.reviewsLinkNumber,a)||(0,v.JE)(B.experienceNumber,x)||(0,v.iG)(B.experienceNumber,V);(0,f.UC)(D,K)}function _(D){return D.href.replace(/\/#otzivi$/,"/otzivi/")}function $(D){return(0,o.Fi)(t.DOCTOR_CARD_NAME,D,!0).innerText}function G(D){if(D.reviewInfoAppended)return;const{reviewsLink:B}=D,K=B.href,k=(0,r.vX)((0,R.sp)(K));if(!k)return;const F=(0,R.pR)(k,K,!0);(0,f.WH)(B,F),D.reviewInfoAppended=!0}function P(){if(!x.value)return;const D=new URL(window.location.href);+D.searchParams.get("experience")!==x.value&&(D.searchParams.set("experience",x.value),window.location.href=D.toString())}},7858:(S,g,e)=>{e.d(g,{O:()=>m});var p=e(573),o=e(9928),f=e(7653);const v={REVIEWS_LINK:".b-doctor-intro__rates-wrapper > a",DOCTOR_DETAILS:".b-doctor-details__toc",REVIEWS_FILTER:".reviews-filter:not(.b-reviews-page__filter)",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]',REVIEWS_FILTER_SPAN:":scope > span",DOCTOR_CONTACTS:"#doctor-contacts"};var R=e(2524);function m(){(0,f.z1)(),i();const s=u();t(s);const r=(0,R.vX)((0,f.rd)());if(!r)return;const l=(0,f.pR)(r,s);(0,f.Np)(l)}function u(){const{location:s}=window;return`${s.origin}${s.pathname}otzivi/`}function i(){if(!(0,p.Fi)(v.DOCTOR_CONTACTS))return;const r=[...(0,p.fI)(v.DOCTOR_DETAILS)].pop();if(!r)return;r.style.position="sticky",r.style.top="16px";const l=(0,o.Sw)({},"\u041C\u0435\u0441\u0442\u043E \u0440\u0430\u0431\u043E\u0442\u044B");l.classList.add("b-doctor-details__toc-title");const w=(0,o.d)({},null,"#doctor-contacts");w.classList.add("b-doctor-details__toc-item"),w.append(l),r.insertBefore(w,r.firstChild)}function t(s){const r=(0,p.Fi)(v.REVIEWS_LINK);r&&(r.href=s)}},5072:(S,g,e)=>{e.d(g,{N:()=>O});var p=e(7653);const o={CONTROLS_CONTAINER:".vue-review-filter",REVIEWS:".b-review-card",REVIEW_TEXT_WRAP:".b-review-card__comment",REVIEW_RATING_WRAP:".review-card-tooltips__stars > .ui-text",FILTER_CHIP:'[data-qa="reviews_filter_chip"]',FILTER_LIST:'[data-qa="reviews_filter_list"]',FILTER_LIST_ITEM:'[data-qa^="reviews_filter_list_item"]',FILTER_TITLE_WRAP:'[data-qa="reviews_filter_title"]',FILTER_COUNT_WRAP:'[data-qa="reviews_filter_amount"]',REVIEWS_CONTAINER:"#otzivi"};var f=e(573),v=e(4921),R=e(5406),m=e(2524),u=e(4521),i=e(5213),t=e(8586),s=e(7877),r=e(5539);function l(F,A){F.forEach(y=>w(A,y))}function w(F,A){if(!A)return;const y=new RegExp(`(${A})`,"gi"),W=document.createTreeWalker(F,NodeFilter.SHOW_TEXT,null);let M=W.nextNode();const j=[];for(;M;){const{textContent:H}=M;if(y.test(H)){const X=document.createDocumentFragment();let Q=0;H.replace(y,(J,re,q)=>{q>Q&&X.appendChild(document.createTextNode(H.slice(Q,q)));const Z=document.createElement("span");Z.className="highlightedSubstring",Z.style.backgroundColor="yellow",Z.textContent=J,X.appendChild(Z),Q=q+J.length}),Q<H.length&&X.appendChild(document.createTextNode(H.slice(Q))),j.push({node:M,fragment:X})}M=W.nextNode()}j.forEach(({node:H,fragment:X})=>{H.parentNode.replaceChild(X,H)})}function T(F){(0,f.fI)(".highlightedSubstring",F).forEach(y=>{const{parentNode:W}=y;y.replaceWith(y.textContent),W.normalize()})}var d=e(8355);function L(F,A){const y=(0,d.fO)(F.value);l(y,A)}function h(F,A){const y=getIncludedSearchStrings(F.value);A.forEach(W=>highlightSubstrings(y,W))}var E=e(3829),c=e(9928);function I(F={}){return(0,c.Sw)(F,"|")}function a(F={},A=75,y="customFiltersContainer"){const W=document.getElementById(y);if(!W)return console.log(`Element with id="${y}" not found.`),null;const M=createButton(F,`${arrowUpIcon}\u041A \u0444\u0438\u043B\u044C\u0442\u0440\u0430\u043C`);return M.addEventListener("mouseenter",()=>{M.style.filter="brightness(0.9)"}),M.addEventListener("mouseleave",()=>{M.style.filter="brightness(1)"}),M.addEventListener("click",()=>{const j=W.getBoundingClientRect();window.scrollTo({top:j.top+window.scrollY-A})}),new IntersectionObserver(([j])=>{M.style.display=j.isIntersecting?"none":"flex"},{threshold:.5}).observe(W),M}function x(F,A={}){const y=a(A);y&&F.appendChild(y)}var V=e(6754);const{createGlobalFilter:U}=(0,u.z)($),z=U("reviews-text-filter"),N=U("reviews-min-rating-filter"),C=U("reviews-max-rating-filter"),b=U("reviews-filter-enabled",!0),n={reviewCardsCache:new Map};async function O(){(0,p.z1)();const F=await(0,v.xk)(document,o.CONTROLS_CONTAINER);(0,i.b)(F,_),$();const A=await D();(0,m.ft)((0,p.rd)(),A);const y=(0,p.pR)(A,K());(0,p.Np)(y),(0,R.$F)("rates_category")&&k()}function _(F,A){(0,V.ZM)(F,t.r.FILTERS_CONTAINER),F.style.marginTop="12px";const y=(0,s.E9)(z,t.r.CONTROL,t.r.TEXT_INPUT),W=(0,s.HX)(N,t.r.CONTROL,t.r.NUMBER_INPUT,1,1),M=(0,s.FR)(C,t.r.CONTROL,t.r.NUMBER_INPUT,1,1),j=I(t.r.CONTROL),H=(0,s.pW)(b,t.r.CONTROL,t.r.CHECKBOX_INPUT);F.append(y,W,M,j,H),A.append(F)}function $(){(0,f.fI)(o.REVIEWS).forEach(G)}function G(F){if(!b.value){(0,r.kl)(F);return}T(F);let A=n.reviewCardsCache.get(F);if(!A){const W=(0,f.Fi)(o.REVIEW_TEXT_WRAP,F),M=(0,f.Fi)(o.REVIEW_RATING_WRAP,F);if(!W){(0,r.Bt)(F);return}A={reviewTextWrap:W,reviewText:W.innerText,rating:M&&(0,f.YA)(M)},n.reviewCardsCache.set(F,A)}z.value&&L(z,A.reviewTextWrap);const y=(0,E.Ay)(A.reviewText,z)||P(A.rating);(0,r.UC)(F,y)}function P(F){return F?(0,E.JE)(F,N)||(0,E.iG)(F,C):!1}async function D(){const F=(0,f.Fi)(o.FILTER_CHIP);F.click();const A=await(0,v.xk)(document,o.FILTER_LIST),y=[...(0,f.fI)(o.FILTER_LIST_ITEM,A)].map(W=>{const M=W.getAttribute("data-qa");if(!M)return null;const j=M.replace("reviews_filter_list_item_",""),H=(0,f.Fi)(o.FILTER_TITLE_WRAP,W).textContent.trim(),X=(0,f.Fi)(o.FILTER_COUNT_WRAP,W),Q=(0,f.YA)(X,!0),J=B(X.classList);return{category:j,title:H,count:Q,bgClassSuffix:J}});return F.click(),y}function B(F){const A=F.value.match(/bg-(\w+)/);return A?A[1]:null}function K(){const{location:F}=window;return`${F.origin}${F.pathname}`}function k(){(0,f.Fi)(o.REVIEWS_CONTAINER).scrollIntoView({behavior:"smooth"})}}},ee={};function Y(S){var g=ee[S];if(g!==void 0)return g.exports;var e=ee[S]={exports:{}};return te[S](e,e.exports,Y),e.exports}(()=>{var S=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",g=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",e=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",p=f=>{f&&f.d<1&&(f.d=1,f.forEach(v=>v.r--),f.forEach(v=>v.r--?v.r++:v()))},o=f=>f.map(v=>{if(v!==null&&typeof v=="object"){if(v[S])return v;if(v.then){var R=[];R.d=0,v.then(i=>{m[g]=i,p(R)},i=>{m[e]=i,p(R)});var m={};return m[S]=i=>i(R),m}}var u={};return u[S]=i=>{},u[g]=v,u});Y.a=(f,v,R)=>{var m;R&&((m=[]).d=-1);var u=new Set,i=f.exports,t,s,r,l=new Promise((w,T)=>{r=T,s=w});l[g]=i,l[S]=w=>(m&&w(m),u.forEach(w),l.catch(T=>{})),f.exports=l,v(w=>{t=o(w);var T,d=()=>t.map(h=>{if(h[e])throw h[e];return h[g]}),L=new Promise(h=>{T=()=>h(d),T.r=0;var E=c=>c!==m&&!u.has(c)&&(u.add(c),c&&!c.d&&(T.r++,c.push(T)));t.map(c=>c[S](E))});return T.r?L:d()},w=>(w?r(l[e]=w):s(i),p(m))),m&&m.d<0&&(m.d=0)}})(),Y.d=(S,g)=>{for(var e in g)Y.o(g,e)&&!Y.o(S,e)&&Object.defineProperty(S,e,{enumerable:!0,get:g[e]})},Y.o=(S,g)=>Object.prototype.hasOwnProperty.call(S,g);var ne=Y(1753)})();})();
