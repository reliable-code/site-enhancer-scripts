// ==UserScript==
// @name         Prodoc enhancer
// @description  Hide doctor cards by filter, enhance doctor page
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://prodoctorov.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      2.0.76927367
// @icon         https://www.google.com/s2/favicons?sz=64&domain=prodoctorov.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/prodoc.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var te={5467:(S,g,e)=>{e.d(g,{E2:()=>r});var p=e(9928);function r(I,m={},u=null){const o=(0,p.Sw)(m,u);return o.append(I),o}function f(I,m=null,u={},o={}){const t=createActionLink(I,m,o);return r(t,u)}function v(I,m=null,u=null,o={},t={}){const s=createActionLinkWithIcon(I,u,m,t);return r(s,o)}},9928:(S,g,e)=>{e.d(g,{S:()=>m,Sw:()=>C,d:()=>s,kU:()=>f,o5:()=>v});var p=e(4921),r=e(6754);function f(E,c,T){const a=u(E,"text",c);return a.value=T,a}function v(E,c,T,a,x,k){const V=u(E,"number",c);return V.value=T,V.step=a,V.min=x,V.max=k,V}function I(E,c,T){const a=u(E,"date",c);return a.value=T,a}function m(E,c,T){const a=u(E,"checkbox",c);return a.checked=T,a}function u(E={},c=null,T=null){const a=h("input",E);return c&&(a.type=c),T&&(a.addEventListener("keyup",(0,p.sg)(T,200)),a.addEventListener("change",(0,p.sg)(T,100))),a}function o(E,c,T){const a=h("select",E);return c&&a.addEventListener("change",c),a.value=T,a}function t(E={},c=null){return h("span",E,c)}function s(E={},c=null,T=null){const a=h("a",E,c);return T&&(a.href=T),a}function n(E,c=null,T={}){T.cursor||="pointer";const a=s(T,c);return E&&a.addEventListener("click",E),a}function l(E,c,T=null,a={},x={}){a.display||="inline-flex",a.alignItems||="center",a.gap||="0.25em";const k=n(E,T,a);return k.prepend(F(c,x)),k}function w(E={},c=null,T=null){const a=h("button",E,c);return T&&a.addEventListener("click",T),a}function C(E={},c=null){return h("div",E,c)}function d(E={},c=null){return h("i",E,c)}function F(E,c={}){c.width||="1em",c.height||="1em",c.paddingBottom||="1px";const T=d(c);return T.setAttribute("data-lucide",E),T}function h(E,c,T=null){if(typeof c!="object"||c===null)throw new TypeError("styles should be an object");const a=document.createElement(E);return(0,r.ZM)(a,c),T&&(a.innerHTML=T),a}},573:(S,g,e)=>{e.d(g,{Fi:()=>f,YA:()=>o,fI:()=>v});var p=e(4214);function r(d,F=document){return!!F.querySelector(d)}function f(d,F=document,h=!1){const E=F.querySelector(d);return h&&!E&&console.log(`No element found for selector: ${d}`),E}function v(d,F=document,h=!1){const E=F.querySelectorAll(d);return h&&!E.length&&console.log(`No elements found for selector: ${d}`),E}function I(d,F=1){let h=d;for(let E=0;E<F;E++){if(!h.parentElement)return null;h=h.parentElement}return h}function m(d,F,h){return[...d.querySelectorAll(F)].find(E=>E.textContent.trim().includes(h))}function u(d,F,h=!1,E=!1,c=null){const T=f(F,d);return o(T,h,E,c)}function o(d,F=!1,h=!1,E=null){if(!d)return E===null?(console.log("No element found"),null):E;const c=d.innerText;return n(c,F,h)}function t(d,F,h=!1){const E=d[F];return o(E,h)}function s(d,F=!1,h=!1){const E=d.textContent;return n(E,F,h)}function n(d,F,h){F&&(d=(0,p.zr)(d)),h&&(d=d.replace(",","."));const E=Number(d);return Number.isNaN(E)?(console.log(`Invalid number: ${d}`),0):E}function l(d){return[...d.childNodes].find(F=>F.nodeType===Node.TEXT_NODE)}function w(d){const F=h=>h.nodeType===Node.TEXT_NODE&&h.textContent.trim()!==""?[h]:[...h.childNodes].flatMap(F);return F(d)}function C(d){return normalizeSpacing(d.textContent)}},5539:(S,g,e)=>{e.d(g,{Bt:()=>r,UC:()=>t,WH:()=>p,kl:()=>u});function p(i,b){i.parentNode.insertBefore(b,i.nextSibling)}function r(i){i.style.display="none"}function f(i,b=1){const _=document.querySelector(i);_&&v(_,b)}function v(i,b=1){const _=getElementAncestor(i,b);_&&r(_)}function I(i){l(i),r(i)}function m(i){i.intersectionObserver||runOnceOnIntersection(i,()=>r(i))}function u(i){i.style.display=""}function o(i){const b=n(i);i.style.display=b}function t(i,b){b?r(i):u(i)}function s(i,b){b?m(i):(clearIntersectionObserver(i),u(i))}function n(i){return l(i),i.defaultDisplay}function l(i){if(i.defaultDisplay)return;const{display:b}=getComputedStyle(i);i.defaultDisplay=b}function w(){return{show:[],hide:[]}}function C(i,b,_){i?b.hide.push(_):b.show.push(_)}function d(i){i.show.forEach(u),i.hide.forEach(r)}function F(i,b,_=.3){b?E(i,_):h(i)}function h(i){i.style.opacity=""}function E(i,b=.3){i.style.opacity=b}function c(i){i.style.order=""}function T(i,b){i.style.order=b}function a(i,b){i.style.background=b}function x(i,b){const _=getFirstElement(b);_&&k(i,_)}function k(i,b){const _=createLink();_.href=i,b.parentNode.append(_),_.append(b)}function V(i,b){const _=getFirstElement(b);_&&L(i,_)}function L(i,b,_={}){const H=createLink(_);H.href=i,H.append(...b.childNodes),b.append(H)}function R(){const i=getURLQueryParam("scrollTo");if(!i)return;const b=document.getElementById(i);b?b.scrollIntoView():console.log(`Element with ID "${i}" was not found.`)}function O(i,b,_=null){const H=`${b}-click-passed`,K=_?B=>findElementByText(B,i,_):B=>getFirstElement(i,B);return function(B){if(B.hasAttribute(H))return!1;const D=K(B);return D&&D.click(),B.setAttribute(H,""),!0}}function P(i,b,_="text/plain"){const H=new Blob([i],{type:_}),K=URL.createObjectURL(H),B=document.createElement("a");B.href=K,B.download=b,document.body.appendChild(B),B.click(),document.body.removeChild(B),requestAnimationFrame(()=>URL.revokeObjectURL(K))}},6754:(S,g,e)=>{e.d(g,{ZM:()=>p});function p(I,m){Object.assign(I.style,m)}function r(I,m="custom-global-style"){let u=document.getElementById(m);u||(u=document.createElement("style"),u.id=m,u.type="text/css",document.head.appendChild(u)),u.textContent=I}function f(I){return Object.entries(I).map(([m,u])=>`${m.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${u};`).join(" ")}function v(I){return I?I.split(";").filter(m=>m.trim()!=="").reduce((m,u)=>{const[o,t]=u.split(":").map(n=>n.trim()),s=o.replace(/-([a-z])/g,(n,l)=>l.toUpperCase());return m[s]=t,m},{}):{}}},4921:(S,g,e)=>{e.d(g,{sg:()=>v,xk:()=>p});function p(t,s,n=null){const l=t.querySelector(s);return l?Promise.resolve(l):new Promise(w=>{const C=new MutationObserver(F);C.observe(t,{childList:!0,subtree:!0});let d;n&&(d=setTimeout(()=>{C.disconnect(),console.log(`No element found for selector: ${s}`),w(null)},n));function F(){const h=t.querySelector(s);h&&(d&&clearTimeout(d),C.disconnect(),w(h))}})}function r(t,s){return t.querySelector(s)?new Promise(l=>{const w=new MutationObserver(C);w.observe(t,{childList:!0,subtree:!0});function C(){t.querySelector(s)||(w.disconnect(),l())}}):Promise.resolve()}function f(t,s=400){return new Promise(n=>{let l;const w=new MutationObserver(()=>{clearTimeout(l),C()});function C(){l=setTimeout(()=>{w.disconnect(),n()},s)}C(),w.observe(t,{childList:!0,subtree:!0})})}function v(t,s=250){let n;return(...l)=>{clearTimeout(n),n=setTimeout(()=>t(...l),s)}}async function I(t){document.visibilityState==="visible"?await t():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await t()},{once:!0})}function m(t,s){const n=new IntersectionObserver(l=>{l.forEach(w=>{w.isIntersecting&&(s(),u(t))})});t.intersectionObserver=n,n.observe(t)}function u(t){t.intersectionObserver&&(t.intersectionObserver.disconnect(),t.intersectionObserver=null)}function o(t){t&&(t.disconnect(),t=null)}},3829:(S,g,e)=>{e.d(g,{Ay:()=>r,JE:()=>m,iG:()=>u});var p=e(8355);function r(n,l){return!f(n,l)}function f(n,l){if(!l||!l.value)return!0;const w=(0,p._7)(l.value);return v(n,w)}function v(n,l){if(!l||!l.length)return!0;const w=(n||"").toLowerCase();return l.every(C=>I(w,C))}function I(n,l){return l.some(({term:w,isNegative:C})=>{const d=n.includes(w);return C?!d:d})}function m(n,l){return l.value!=null&&n<l.value}function u(n,l){return l.value!=null&&n>l.value}function o(n,l){return l.value==null?!1:n<parseDateFromISO(l.value)}function t(n,l){return l.value==null?!1:n>parseDateFromISO(l.value)}function s(n,l){return l.value&&n!==l.value}},4521:(S,g,e)=>{e.d(g,{z:()=>r});var p=e(3048);function r(f,v=null){return{createGlobalFilter(I,m=null,u=f){return p.V.create(I,m,u)},createSectionFilter(I,m=null,u=f){if(!v)throw new Error("sectionId must be provided to use createSectionFilter.");return p.V.createWithCompositeKey(v,I,m,u)}}}},5884:(S,g,e)=>{e.d(g,{Hw:()=>u,Nm:()=>f,nW:()=>v});var p=e(9928),r=e(5467);function f(o,t,s={},n={}){const l=(0,p.kU)(n,t.updateValueFromEvent,t.value);return(0,r.E2)(l,s,o)}function v(o,t,s,n,l,w={},C={}){const d=(0,p.o5)(C,t.updateValueFromEvent,t.value,s,n,l);return(0,r.E2)(d,w,o)}function I(o,t,s={},n={}){const l=createSelect(n,t.updateValueFromEvent,t.value);return createControl(l,s,o)}function m(o,t,s={},n={}){const l=createDateInput(n,t.updateValueFromEvent,t.value);return createControl(l,s,o)}function u(o,t,s={},n={}){const l=(0,p.S)(n,t.updateValueFromEvent,t.value);return(0,r.E2)(l,s,o)}},7877:(S,g,e)=>{e.d(g,{E9:()=>r,FR:()=>v,HX:()=>f,X0:()=>I,pW:()=>k});var p=e(5884);function r(L,R={},O={}){return(0,p.Nm)("\u041F\u043E\u0438\u0441\u043A: ",L,R,O)}function f(L,R={},O={},P=.1,i=3){return(0,p.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",L,P,i,5,R,O)}function v(L,R={},O={},P=.1,i=3){return(0,p.nW)("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",L,P,i,5,R,O)}function I(L,R={},O={}){return u("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",L,R,O)}function m(L,R={},O={}){return u("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",L,R,O)}function u(L,R,O={},P={}){return(0,p.nW)(L,R,"1","1","999999",O,P)}function o(L,R={},O={}){return createDateFilterControl("\u041C\u0438\u043D. \u0434\u0430\u0442\u0430: ",L,R,O)}function t(L,R={},O={}){return s("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",L,R,O)}function s(L,R,O={},P={}){return createNumberFilterControl(L,R,"5","0","100",O,P)}function n(L,R={},O={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",L,"5","0","100",R,O)}function l(L,R,O={},P={},i="250"){return createNumberFilterControl(L,R,i,"0","1000000",O,P)}function w(L,R={},O={},P="25"){return l("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",L,R,O,P)}function C(L,R={},O={},P="25"){return l("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",L,R,O,P)}function d(L,R={},O={}){return F("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",L,R,O)}function F(L,R,O={},P={}){return createNumberFilterControl(L,R,"1","0","99999",O,P)}function h(L,R={},O={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",L,"1","2","8",R,O)}function E(L,R={},O={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",L,1,1,10,R,O)}function c(L,R={},O={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",L,R,O)}function T(L,R={},O={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",L,R,O)}function a(L,R={},O={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",L,R,O)}function x(L,R={},O={}){return createCheckboxFilterControl("\u0411\u043E\u043D\u0443\u0441: ",L,R,O)}function k(L,R={},O={}){return(0,p.Hw)("\u0412\u043A\u043B: ",L,R,O)}function V(L,R,O={}){const P=[{value:-25,emoji:"\u{1F48E}",tooltip:"\u0421\u0443\u043F\u0435\u0440 \u0446\u0435\u043D\u0430 (-25%)"},{value:-15,emoji:"\u{1F525}",tooltip:"\u041E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-15%)"},{value:-5,emoji:"\u{1F31F}",tooltip:"\u041A\u043B\u0430\u0441\u0441\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-5%)"},{value:5,emoji:"\u{1F44C}",tooltip:"\u0425\u043E\u0440\u043E\u0448\u0430\u044F \u0446\u0435\u043D\u0430 (+5%)"}],i={active:{background:"#e3f2fd",borderColor:"#2196f3",boxShadow:"0 0 0 1px #2196f3"},inactive:{background:"#fff",borderColor:"#ccc",boxShadow:"none"},hover:{background:"#f5f5f5"}},b=createDiv({display:"inline-flex",gap:"4px",marginLeft:"4px"}),_=[],H=()=>R?parseFloat(R.value)||0:L.value,K=()=>{const B=H();_.forEach(({button:D,value:W})=>{const z=W<=B?i.active:i.inactive;Object.assign(D.style,z)})};return P.forEach(({value:B,emoji:D,tooltip:W})=>{const $=createButton({padding:"2px 6px",fontSize:"16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"#fff",transition:"all 0.2s",...O},D);$.title=W,$.type="button",$.addEventListener("click",z=>{z.preventDefault(),L.updateValue(B),R&&(R.value=B),K()}),$.addEventListener("mouseenter",()=>{B<=H()||($.style.background=i.hover.background)}),$.addEventListener("mouseleave",()=>{K()}),_.push({button:$,value:B}),b.appendChild($)}),K(),R&&(R.addEventListener("input",K),R.addEventListener("change",K)),b}},8355:(S,g,e)=>{e.d(g,{_7:()=>r,fO:()=>p});function p(o){if(!o)return[];const s=r(o).flat().filter(n=>n&&!n.isNegative&&n.term).map(n=>n.term);return[...new Set(s)]}function r(o){return o?o.toLowerCase().split(",").map(f).filter(Boolean):[]}function f(o){const t=o.split("/").map(n=>n.trim()).filter(Boolean);if(t.length===0)return null;const s=t.map(v).filter(Boolean);return s.length>0?s:null}function v(o){const t=o.startsWith("!"),s=t?o.slice(1).trim():o;return s?{term:s,isNegative:t}:null}function I(o,t){u(o,s=>s.style.display!=="none",t)}function m(o,t){u(o,s=>s.style.opacity==="",t)}function u(o,t,s){const n=[...o].filter(t).length;s.textContent=`\u041F\u043E\u043A\u0430\u0437\u0430\u043D\u043E: ${n} \u0438\u0437 ${o.length}`}},5213:(S,g,e)=>{e.d(g,{b:()=>f});var p=e(9928),r=e(573);function f(v,I,m=!1,u="customFiltersContainer"){let o=(0,r.Fi)(`#${u}`,v);if(o)if(m)o.remove();else return;o=(0,p.Sw)(),o.id=u,I(o,v)}},8200:(S,g,e)=>{e.d(g,{s:()=>p});function p(r){const{target:f}=r,{type:v}=f;switch(v){case"text":return`"${f.value}"`;case"number":return f.value;case"select-one":return f.value;case"date":return`"${f.value}"`;case"checkbox":return f.checked;default:return console.log(`Unknown input type: ${v}`),null}}},157:(S,g,e)=>{e.d(g,{Fg:()=>p,vx:()=>f});const p=window.GM_setValue,r=window.GM.setValue,f=window.GM_getValue},1870:(S,g,e)=>{e.d(g,{j:()=>p});class p{constructor(f,v){this.value=f,this.onChange=v}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(S,g,e)=>{e.d(g,{V:()=>I});var p=e(1870),r=e(8200),f=e(3976),v=e(157);class I extends p.j{constructor(u,o=null,t=null){super((0,v.vx)(u,o),t),this.storageKey=u,this.defaultValue=o}static create(u,o=null,t=null){return new I(u,o,t)}static createWithCompositeKey(u,o,t=null,s=null){const n=`${u}-${o}`;return new I(n,t,s)}updateValueFromEvent=u=>{const o=(0,r.s)(u),t=(0,f.$)(o);this.updateValue(t)};updateValue(u,o=!0){this.value!==u&&((0,v.Fg)(this.storageKey,u),this.value=u,o&&this.onChangeIfDefined())}clearValue(u=!1){this.updateValue(null,u)}resetValue(u=!1){this.updateValue(this.defaultValue,u)}}},3976:(S,g,e)=>{e.d(g,{$:()=>p});function p(r){return r===""?null:JSON.parse(r)}},4214:(S,g,e)=>{e.d(g,{$z:()=>p,zr:()=>r});function p(m){return m.replace(/\D/g,"")}function r(m){return m.replace(/[^\d.,-]/g,"")}function f(m){return m.replace(/\s/g,"")}function v(m){return m.charAt(0).toUpperCase()+m.slice(1)}function I(m){return m.replace(/\s+/g," ").trim()}},5406:(S,g,e)=>{e.d(g,{$F:()=>m,Fc:()=>p,bn:()=>r,z2:()=>s});function p(C,d="common",F=!1){const{pathname:h}=window.location;return r(h,C,d,F)}function r(C,d,F,h=!1){const E=C.split("/");d=d<0?E.length+d:d;const c=E[d]||F;return h&&console.log(`Pathname element: ${c}`),c}function f(C,d="common",F=!1){const h=p(C,"",F);return v(h,d,F)}function v(C,d,F){if(!C)return d;const h=C.split("-").at(-1);return F&&console.log(`Pathname element ending: ${h}`),h}function I(C,d,F="common",h=!1){const E=r(C,d,"",h);return v(E,F,h)}function m(C){return new URLSearchParams(window.location.search).get(C)}function u(C){return C.split("?")[0]}function o(C){return window.location.pathname.includes(C)}function t(C){return C.some(d=>o(d))}function s(...C){return window.location.pathname.split("/").some(F=>C.includes(F))}function n(C){try{const d=new URL(window.location.href);Object.entries(C).forEach(([F,h])=>{d.searchParams.set(F,h)}),window.location.href=d.toString()}catch(d){console.error("Failed to redirect:",d)}}function l(C,d=[]){const F={pathname:window.location.pathname};d.forEach(a=>{F[a]=m(a)});let h=!1;async function E(){if(h)return;const a={pathname:window.location.pathname};if(d.forEach(x=>{a[x]=m(x)}),Object.keys(F).some(x=>F[x]!==a[x])){Object.assign(F,a),h=!0;try{await C()}catch(x){console.error("Error in URL observer callback:",x)}finally{h=!1}}}function c(){E().catch(a=>{console.error("Error in URL change handler:",a)})}let T=window.location.href;setInterval(()=>{window.location.href!==T&&(T=window.location.href,c())},200),window.addEventListener("popstate",c)}function w(C=[]){l(()=>window.location.reload(),C)}},2524:(S,g,e)=>{e.d(g,{d5:()=>f,vX:()=>u,ft:()=>v});var p=e(157);class r{constructor(s=Date.now(),n=[]){this.lastCheckDate=s,this.reviewsData=n}updateLastCheckDate=()=>{this.lastCheckDate=Date.now()};static fromObject(s){const{lastCheckDate:n,reviewsData:l}=s;return new r(n,l)}}const f={LAST_DOCTOR_UPDATE:"last-doctor-update"};function v(t,s){const n=I(t),l=(0,p.vx)(n),w=m(l);w.reviewsData=s,w.updateLastCheckDate(),(0,p.Fg)(n,w),(0,p.Fg)(f.LAST_DOCTOR_UPDATE,Date.now())}function I(t){return`doctor-${t}`}function m(t){return t?r.fromObject(t):new r}function u(t){return o(t)?.reviewsData??null}function o(t){const s=I(t);return(0,p.vx)(s)}},1753:(S,g,e)=>{e.a(S,async(p,r)=>{try{var f=e(573),v=e(7858),I=e(4231),m=e(5406),u=e(5072);const t=(0,f.Fi)(".appointments_page");t?(0,I.$)(t):(0,m.z2)("otzivi")?await(0,u.N)():(0,m.z2)("vrach")&&(0,v.O)(),r()}catch(o){r(o)}},1)},7653:(S,g,e)=>{e.d(g,{NI:()=>t,z1:()=>l,Np:()=>F,pR:()=>w,sp:()=>E,rd:()=>h});var p=e(9928),r=e(573);const f={DOCTOR_CARD_NAME:'.b-doctor-intro__title-first-line [itemprop="name"]',DOCTOR_INTRO_LEFT:".b-doctor-intro__left-side",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]'};var v=e(8586),I=e(5406),m=e(4214);const u="additionalLinksAppended",o=["\u042F\u043D\u0434\u0435\u043A\u0441","\u041D\u0430\u041F\u043E\u043F\u0440\u0430\u0432\u043A\u0443","DocDoc","\u0414\u043E\u043A\u0442\u0443"];function t(c,T){T.classList.contains(u)||(o.forEach(a=>{s(c,T,a)}),T.classList.add(u))}function s(c,T,a){const x=n(c,a),k=(0,p.d)({},a,x),V=document.createElement("br");T.append(V,k)}function n(c,T){const a=`${c} ${T}`;return`https://www.google.com/search?q=${encodeURIComponent(a)}&btnI`}function l(){const c=(0,r.Fi)(f.DOCTOR_CARD_NAME,document,!0);if(!c)return;const T=c.innerText.trim(),a=(0,p.Sw)();a.style.textAlign="center",(0,r.Fi)(f.DOCTOR_INTRO_LEFT).append(a),t(T,a)}function w(c,T,a=!1){const x=(0,p.Sw)(v.r.REVIEWS_INFO);a&&(x.style.justifyContent="center"),x.classList.add("v-application");const k=(0,p.Sw)(v.r.REVIEWS_INFO_BLOCK);return k.style.height=a?"10px":"23px",k.append(x),c.slice(a?1:0).forEach(V=>{const{category:L,title:R,count:O,bgClassSuffix:P}=V,i=`${T}?rates_category=${L}`,b=a?O:`${R} ${O}`,_=(0,p.d)(v.r.REVIEW_INFO,b,i);_.classList=C(P),x.append(_),a&&d(_,R)}),k}function C(c){return`text-caption text--text px-2 py-1 rounded-sm bg-${c}`}function d(c,T){let a=null;c.addEventListener("mouseenter",()=>{a=(0,p.Sw)(v.r.REVIEW_INFO_TOOLTIP,T),document.body.appendChild(a);const x=c.getBoundingClientRect();a.style.left=`${(x.left+x.right)/2-a.offsetWidth/2+window.scrollX+2}px`,a.style.top=`${x.top+window.scrollY-a.offsetHeight-4}px`}),c.addEventListener("mouseleave",()=>{a&&(a.remove(),a=null)})}function F(c){const T=(0,r.Fi)(f.NAME_SPAN_HOLDER,document,!0);if(!T)return;const a=(0,r.Fi)(f.NAME_SPAN,T,!0);a&&a.append(c)}function h(){const c=(0,I.Fc)(3,"unknown");return(0,m.$z)(c)}function E(c){const T=(0,I.bn)(c,5,"");return(0,m.$z)(T)}},8586:(S,g,e)=>{e.d(g,{r:()=>r});const p={INPUT:{border:"1px solid #c7d3d9",borderRadius:"10px",padding:"7px 14px",marginLeft:"6px"}},r={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",flexFlow:"wrap"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...p.INPUT,width:"195px"},NUMBER_INPUT:{...p.INPUT,width:"70px"},CHECKBOX_INPUT:{...p.INPUT,width:"20px",height:"20px"},REVIEWS_INFO:{gridGap:"6px"},REVIEWS_INFO_BLOCK:{marginTop:"5px"},REVIEW_INFO:{textDecoration:"none",flexShrink:0},REVIEW_INFO_TOOLTIP:{position:"absolute",backgroundColor:"#333",color:"#fff",padding:"4px 8px",borderRadius:"8px",fontSize:"12px",zIndex:"1000",pointerEvents:"none",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"}}},4231:(S,g,e)=>{e.d(g,{$:()=>R});var p=e(5406),r=e(573),f=e(5539),v=e(3829),I=e(7653),m=e(5213),u=e(5884),o=e(7877);const t={LIST_HEADER:".h2_rating",DOCTOR_FILTERS:".vue-the-doctors-filters > .b-container",DOCTOR_CARD:".b-doctor-card",DOCTOR_CARD_NAME:".b-doctor-card__name-surname",PROFILE_CARD:".b-profile-card",REVIEWS_LINK:":scope > a",EXPERIENCE_WRAP:".b-doctor-card__experience .mr-2 .text-subtitle-1",SPEC_WRAP:".b-doctor-card__spec",CLINIC_CONTAINER:"div.b-doctor-card__lpu-select",CLINIC_WRAP:".b-select__trigger-main-text"};var s=e(4521),n=e(2524),l=e(4921),w=e(8586),C=e(6754);const d=window.GM_addValueChangeListener,F=(0,p.Fc)(2),{createGlobalFilter:h,createSectionFilter:E}=(0,s.z)(i,F),c=E("spec-filter"),T=E("clinic-filter"),a=E("min-reviews-filter",10),x=E("min-experience-filter",5,B),k=E("max-experience-filter",40),V=h("filter-enabled",!0),L={doctorCardsCache:new WeakMap};function R(D){B(),O();const W=(0,r.Fi)(t.DOCTOR_FILTERS);(0,m.b)(W,P),i(),d(n.d5.LAST_DOCTOR_UPDATE,i),new MutationObserver((0,l.sg)(i)).observe(D,{childList:!0})}function O(){const D=(0,r.Fi)(t.LIST_HEADER);D&&D.remove()}function P(D,W){(0,C.ZM)(D,w.r.FILTERS_CONTAINER),D.style.marginTop="6px";const $=(0,u.Nm)("\u0421\u043F\u0435\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F:",c,w.r.CONTROL,w.r.TEXT_INPUT),z=(0,u.Nm)("\u041A\u043B\u0438\u043D\u0438\u043A\u0430:",T,w.r.CONTROL,w.r.TEXT_INPUT),N=(0,o.X0)(a,w.r.CONTROL,w.r.NUMBER_INPUT),A=(0,u.nW)("\u041C\u0438\u043D. \u043E\u043F\u044B\u0442: ",x,"1","0","100",w.r.CONTROL,w.r.NUMBER_INPUT),y=(0,u.nW)("\u041C\u0430\u043A\u0441. \u043E\u043F\u044B\u0442: ",k,"1","0","100",w.r.CONTROL,w.r.NUMBER_INPUT),M=(0,o.pW)(V,w.r.CONTROL,w.r.CHECKBOX_INPUT);D.append($,z,N,A,y,M),W.append(D)}function i(){(0,r.fI)(t.DOCTOR_CARD).forEach(b)}function b(D){if(!V.value){(0,f.kl)(D);return}let W=L.doctorCardsCache.get(D);if(!W){const z=(0,r.Fi)(t.PROFILE_CARD,D),N=(0,r.Fi)(t.REVIEWS_LINK,z),A=(0,r.Fi)(t.EXPERIENCE_WRAP,D);if(!N||!A){(0,f.Bt)(D);return}const M=(0,r.Fi)(t.SPEC_WRAP,D,!0).innerText.trim(),U=(0,r.Fi)(t.CLINIC_CONTAINER,D,!0),G=(0,r.Fi)(t.CLINIC_WRAP,U,!0).innerText.trim(),X=(0,r.YA)(N,!0),Q=(0,r.YA)(A,!0),J=_(N);N.href=J,(0,I.NI)(H(D),z),W={specInfo:M,clinicName:G,reviewsLinkNumber:X,experienceNumber:Q,reviewsLink:N,reviewInfoAppended:!1},L.doctorCardsCache.set(D,W)}K(W);const $=(0,v.Ay)(W.specInfo,c)||(0,v.Ay)(W.clinicName,T)||(0,v.JE)(W.reviewsLinkNumber,a)||(0,v.JE)(W.experienceNumber,x)||(0,v.iG)(W.experienceNumber,k);(0,f.UC)(D,$)}function _(D){return D.href.replace(/\/#otzivi$/,"/otzivi/")}function H(D){return(0,r.Fi)(t.DOCTOR_CARD_NAME,D,!0).innerText}function K(D){if(D.reviewInfoAppended)return;const{reviewsLink:W}=D,$=W.href,z=(0,n.vX)((0,I.sp)($));if(!z)return;const N=(0,I.pR)(z,$,!0);(0,f.WH)(W,N),D.reviewInfoAppended=!0}function B(){if(!x.value)return;const D=new URL(window.location.href);+D.searchParams.get("experience")!==x.value&&(D.searchParams.set("experience",x.value),window.location.href=D.toString())}},7858:(S,g,e)=>{e.d(g,{O:()=>m});var p=e(573),r=e(9928),f=e(7653);const v={REVIEWS_LINK:".b-doctor-intro__rates-wrapper > a",DOCTOR_DETAILS:".b-doctor-details__toc",REVIEWS_FILTER:".reviews-filter:not(.b-reviews-page__filter)",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]',REVIEWS_FILTER_SPAN:":scope > span",DOCTOR_CONTACTS:"#doctor-contacts"};var I=e(2524);function m(){(0,f.z1)(),o();const s=u();t(s);const n=(0,I.vX)((0,f.rd)());if(!n)return;const l=(0,f.pR)(n,s);(0,f.Np)(l)}function u(){const{location:s}=window;return`${s.origin}${s.pathname}otzivi/`}function o(){if(!(0,p.Fi)(v.DOCTOR_CONTACTS))return;const n=[...(0,p.fI)(v.DOCTOR_DETAILS)].pop();if(!n)return;n.style.position="sticky",n.style.top="16px";const l=(0,r.Sw)({},"\u041C\u0435\u0441\u0442\u043E \u0440\u0430\u0431\u043E\u0442\u044B");l.classList.add("b-doctor-details__toc-title");const w=(0,r.d)({},null,"#doctor-contacts");w.classList.add("b-doctor-details__toc-item"),w.append(l),n.insertBefore(w,n.firstChild)}function t(s){const n=(0,p.Fi)(v.REVIEWS_LINK);n&&(n.href=s)}},5072:(S,g,e)=>{e.d(g,{N:()=>b});var p=e(7653);const r={CONTROLS_CONTAINER:".vue-review-filter",REVIEWS:".b-review-card",REVIEW_TEXT_WRAP:".b-review-card__comment",REVIEW_RATING_WRAP:".review-card-tooltips__stars > .ui-text",FILTER_CHIP:'[data-qa="reviews_filter_chip"]',FILTER_LIST:'[data-qa="reviews_filter_list"]',FILTER_LIST_ITEM:'[data-qa^="reviews_filter_list_item"]',FILTER_TITLE_WRAP:'[data-qa="reviews_filter_title"]',FILTER_COUNT_WRAP:'[data-qa="reviews_filter_amount"]',REVIEWS_CONTAINER:"#otzivi"};var f=e(573),v=e(4921),I=e(5406),m=e(2524),u=e(4521),o=e(5213),t=e(8586),s=e(7877),n=e(5539);function l(N,A){N.forEach(y=>w(A,y))}function w(N,A){if(!A)return;const y=new RegExp(`(${A})`,"gi"),M=document.createTreeWalker(N,NodeFilter.SHOW_TEXT,null);let U=M.nextNode();const j=[];for(;U;){const{textContent:G}=U;if(y.test(G)){const X=document.createDocumentFragment();let Q=0;G.replace(y,(J,re,q)=>{q>Q&&X.appendChild(document.createTextNode(G.slice(Q,q)));const Z=document.createElement("span");Z.className="highlightedSubstring",Z.style.backgroundColor="yellow",Z.textContent=J,X.appendChild(Z),Q=q+J.length}),Q<G.length&&X.appendChild(document.createTextNode(G.slice(Q))),j.push({node:U,fragment:X})}U=M.nextNode()}j.forEach(({node:G,fragment:X})=>{G.parentNode.replaceChild(X,G)})}function C(N){(0,f.fI)(".highlightedSubstring",N).forEach(y=>{const{parentNode:M}=y;y.replaceWith(y.textContent),M.normalize()})}var d=e(8355);function F(N,A){const y=(0,d.fO)(N.value);l(y,A)}function h(N,A){const y=getIncludedSearchStrings(N.value);A.forEach(M=>highlightSubstrings(y,M))}var E=e(3829),c=e(9928);function T(N={}){return(0,c.Sw)(N,"|")}function a(N={},A=75,y="customFiltersContainer"){const M=document.getElementById(y);if(!M)return console.log(`Element with id="${y}" not found.`),null;const U=createButton(N,`${arrowUpIcon}\u041A \u0444\u0438\u043B\u044C\u0442\u0440\u0430\u043C`);return U.addEventListener("mouseenter",()=>{U.style.filter="brightness(0.9)"}),U.addEventListener("mouseleave",()=>{U.style.filter="brightness(1)"}),U.addEventListener("click",()=>{const j=M.getBoundingClientRect();window.scrollTo({top:j.top+window.scrollY-A})}),new IntersectionObserver(([j])=>{U.style.display=j.isIntersecting?"none":"flex"},{threshold:.5}).observe(M),U}function x(N,A={}){const y=a(A);y&&N.appendChild(y)}var k=e(6754);const{createGlobalFilter:V}=(0,u.z)(H),L=V("reviews-text-filter"),R=V("reviews-min-rating-filter"),O=V("reviews-max-rating-filter"),P=V("reviews-filter-enabled",!0),i={reviewCardsCache:new Map};async function b(){(0,p.z1)();const N=await(0,v.xk)(document,r.CONTROLS_CONTAINER);(0,o.b)(N,_),H();const A=await D();(0,m.ft)((0,p.rd)(),A);const y=(0,p.pR)(A,$());(0,p.Np)(y),(0,I.$F)("rates_category")&&z()}function _(N,A){(0,k.ZM)(N,t.r.FILTERS_CONTAINER),N.style.marginTop="12px";const y=(0,s.E9)(L,t.r.CONTROL,t.r.TEXT_INPUT),M=(0,s.HX)(R,t.r.CONTROL,t.r.NUMBER_INPUT,1,1),U=(0,s.FR)(O,t.r.CONTROL,t.r.NUMBER_INPUT,1,1),j=T(t.r.CONTROL),G=(0,s.pW)(P,t.r.CONTROL,t.r.CHECKBOX_INPUT);N.append(y,M,U,j,G),A.append(N)}function H(){(0,f.fI)(r.REVIEWS).forEach(K)}function K(N){if(!P.value){(0,n.kl)(N);return}C(N);let A=i.reviewCardsCache.get(N);if(!A){const M=(0,f.Fi)(r.REVIEW_TEXT_WRAP,N),U=(0,f.Fi)(r.REVIEW_RATING_WRAP,N);if(!M){(0,n.Bt)(N);return}A={reviewTextWrap:M,reviewText:M.innerText,rating:U&&(0,f.YA)(U)},i.reviewCardsCache.set(N,A)}L.value&&F(L,A.reviewTextWrap);const y=(0,E.Ay)(A.reviewText,L)||B(A.rating);(0,n.UC)(N,y)}function B(N){return N?(0,E.JE)(N,R)||(0,E.iG)(N,O):!1}async function D(){const N=(0,f.Fi)(r.FILTER_CHIP);N.click();const A=await(0,v.xk)(document,r.FILTER_LIST),y=[...(0,f.fI)(r.FILTER_LIST_ITEM,A)].map(M=>{const U=M.getAttribute("data-qa");if(!U)return null;const j=U.replace("reviews_filter_list_item_",""),G=(0,f.Fi)(r.FILTER_TITLE_WRAP,M).textContent.trim(),X=(0,f.Fi)(r.FILTER_COUNT_WRAP,M),Q=(0,f.YA)(X,!0),J=W(X.classList);return{category:j,title:G,count:Q,bgClassSuffix:J}});return N.click(),y}function W(N){const A=N.value.match(/bg-(\w+)/);return A?A[1]:null}function $(){const{location:N}=window;return`${N.origin}${N.pathname}`}function z(){(0,f.Fi)(r.REVIEWS_CONTAINER).scrollIntoView({behavior:"smooth"})}}},ee={};function Y(S){var g=ee[S];if(g!==void 0)return g.exports;var e=ee[S]={exports:{}};return te[S](e,e.exports,Y),e.exports}(()=>{var S=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",g=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",e=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",p=f=>{f&&f.d<1&&(f.d=1,f.forEach(v=>v.r--),f.forEach(v=>v.r--?v.r++:v()))},r=f=>f.map(v=>{if(v!==null&&typeof v=="object"){if(v[S])return v;if(v.then){var I=[];I.d=0,v.then(o=>{m[g]=o,p(I)},o=>{m[e]=o,p(I)});var m={};return m[S]=o=>o(I),m}}var u={};return u[S]=o=>{},u[g]=v,u});Y.a=(f,v,I)=>{var m;I&&((m=[]).d=-1);var u=new Set,o=f.exports,t,s,n,l=new Promise((w,C)=>{n=C,s=w});l[g]=o,l[S]=w=>(m&&w(m),u.forEach(w),l.catch(C=>{})),f.exports=l,v(w=>{t=r(w);var C,d=()=>t.map(h=>{if(h[e])throw h[e];return h[g]}),F=new Promise(h=>{C=()=>h(d),C.r=0;var E=c=>c!==m&&!u.has(c)&&(u.add(c),c&&!c.d&&(C.r++,c.push(C)));t.map(c=>c[S](E))});return C.r?F:d()},w=>(w?n(l[e]=w):s(o),p(m))),m&&m.d<0&&(m.d=0)}})(),Y.d=(S,g)=>{for(var e in g)Y.o(g,e)&&!Y.o(S,e)&&Object.defineProperty(S,e,{enumerable:!0,get:g[e]})},Y.o=(S,g)=>Object.prototype.hasOwnProperty.call(S,g);var ne=Y(1753)})();})();
