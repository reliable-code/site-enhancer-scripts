// ==UserScript==
// @name         Prodoc enhancer
// @description  Hide doctor cards by filter, enhance doctor page
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://prodoctorov.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      2.0.76503911
// @icon         https://www.google.com/s2/favicons?sz=64&domain=prodoctorov.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/prodoc.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var te={5467:(F,m,e)=>{e.d(m,{E2:()=>o});var d=e(9928);function o(C,c={},n=null){const a=(0,d.Sw)(c,n);return a.append(C),a}function f(C,c=null,n={},a={}){const t=createActionLink(C,c,a);return o(t,n)}function p(C,c=null,n=null,a={},t={}){const v=createActionLinkWithIcon(C,n,c,t);return o(v,a)}},9928:(F,m,e)=>{e.d(m,{S:()=>C,Sw:()=>O,d:()=>a,kU:()=>f,o5:()=>p});var d=e(4921),o=e(6754);function f(i,r,E){const l=c(i,"text",r);return l.value=E,l}function p(i,r,E,l,x,N){const _=c(i,"number",r);return _.value=E,_.step=l,_.min=x,_.max=N,_}function C(i,r,E){const l=c(i,"checkbox",r);return l.checked=E,l}function c(i={},r=null,E=null){const l=u("input",i);return r&&(l.type=r),E&&(l.addEventListener("keyup",(0,d.sg)(E,200)),l.addEventListener("change",(0,d.sg)(E,100))),l}function n(i={},r=null){return u("span",i,r)}function a(i={},r=null,E=null){const l=u("a",i,r);return E&&(l.href=E),l}function t(i,r=null,E={}){E.cursor||="pointer";const l=a(E,r);return i&&l.addEventListener("click",i),l}function v(i,r,E=null,l={},x={}){l.display||="inline-flex",l.alignItems||="center",l.gap||="0.25em";const N=t(i,E,l);return N.prepend(R(r,x)),N}function h(i={},r=null,E=null){const l=u("button",i,r);return E&&l.addEventListener("click",E),l}function O(i={},r=null){return u("div",i,r)}function g(i={}){return u("i",i)}function R(i,r={}){r.width||="1em",r.height||="1em",r.paddingBottom||="1px";const E=g(r);return E.setAttribute("data-lucide",i),E}function u(i,r,E=null){if(typeof r!="object"||r===null)throw new TypeError("styles should be an object");const l=document.createElement(i);return(0,o.ZM)(l,r),E&&(l.innerHTML=E),l}},573:(F,m,e)=>{e.d(m,{Fi:()=>f,YA:()=>a,fI:()=>p});var d=e(4214);function o(u,i=document){return!!i.querySelector(u)}function f(u,i=document,r=!1){const E=i.querySelector(u);return r&&!E&&console.log(`No element found for selector: ${u}`),E}function p(u,i=document,r=!1){const E=i.querySelectorAll(u);return r&&!E.length&&console.log(`No elements found for selector: ${u}`),E}function C(u,i=1){let r=u;for(let E=0;E<i;E++){if(!r.parentElement)return null;r=r.parentElement}return r}function c(u,i,r){return[...u.querySelectorAll(i)].find(E=>E.textContent.trim().includes(r))}function n(u,i,r=!1,E=!1,l=null){const x=f(i,u);return a(x,r,E,l)}function a(u,i=!1,r=!1,E=null){if(!u)return E===null?(console.log("No element found"),null):E;const l=u.innerText;return h(l,i,r)}function t(u,i,r=!1){const E=u[i];return a(E,r)}function v(u,i=!1,r=!1){const E=u.textContent;return h(E,i,r)}function h(u,i,r){i&&(u=(0,d.zr)(u)),r&&(u=u.replace(",","."));const E=Number(u);return Number.isNaN(E)?(console.log(`Invalid number: ${u}`),0):E}function O(u){return[...u.childNodes].find(i=>i.nodeType===Node.TEXT_NODE)}function g(u){const i=r=>r.nodeType===Node.TEXT_NODE&&r.textContent.trim()!==""?[r]:[...r.childNodes].flatMap(i);return i(u)}function R(u){return normalizeSpacing(u.textContent)}},5539:(F,m,e)=>{e.d(m,{Bt:()=>o,UC:()=>t,WH:()=>d,kl:()=>n});function d(s,b){s.parentNode.insertBefore(b,s.nextSibling)}function o(s){s.style.display="none"}function f(s,b=1){const D=document.querySelector(s);D&&p(D,b)}function p(s,b=1){const D=getElementAncestor(s,b);D&&o(D)}function C(s){O(s),o(s)}function c(s){s.intersectionObserver||runOnceOnIntersection(s,()=>o(s))}function n(s){s.style.display=""}function a(s){const b=h(s);s.style.display=b}function t(s,b){b?o(s):n(s)}function v(s,b){b?c(s):(clearIntersectionObserver(s),n(s))}function h(s){return O(s),s.defaultDisplay}function O(s){if(s.defaultDisplay)return;const{display:b}=getComputedStyle(s);s.defaultDisplay=b}function g(){return{show:[],hide:[]}}function R(s,b,D){s?b.hide.push(D):b.show.push(D)}function u(s){s.show.forEach(n),s.hide.forEach(o)}function i(s,b,D=.3){b?E(s,D):r(s)}function r(s){s.style.opacity=""}function E(s,b=.3){s.style.opacity=b}function l(s){s.style.order=""}function x(s,b){s.style.order=b}function N(s,b){s.style.background=b}function _(s,b){const D=getFirstElement(b);D&&z(s,D)}function z(s,b){const D=createLink();D.href=s,b.parentNode.append(D),D.append(b)}function I(s,b){const D=getFirstElement(b);D&&T(s,D)}function T(s,b){const D=createLink();D.href=s,D.append(...b.childNodes),b.append(D)}function L(){const s=getURLQueryParam("scrollTo");if(!s)return;const b=document.getElementById(s);b?b.scrollIntoView():console.log(`Element with ID "${s}" was not found.`)}function W(s,b,D=null){const V=`${b}-click-passed`,$=D?M=>findElementByText(M,s,D):M=>getFirstElement(s,M);return function(M){if(M.hasAttribute(V))return!1;const S=$(M);return S&&S.click(),M.setAttribute(V,""),!0}}function k(s,b,D="text/plain"){const V=new Blob([s],{type:D}),$=URL.createObjectURL(V),M=document.createElement("a");M.href=$,M.download=b,document.body.appendChild(M),M.click(),document.body.removeChild(M),requestAnimationFrame(()=>URL.revokeObjectURL($))}},6754:(F,m,e)=>{e.d(m,{ZM:()=>d});function d(C,c){Object.assign(C.style,c)}function o(C,c="custom-global-style"){let n=document.getElementById(c);n||(n=document.createElement("style"),n.id=c,n.type="text/css",document.head.appendChild(n)),n.textContent=C}function f(C){return Object.entries(C).map(([c,n])=>`${c.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${n};`).join(" ")}function p(C){return C?C.split(";").filter(c=>c.trim()!=="").reduce((c,n)=>{const[a,t]=n.split(":").map(h=>h.trim()),v=a.replace(/-([a-z])/g,(h,O)=>O.toUpperCase());return c[v]=t,c},{}):{}}},4921:(F,m,e)=>{e.d(m,{sg:()=>p,xk:()=>d});function d(t,v,h=null){const O=t.querySelector(v);return O?Promise.resolve(O):new Promise(g=>{const R=new MutationObserver(i);R.observe(t,{childList:!0,subtree:!0});let u;h&&(u=setTimeout(()=>{R.disconnect(),console.log(`No element found for selector: ${v}`),g(null)},h));function i(){const r=t.querySelector(v);r&&(u&&clearTimeout(u),R.disconnect(),g(r))}})}function o(t,v){return t.querySelector(v)?new Promise(O=>{const g=new MutationObserver(R);g.observe(t,{childList:!0,subtree:!0});function R(){t.querySelector(v)||(g.disconnect(),O())}}):Promise.resolve()}function f(t,v=400){return new Promise(h=>{let O;const g=new MutationObserver(()=>{clearTimeout(O),R()});function R(){O=setTimeout(()=>{g.disconnect(),h()},v)}R(),g.observe(t,{childList:!0,subtree:!0})})}function p(t,v=250){let h;return(...O)=>{clearTimeout(h),h=setTimeout(()=>t(...O),v)}}async function C(t){document.visibilityState==="visible"?await t():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await t()},{once:!0})}function c(t,v){const h=new IntersectionObserver(O=>{O.forEach(g=>{g.isIntersecting&&(v(),n(t))})});t.intersectionObserver=h,h.observe(t)}function n(t){t.intersectionObserver&&(t.intersectionObserver.disconnect(),t.intersectionObserver=null)}function a(t){t&&(t.disconnect(),t=null)}},3829:(F,m,e)=>{e.d(m,{Ay:()=>o,JE:()=>p,iG:()=>C});var d=e(8355);function o(n,a){return!f(n,a)}function f(n,a){if(!a.value)return!0;const t=n.toLowerCase(),v=(0,d.R)(a),h=[],O=[];return v.forEach(g=>{if(g.startsWith("!")){const R=g.substring(1);R&&O.push(R)}else h.push(g)}),h.every(g=>t.includes(g))&&O.every(g=>!t.includes(g))}function p(n,a){return a.value!=null&&n<a.value}function C(n,a){return a.value!=null&&n>a.value}function c(n,a){return a.value&&n!==a.value}},4521:(F,m,e)=>{e.d(m,{z:()=>o});var d=e(3048);function o(f,p=null){return{createGlobalFilter(C,c=null,n=f){return d.V.create(C,c,n)},createSectionFilter(C,c=null,n=f){if(!p)throw new Error("sectionId must be provided to use createSectionFilter.");return d.V.createWithCompositeKey(p,C,c,n)}}}},5884:(F,m,e)=>{e.d(m,{Hw:()=>C,Nm:()=>f,nW:()=>p});var d=e(9928),o=e(5467);function f(c,n,a={},t={}){const v=(0,d.kU)(t,n.updateValueFromEvent,n.value);return(0,o.E2)(v,a,c)}function p(c,n,a,t,v,h={},O={}){const g=(0,d.o5)(O,n.updateValueFromEvent,n.value,a,t,v);return(0,o.E2)(g,h,c)}function C(c,n,a={},t={}){const v=(0,d.S)(t,n.updateValueFromEvent,n.value);return(0,o.E2)(v,a,c)}},7877:(F,m,e)=>{e.d(m,{E9:()=>o,FR:()=>p,HX:()=>f,X0:()=>C,pW:()=>_});var d=e(5884);function o(I,T={},L={}){return(0,d.Nm)("\u041F\u043E\u0438\u0441\u043A: ",I,T,L)}function f(I,T={},L={},W=.1,k=3){return(0,d.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",I,W,k,5,T,L)}function p(I,T={},L={},W=.1,k=3){return(0,d.nW)("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",I,W,k,5,T,L)}function C(I,T={},L={}){return n("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",I,T,L)}function c(I,T={},L={}){return n("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",I,T,L)}function n(I,T,L={},W={}){return(0,d.nW)(I,T,"1","1","999999",L,W)}function a(I,T={},L={}){return t("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",I,T,L)}function t(I,T,L={},W={}){return createNumberFilterControl(I,T,"5","0","100",L,W)}function v(I,T={},L={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",I,"5","0","100",T,L)}function h(I,T,L={},W={},k="250"){return createNumberFilterControl(I,T,k,"0","1000000",L,W)}function O(I,T={},L={},W="25"){return h("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",I,T,L,W)}function g(I,T={},L={},W="25"){return h("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",I,T,L,W)}function R(I,T={},L={}){return u("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",I,T,L)}function u(I,T,L={},W={}){return createNumberFilterControl(I,T,"1","0","99999",L,W)}function i(I,T={},L={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",I,"1","2","7",T,L)}function r(I,T={},L={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",I,1,1,10,T,L)}function E(I,T={},L={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",I,T,L)}function l(I,T={},L={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",I,T,L)}function x(I,T={},L={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",I,T,L)}function N(I,T={},L={}){return createCheckboxFilterControl("\u0411\u0430\u043B\u043B\u044B: ",I,T,L)}function _(I,T={},L={}){return(0,d.Hw)("\u0412\u043A\u043B: ",I,T,L)}function z(I,T,L={}){const W=[{value:-25,emoji:"\u{1F48E}",tooltip:"\u0421\u0443\u043F\u0435\u0440 \u0446\u0435\u043D\u0430 (-25%)"},{value:-15,emoji:"\u{1F525}",tooltip:"\u041E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-15%)"},{value:-5,emoji:"\u{1F31F}",tooltip:"\u041A\u043B\u0430\u0441\u0441\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-5%)"},{value:5,emoji:"\u{1F44C}",tooltip:"\u0425\u043E\u0440\u043E\u0448\u0430\u044F \u0446\u0435\u043D\u0430 (+5%)"}],k={active:{background:"#e3f2fd",borderColor:"#2196f3",boxShadow:"0 0 0 1px #2196f3"},inactive:{background:"#fff",borderColor:"#ccc",boxShadow:"none"},hover:{background:"#f5f5f5"}},s=createDiv({display:"inline-flex",gap:"4px",marginLeft:"4px"}),b=[],D=()=>T?parseFloat(T.value)||0:I.value,V=()=>{const $=D();b.forEach(({button:M,value:S})=>{const H=S<=$?k.active:k.inactive;Object.assign(M.style,H)})};return W.forEach(({value:$,emoji:M,tooltip:S})=>{const y=createButton({padding:"2px 6px",fontSize:"16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"#fff",transition:"all 0.2s",...L},M);y.title=S,y.type="button",y.addEventListener("click",H=>{H.preventDefault(),I.updateValue($),T&&(T.value=$),V()}),y.addEventListener("mouseenter",()=>{$<=D()||(y.style.background=k.hover.background)}),y.addEventListener("mouseleave",()=>{V()}),b.push({button:y,value:$}),s.appendChild(y)}),V(),T&&(T.addEventListener("input",V),T.addEventListener("change",V)),s}},8355:(F,m,e)=>{e.d(m,{R:()=>d,f:()=>o});function d(f){return f.value.toLowerCase().split(",").map(p=>p.trim()).filter(p=>p!=="")}function o(f){return d(f).filter(p=>!p.startsWith("!"))}},5213:(F,m,e)=>{e.d(m,{b:()=>f});var d=e(9928),o=e(573);function f(p,C,c=!1,n="customFiltersContainer"){let a=(0,o.Fi)(`#${n}`,p);if(a)if(c)a.remove();else return;a=(0,d.Sw)(),a.id=n,C(a,p)}},8200:(F,m,e)=>{e.d(m,{s:()=>d});function d(o){const{target:f}=o,{type:p}=f;switch(p){case"text":return`"${f.value}"`;case"number":return f.value;case"checkbox":return f.checked;default:return console.log(`Unknown input type: ${p}`),null}}},157:(F,m,e)=>{e.d(m,{Fg:()=>d,vx:()=>f});const d=window.GM_setValue,o=window.GM.setValue,f=window.GM_getValue},1870:(F,m,e)=>{e.d(m,{j:()=>d});class d{constructor(f,p){this.value=f,this.onChange=p}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(F,m,e)=>{e.d(m,{V:()=>C});var d=e(1870),o=e(8200),f=e(3976),p=e(157);class C extends d.j{constructor(n,a=null,t=null){super((0,p.vx)(n,a),t),this.storageKey=n,this.defaultValue=a}static create(n,a=null,t=null){return new C(n,a,t)}static createWithCompositeKey(n,a,t=null,v=null){const h=`${n}-${a}`;return new C(h,t,v)}updateValueFromEvent=n=>{const a=(0,o.s)(n),t=(0,f.$)(a);this.updateValue(t)};updateValue(n,a=!0){this.value!==n&&((0,p.Fg)(this.storageKey,n),this.value=n,a&&this.onChangeIfDefined())}clearValue(n=!1){this.updateValue(null,n)}resetValue(n=!1){this.updateValue(this.defaultValue,n)}}},3976:(F,m,e)=>{e.d(m,{$:()=>d});function d(o){return o===""?null:JSON.parse(o)}},4214:(F,m,e)=>{e.d(m,{$z:()=>d,zr:()=>o});function d(c){return c.replace(/\D/g,"")}function o(c){return c.replace(/[^\d.,-]/g,"")}function f(c){return c.replace(/\s/g,"")}function p(c){return c.charAt(0).toUpperCase()+c.slice(1)}function C(c){return c.replace(/\s+/g," ").trim()}},5406:(F,m,e)=>{e.d(m,{$F:()=>c,Fc:()=>d,bn:()=>o,z2:()=>v});function d(R,u="common",i=!1){const{pathname:r}=window.location;return o(r,R,u,i)}function o(R,u,i,r=!1){const E=R.split("/");u=u<0?E.length+u:u;const l=E[u]||i;return r&&console.log(`Pathname element: ${l}`),l}function f(R,u="common",i=!1){const r=d(R,"",i);return p(r,u,i)}function p(R,u,i){if(!R)return u;const r=R.split("-").at(-1);return i&&console.log(`Pathname element ending: ${r}`),r}function C(R,u,i="common",r=!1){const E=o(R,u,"",r);return p(E,i,r)}function c(R){return new URLSearchParams(window.location.search).get(R)}function n(R){return R.split("?")[0]}function a(R){return window.location.pathname.includes(R)}function t(R){return R.some(u=>a(u))}function v(R){return window.location.pathname.split("/").some(i=>i===R)}function h(R){try{const u=new URL(window.location.href);Object.entries(R).forEach(([i,r])=>{u.searchParams.set(i,r)}),window.location.href=u.toString()}catch(u){console.error("Failed to redirect:",u)}}function O(R,u=[]){const i={pathname:window.location.pathname};u.forEach(N=>{i[N]=c(N)});let r=!1;async function E(){if(r)return;const N={pathname:window.location.pathname};if(u.forEach(_=>{N[_]=c(_)}),Object.keys(i).some(_=>i[_]!==N[_])){Object.assign(i,N),r=!0;try{await R()}catch(_){console.error("Error in URL observer callback:",_)}finally{r=!1}}}function l(){E().catch(N=>{console.error("Error in URL change handler:",N)})}let x=window.location.href;setInterval(()=>{window.location.href!==x&&(x=window.location.href,l())},200),window.addEventListener("popstate",l)}function g(R=[]){O(()=>window.location.reload(),R)}},2524:(F,m,e)=>{e.d(m,{d5:()=>f,vX:()=>n,ft:()=>p});var d=e(157);class o{constructor(v=Date.now(),h=[]){this.lastCheckDate=v,this.reviewsData=h}updateLastCheckDate=()=>{this.lastCheckDate=Date.now()};static fromObject(v){const{lastCheckDate:h,reviewsData:O}=v;return new o(h,O)}}const f={LAST_DOCTOR_UPDATE:"last-doctor-update"};function p(t,v){const h=C(t),O=(0,d.vx)(h),g=c(O);g.reviewsData=v,g.updateLastCheckDate(),(0,d.Fg)(h,g),(0,d.Fg)(f.LAST_DOCTOR_UPDATE,Date.now())}function C(t){return`doctor-${t}`}function c(t){return t?o.fromObject(t):new o}function n(t){return a(t)?.reviewsData??null}function a(t){const v=C(t);return(0,d.vx)(v)}},1753:(F,m,e)=>{e.a(F,async(d,o)=>{try{var f=e(573),p=e(7858),C=e(4231),c=e(5406),n=e(5072);const t=(0,f.Fi)(".appointments_page");t?(0,C.$)(t):(0,c.z2)("otzivi")?await(0,n.N)():(0,c.z2)("vrach")&&(0,p.O)(),o()}catch(a){o(a)}},1)},7653:(F,m,e)=>{e.d(m,{NI:()=>t,z1:()=>O,Np:()=>i,pR:()=>g,sp:()=>E,rd:()=>r});var d=e(9928),o=e(573);const f={DOCTOR_CARD_NAME:'.b-doctor-intro__title-first-line [itemprop="name"]',DOCTOR_INTRO_LEFT:".b-doctor-intro__left-side",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]'};var p=e(8586),C=e(5406),c=e(4214);const n="additionalLinksAppended",a=["\u042F\u043D\u0434\u0435\u043A\u0441","\u041D\u0430\u041F\u043E\u043F\u0440\u0430\u0432\u043A\u0443","DocDoc","\u0414\u043E\u043A\u0442\u0443"];function t(l,x){x.classList.contains(n)||(a.forEach(N=>{v(l,x,N)}),x.classList.add(n))}function v(l,x,N){const _=h(l,N),z=(0,d.d)({},N,_),I=document.createElement("br");x.append(I,z)}function h(l,x){const N=`${l} ${x}`;return`https://www.google.com/search?q=${encodeURIComponent(N)}&btnI`}function O(){const l=(0,o.Fi)(f.DOCTOR_CARD_NAME,document,!0);if(!l)return;const x=l.innerText.trim(),N=(0,d.Sw)();N.style.textAlign="center",(0,o.Fi)(f.DOCTOR_INTRO_LEFT).append(N),t(x,N)}function g(l,x,N=!1){const _=(0,d.Sw)(p.r.REVIEWS_INFO);N&&(_.style.justifyContent="center"),_.classList.add("v-application");const z=(0,d.Sw)(p.r.REVIEWS_INFO_BLOCK);return z.style.height=N?"10px":"23px",z.append(_),l.slice(N?1:0).forEach(I=>{const{category:T,title:L,count:W,bgClassSuffix:k}=I,s=`${x}?rates_category=${T}`,b=N?W:`${L} ${W}`,D=(0,d.d)(p.r.REVIEW_INFO,b,s);D.classList=R(k),_.append(D),N&&u(D,L)}),z}function R(l){return`text-caption text--text px-2 py-1 rounded-sm bg-${l}`}function u(l,x){let N=null;l.addEventListener("mouseenter",()=>{N=(0,d.Sw)(p.r.REVIEW_INFO_TOOLTIP,x),document.body.appendChild(N);const _=l.getBoundingClientRect();N.style.left=`${(_.left+_.right)/2-N.offsetWidth/2+window.scrollX+2}px`,N.style.top=`${_.top+window.scrollY-N.offsetHeight-4}px`}),l.addEventListener("mouseleave",()=>{N&&(N.remove(),N=null)})}function i(l){const x=(0,o.Fi)(f.NAME_SPAN_HOLDER,document,!0);if(!x)return;const N=(0,o.Fi)(f.NAME_SPAN,x,!0);N&&N.append(l)}function r(){const l=(0,C.Fc)(3,"unknown");return(0,c.$z)(l)}function E(l){const x=(0,C.bn)(l,5,"");return(0,c.$z)(x)}},8586:(F,m,e)=>{e.d(m,{r:()=>o});const d={INPUT:{border:"1px solid #c7d3d9",borderRadius:"10px",padding:"7px 14px",marginLeft:"6px"}},o={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",flexFlow:"wrap"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...d.INPUT,width:"195px"},NUMBER_INPUT:{...d.INPUT,width:"70px"},CHECKBOX_INPUT:{...d.INPUT,width:"20px",height:"20px"},REVIEWS_INFO:{gridGap:"6px"},REVIEWS_INFO_BLOCK:{marginTop:"5px"},REVIEW_INFO:{textDecoration:"none",flexShrink:0},REVIEW_INFO_TOOLTIP:{position:"absolute",backgroundColor:"#333",color:"#fff",padding:"4px 8px",borderRadius:"8px",fontSize:"12px",zIndex:"1000",pointerEvents:"none",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"}}},4231:(F,m,e)=>{e.d(m,{$:()=>L});var d=e(5406),o=e(573),f=e(5539),p=e(3829),C=e(7653),c=e(5213),n=e(5884),a=e(7877);const t={LIST_HEADER:".h2_rating",DOCTOR_FILTERS:".vue-the-doctors-filters > .b-container",DOCTOR_CARD:".b-doctor-card",DOCTOR_CARD_NAME:".b-doctor-card__name-surname",PROFILE_CARD:".b-profile-card",REVIEWS_LINK:":scope > a",EXPERIENCE_WRAP:".b-doctor-card__experience .mr-2 .text-subtitle-1",SPEC_WRAP:".b-doctor-card__spec",CLINIC_CONTAINER:"div.b-doctor-card__lpu-select",CLINIC_WRAP:".b-select__trigger-main-text"};var v=e(4521),h=e(2524),O=e(4921),g=e(8586),R=e(6754);const u=window.GM_addValueChangeListener,i=(0,d.Fc)(2),{createGlobalFilter:r,createSectionFilter:E}=(0,v.z)(s,i),l=E("spec-filter"),x=E("clinic-filter"),N=E("min-reviews-filter",10),_=E("min-experience-filter",5,M),z=E("max-experience-filter",40),I=r("filter-enabled",!0),T={doctorCardsCache:new WeakMap};function L(S){M(),W();const y=(0,o.Fi)(t.DOCTOR_FILTERS);(0,c.b)(y,k),s(),u(h.d5.LAST_DOCTOR_UPDATE,s),new MutationObserver((0,O.sg)(s)).observe(S,{childList:!0})}function W(){const S=(0,o.Fi)(t.LIST_HEADER);S&&S.remove()}function k(S,y){(0,R.ZM)(S,g.r.FILTERS_CONTAINER),S.style.marginTop="6px";const H=(0,n.Nm)("\u0421\u043F\u0435\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F:",l,g.r.CONTROL,g.r.TEXT_INPUT),G=(0,n.Nm)("\u041A\u043B\u0438\u043D\u0438\u043A\u0430:",x,g.r.CONTROL,g.r.TEXT_INPUT),w=(0,a.X0)(N,g.r.CONTROL,g.r.NUMBER_INPUT),A=(0,n.nW)("\u041C\u0438\u043D. \u043E\u043F\u044B\u0442: ",_,"1","0","100",g.r.CONTROL,g.r.NUMBER_INPUT),P=(0,n.nW)("\u041C\u0430\u043A\u0441. \u043E\u043F\u044B\u0442: ",z,"1","0","100",g.r.CONTROL,g.r.NUMBER_INPUT),B=(0,a.pW)(I,g.r.CONTROL,g.r.CHECKBOX_INPUT);S.append(H,G,w,A,P,B),y.append(S)}function s(){(0,o.fI)(t.DOCTOR_CARD).forEach(b)}function b(S){if(!I.value){(0,f.kl)(S);return}let y=T.doctorCardsCache.get(S);if(!y){const G=(0,o.Fi)(t.PROFILE_CARD,S),w=(0,o.Fi)(t.REVIEWS_LINK,G),A=(0,o.Fi)(t.EXPERIENCE_WRAP,S);if(!w||!A){(0,f.Bt)(S);return}const B=(0,o.Fi)(t.SPEC_WRAP,S,!0).innerText.trim(),U=(0,o.Fi)(t.CLINIC_CONTAINER,S,!0),K=(0,o.Fi)(t.CLINIC_WRAP,U,!0).innerText.trim(),X=(0,o.YA)(w,!0),Q=(0,o.YA)(A,!0),J=D(w);w.href=J,(0,C.NI)(V(S),G),y={specInfo:B,clinicName:K,reviewsLinkNumber:X,experienceNumber:Q,reviewsLink:w,reviewInfoAppended:!1},T.doctorCardsCache.set(S,y)}$(y);const H=(0,p.Ay)(y.specInfo,l)||(0,p.Ay)(y.clinicName,x)||(0,p.JE)(y.reviewsLinkNumber,N)||(0,p.JE)(y.experienceNumber,_)||(0,p.iG)(y.experienceNumber,z);(0,f.UC)(S,H)}function D(S){return S.href.replace(/\/#otzivi$/,"/otzivi/")}function V(S){return(0,o.Fi)(t.DOCTOR_CARD_NAME,S,!0).innerText}function $(S){if(S.reviewInfoAppended)return;const{reviewsLink:y}=S,H=y.href,G=(0,h.vX)((0,C.sp)(H));if(!G)return;const w=(0,C.pR)(G,H,!0);(0,f.WH)(y,w),S.reviewInfoAppended=!0}function M(){if(!_.value)return;const S=new URL(window.location.href);+S.searchParams.get("experience")!==_.value&&(S.searchParams.set("experience",_.value),window.location.href=S.toString())}},7858:(F,m,e)=>{e.d(m,{O:()=>c});var d=e(573),o=e(9928),f=e(7653);const p={REVIEWS_LINK:".b-doctor-intro__rates-wrapper > a",DOCTOR_DETAILS:".b-doctor-details__toc",REVIEWS_FILTER:".reviews-filter:not(.b-reviews-page__filter)",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]',REVIEWS_FILTER_SPAN:":scope > span",DOCTOR_CONTACTS:"#doctor-contacts"};var C=e(2524);function c(){(0,f.z1)(),a();const v=n();t(v);const h=(0,C.vX)((0,f.rd)());if(!h)return;const O=(0,f.pR)(h,v);(0,f.Np)(O)}function n(){const{location:v}=window;return`${v.origin}${v.pathname}otzivi/`}function a(){if(!(0,d.Fi)(p.DOCTOR_CONTACTS))return;const h=[...(0,d.fI)(p.DOCTOR_DETAILS)].pop();if(!h)return;h.style.position="sticky",h.style.top="16px";const O=(0,o.Sw)({},"\u041C\u0435\u0441\u0442\u043E \u0440\u0430\u0431\u043E\u0442\u044B");O.classList.add("b-doctor-details__toc-title");const g=(0,o.d)({},null,"#doctor-contacts");g.classList.add("b-doctor-details__toc-item"),g.append(O),h.insertBefore(g,h.firstChild)}function t(v){const h=(0,d.Fi)(p.REVIEWS_LINK);h&&(h.href=v)}},5072:(F,m,e)=>{e.d(m,{N:()=>b});var d=e(7653);const o={CONTROLS_CONTAINER:".vue-review-filter",REVIEWS:".b-review-card",REVIEW_TEXT_WRAP:".b-review-card__comment",REVIEW_RATING_WRAP:".review-card-tooltips__stars > .ui-text",FILTER_CHIP:'[data-qa="reviews_filter_chip"]',FILTER_LIST:'[data-qa="reviews_filter_list"]',FILTER_LIST_ITEM:'[data-qa^="reviews_filter_list_item"]',FILTER_TITLE_WRAP:'[data-qa="reviews_filter_title"]',FILTER_COUNT_WRAP:'[data-qa="reviews_filter_amount"]',REVIEWS_CONTAINER:"#otzivi"};var f=e(573),p=e(4921),C=e(5406),c=e(2524),n=e(4521),a=e(5213),t=e(8586),v=e(7877),h=e(5539);function O(w,A){w.forEach(P=>g(A,P))}function g(w,A){if(!A)return;const P=new RegExp(`(${A})`,"gi"),B=document.createTreeWalker(w,NodeFilter.SHOW_TEXT,null);let U=B.nextNode();const j=[];for(;U;){const{textContent:K}=U;if(P.test(K)){const X=document.createDocumentFragment();let Q=0;K.replace(P,(J,re,q)=>{q>Q&&X.appendChild(document.createTextNode(K.slice(Q,q)));const Z=document.createElement("span");Z.className="highlightedSubstring",Z.style.backgroundColor="yellow",Z.textContent=J,X.appendChild(Z),Q=q+J.length}),Q<K.length&&X.appendChild(document.createTextNode(K.slice(Q))),j.push({node:U,fragment:X})}U=B.nextNode()}j.forEach(({node:K,fragment:X})=>{K.parentNode.replaceChild(X,K)})}function R(w){(0,f.fI)(".highlightedSubstring",w).forEach(P=>{const{parentNode:B}=P;P.replaceWith(P.textContent),B.normalize()})}var u=e(8355);function i(w,A){const P=(0,u.f)(w);O(P,A)}function r(w,A){const P=getIncludedSearchStrings(w);A.forEach(B=>highlightSubstrings(P,B))}var E=e(3829),l=e(9928);function x(w={}){return(0,l.Sw)(w,"|")}function N(w={},A=75,P="customFiltersContainer"){const B=document.getElementById(P);if(!B)return console.log(`Element with id="${P}" not found.`),null;const U=createButton(w,`${arrowUpIcon}\u041A \u0444\u0438\u043B\u044C\u0442\u0440\u0430\u043C`);return U.addEventListener("mouseenter",()=>{U.style.filter="brightness(0.9)"}),U.addEventListener("mouseleave",()=>{U.style.filter="brightness(1)"}),U.addEventListener("click",()=>{const j=B.getBoundingClientRect();window.scrollTo({top:j.top+window.scrollY-A})}),new IntersectionObserver(([j])=>{U.style.display=j.isIntersecting?"none":"flex"},{threshold:.5}).observe(B),U}function _(w,A={}){const P=N(A);P&&w.appendChild(P)}var z=e(6754);const{createGlobalFilter:I}=(0,n.z)(V),T=I("reviews-text-filter"),L=I("reviews-min-rating-filter"),W=I("reviews-max-rating-filter"),k=I("reviews-filter-enabled",!0),s={reviewCardsCache:new Map};async function b(){(0,d.z1)();const w=await(0,p.xk)(document,o.CONTROLS_CONTAINER);(0,a.b)(w,D),V();const A=await S();(0,c.ft)((0,d.rd)(),A);const P=(0,d.pR)(A,H());(0,d.Np)(P),(0,C.$F)("rates_category")&&G()}function D(w,A){(0,z.ZM)(w,t.r.FILTERS_CONTAINER),w.style.marginTop="12px";const P=(0,v.E9)(T,t.r.CONTROL,t.r.TEXT_INPUT),B=(0,v.HX)(L,t.r.CONTROL,t.r.NUMBER_INPUT,1,1),U=(0,v.FR)(W,t.r.CONTROL,t.r.NUMBER_INPUT,1,1),j=x(t.r.CONTROL),K=(0,v.pW)(k,t.r.CONTROL,t.r.CHECKBOX_INPUT);w.append(P,B,U,j,K),A.append(w)}function V(){(0,f.fI)(o.REVIEWS).forEach($)}function $(w){if(!k.value){(0,h.kl)(w);return}R(w);let A=s.reviewCardsCache.get(w);if(!A){const B=(0,f.Fi)(o.REVIEW_TEXT_WRAP,w),U=(0,f.Fi)(o.REVIEW_RATING_WRAP,w);if(!B){(0,h.Bt)(w);return}A={reviewTextWrap:B,reviewText:B.innerText,rating:U&&(0,f.YA)(U)},s.reviewCardsCache.set(w,A)}T.value&&i(T,A.reviewTextWrap);const P=(0,E.Ay)(A.reviewText,T)||M(A.rating);(0,h.UC)(w,P)}function M(w){return w?(0,E.JE)(w,L)||(0,E.iG)(w,W):!1}async function S(){const w=(0,f.Fi)(o.FILTER_CHIP);w.click();const A=await(0,p.xk)(document,o.FILTER_LIST),P=[...(0,f.fI)(o.FILTER_LIST_ITEM,A)].map(B=>{const U=B.getAttribute("data-qa");if(!U)return null;const j=U.replace("reviews_filter_list_item_",""),K=(0,f.Fi)(o.FILTER_TITLE_WRAP,B).textContent.trim(),X=(0,f.Fi)(o.FILTER_COUNT_WRAP,B),Q=(0,f.YA)(X,!0),J=y(X.classList);return{category:j,title:K,count:Q,bgClassSuffix:J}});return w.click(),P}function y(w){const A=w.value.match(/bg-(\w+)/);return A?A[1]:null}function H(){const{location:w}=window;return`${w.origin}${w.pathname}`}function G(){(0,f.Fi)(o.REVIEWS_CONTAINER).scrollIntoView({behavior:"smooth"})}}},ee={};function Y(F){var m=ee[F];if(m!==void 0)return m.exports;var e=ee[F]={exports:{}};return te[F](e,e.exports,Y),e.exports}(()=>{var F=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",m=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",e=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",d=f=>{f&&f.d<1&&(f.d=1,f.forEach(p=>p.r--),f.forEach(p=>p.r--?p.r++:p()))},o=f=>f.map(p=>{if(p!==null&&typeof p=="object"){if(p[F])return p;if(p.then){var C=[];C.d=0,p.then(a=>{c[m]=a,d(C)},a=>{c[e]=a,d(C)});var c={};return c[F]=a=>a(C),c}}var n={};return n[F]=a=>{},n[m]=p,n});Y.a=(f,p,C)=>{var c;C&&((c=[]).d=-1);var n=new Set,a=f.exports,t,v,h,O=new Promise((g,R)=>{h=R,v=g});O[m]=a,O[F]=g=>(c&&g(c),n.forEach(g),O.catch(R=>{})),f.exports=O,p(g=>{t=o(g);var R,u=()=>t.map(r=>{if(r[e])throw r[e];return r[m]}),i=new Promise(r=>{R=()=>r(u),R.r=0;var E=l=>l!==c&&!n.has(l)&&(n.add(l),l&&!l.d&&(R.r++,l.push(R)));t.map(l=>l[F](E))});return R.r?i:u()},g=>(g?h(O[e]=g):v(a),d(c))),c&&c.d<0&&(c.d=0)}})(),Y.d=(F,m)=>{for(var e in m)Y.o(m,e)&&!Y.o(F,e)&&Object.defineProperty(F,e,{enumerable:!0,get:m[e]})},Y.o=(F,m)=>Object.prototype.hasOwnProperty.call(F,m);var ne=Y(1753)})();})();
