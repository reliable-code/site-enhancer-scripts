// ==UserScript==
// @name         Prodoc enhancer
// @description  Hide doctor cards by filter, enhance doctor page
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://prodoctorov.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      2.0.76667969
// @icon         https://www.google.com/s2/favicons?sz=64&domain=prodoctorov.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/prodoc.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var te={5467:(D,h,e)=>{e.d(h,{E2:()=>i});var s=e(9928);function i(I,p={},n=null){const m=(0,s.Sw)(p,n);return m.append(I),m}function a(I,p=null,n={},m={}){const t=createActionLink(I,p,m);return i(t,n)}function f(I,p=null,n=null,m={},t={}){const u=createActionLinkWithIcon(I,n,p,t);return i(u,m)}},9928:(D,h,e)=>{e.d(h,{S:()=>p,Sw:()=>w,d:()=>t,kU:()=>a,o5:()=>f});var s=e(4921),i=e(6754);function a(r,l,d){const g=n(r,"text",l);return g.value=d,g}function f(r,l,d,g,N,x){const k=n(r,"number",l);return k.value=d,k.step=g,k.min=N,k.max=x,k}function I(r,l,d){const g=n(r,"date",l);return g.value=d,g}function p(r,l,d){const g=n(r,"checkbox",l);return g.checked=d,g}function n(r={},l=null,d=null){const g=E("input",r);return l&&(g.type=l),d&&(g.addEventListener("keyup",(0,s.sg)(d,200)),g.addEventListener("change",(0,s.sg)(d,100))),g}function m(r={},l=null){return E("span",r,l)}function t(r={},l=null,d=null){const g=E("a",r,l);return d&&(g.href=d),g}function u(r,l=null,d={}){d.cursor||="pointer";const g=t(d,l);return r&&g.addEventListener("click",r),g}function v(r,l,d=null,g={},N={}){g.display||="inline-flex",g.alignItems||="center",g.gap||="0.25em";const x=u(r,d,g);return x.prepend(c(l,N)),x}function b(r={},l=null,d=null){const g=E("button",r,l);return d&&g.addEventListener("click",d),g}function w(r={},l=null){return E("div",r,l)}function C(r={}){return E("i",r)}function c(r,l={}){l.width||="1em",l.height||="1em",l.paddingBottom||="1px";const d=C(l);return d.setAttribute("data-lucide",r),d}function E(r,l,d=null){if(typeof l!="object"||l===null)throw new TypeError("styles should be an object");const g=document.createElement(r);return(0,i.ZM)(g,l),d&&(g.innerHTML=d),g}},573:(D,h,e)=>{e.d(h,{Fi:()=>a,YA:()=>m,fI:()=>f});var s=e(4214);function i(c,E=document){return!!E.querySelector(c)}function a(c,E=document,r=!1){const l=E.querySelector(c);return r&&!l&&console.log(`No element found for selector: ${c}`),l}function f(c,E=document,r=!1){const l=E.querySelectorAll(c);return r&&!l.length&&console.log(`No elements found for selector: ${c}`),l}function I(c,E=1){let r=c;for(let l=0;l<E;l++){if(!r.parentElement)return null;r=r.parentElement}return r}function p(c,E,r){return[...c.querySelectorAll(E)].find(l=>l.textContent.trim().includes(r))}function n(c,E,r=!1,l=!1,d=null){const g=a(E,c);return m(g,r,l,d)}function m(c,E=!1,r=!1,l=null){if(!c)return l===null?(console.log("No element found"),null):l;const d=c.innerText;return v(d,E,r)}function t(c,E,r=!1){const l=c[E];return m(l,r)}function u(c,E=!1,r=!1){const l=c.textContent;return v(l,E,r)}function v(c,E,r){E&&(c=(0,s.zr)(c)),r&&(c=c.replace(",","."));const l=Number(c);return Number.isNaN(l)?(console.log(`Invalid number: ${c}`),0):l}function b(c){return[...c.childNodes].find(E=>E.nodeType===Node.TEXT_NODE)}function w(c){const E=r=>r.nodeType===Node.TEXT_NODE&&r.textContent.trim()!==""?[r]:[...r.childNodes].flatMap(E);return E(c)}function C(c){return normalizeSpacing(c.textContent)}},5539:(D,h,e)=>{e.d(h,{Bt:()=>i,UC:()=>t,WH:()=>s,kl:()=>n});function s(o,O){o.parentNode.insertBefore(O,o.nextSibling)}function i(o){o.style.display="none"}function a(o,O=1){const _=document.querySelector(o);_&&f(_,O)}function f(o,O=1){const _=getElementAncestor(o,O);_&&i(_)}function I(o){b(o),i(o)}function p(o){o.intersectionObserver||runOnceOnIntersection(o,()=>i(o))}function n(o){o.style.display=""}function m(o){const O=v(o);o.style.display=O}function t(o,O){O?i(o):n(o)}function u(o,O){O?p(o):(clearIntersectionObserver(o),n(o))}function v(o){return b(o),o.defaultDisplay}function b(o){if(o.defaultDisplay)return;const{display:O}=getComputedStyle(o);o.defaultDisplay=O}function w(){return{show:[],hide:[]}}function C(o,O,_){o?O.hide.push(_):O.show.push(_)}function c(o){o.show.forEach(n),o.hide.forEach(i)}function E(o,O,_=.3){O?l(o,_):r(o)}function r(o){o.style.opacity=""}function l(o,O=.3){o.style.opacity=O}function d(o){o.style.order=""}function g(o,O){o.style.order=O}function N(o,O){o.style.background=O}function x(o,O){const _=getFirstElement(O);_&&k(o,_)}function k(o,O){const _=createLink();_.href=o,O.parentNode.append(_),_.append(O)}function z(o,O){const _=getFirstElement(O);_&&R(o,_)}function R(o,O){const _=createLink();_.href=o,_.append(...O.childNodes),O.append(_)}function T(){const o=getURLQueryParam("scrollTo");if(!o)return;const O=document.getElementById(o);O?O.scrollIntoView():console.log(`Element with ID "${o}" was not found.`)}function F(o,O,_=null){const j=`${O}-click-passed`,$=_?W=>findElementByText(W,o,_):W=>getFirstElement(o,W);return function(W){if(W.hasAttribute(j))return!1;const S=$(W);return S&&S.click(),W.setAttribute(j,""),!0}}function P(o,O,_="text/plain"){const j=new Blob([o],{type:_}),$=URL.createObjectURL(j),W=document.createElement("a");W.href=$,W.download=O,document.body.appendChild(W),W.click(),document.body.removeChild(W),requestAnimationFrame(()=>URL.revokeObjectURL($))}},6754:(D,h,e)=>{e.d(h,{ZM:()=>s});function s(I,p){Object.assign(I.style,p)}function i(I,p="custom-global-style"){let n=document.getElementById(p);n||(n=document.createElement("style"),n.id=p,n.type="text/css",document.head.appendChild(n)),n.textContent=I}function a(I){return Object.entries(I).map(([p,n])=>`${p.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${n};`).join(" ")}function f(I){return I?I.split(";").filter(p=>p.trim()!=="").reduce((p,n)=>{const[m,t]=n.split(":").map(v=>v.trim()),u=m.replace(/-([a-z])/g,(v,b)=>b.toUpperCase());return p[u]=t,p},{}):{}}},4921:(D,h,e)=>{e.d(h,{sg:()=>f,xk:()=>s});function s(t,u,v=null){const b=t.querySelector(u);return b?Promise.resolve(b):new Promise(w=>{const C=new MutationObserver(E);C.observe(t,{childList:!0,subtree:!0});let c;v&&(c=setTimeout(()=>{C.disconnect(),console.log(`No element found for selector: ${u}`),w(null)},v));function E(){const r=t.querySelector(u);r&&(c&&clearTimeout(c),C.disconnect(),w(r))}})}function i(t,u){return t.querySelector(u)?new Promise(b=>{const w=new MutationObserver(C);w.observe(t,{childList:!0,subtree:!0});function C(){t.querySelector(u)||(w.disconnect(),b())}}):Promise.resolve()}function a(t,u=400){return new Promise(v=>{let b;const w=new MutationObserver(()=>{clearTimeout(b),C()});function C(){b=setTimeout(()=>{w.disconnect(),v()},u)}C(),w.observe(t,{childList:!0,subtree:!0})})}function f(t,u=250){let v;return(...b)=>{clearTimeout(v),v=setTimeout(()=>t(...b),u)}}async function I(t){document.visibilityState==="visible"?await t():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await t()},{once:!0})}function p(t,u){const v=new IntersectionObserver(b=>{b.forEach(w=>{w.isIntersecting&&(u(),n(t))})});t.intersectionObserver=v,v.observe(t)}function n(t){t.intersectionObserver&&(t.intersectionObserver.disconnect(),t.intersectionObserver=null)}function m(t){t&&(t.disconnect(),t=null)}},3829:(D,h,e)=>{e.d(h,{Ay:()=>i,JE:()=>f,iG:()=>I});var s=e(8355);function i(t,u){return!a(t,u)}function a(t,u){if(!u.value)return!0;const v=t.toLowerCase(),b=(0,s.R)(u),w=[],C=[];return b.forEach(c=>{if(c.startsWith("!")){const E=c.substring(1);E&&C.push(E)}else w.push(c)}),w.every(c=>v.includes(c))&&C.every(c=>!v.includes(c))}function f(t,u){return u.value!=null&&t<u.value}function I(t,u){return u.value!=null&&t>u.value}function p(t,u){return u.value==null?!1:t<parseDateFromISO(u.value)}function n(t,u){return u.value==null?!1:t>parseDateFromISO(u.value)}function m(t,u){return u.value&&t!==u.value}},4521:(D,h,e)=>{e.d(h,{z:()=>i});var s=e(3048);function i(a,f=null){return{createGlobalFilter(I,p=null,n=a){return s.V.create(I,p,n)},createSectionFilter(I,p=null,n=a){if(!f)throw new Error("sectionId must be provided to use createSectionFilter.");return s.V.createWithCompositeKey(f,I,p,n)}}}},5884:(D,h,e)=>{e.d(h,{Hw:()=>p,Nm:()=>a,nW:()=>f});var s=e(9928),i=e(5467);function a(n,m,t={},u={}){const v=(0,s.kU)(u,m.updateValueFromEvent,m.value);return(0,i.E2)(v,t,n)}function f(n,m,t,u,v,b={},w={}){const C=(0,s.o5)(w,m.updateValueFromEvent,m.value,t,u,v);return(0,i.E2)(C,b,n)}function I(n,m,t={},u={}){const v=createDateInput(u,m.updateValueFromEvent,m.value);return createControl(v,t,n)}function p(n,m,t={},u={}){const v=(0,s.S)(u,m.updateValueFromEvent,m.value);return(0,i.E2)(v,t,n)}},7877:(D,h,e)=>{e.d(h,{E9:()=>i,FR:()=>f,HX:()=>a,X0:()=>I,pW:()=>k});var s=e(5884);function i(R,T={},F={}){return(0,s.Nm)("\u041F\u043E\u0438\u0441\u043A: ",R,T,F)}function a(R,T={},F={},P=.1,o=3){return(0,s.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",R,P,o,5,T,F)}function f(R,T={},F={},P=.1,o=3){return(0,s.nW)("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",R,P,o,5,T,F)}function I(R,T={},F={}){return n("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",R,T,F)}function p(R,T={},F={}){return n("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",R,T,F)}function n(R,T,F={},P={}){return(0,s.nW)(R,T,"1","1","999999",F,P)}function m(R,T={},F={}){return createDateFilterControl("\u041C\u0438\u043D. \u0434\u0430\u0442\u0430: ",R,T,F)}function t(R,T={},F={}){return u("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",R,T,F)}function u(R,T,F={},P={}){return createNumberFilterControl(R,T,"5","0","100",F,P)}function v(R,T={},F={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",R,"5","0","100",T,F)}function b(R,T,F={},P={},o="250"){return createNumberFilterControl(R,T,o,"0","1000000",F,P)}function w(R,T={},F={},P="25"){return b("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",R,T,F,P)}function C(R,T={},F={},P="25"){return b("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",R,T,F,P)}function c(R,T={},F={}){return E("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",R,T,F)}function E(R,T,F={},P={}){return createNumberFilterControl(R,T,"1","0","99999",F,P)}function r(R,T={},F={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",R,"1","2","7",T,F)}function l(R,T={},F={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",R,1,1,10,T,F)}function d(R,T={},F={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",R,T,F)}function g(R,T={},F={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",R,T,F)}function N(R,T={},F={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",R,T,F)}function x(R,T={},F={}){return createCheckboxFilterControl("\u0411\u0430\u043B\u043B\u044B: ",R,T,F)}function k(R,T={},F={}){return(0,s.Hw)("\u0412\u043A\u043B: ",R,T,F)}function z(R,T,F={}){const P=[{value:-25,emoji:"\u{1F48E}",tooltip:"\u0421\u0443\u043F\u0435\u0440 \u0446\u0435\u043D\u0430 (-25%)"},{value:-15,emoji:"\u{1F525}",tooltip:"\u041E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-15%)"},{value:-5,emoji:"\u{1F31F}",tooltip:"\u041A\u043B\u0430\u0441\u0441\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-5%)"},{value:5,emoji:"\u{1F44C}",tooltip:"\u0425\u043E\u0440\u043E\u0448\u0430\u044F \u0446\u0435\u043D\u0430 (+5%)"}],o={active:{background:"#e3f2fd",borderColor:"#2196f3",boxShadow:"0 0 0 1px #2196f3"},inactive:{background:"#fff",borderColor:"#ccc",boxShadow:"none"},hover:{background:"#f5f5f5"}},O=createDiv({display:"inline-flex",gap:"4px",marginLeft:"4px"}),_=[],j=()=>T?parseFloat(T.value)||0:R.value,$=()=>{const W=j();_.forEach(({button:S,value:B})=>{const H=B<=W?o.active:o.inactive;Object.assign(S.style,H)})};return P.forEach(({value:W,emoji:S,tooltip:B})=>{const V=createButton({padding:"2px 6px",fontSize:"16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"#fff",transition:"all 0.2s",...F},S);V.title=B,V.type="button",V.addEventListener("click",H=>{H.preventDefault(),R.updateValue(W),T&&(T.value=W),$()}),V.addEventListener("mouseenter",()=>{W<=j()||(V.style.background=o.hover.background)}),V.addEventListener("mouseleave",()=>{$()}),_.push({button:V,value:W}),O.appendChild(V)}),$(),T&&(T.addEventListener("input",$),T.addEventListener("change",$)),O}},8355:(D,h,e)=>{e.d(h,{R:()=>s,f:()=>i});function s(a){return a.value.toLowerCase().split(",").map(f=>f.trim()).filter(f=>f!=="")}function i(a){return s(a).filter(f=>!f.startsWith("!"))}},5213:(D,h,e)=>{e.d(h,{b:()=>a});var s=e(9928),i=e(573);function a(f,I,p=!1,n="customFiltersContainer"){let m=(0,i.Fi)(`#${n}`,f);if(m)if(p)m.remove();else return;m=(0,s.Sw)(),m.id=n,I(m,f)}},8200:(D,h,e)=>{e.d(h,{s:()=>s});function s(i){const{target:a}=i,{type:f}=a;switch(f){case"text":return`"${a.value}"`;case"number":return a.value;case"date":return`"${a.value}"`;case"checkbox":return a.checked;default:return console.log(`Unknown input type: ${f}`),null}}},157:(D,h,e)=>{e.d(h,{Fg:()=>s,vx:()=>a});const s=window.GM_setValue,i=window.GM.setValue,a=window.GM_getValue},1870:(D,h,e)=>{e.d(h,{j:()=>s});class s{constructor(a,f){this.value=a,this.onChange=f}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(D,h,e)=>{e.d(h,{V:()=>I});var s=e(1870),i=e(8200),a=e(3976),f=e(157);class I extends s.j{constructor(n,m=null,t=null){super((0,f.vx)(n,m),t),this.storageKey=n,this.defaultValue=m}static create(n,m=null,t=null){return new I(n,m,t)}static createWithCompositeKey(n,m,t=null,u=null){const v=`${n}-${m}`;return new I(v,t,u)}updateValueFromEvent=n=>{const m=(0,i.s)(n),t=(0,a.$)(m);this.updateValue(t)};updateValue(n,m=!0){this.value!==n&&((0,f.Fg)(this.storageKey,n),this.value=n,m&&this.onChangeIfDefined())}clearValue(n=!1){this.updateValue(null,n)}resetValue(n=!1){this.updateValue(this.defaultValue,n)}}},3976:(D,h,e)=>{e.d(h,{$:()=>s});function s(i){return i===""?null:JSON.parse(i)}},4214:(D,h,e)=>{e.d(h,{$z:()=>s,zr:()=>i});function s(p){return p.replace(/\D/g,"")}function i(p){return p.replace(/[^\d.,-]/g,"")}function a(p){return p.replace(/\s/g,"")}function f(p){return p.charAt(0).toUpperCase()+p.slice(1)}function I(p){return p.replace(/\s+/g," ").trim()}},5406:(D,h,e)=>{e.d(h,{$F:()=>p,Fc:()=>s,bn:()=>i,z2:()=>u});function s(C,c="common",E=!1){const{pathname:r}=window.location;return i(r,C,c,E)}function i(C,c,E,r=!1){const l=C.split("/");c=c<0?l.length+c:c;const d=l[c]||E;return r&&console.log(`Pathname element: ${d}`),d}function a(C,c="common",E=!1){const r=s(C,"",E);return f(r,c,E)}function f(C,c,E){if(!C)return c;const r=C.split("-").at(-1);return E&&console.log(`Pathname element ending: ${r}`),r}function I(C,c,E="common",r=!1){const l=i(C,c,"",r);return f(l,E,r)}function p(C){return new URLSearchParams(window.location.search).get(C)}function n(C){return C.split("?")[0]}function m(C){return window.location.pathname.includes(C)}function t(C){return C.some(c=>m(c))}function u(C){return window.location.pathname.split("/").some(E=>E===C)}function v(C){try{const c=new URL(window.location.href);Object.entries(C).forEach(([E,r])=>{c.searchParams.set(E,r)}),window.location.href=c.toString()}catch(c){console.error("Failed to redirect:",c)}}function b(C,c=[]){const E={pathname:window.location.pathname};c.forEach(N=>{E[N]=p(N)});let r=!1;async function l(){if(r)return;const N={pathname:window.location.pathname};if(c.forEach(x=>{N[x]=p(x)}),Object.keys(E).some(x=>E[x]!==N[x])){Object.assign(E,N),r=!0;try{await C()}catch(x){console.error("Error in URL observer callback:",x)}finally{r=!1}}}function d(){l().catch(N=>{console.error("Error in URL change handler:",N)})}let g=window.location.href;setInterval(()=>{window.location.href!==g&&(g=window.location.href,d())},200),window.addEventListener("popstate",d)}function w(C=[]){b(()=>window.location.reload(),C)}},2524:(D,h,e)=>{e.d(h,{d5:()=>a,vX:()=>n,ft:()=>f});var s=e(157);class i{constructor(u=Date.now(),v=[]){this.lastCheckDate=u,this.reviewsData=v}updateLastCheckDate=()=>{this.lastCheckDate=Date.now()};static fromObject(u){const{lastCheckDate:v,reviewsData:b}=u;return new i(v,b)}}const a={LAST_DOCTOR_UPDATE:"last-doctor-update"};function f(t,u){const v=I(t),b=(0,s.vx)(v),w=p(b);w.reviewsData=u,w.updateLastCheckDate(),(0,s.Fg)(v,w),(0,s.Fg)(a.LAST_DOCTOR_UPDATE,Date.now())}function I(t){return`doctor-${t}`}function p(t){return t?i.fromObject(t):new i}function n(t){return m(t)?.reviewsData??null}function m(t){const u=I(t);return(0,s.vx)(u)}},1753:(D,h,e)=>{e.a(D,async(s,i)=>{try{var a=e(573),f=e(7858),I=e(4231),p=e(5406),n=e(5072);const t=(0,a.Fi)(".appointments_page");t?(0,I.$)(t):(0,p.z2)("otzivi")?await(0,n.N)():(0,p.z2)("vrach")&&(0,f.O)(),i()}catch(m){i(m)}},1)},7653:(D,h,e)=>{e.d(h,{NI:()=>t,z1:()=>b,Np:()=>E,pR:()=>w,sp:()=>l,rd:()=>r});var s=e(9928),i=e(573);const a={DOCTOR_CARD_NAME:'.b-doctor-intro__title-first-line [itemprop="name"]',DOCTOR_INTRO_LEFT:".b-doctor-intro__left-side",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]'};var f=e(8586),I=e(5406),p=e(4214);const n="additionalLinksAppended",m=["\u042F\u043D\u0434\u0435\u043A\u0441","\u041D\u0430\u041F\u043E\u043F\u0440\u0430\u0432\u043A\u0443","DocDoc","\u0414\u043E\u043A\u0442\u0443"];function t(d,g){g.classList.contains(n)||(m.forEach(N=>{u(d,g,N)}),g.classList.add(n))}function u(d,g,N){const x=v(d,N),k=(0,s.d)({},N,x),z=document.createElement("br");g.append(z,k)}function v(d,g){const N=`${d} ${g}`;return`https://www.google.com/search?q=${encodeURIComponent(N)}&btnI`}function b(){const d=(0,i.Fi)(a.DOCTOR_CARD_NAME,document,!0);if(!d)return;const g=d.innerText.trim(),N=(0,s.Sw)();N.style.textAlign="center",(0,i.Fi)(a.DOCTOR_INTRO_LEFT).append(N),t(g,N)}function w(d,g,N=!1){const x=(0,s.Sw)(f.r.REVIEWS_INFO);N&&(x.style.justifyContent="center"),x.classList.add("v-application");const k=(0,s.Sw)(f.r.REVIEWS_INFO_BLOCK);return k.style.height=N?"10px":"23px",k.append(x),d.slice(N?1:0).forEach(z=>{const{category:R,title:T,count:F,bgClassSuffix:P}=z,o=`${g}?rates_category=${R}`,O=N?F:`${T} ${F}`,_=(0,s.d)(f.r.REVIEW_INFO,O,o);_.classList=C(P),x.append(_),N&&c(_,T)}),k}function C(d){return`text-caption text--text px-2 py-1 rounded-sm bg-${d}`}function c(d,g){let N=null;d.addEventListener("mouseenter",()=>{N=(0,s.Sw)(f.r.REVIEW_INFO_TOOLTIP,g),document.body.appendChild(N);const x=d.getBoundingClientRect();N.style.left=`${(x.left+x.right)/2-N.offsetWidth/2+window.scrollX+2}px`,N.style.top=`${x.top+window.scrollY-N.offsetHeight-4}px`}),d.addEventListener("mouseleave",()=>{N&&(N.remove(),N=null)})}function E(d){const g=(0,i.Fi)(a.NAME_SPAN_HOLDER,document,!0);if(!g)return;const N=(0,i.Fi)(a.NAME_SPAN,g,!0);N&&N.append(d)}function r(){const d=(0,I.Fc)(3,"unknown");return(0,p.$z)(d)}function l(d){const g=(0,I.bn)(d,5,"");return(0,p.$z)(g)}},8586:(D,h,e)=>{e.d(h,{r:()=>i});const s={INPUT:{border:"1px solid #c7d3d9",borderRadius:"10px",padding:"7px 14px",marginLeft:"6px"}},i={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",flexFlow:"wrap"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...s.INPUT,width:"195px"},NUMBER_INPUT:{...s.INPUT,width:"70px"},CHECKBOX_INPUT:{...s.INPUT,width:"20px",height:"20px"},REVIEWS_INFO:{gridGap:"6px"},REVIEWS_INFO_BLOCK:{marginTop:"5px"},REVIEW_INFO:{textDecoration:"none",flexShrink:0},REVIEW_INFO_TOOLTIP:{position:"absolute",backgroundColor:"#333",color:"#fff",padding:"4px 8px",borderRadius:"8px",fontSize:"12px",zIndex:"1000",pointerEvents:"none",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"}}},4231:(D,h,e)=>{e.d(h,{$:()=>T});var s=e(5406),i=e(573),a=e(5539),f=e(3829),I=e(7653),p=e(5213),n=e(5884),m=e(7877);const t={LIST_HEADER:".h2_rating",DOCTOR_FILTERS:".vue-the-doctors-filters > .b-container",DOCTOR_CARD:".b-doctor-card",DOCTOR_CARD_NAME:".b-doctor-card__name-surname",PROFILE_CARD:".b-profile-card",REVIEWS_LINK:":scope > a",EXPERIENCE_WRAP:".b-doctor-card__experience .mr-2 .text-subtitle-1",SPEC_WRAP:".b-doctor-card__spec",CLINIC_CONTAINER:"div.b-doctor-card__lpu-select",CLINIC_WRAP:".b-select__trigger-main-text"};var u=e(4521),v=e(2524),b=e(4921),w=e(8586),C=e(6754);const c=window.GM_addValueChangeListener,E=(0,s.Fc)(2),{createGlobalFilter:r,createSectionFilter:l}=(0,u.z)(o,E),d=l("spec-filter"),g=l("clinic-filter"),N=l("min-reviews-filter",10),x=l("min-experience-filter",5,W),k=l("max-experience-filter",40),z=r("filter-enabled",!0),R={doctorCardsCache:new WeakMap};function T(S){W(),F();const B=(0,i.Fi)(t.DOCTOR_FILTERS);(0,p.b)(B,P),o(),c(v.d5.LAST_DOCTOR_UPDATE,o),new MutationObserver((0,b.sg)(o)).observe(S,{childList:!0})}function F(){const S=(0,i.Fi)(t.LIST_HEADER);S&&S.remove()}function P(S,B){(0,C.ZM)(S,w.r.FILTERS_CONTAINER),S.style.marginTop="6px";const V=(0,n.Nm)("\u0421\u043F\u0435\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F:",d,w.r.CONTROL,w.r.TEXT_INPUT),H=(0,n.Nm)("\u041A\u043B\u0438\u043D\u0438\u043A\u0430:",g,w.r.CONTROL,w.r.TEXT_INPUT),L=(0,m.X0)(N,w.r.CONTROL,w.r.NUMBER_INPUT),A=(0,n.nW)("\u041C\u0438\u043D. \u043E\u043F\u044B\u0442: ",x,"1","0","100",w.r.CONTROL,w.r.NUMBER_INPUT),y=(0,n.nW)("\u041C\u0430\u043A\u0441. \u043E\u043F\u044B\u0442: ",k,"1","0","100",w.r.CONTROL,w.r.NUMBER_INPUT),M=(0,m.pW)(z,w.r.CONTROL,w.r.CHECKBOX_INPUT);S.append(V,H,L,A,y,M),B.append(S)}function o(){(0,i.fI)(t.DOCTOR_CARD).forEach(O)}function O(S){if(!z.value){(0,a.kl)(S);return}let B=R.doctorCardsCache.get(S);if(!B){const H=(0,i.Fi)(t.PROFILE_CARD,S),L=(0,i.Fi)(t.REVIEWS_LINK,H),A=(0,i.Fi)(t.EXPERIENCE_WRAP,S);if(!L||!A){(0,a.Bt)(S);return}const M=(0,i.Fi)(t.SPEC_WRAP,S,!0).innerText.trim(),U=(0,i.Fi)(t.CLINIC_CONTAINER,S,!0),K=(0,i.Fi)(t.CLINIC_WRAP,U,!0).innerText.trim(),X=(0,i.YA)(L,!0),Q=(0,i.YA)(A,!0),J=_(L);L.href=J,(0,I.NI)(j(S),H),B={specInfo:M,clinicName:K,reviewsLinkNumber:X,experienceNumber:Q,reviewsLink:L,reviewInfoAppended:!1},R.doctorCardsCache.set(S,B)}$(B);const V=(0,f.Ay)(B.specInfo,d)||(0,f.Ay)(B.clinicName,g)||(0,f.JE)(B.reviewsLinkNumber,N)||(0,f.JE)(B.experienceNumber,x)||(0,f.iG)(B.experienceNumber,k);(0,a.UC)(S,V)}function _(S){return S.href.replace(/\/#otzivi$/,"/otzivi/")}function j(S){return(0,i.Fi)(t.DOCTOR_CARD_NAME,S,!0).innerText}function $(S){if(S.reviewInfoAppended)return;const{reviewsLink:B}=S,V=B.href,H=(0,v.vX)((0,I.sp)(V));if(!H)return;const L=(0,I.pR)(H,V,!0);(0,a.WH)(B,L),S.reviewInfoAppended=!0}function W(){if(!x.value)return;const S=new URL(window.location.href);+S.searchParams.get("experience")!==x.value&&(S.searchParams.set("experience",x.value),window.location.href=S.toString())}},7858:(D,h,e)=>{e.d(h,{O:()=>p});var s=e(573),i=e(9928),a=e(7653);const f={REVIEWS_LINK:".b-doctor-intro__rates-wrapper > a",DOCTOR_DETAILS:".b-doctor-details__toc",REVIEWS_FILTER:".reviews-filter:not(.b-reviews-page__filter)",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]',REVIEWS_FILTER_SPAN:":scope > span",DOCTOR_CONTACTS:"#doctor-contacts"};var I=e(2524);function p(){(0,a.z1)(),m();const u=n();t(u);const v=(0,I.vX)((0,a.rd)());if(!v)return;const b=(0,a.pR)(v,u);(0,a.Np)(b)}function n(){const{location:u}=window;return`${u.origin}${u.pathname}otzivi/`}function m(){if(!(0,s.Fi)(f.DOCTOR_CONTACTS))return;const v=[...(0,s.fI)(f.DOCTOR_DETAILS)].pop();if(!v)return;v.style.position="sticky",v.style.top="16px";const b=(0,i.Sw)({},"\u041C\u0435\u0441\u0442\u043E \u0440\u0430\u0431\u043E\u0442\u044B");b.classList.add("b-doctor-details__toc-title");const w=(0,i.d)({},null,"#doctor-contacts");w.classList.add("b-doctor-details__toc-item"),w.append(b),v.insertBefore(w,v.firstChild)}function t(u){const v=(0,s.Fi)(f.REVIEWS_LINK);v&&(v.href=u)}},5072:(D,h,e)=>{e.d(h,{N:()=>O});var s=e(7653);const i={CONTROLS_CONTAINER:".vue-review-filter",REVIEWS:".b-review-card",REVIEW_TEXT_WRAP:".b-review-card__comment",REVIEW_RATING_WRAP:".review-card-tooltips__stars > .ui-text",FILTER_CHIP:'[data-qa="reviews_filter_chip"]',FILTER_LIST:'[data-qa="reviews_filter_list"]',FILTER_LIST_ITEM:'[data-qa^="reviews_filter_list_item"]',FILTER_TITLE_WRAP:'[data-qa="reviews_filter_title"]',FILTER_COUNT_WRAP:'[data-qa="reviews_filter_amount"]',REVIEWS_CONTAINER:"#otzivi"};var a=e(573),f=e(4921),I=e(5406),p=e(2524),n=e(4521),m=e(5213),t=e(8586),u=e(7877),v=e(5539);function b(L,A){L.forEach(y=>w(A,y))}function w(L,A){if(!A)return;const y=new RegExp(`(${A})`,"gi"),M=document.createTreeWalker(L,NodeFilter.SHOW_TEXT,null);let U=M.nextNode();const G=[];for(;U;){const{textContent:K}=U;if(y.test(K)){const X=document.createDocumentFragment();let Q=0;K.replace(y,(J,re,q)=>{q>Q&&X.appendChild(document.createTextNode(K.slice(Q,q)));const Z=document.createElement("span");Z.className="highlightedSubstring",Z.style.backgroundColor="yellow",Z.textContent=J,X.appendChild(Z),Q=q+J.length}),Q<K.length&&X.appendChild(document.createTextNode(K.slice(Q))),G.push({node:U,fragment:X})}U=M.nextNode()}G.forEach(({node:K,fragment:X})=>{K.parentNode.replaceChild(X,K)})}function C(L){(0,a.fI)(".highlightedSubstring",L).forEach(y=>{const{parentNode:M}=y;y.replaceWith(y.textContent),M.normalize()})}var c=e(8355);function E(L,A){const y=(0,c.f)(L);b(y,A)}function r(L,A){const y=getIncludedSearchStrings(L);A.forEach(M=>highlightSubstrings(y,M))}var l=e(3829),d=e(9928);function g(L={}){return(0,d.Sw)(L,"|")}function N(L={},A=75,y="customFiltersContainer"){const M=document.getElementById(y);if(!M)return console.log(`Element with id="${y}" not found.`),null;const U=createButton(L,`${arrowUpIcon}\u041A \u0444\u0438\u043B\u044C\u0442\u0440\u0430\u043C`);return U.addEventListener("mouseenter",()=>{U.style.filter="brightness(0.9)"}),U.addEventListener("mouseleave",()=>{U.style.filter="brightness(1)"}),U.addEventListener("click",()=>{const G=M.getBoundingClientRect();window.scrollTo({top:G.top+window.scrollY-A})}),new IntersectionObserver(([G])=>{U.style.display=G.isIntersecting?"none":"flex"},{threshold:.5}).observe(M),U}function x(L,A={}){const y=N(A);y&&L.appendChild(y)}var k=e(6754);const{createGlobalFilter:z}=(0,n.z)(j),R=z("reviews-text-filter"),T=z("reviews-min-rating-filter"),F=z("reviews-max-rating-filter"),P=z("reviews-filter-enabled",!0),o={reviewCardsCache:new Map};async function O(){(0,s.z1)();const L=await(0,f.xk)(document,i.CONTROLS_CONTAINER);(0,m.b)(L,_),j();const A=await S();(0,p.ft)((0,s.rd)(),A);const y=(0,s.pR)(A,V());(0,s.Np)(y),(0,I.$F)("rates_category")&&H()}function _(L,A){(0,k.ZM)(L,t.r.FILTERS_CONTAINER),L.style.marginTop="12px";const y=(0,u.E9)(R,t.r.CONTROL,t.r.TEXT_INPUT),M=(0,u.HX)(T,t.r.CONTROL,t.r.NUMBER_INPUT,1,1),U=(0,u.FR)(F,t.r.CONTROL,t.r.NUMBER_INPUT,1,1),G=g(t.r.CONTROL),K=(0,u.pW)(P,t.r.CONTROL,t.r.CHECKBOX_INPUT);L.append(y,M,U,G,K),A.append(L)}function j(){(0,a.fI)(i.REVIEWS).forEach($)}function $(L){if(!P.value){(0,v.kl)(L);return}C(L);let A=o.reviewCardsCache.get(L);if(!A){const M=(0,a.Fi)(i.REVIEW_TEXT_WRAP,L),U=(0,a.Fi)(i.REVIEW_RATING_WRAP,L);if(!M){(0,v.Bt)(L);return}A={reviewTextWrap:M,reviewText:M.innerText,rating:U&&(0,a.YA)(U)},o.reviewCardsCache.set(L,A)}R.value&&E(R,A.reviewTextWrap);const y=(0,l.Ay)(A.reviewText,R)||W(A.rating);(0,v.UC)(L,y)}function W(L){return L?(0,l.JE)(L,T)||(0,l.iG)(L,F):!1}async function S(){const L=(0,a.Fi)(i.FILTER_CHIP);L.click();const A=await(0,f.xk)(document,i.FILTER_LIST),y=[...(0,a.fI)(i.FILTER_LIST_ITEM,A)].map(M=>{const U=M.getAttribute("data-qa");if(!U)return null;const G=U.replace("reviews_filter_list_item_",""),K=(0,a.Fi)(i.FILTER_TITLE_WRAP,M).textContent.trim(),X=(0,a.Fi)(i.FILTER_COUNT_WRAP,M),Q=(0,a.YA)(X,!0),J=B(X.classList);return{category:G,title:K,count:Q,bgClassSuffix:J}});return L.click(),y}function B(L){const A=L.value.match(/bg-(\w+)/);return A?A[1]:null}function V(){const{location:L}=window;return`${L.origin}${L.pathname}`}function H(){(0,a.Fi)(i.REVIEWS_CONTAINER).scrollIntoView({behavior:"smooth"})}}},ee={};function Y(D){var h=ee[D];if(h!==void 0)return h.exports;var e=ee[D]={exports:{}};return te[D](e,e.exports,Y),e.exports}(()=>{var D=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",h=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",e=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",s=a=>{a&&a.d<1&&(a.d=1,a.forEach(f=>f.r--),a.forEach(f=>f.r--?f.r++:f()))},i=a=>a.map(f=>{if(f!==null&&typeof f=="object"){if(f[D])return f;if(f.then){var I=[];I.d=0,f.then(m=>{p[h]=m,s(I)},m=>{p[e]=m,s(I)});var p={};return p[D]=m=>m(I),p}}var n={};return n[D]=m=>{},n[h]=f,n});Y.a=(a,f,I)=>{var p;I&&((p=[]).d=-1);var n=new Set,m=a.exports,t,u,v,b=new Promise((w,C)=>{v=C,u=w});b[h]=m,b[D]=w=>(p&&w(p),n.forEach(w),b.catch(C=>{})),a.exports=b,f(w=>{t=i(w);var C,c=()=>t.map(r=>{if(r[e])throw r[e];return r[h]}),E=new Promise(r=>{C=()=>r(c),C.r=0;var l=d=>d!==p&&!n.has(d)&&(n.add(d),d&&!d.d&&(C.r++,d.push(C)));t.map(d=>d[D](l))});return C.r?E:c()},w=>(w?v(b[e]=w):u(m),s(p))),p&&p.d<0&&(p.d=0)}})(),Y.d=(D,h)=>{for(var e in h)Y.o(h,e)&&!Y.o(D,e)&&Object.defineProperty(D,e,{enumerable:!0,get:h[e]})},Y.o=(D,h)=>Object.prototype.hasOwnProperty.call(D,h);var ne=Y(1753)})();})();
