// ==UserScript==
// @name         Prodoc enhancer
// @description  Hide doctor cards by filter, enhance doctor page
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://prodoctorov.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      2.0.77032393
// @icon         https://www.google.com/s2/favicons?sz=64&domain=prodoctorov.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/prodoc.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var te={8738:(w,m,n)=>{n.d(m,{d:()=>i});var d=n(5558);function i(e={},o=null,r=null){const t=(0,d.n)("a",e,o);return r&&(t.href=r),t}function s(e,o=null,r={}){r.cursor||="pointer";const t=i(r,o);return e&&t.addEventListener("click",e),t}function f(e,o,r=null,t={},v={}){t.display||="inline-flex",t.alignItems||="center",t.gap||="0.25em";const F=s(e,r,t);return F.prepend(createLucideIcon(o,v)),F}function E(e,o,r,t=null,v={},F={},u="userscript-control"){const h=_=>{_.stopPropagation(),_.preventDefault(),window.confirm(r)&&e()},C=t?`<span>${t}</span>`:null,g=f(h,o,C,v,F);return g.classList.add(u),g}function l(e,o,r={},t={}){return E(e,ThumbsDown,"\u0412\u044B\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u043D\u0438\u0437\u043A\u0438\u0439 \u0440\u0435\u0439\u0442\u0438\u043D\u0433?",o?"\u0414\u0438\u0437\u043B\u0430\u0439\u043A":null,r,t)}function c(e,o,r={},t={}){return E(e,RotateCcw,"\u0423\u0431\u0440\u0430\u0442\u044C \u043D\u0438\u0437\u043A\u0438\u0439 \u0440\u0435\u0439\u0442\u0438\u043D\u0433?",o?"\u0423\u0431\u0440\u0430\u0442\u044C \u0434\u0438\u0437\u043B\u0430\u0439\u043A":null,r,t)}function p(e={},o=null,r=null){const t=createElement("button",e,o);return r&&t.addEventListener("click",r),t}},7273:(w,m,n)=>{n.d(m,{S:()=>s});var d=n(5558);function i(f={},E=null){return createElement("span",f,E)}function s(f={},E=null){return(0,d.n)("div",f,E)}},5467:(w,m,n)=>{n.d(m,{E2:()=>i});var d=n(7273);function i(E,l={},c=null){const p=(0,d.S)(l,c);return p.append(E),p}function s(E,l=null,c={},p={}){const e=createActionLink(E,l,p);return i(e,c)}function f(E,l=null,c=null,p={},e={},o={}){const r=createActionLinkWithIcon(E,c,l,e,o);return i(r,p)}},5558:(w,m,n)=>{n.d(m,{n:()=>i});var d=n(6754);function i(s,f,E=null){if(typeof f!="object"||f===null)throw new TypeError("styles should be an object");const l=document.createElement(s);return(0,d.ZM)(l,f),E&&(l.innerHTML=E),l}},740:(w,m,n)=>{n.d(m,{S:()=>l,kU:()=>s,o5:()=>f});var d=n(5558),i=n(4921);function s(e,o,r){const t=c(e,"text",o);return t.value=r,t}function f(e,o,r,t,v,F){const u=c(e,"number",o);return u.value=r,u.step=t,u.min=v,u.max=F,u}function E(e,o,r){const t=c(e,"date",o);return t.value=r,t}function l(e,o,r){const t=c(e,"checkbox",o);return t.checked=r,t}function c(e={},o=null,r=null){const t=(0,d.n)("input",e);return o&&(t.type=o),r&&(t.addEventListener("keyup",(0,i.sg)(r,200)),t.addEventListener("change",(0,i.sg)(r,100))),t}function p(e,o,r){const t=createElement("select",e);return o&&t.addEventListener("change",o),t.value=r,t}},573:(w,m,n)=>{n.d(m,{Fi:()=>s,YA:()=>p,fI:()=>f});var d=n(4214);function i(u,h=document){return!!h.querySelector(u)}function s(u,h=document,C=!1){const g=h.querySelector(u);return C&&!g&&console.log(`No element found for selector: ${u}`),g}function f(u,h=document,C=!1){const g=h.querySelectorAll(u);return C&&!g.length&&console.log(`No elements found for selector: ${u}`),g}function E(u,h=1){let C=u;for(let g=0;g<h;g++){if(!C.parentElement)return null;C=C.parentElement}return C}function l(u,h,C){return[...u.querySelectorAll(h)].find(g=>g.textContent.trim().includes(C))}function c(u,h,C=!1,g=!1,_=null){const N=s(h,u);return p(N,C,g,_)}function p(u,h=!1,C=!1,g=null){if(!u)return g===null?(console.log("No element found"),null):g;const _=u.innerText;return r(_,h,C)}function e(u,h,C=!1){const g=u[h];return p(g,C)}function o(u,h=!1,C=!1){const g=u.textContent;return r(g,h,C)}function r(u,h,C){h&&(u=(0,d.zr)(u)),C&&(u=u.replace(",","."));const g=Number(u);return Number.isNaN(g)?(console.log(`Invalid number: ${u}`),0):g}function t(u){return[...u.childNodes].find(h=>h.nodeType===Node.TEXT_NODE)}function v(u){const h=C=>C.nodeType===Node.TEXT_NODE&&C.textContent.trim()!==""?[C]:[...C.childNodes].flatMap(h);return h(u)}function F(u){return normalizeSpacing(u.textContent)}},5539:(w,m,n)=>{n.d(m,{Bt:()=>i,UC:()=>e,WH:()=>d,kl:()=>c});function d(a,O){a.parentNode.insertBefore(O,a.nextSibling)}function i(a){a.style.display="none"}function s(a,O=1){const S=document.querySelector(a);S&&f(S,O)}function f(a,O=1){const S=getElementAncestor(a,O);S&&i(S)}function E(a){t(a),i(a)}function l(a){a.intersectionObserver||runOnceOnIntersection(a,()=>i(a))}function c(a){a.style.display=""}function p(a){const O=r(a);a.style.display=O}function e(a,O){O?i(a):c(a)}function o(a,O){O?l(a):(clearIntersectionObserver(a),c(a))}function r(a){return t(a),a.dataset.defaultDisplay}function t(a){if(a.dataset.defaultDisplay)return;const{display:O}=getComputedStyle(a);a.dataset.defaultDisplay=O}function v(){return{show:[],hide:[]}}function F(a,O,S){a?O.hide.push(S):O.show.push(S)}function u(a){a.show.forEach(c),a.hide.forEach(i)}function h(a,O,S=.3){O?g(a,S):C(a)}function C(a){a.style.opacity=""}function g(a,O=.3){a.style.opacity=O}function _(a){a.style.order=""}function N(a,O){a.style.order=O}function A(a,O,S,$="inline-flex"){O.style.display=a?$:"none",S.style.display=a?"none":$}function b(a,O){a.style.background=O}function y(a,O){const S=getFirstElement(O);S&&k(a,S)}function k(a,O){const S=createLink();S.href=a,O.parentNode.append(S),S.append(O)}function z(a,O){const S=getFirstElement(O);S&&R(a,S)}function R(a,O,S={}){const $=createLink(S);$.href=a,$.append(...O.childNodes),O.append($)}function T(){const a=getURLQueryParam("scrollTo");if(!a)return;const O=document.getElementById(a);O?O.scrollIntoView():console.log(`Element with ID "${a}" was not found.`)}function D(a,O,S=null){const $=`${O}-click-passed`,H=S?L=>findElementByText(L,a,S):L=>getFirstElement(a,L);return function(L){if(L.hasAttribute($))return!1;const M=H(L);return M&&M.click(),L.setAttribute($,""),!0}}function P(a,O,S="text/plain"){const $=new Blob([a],{type:S}),H=URL.createObjectURL($),L=document.createElement("a");L.href=H,L.download=O,document.body.appendChild(L),L.click(),document.body.removeChild(L),requestAnimationFrame(()=>URL.revokeObjectURL(H))}},6754:(w,m,n)=>{n.d(m,{ZM:()=>d});function d(E,l){Object.assign(E.style,l)}function i(E,l="custom-global-style"){let c=document.getElementById(l);c||(c=document.createElement("style"),c.id=l,c.type="text/css",document.head.appendChild(c)),c.textContent=E}function s(E){return Object.entries(E).map(([l,c])=>`${l.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${c};`).join(" ")}function f(E){return E?E.split(";").filter(l=>l.trim()!=="").reduce((l,c)=>{const[p,e]=c.split(":").map(r=>r.trim()),o=p.replace(/-([a-z])/g,(r,t)=>t.toUpperCase());return l[o]=e,l},{}):{}}},4921:(w,m,n)=>{n.d(m,{sg:()=>f,xk:()=>d});function d(e,o,r=null){const t=e.querySelector(o);return t?Promise.resolve(t):new Promise(v=>{const F=new MutationObserver(h);F.observe(e,{childList:!0,subtree:!0});let u;r&&(u=setTimeout(()=>{F.disconnect(),console.log(`No element found for selector: ${o}`),v(null)},r));function h(){const C=e.querySelector(o);C&&(u&&clearTimeout(u),F.disconnect(),v(C))}})}function i(e,o){return e.querySelector(o)?new Promise(t=>{const v=new MutationObserver(F);v.observe(e,{childList:!0,subtree:!0});function F(){e.querySelector(o)||(v.disconnect(),t())}}):Promise.resolve()}function s(e,o=400){return new Promise(r=>{let t;const v=new MutationObserver(()=>{clearTimeout(t),F()});function F(){t=setTimeout(()=>{v.disconnect(),r()},o)}F(),v.observe(e,{childList:!0,subtree:!0})})}function f(e,o=250){let r;return function(...t){const v=this;clearTimeout(r),r=setTimeout(()=>e.apply(v,t),o)}}async function E(e){document.visibilityState==="visible"?await e():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await e()},{once:!0})}function l(e,o){const r=new IntersectionObserver(t=>{t.forEach(v=>{v.isIntersecting&&(o(),c(e))})});e.intersectionObserver=r,r.observe(e)}function c(e){e.intersectionObserver&&(e.intersectionObserver.disconnect(),e.intersectionObserver=null)}function p(e){e&&(e.disconnect(),e=null)}},3829:(w,m,n)=>{n.d(m,{Ay:()=>i,JE:()=>l,iG:()=>c});var d=n(8355);function i(r,t){return!s(r,t)}function s(r,t){if(!t||!t.value)return!0;const v=(0,d._7)(t.value);return f(r,v)}function f(r,t){if(!t||!t.length)return!0;const v=(r||"").toLowerCase();return t.every(F=>E(v,F))}function E(r,t){return t.some(({term:v,isNegative:F})=>{const u=r.includes(v);return F?!u:u})}function l(r,t){return t.value!=null&&r<t.value}function c(r,t){return t.value!=null&&r>t.value}function p(r,t){return t.value==null?!1:r<parseDateFromISO(t.value)}function e(r,t){return t.value==null?!1:r>parseDateFromISO(t.value)}function o(r,t){return t.value&&r!==t.value}},4521:(w,m,n)=>{n.d(m,{z:()=>i});var d=n(3048);function i(s,f=null){return{createGlobalFilter(E,l=null,c=s){return d.V.create(E,l,c)},createSectionFilter(E,l=null,c=s){if(!f)throw new Error("sectionId must be provided to use createSectionFilter.");return d.V.createWithCompositeKey(f,E,l,c)}}}},5884:(w,m,n)=>{n.d(m,{Hw:()=>c,Nm:()=>s,nW:()=>f});var d=n(5467),i=n(740);function s(p,e,o={},r={}){const t=(0,i.kU)(r,e.updateValueFromEvent,e.value);return(0,d.E2)(t,o,p)}function f(p,e,o,r,t,v={},F={}){const u=(0,i.o5)(F,e.updateValueFromEvent,e.value,o,r,t);return(0,d.E2)(u,v,p)}function E(p,e,o={},r={}){const t=createSelect(r,e.updateValueFromEvent,e.value);return createControl(t,o,p)}function l(p,e,o={},r={}){const t=createDateInput(r,e.updateValueFromEvent,e.value);return createControl(t,o,p)}function c(p,e,o={},r={}){const t=(0,i.S)(r,e.updateValueFromEvent,e.value);return(0,d.E2)(t,o,p)}},7877:(w,m,n)=>{n.d(m,{E9:()=>i,FR:()=>f,HX:()=>s,X0:()=>E,pW:()=>k});var d=n(5884);function i(R,T={},D={}){return(0,d.Nm)("\u041F\u043E\u0438\u0441\u043A: ",R,T,D)}function s(R,T={},D={},P=.1,a=3){return(0,d.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",R,P,a,5,T,D)}function f(R,T={},D={},P=.1,a=3){return(0,d.nW)("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",R,P,a,5,T,D)}function E(R,T={},D={}){return c("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",R,T,D)}function l(R,T={},D={}){return c("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",R,T,D)}function c(R,T,D={},P={}){return(0,d.nW)(R,T,"1","1","999999",D,P)}function p(R,T={},D={}){return createDateFilterControl("\u041C\u0438\u043D. \u0434\u0430\u0442\u0430: ",R,T,D)}function e(R,T={},D={}){return o("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",R,T,D)}function o(R,T,D={},P={}){return createNumberFilterControl(R,T,"5","0","100",D,P)}function r(R,T={},D={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",R,"5","0","100",T,D)}function t(R,T,D={},P={},a="250"){return createNumberFilterControl(R,T,a,"0","1000000",D,P)}function v(R,T={},D={},P="25"){return t("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",R,T,D,P)}function F(R,T={},D={},P="25"){return t("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",R,T,D,P)}function u(R,T={},D={}){return h("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",R,T,D)}function h(R,T,D={},P={}){return createNumberFilterControl(R,T,"1","0","99999",D,P)}function C(R,T={},D={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",R,"1","2","8",T,D)}function g(R,T={},D={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",R,1,1,10,T,D)}function _(R,T={},D={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",R,T,D)}function N(R,T={},D={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",R,T,D)}function A(R,T={},D={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",R,T,D)}function b(R,T={},D={}){return createCheckboxFilterControl("\u0411\u043E\u043D\u0443\u0441: ",R,T,D)}function y(R,T={},D={}){return createCheckboxFilterControl("\u0412 \u043D\u0430\u043B\u0438\u0447\u0438\u0438: ",R,T,D)}function k(R,T={},D={}){return(0,d.Hw)("\u0412\u043A\u043B: ",R,T,D)}function z(R,T,D={}){const P=[{value:-25,emoji:"\u{1F48E}",tooltip:"\u0421\u0443\u043F\u0435\u0440 \u0446\u0435\u043D\u0430 (-25%)"},{value:-15,emoji:"\u{1F525}",tooltip:"\u041E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-15%)"},{value:-5,emoji:"\u{1F31F}",tooltip:"\u041A\u043B\u0430\u0441\u0441\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-5%)"},{value:5,emoji:"\u{1F44C}",tooltip:"\u0425\u043E\u0440\u043E\u0448\u0430\u044F \u0446\u0435\u043D\u0430 (+5%)"}],a={active:{background:"#e3f2fd",borderColor:"#2196f3",boxShadow:"0 0 0 1px #2196f3"},inactive:{background:"#fff",borderColor:"#ccc",boxShadow:"none"},hover:{background:"#f5f5f5"}},O=createDiv({display:"inline-flex",gap:"4px",marginLeft:"4px"}),S=[],$=()=>T?parseFloat(T.value)||0:R.value,H=()=>{const L=$();S.forEach(({button:M,value:j})=>{const I=j<=L?a.active:a.inactive;Object.assign(M.style,I)})};return P.forEach(({value:L,emoji:M,tooltip:j})=>{const V=createButton({padding:"2px 6px",fontSize:"16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"#fff",transition:"all 0.2s",...D},M);V.title=j,V.type="button",V.addEventListener("click",I=>{I.preventDefault(),R.updateValue(L),T&&(T.value=L),H()}),V.addEventListener("mouseenter",()=>{L<=$()||(V.style.background=a.hover.background)}),V.addEventListener("mouseleave",()=>{H()}),S.push({button:V,value:L}),O.appendChild(V)}),H(),T&&(T.addEventListener("input",H),T.addEventListener("change",H)),O}},8355:(w,m,n)=>{n.d(m,{_7:()=>i,fO:()=>d});function d(e){if(!e)return[];const r=i(e).flat().filter(t=>t&&!t.isNegative&&t.term).map(t=>t.term);return[...new Set(r)]}function i(e){return e?e.toLowerCase().split(",").map(s).filter(Boolean):[]}function s(e){const o=e.split("/").map(t=>t.trim()).filter(Boolean);if(o.length===0)return null;const r=o.map(f).filter(Boolean);return r.length>0?r:null}function f(e){const o=e.startsWith("!"),r=o?e.slice(1).trim():e;return r?{term:r,isNegative:o}:null}function E(e,o){c(e,r=>r.style.display!=="none",o)}function l(e,o){c(e,r=>r.style.opacity==="",o)}function c(e,o,r){const t=[...e].filter(o).length,v=e.length;p(r,t,v)}function p(e,o,r){e.textContent=`\u041F\u043E\u043A\u0430\u0437\u0430\u043D\u043E: ${o} \u0438\u0437 ${r}`}},5213:(w,m,n)=>{n.d(m,{b:()=>s});var d=n(573),i=n(7273);function s(f,E,l=!1,c="customFiltersContainer"){let p=(0,d.Fi)(`#${c}`,f);if(p)if(l)p.remove();else return;p=(0,i.S)(),p.id=c,E(p,f)}},8200:(w,m,n)=>{n.d(m,{s:()=>d});function d(i){const{target:s}=i,{type:f}=s;switch(f){case"text":return`"${s.value}"`;case"number":return s.value;case"select-one":return s.value;case"date":return`"${s.value}"`;case"checkbox":return s.checked;default:return console.log(`Unknown input type: ${f}`),null}}},157:(w,m,n)=>{n.d(m,{Fg:()=>d,vx:()=>s});const d=window.GM_setValue,i=window.GM.setValue,s=window.GM_getValue},1870:(w,m,n)=>{n.d(m,{j:()=>d});class d{constructor(s,f){this.value=s,this.onChange=f}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(w,m,n)=>{n.d(m,{V:()=>E});var d=n(1870),i=n(8200),s=n(3976),f=n(157);class E extends d.j{constructor(c,p=null,e=null){super((0,f.vx)(c,p),e),this.storageKey=c,this.defaultValue=p}static create(c,p=null,e=null){return new E(c,p,e)}static createWithCompositeKey(c,p,e=null,o=null){const r=`${c}-${p}`;return new E(r,e,o)}updateValueFromEvent=c=>{const p=(0,i.s)(c),e=(0,s.$)(p);this.updateValue(e)};updateValue(c,p=!0){this.value!==c&&((0,f.Fg)(this.storageKey,c),this.value=c,p&&this.onChangeIfDefined())}clearValue(c=!1){this.updateValue(null,c)}resetValue(c=!1){this.updateValue(this.defaultValue,c)}}},3976:(w,m,n)=>{n.d(m,{$:()=>d});function d(i){return i===""?null:JSON.parse(i)}},4214:(w,m,n)=>{n.d(m,{$z:()=>d,zr:()=>i});function d(l){return l.replace(/\D/g,"")}function i(l){return l.replace(/[^\d.,-]/g,"")}function s(l){return l.replace(/\s/g,"")}function f(l){return l.charAt(0).toUpperCase()+l.slice(1)}function E(l){return l.replace(/\s+/g," ").trim()}},5406:(w,m,n)=>{n.d(m,{$F:()=>l,Fc:()=>d,bn:()=>i,z2:()=>o});function d(u,h="common",C=!1){const{pathname:g}=window.location;return i(g,u,h,C)}function i(u,h,C,g=!1){const _=u.split("/");h=h<0?_.length+h:h;const N=_[h]||C;return g&&console.log(`Pathname element: ${N}`),N}function s(u,h="common",C=!1){const g=d(u,"",C);return f(g,h,C)}function f(u,h,C){if(!u)return h;const g=u.split("-").at(-1);return C&&console.log(`Pathname element ending: ${g}`),g}function E(u,h,C="common",g=!1){const _=i(u,h,"",g);return f(_,C,g)}function l(u){return new URLSearchParams(window.location.search).get(u)}function c(u){return u.split("?")[0]}function p(u){return window.location.pathname.includes(u)}function e(u){return u.some(h=>p(h))}function o(...u){return window.location.pathname.split("/").some(C=>u.includes(C))}function r(u){try{const h=new URL(window.location.href);Object.entries(u).forEach(([C,g])=>{h.searchParams.set(C,g)}),window.location.href=h.toString()}catch(h){console.error("Failed to redirect:",h)}}function t(u,h=[]){const C=new AbortController;let g=!1;const _=A=>{const b=new URL(A),y={pathname:b.pathname};return h.forEach(k=>{y[k]=b.searchParams.get(k)}),y};let N=_(window.location.href);return window.navigation.addEventListener("navigatesuccess",async()=>{if(g)return;const A=_(window.navigation.currentEntry.url);if(Object.keys(N).some(y=>N[y]!==A[y])){N=A,g=!0;try{await u(A)}catch(y){console.error("URL observer error:",y)}finally{g=!1}}},{signal:C.signal}),()=>C.abort()}function v(u,h=[]){const C={pathname:window.location.pathname};h.forEach(b=>{C[b]=l(b)});let g=!1;async function _(){if(g)return;const b={pathname:window.location.pathname};if(h.forEach(y=>{b[y]=l(y)}),Object.keys(C).some(y=>C[y]!==b[y])){Object.assign(C,b),g=!0;try{await u()}catch(y){console.error("Error in URL observer callback:",y)}finally{g=!1}}}function N(){_().catch(b=>{console.error("Error in URL change handler:",b)})}let A=window.location.href;setInterval(()=>{window.location.href!==A&&(console.log("URL changed:",window.location.href),A=window.location.href,N())},200),window.addEventListener("popstate",N)}function F(u=[]){v(()=>window.location.reload(),u)}},2524:(w,m,n)=>{n.d(m,{d5:()=>s,vX:()=>c,ft:()=>f});var d=n(157);class i{constructor(o=Date.now(),r=[]){this.lastCheckDate=o,this.reviewsData=r}updateLastCheckDate=()=>{this.lastCheckDate=Date.now()};static fromObject(o){const{lastCheckDate:r,reviewsData:t}=o;return new i(r,t)}}const s={LAST_DOCTOR_UPDATE:"last-doctor-update"};function f(e,o){const r=E(e),t=(0,d.vx)(r),v=l(t);v.reviewsData=o,v.updateLastCheckDate(),(0,d.Fg)(r,v),(0,d.Fg)(s.LAST_DOCTOR_UPDATE,Date.now())}function E(e){return`doctor-${e}`}function l(e){return e?i.fromObject(e):new i}function c(e){return p(e)?.reviewsData??null}function p(e){const o=E(e);return(0,d.vx)(o)}},1753:(w,m,n)=>{n.a(w,async(d,i)=>{try{var s=n(573),f=n(7858),E=n(4231),l=n(5406),c=n(5072);const e=(0,s.Fi)(".appointments_page");e?(0,E.$)(e):(0,l.z2)("otzivi")?await(0,c.N)():(0,l.z2)("vrach")&&(0,f.O)(),i()}catch(p){i(p)}},1)},7653:(w,m,n)=>{n.d(m,{NI:()=>o,z1:()=>v,Np:()=>C,pR:()=>F,sp:()=>_,rd:()=>g});var d=n(573);const i={DOCTOR_CARD_NAME:'.b-doctor-intro__title-first-line [itemprop="name"]',DOCTOR_INTRO_LEFT:".b-doctor-intro__left-side",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]'};var s=n(8586),f=n(5406),E=n(4214),l=n(7273),c=n(8738);const p="additionalLinksAppended",e=["\u042F\u043D\u0434\u0435\u043A\u0441","\u041D\u0430\u041F\u043E\u043F\u0440\u0430\u0432\u043A\u0443","DocDoc","\u0414\u043E\u043A\u0442\u0443"];function o(N,A){A.classList.contains(p)||(e.forEach(b=>{r(N,A,b)}),A.classList.add(p))}function r(N,A,b){const y=t(N,b),k=(0,c.d)({},b,y),z=document.createElement("br");A.append(z,k)}function t(N,A){const b=`${N} ${A}`;return`https://www.google.com/search?q=${encodeURIComponent(b)}&btnI`}function v(){const N=(0,d.Fi)(i.DOCTOR_CARD_NAME,document,!0);if(!N)return;const A=N.innerText.trim(),b=(0,l.S)();b.style.textAlign="center",(0,d.Fi)(i.DOCTOR_INTRO_LEFT).append(b),o(A,b)}function F(N,A,b=!1){const y=(0,l.S)(s.r.REVIEWS_INFO);b&&(y.style.justifyContent="center"),y.classList.add("v-application");const k=(0,l.S)(s.r.REVIEWS_INFO_BLOCK);return k.style.height=b?"10px":"23px",k.append(y),N.slice(b?1:0).forEach(z=>{const{category:R,title:T,count:D,bgClassSuffix:P}=z,a=`${A}?rates_category=${R}`,O=b?D:`${T} ${D}`,S=(0,c.d)(s.r.REVIEW_INFO,O,a);S.classList=u(P),y.append(S),b&&h(S,T)}),k}function u(N){return`text-caption text--text px-2 py-1 rounded-sm bg-${N}`}function h(N,A){let b=null;N.addEventListener("mouseenter",()=>{b=(0,l.S)(s.r.REVIEW_INFO_TOOLTIP,A),document.body.appendChild(b);const y=N.getBoundingClientRect();b.style.left=`${(y.left+y.right)/2-b.offsetWidth/2+window.scrollX+2}px`,b.style.top=`${y.top+window.scrollY-b.offsetHeight-4}px`}),N.addEventListener("mouseleave",()=>{b&&(b.remove(),b=null)})}function C(N){const A=(0,d.Fi)(i.NAME_SPAN_HOLDER,document,!0);if(!A)return;const b=(0,d.Fi)(i.NAME_SPAN,A,!0);b&&b.append(N)}function g(){const N=(0,f.Fc)(3,"unknown");return(0,E.$z)(N)}function _(N){const A=(0,f.bn)(N,5,"");return(0,E.$z)(A)}},8586:(w,m,n)=>{n.d(m,{r:()=>i});const d={INPUT:{border:"1px solid #c7d3d9",borderRadius:"10px",padding:"7px 14px",marginLeft:"6px"}},i={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",flexFlow:"wrap"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...d.INPUT,width:"195px"},NUMBER_INPUT:{...d.INPUT,width:"70px"},CHECKBOX_INPUT:{...d.INPUT,width:"20px",height:"20px"},REVIEWS_INFO:{gridGap:"6px"},REVIEWS_INFO_BLOCK:{marginTop:"5px"},REVIEW_INFO:{textDecoration:"none",flexShrink:0},REVIEW_INFO_TOOLTIP:{position:"absolute",backgroundColor:"#333",color:"#fff",padding:"4px 8px",borderRadius:"8px",fontSize:"12px",zIndex:"1000",pointerEvents:"none",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"}}},4231:(w,m,n)=>{n.d(m,{$:()=>R});var d=n(5406),i=n(573),s=n(5539),f=n(3829),E=n(7653),l=n(5213),c=n(5884),p=n(7877);const e={LIST_HEADER:".h2_rating",DOCTOR_FILTERS:".vue-the-doctors-filters > .b-container",DOCTOR_CARD:".b-doctor-card",DOCTOR_CARD_NAME:".b-doctor-card__name-surname",PROFILE_CARD:".b-profile-card",REVIEWS_LINK:":scope > a",EXPERIENCE_WRAP:".b-doctor-card__experience .text-subtitle-1",SPEC_WRAP:".b-doctor-card__spec",CLINIC_CONTAINER:"div.b-doctor-card__lpu-select",CLINIC_WRAP:".b-select__trigger-main-text"};var o=n(4521),r=n(2524),t=n(4921),v=n(8586),F=n(6754);const u=window.GM_addValueChangeListener,h=(0,d.Fc)(2),{createGlobalFilter:C,createSectionFilter:g}=(0,o.z)(P,h),_=g("spec-filter"),N=g("clinic-filter"),A=g("min-reviews-filter",10),b=g("min-experience-filter",5,H),y=g("max-experience-filter",40),k=C("filter-enabled",!0),z={doctorCardsCache:new WeakMap};function R(L){H(),T();const M=(0,i.Fi)(e.DOCTOR_FILTERS);(0,l.b)(M,D),P(),u(r.d5.LAST_DOCTOR_UPDATE,P),new MutationObserver((0,t.sg)(P)).observe(L,{childList:!0})}function T(){const L=(0,i.Fi)(e.LIST_HEADER);L&&L.remove()}function D(L,M){(0,F.ZM)(L,v.r.FILTERS_CONTAINER),L.style.marginTop="6px";const j=(0,c.Nm)("\u0421\u043F\u0435\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F:",_,v.r.CONTROL,v.r.TEXT_INPUT),V=(0,c.Nm)("\u041A\u043B\u0438\u043D\u0438\u043A\u0430:",N,v.r.CONTROL,v.r.TEXT_INPUT),I=(0,p.X0)(A,v.r.CONTROL,v.r.NUMBER_INPUT),x=(0,c.nW)("\u041C\u0438\u043D. \u043E\u043F\u044B\u0442: ",b,"1","0","100",v.r.CONTROL,v.r.NUMBER_INPUT),B=(0,c.nW)("\u041C\u0430\u043A\u0441. \u043E\u043F\u044B\u0442: ",y,"1","0","100",v.r.CONTROL,v.r.NUMBER_INPUT),W=(0,p.pW)(k,v.r.CONTROL,v.r.CHECKBOX_INPUT);L.append(j,V,I,x,B,W),M.append(L)}function P(){(0,i.fI)(e.DOCTOR_CARD).forEach(a)}function a(L){if(!k.value){(0,s.kl)(L);return}let M=z.doctorCardsCache.get(L);if(!M){const V=(0,i.Fi)(e.PROFILE_CARD,L),I=(0,i.Fi)(e.REVIEWS_LINK,V),x=(0,i.Fi)(e.EXPERIENCE_WRAP,L);if(!I||!x){(0,s.Bt)(L);return}const W=(0,i.Fi)(e.SPEC_WRAP,L,!0).innerText.trim(),U=(0,i.Fi)(e.CLINIC_CONTAINER,L,!0),K=(0,i.Fi)(e.CLINIC_WRAP,U,!0).innerText.trim(),G=(0,i.YA)(I,!0),Q=(0,i.YA)(x,!0),J=O(I);I.href=J,(0,E.NI)(S(L),V),M={specInfo:W,clinicName:K,reviewsLinkNumber:G,experienceNumber:Q,reviewsLink:I,reviewInfoAppended:!1},z.doctorCardsCache.set(L,M)}$(M);const j=(0,f.Ay)(M.specInfo,_)||(0,f.Ay)(M.clinicName,N)||(0,f.JE)(M.reviewsLinkNumber,A)||(0,f.JE)(M.experienceNumber,b)||(0,f.iG)(M.experienceNumber,y);(0,s.UC)(L,j)}function O(L){return L.href.replace(/\/#otzivi$/,"/otzivi/")}function S(L){return(0,i.Fi)(e.DOCTOR_CARD_NAME,L,!0).innerText}function $(L){if(L.reviewInfoAppended)return;const{reviewsLink:M}=L,j=M.href,V=(0,r.vX)((0,E.sp)(j));if(!V)return;const I=(0,E.pR)(V,j,!0);(0,s.WH)(M,I),L.reviewInfoAppended=!0}function H(){if(!b.value)return;const L=new URL(window.location.href);+L.searchParams.get("experience")!==b.value&&(L.searchParams.set("experience",b.value),window.location.href=L.toString())}},7858:(w,m,n)=>{n.d(m,{O:()=>c});var d=n(573),i=n(7653);const s={REVIEWS_LINK:".b-doctor-intro__rates-wrapper > a",DOCTOR_DETAILS:".b-doctor-details__toc",REVIEWS_FILTER:".reviews-filter:not(.b-reviews-page__filter)",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]',REVIEWS_FILTER_SPAN:":scope > span",DOCTOR_CONTACTS:"#doctor-contacts"};var f=n(2524),E=n(7273),l=n(8738);function c(){(0,i.z1)(),e();const r=p();o(r);const t=(0,f.vX)((0,i.rd)());if(!t)return;const v=(0,i.pR)(t,r);(0,i.Np)(v)}function p(){const{location:r}=window;return`${r.origin}${r.pathname}otzivi/`}function e(){if(!(0,d.Fi)(s.DOCTOR_CONTACTS))return;const t=[...(0,d.fI)(s.DOCTOR_DETAILS)].pop();if(!t)return;t.style.position="sticky",t.style.top="16px";const v=(0,E.S)({},"\u041C\u0435\u0441\u0442\u043E \u0440\u0430\u0431\u043E\u0442\u044B");v.classList.add("b-doctor-details__toc-title");const F=(0,l.d)({},null,"#doctor-contacts");F.classList.add("b-doctor-details__toc-item"),F.append(v),t.insertBefore(F,t.firstChild)}function o(r){const t=(0,d.Fi)(s.REVIEWS_LINK);t&&(t.href=r)}},5072:(w,m,n)=>{n.d(m,{N:()=>a});var d=n(7653);const i={CONTROLS_CONTAINER:".vue-review-filter",REVIEWS:".b-review-card",REVIEW_TEXT_WRAP:".b-review-card__comment",REVIEW_RATING_WRAP:".review-card-tooltips__stars > .ui-text",FILTER_CHIP:'[data-qa="reviews_filter_chip"]',FILTER_LIST:'[data-qa="reviews_filter_list"]',FILTER_LIST_ITEM:'[data-qa^="reviews_filter_list_item"]',FILTER_TITLE_WRAP:'[data-qa="reviews_filter_title"]',FILTER_COUNT_WRAP:'[data-qa="reviews_filter_amount"]',REVIEWS_CONTAINER:"#otzivi"};var s=n(573),f=n(4921),E=n(5406),l=n(2524),c=n(4521),p=n(5213),e=n(8586),o=n(7877),r=n(5539);function t(I,x){I.forEach(B=>v(x,B))}function v(I,x){if(!x)return;const B=new RegExp(`(${x})`,"gi"),W=document.createTreeWalker(I,NodeFilter.SHOW_TEXT,null);let U=W.nextNode();const X=[];for(;U;){const{textContent:K}=U;if(B.test(K)){const G=document.createDocumentFragment();let Q=0;K.replace(B,(J,re,q)=>{q>Q&&G.appendChild(document.createTextNode(K.slice(Q,q)));const Z=document.createElement("span");Z.className="highlightedSubstring",Z.style.backgroundColor="yellow",Z.textContent=J,G.appendChild(Z),Q=q+J.length}),Q<K.length&&G.appendChild(document.createTextNode(K.slice(Q))),X.push({node:U,fragment:G})}U=W.nextNode()}X.forEach(({node:K,fragment:G})=>{K.parentNode.replaceChild(G,K)})}function F(I){(0,s.fI)(".highlightedSubstring",I).forEach(B=>{const{parentNode:W}=B;B.replaceWith(B.textContent),W.normalize()})}var u=n(8355);function h(I,x){const B=(0,u.fO)(I.value);t(B,x)}function C(I,x){const B=getIncludedSearchStrings(I.value);x.forEach(W=>highlightSubstrings(B,W))}var g=n(3829),_=n(7273);function N(I={}){return(0,_.S)(I,"|")}function A(I,x={},B="customFiltersContainer"){const W=document.getElementById(B);if(!W)return console.log(`Element with id="${B}" not found.`),null;const U=createButton(x,`${arrowUpIcon}\u041A \u0444\u0438\u043B\u044C\u0442\u0440\u0430\u043C`);return U.addEventListener("mouseenter",()=>{U.style.filter="brightness(0.9)"}),U.addEventListener("mouseleave",()=>{U.style.filter="brightness(1)"}),U.addEventListener("click",()=>{const X=W.getBoundingClientRect();window.scrollTo({top:X.top+window.scrollY-I,behavior:"smooth"})}),new IntersectionObserver(([X])=>{const K=X.boundingClientRect.top<0,G=!X.isIntersecting&&K;U.style.display=G?"flex":"none"},{threshold:.5}).observe(W),U}function b(I,x={},B=75){const W=A(B,x);W&&I.appendChild(W)}var y=n(6754);const{createGlobalFilter:k}=(0,c.z)(S),z=k("reviews-text-filter"),R=k("reviews-min-rating-filter"),T=k("reviews-max-rating-filter"),D=k("reviews-filter-enabled",!0),P={reviewCardsCache:new Map};async function a(){(0,d.z1)();const I=await(0,f.xk)(document,i.CONTROLS_CONTAINER);(0,p.b)(I,O),S();const x=await L();(0,l.ft)((0,d.rd)(),x);const B=(0,d.pR)(x,j());(0,d.Np)(B),(0,E.$F)("rates_category")&&V()}function O(I,x){(0,y.ZM)(I,e.r.FILTERS_CONTAINER),I.style.marginTop="12px";const B=(0,o.E9)(z,e.r.CONTROL,e.r.TEXT_INPUT),W=(0,o.HX)(R,e.r.CONTROL,e.r.NUMBER_INPUT,1,1),U=(0,o.FR)(T,e.r.CONTROL,e.r.NUMBER_INPUT,1,1),X=N(e.r.CONTROL),K=(0,o.pW)(D,e.r.CONTROL,e.r.CHECKBOX_INPUT);I.append(B,W,U,X,K),x.append(I)}function S(){(0,s.fI)(i.REVIEWS).forEach($)}function $(I){if(!D.value){(0,r.kl)(I);return}F(I);let x=P.reviewCardsCache.get(I);if(!x){const W=(0,s.Fi)(i.REVIEW_TEXT_WRAP,I),U=(0,s.Fi)(i.REVIEW_RATING_WRAP,I);if(!W){(0,r.Bt)(I);return}x={reviewTextWrap:W,reviewText:W.innerText,rating:U&&(0,s.YA)(U)},P.reviewCardsCache.set(I,x)}z.value&&h(z,x.reviewTextWrap);const B=(0,g.Ay)(x.reviewText,z)||H(x.rating);(0,r.UC)(I,B)}function H(I){return I?(0,g.JE)(I,R)||(0,g.iG)(I,T):!1}async function L(){const I=(0,s.Fi)(i.FILTER_CHIP);I.click();const x=await(0,f.xk)(document,i.FILTER_LIST),B=[...(0,s.fI)(i.FILTER_LIST_ITEM,x)].map(W=>{const U=W.getAttribute("data-qa");if(!U)return null;const X=U.replace("reviews_filter_list_item_",""),K=(0,s.Fi)(i.FILTER_TITLE_WRAP,W).textContent.trim(),G=(0,s.Fi)(i.FILTER_COUNT_WRAP,W),Q=(0,s.YA)(G,!0),J=M(G.classList);return{category:X,title:K,count:Q,bgClassSuffix:J}});return I.click(),B}function M(I){const x=I.value.match(/bg-(\w+)/);return x?x[1]:null}function j(){const{location:I}=window;return`${I.origin}${I.pathname}`}function V(){(0,s.Fi)(i.REVIEWS_CONTAINER).scrollIntoView({behavior:"smooth"})}}},ee={};function Y(w){var m=ee[w];if(m!==void 0)return m.exports;var n=ee[w]={exports:{}};return te[w](n,n.exports,Y),n.exports}(()=>{var w=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",m=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",n=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",d=s=>{s&&s.d<1&&(s.d=1,s.forEach(f=>f.r--),s.forEach(f=>f.r--?f.r++:f()))},i=s=>s.map(f=>{if(f!==null&&typeof f=="object"){if(f[w])return f;if(f.then){var E=[];E.d=0,f.then(p=>{l[m]=p,d(E)},p=>{l[n]=p,d(E)});var l={};return l[w]=p=>p(E),l}}var c={};return c[w]=p=>{},c[m]=f,c});Y.a=(s,f,E)=>{var l;E&&((l=[]).d=-1);var c=new Set,p=s.exports,e,o,r,t=new Promise((v,F)=>{r=F,o=v});t[m]=p,t[w]=v=>(l&&v(l),c.forEach(v),t.catch(F=>{})),s.exports=t,f(v=>{e=i(v);var F,u=()=>e.map(C=>{if(C[n])throw C[n];return C[m]}),h=new Promise(C=>{F=()=>C(u),F.r=0;var g=_=>_!==l&&!c.has(_)&&(c.add(_),_&&!_.d&&(F.r++,_.push(F)));e.map(_=>_[w](g))});return F.r?h:u()},v=>(v?r(t[n]=v):o(p),d(l))),l&&l.d<0&&(l.d=0)}})(),Y.d=(w,m)=>{for(var n in m)Y.o(m,n)&&!Y.o(w,n)&&Object.defineProperty(w,n,{enumerable:!0,get:m[n]})},Y.o=(w,m)=>Object.prototype.hasOwnProperty.call(w,m);var ne=Y(1753)})();})();
