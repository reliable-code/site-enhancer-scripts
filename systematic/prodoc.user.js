// ==UserScript==
// @name         Prodoc enhancer
// @description  Hide doctor cards by filter, enhance doctor page
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://prodoctorov.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      2.0.75968458
// @icon         https://www.google.com/s2/favicons?sz=64&domain=prodoctorov.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/prodoc.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var te={5467:(F,E,e)=>{e.d(E,{E2:()=>o});var l=e(9928);function o(C,c={},n=null){const s=(0,l.Sw)(c,n);return s.append(C),s}function d(C,c=null,n={},s={}){const t=createActionLink(C,c,s);return o(t,n)}function p(C,c=null,n=null,s={},t={}){const h=createActionLinkWithIcon(C,n,c,t);return o(h,s)}},9928:(F,E,e)=>{e.d(E,{S:()=>C,Sw:()=>L,d:()=>s,kU:()=>d,o5:()=>p});var l=e(4921),o=e(6754);function d(i,r,m){const a=c(i,"text",r);return a.value=m,a}function p(i,r,m,a,x,O){const D=c(i,"number",r);return D.value=m,D.step=a,D.min=x,D.max=O,D}function C(i,r,m){const a=c(i,"checkbox",r);return a.checked=m,a}function c(i={},r=null,m=null){const a=u("input",i);return r&&(a.type=r),m&&(a.addEventListener("keyup",(0,l.sg)(m,200)),a.addEventListener("change",(0,l.sg)(m,100))),a}function n(i={},r=null){return u("span",i,r)}function s(i={},r=null,m=null){const a=u("a",i,r);return m&&(a.href=m),a}function t(i,r=null,m={}){m.cursor||="pointer";const a=s(m,r);return i&&a.addEventListener("click",i),a}function h(i,r,m=null,a={},x={}){a.display||="inline-flex",a.alignItems||="center",a.gap||="0.25em";const O=t(i,m,a);return O.prepend(T(r,x)),O}function v(i={},r=null,m=null){const a=u("button",i,r);return m&&a.addEventListener("click",m),a}function L(i={},r=null){return u("div",i,r)}function g(i={}){return u("i",i)}function T(i,r={}){r.width||="1em",r.height||="1em",r.paddingBottom||="1px";const m=g(r);return m.setAttribute("data-lucide",i),m}function u(i,r,m=null){if(typeof r!="object"||r===null)throw new TypeError("styles should be an object");const a=document.createElement(i);return(0,o.ZM)(a,r),m&&(a.innerHTML=m),a}},573:(F,E,e)=>{e.d(E,{Fi:()=>d,YA:()=>s,fI:()=>p});var l=e(4214);function o(u,i=document){return!!i.querySelector(u)}function d(u,i=document,r=!1){const m=i.querySelector(u);return r&&!m&&console.log(`No element found for selector: ${u}`),m}function p(u,i=document,r=!1){const m=i.querySelectorAll(u);return r&&!m.length&&console.log(`No elements found for selector: ${u}`),m}function C(u,i=1){let r=u;for(let m=0;m<i;m++){if(!r.parentElement)return null;r=r.parentElement}return r}function c(u,i,r){return[...u.querySelectorAll(i)].find(m=>m.textContent.trim().includes(r))}function n(u,i,r=!1,m=!1,a=null){const x=d(i,u);return s(x,r,m,a)}function s(u,i=!1,r=!1,m=null){if(!u)return m===null?(console.log("No element found"),null):m;const a=u.innerText;return v(a,i,r)}function t(u,i,r=!1){const m=u[i];return s(m,r)}function h(u,i=!1,r=!1){const m=u.textContent;return v(m,i,r)}function v(u,i,r){i&&(u=(0,l.zr)(u)),r&&(u=u.replace(",","."));const m=Number(u);return Number.isNaN(m)?(console.log(`Invalid number: ${u}`),0):m}function L(u){return[...u.childNodes].find(i=>i.nodeType===Node.TEXT_NODE)}function g(u){const i=r=>r.nodeType===Node.TEXT_NODE&&r.textContent.trim()!==""?[r]:[...r.childNodes].flatMap(i);return i(u)}function T(u){return normalizeSpacing(u.textContent)}},5539:(F,E,e)=>{e.d(E,{Bt:()=>o,UC:()=>t,WH:()=>l,kl:()=>n});function l(f,S){f.parentNode.insertBefore(S,f.nextSibling)}function o(f){f.style.display="none"}function d(f,S=1){const _=document.querySelector(f);_&&p(_,S)}function p(f,S=1){const _=getElementAncestor(f,S);_&&o(_)}function C(f){L(f),o(f)}function c(f){f.intersectionObserver||runOnceOnIntersection(f,()=>o(f))}function n(f){f.style.display=""}function s(f){const S=v(f);f.style.display=S}function t(f,S){S?o(f):n(f)}function h(f,S){S?c(f):(clearIntersectionObserver(f),n(f))}function v(f){return L(f),f.defaultDisplay}function L(f){if(f.defaultDisplay)return;const{display:S}=getComputedStyle(f);f.defaultDisplay=S}function g(){return{show:[],hide:[]}}function T(f,S,_){f?S.hide.push(_):S.show.push(_)}function u(f){f.show.forEach(n),f.hide.forEach(o)}function i(f,S,_=.3){S?m(f,_):r(f)}function r(f){f.style.opacity=""}function m(f,S=.3){f.style.opacity=S}function a(f){f.style.order=""}function x(f,S){f.style.order=S}function O(f,S){f.style.background=S}function D(f,S){const _=getFirstElement(S);_&&R(f,_)}function R(f,S){const _=createLink();_.href=f,S.parentNode.append(_),_.append(S)}function w(f,S){const _=getFirstElement(S);_&&N(f,_)}function N(f,S){const _=createLink();_.href=f,_.append(...S.childNodes),S.append(_)}function P(){const f=getURLQueryParam("scrollTo");if(!f)return;const S=document.getElementById(f);S?S.scrollIntoView():console.log(`Element with ID "${f}" was not found.`)}function k(f,S,_=null){const K=`${S}-click-passed`,j=_?B=>findElementByText(B,f,_):B=>getFirstElement(f,B);return function(B){if(B.hasAttribute(K))return!1;const b=j(B);return b&&b.click(),B.setAttribute(K,""),!0}}function Y(f,S,_="text/plain"){const K=new Blob([f],{type:_}),j=URL.createObjectURL(K),B=document.createElement("a");B.href=j,B.download=S,document.body.appendChild(B),B.click(),document.body.removeChild(B),requestAnimationFrame(()=>URL.revokeObjectURL(j))}},6754:(F,E,e)=>{e.d(E,{ZM:()=>l});function l(C,c){Object.assign(C.style,c)}function o(C,c="custom-global-style"){let n=document.getElementById(c);n||(n=document.createElement("style"),n.id=c,n.type="text/css",document.head.appendChild(n)),n.textContent=C}function d(C){return Object.entries(C).map(([c,n])=>`${c.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${n};`).join(" ")}function p(C){return C?C.split(";").filter(c=>c.trim()!=="").reduce((c,n)=>{const[s,t]=n.split(":").map(v=>v.trim()),h=s.replace(/-([a-z])/g,(v,L)=>L.toUpperCase());return c[h]=t,c},{}):{}}},4921:(F,E,e)=>{e.d(E,{sg:()=>p,xk:()=>l});function l(t,h,v=null){const L=t.querySelector(h);return L?Promise.resolve(L):new Promise(g=>{const T=new MutationObserver(i);T.observe(t,{childList:!0,subtree:!0});let u;v&&(u=setTimeout(()=>{T.disconnect(),console.log(`No element found for selector: ${h}`),g(null)},v));function i(){const r=t.querySelector(h);r&&(u&&clearTimeout(u),T.disconnect(),g(r))}})}function o(t,h){return t.querySelector(h)?new Promise(L=>{const g=new MutationObserver(T);g.observe(t,{childList:!0,subtree:!0});function T(){t.querySelector(h)||(g.disconnect(),L())}}):Promise.resolve()}function d(t,h=400){return new Promise(v=>{let L;const g=new MutationObserver(()=>{clearTimeout(L),T()});function T(){L=setTimeout(()=>{g.disconnect(),v()},h)}T(),g.observe(t,{childList:!0,subtree:!0})})}function p(t,h=250){let v;return(...L)=>{clearTimeout(v),v=setTimeout(()=>t(...L),h)}}async function C(t){document.visibilityState==="visible"?await t():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await t()},{once:!0})}function c(t,h){const v=new IntersectionObserver(L=>{L.forEach(g=>{g.isIntersecting&&(h(),n(t))})});t.intersectionObserver=v,v.observe(t)}function n(t){t.intersectionObserver&&(t.intersectionObserver.disconnect(),t.intersectionObserver=null)}function s(t){t&&(t.disconnect(),t=null)}},3829:(F,E,e)=>{e.d(E,{Ay:()=>o,JE:()=>p,iG:()=>C});var l=e(8355);function o(n,s){return!d(n,s)}function d(n,s){if(!s.value)return!0;const t=n.toLowerCase(),h=(0,l.R)(s),v=[],L=[];return h.forEach(g=>{if(g.startsWith("!")){const T=g.substring(1);T&&L.push(T)}else v.push(g)}),v.every(g=>t.includes(g))&&L.every(g=>!t.includes(g))}function p(n,s){return s.value!=null&&n<s.value}function C(n,s){return s.value!=null&&n>s.value}function c(n,s){return s.value&&n!==s.value}},4521:(F,E,e)=>{e.d(E,{z:()=>o});var l=e(3048);function o(d,p=null){return{createGlobalFilter(C,c=null,n=d){return l.V.create(C,c,n)},createSectionFilter(C,c=null,n=d){if(!p)throw new Error("sectionId must be provided to use createSectionFilter.");return l.V.createWithCompositeKey(p,C,c,n)}}}},5884:(F,E,e)=>{e.d(E,{Hw:()=>C,Nm:()=>d,nW:()=>p});var l=e(9928),o=e(5467);function d(c,n,s={},t={}){const h=(0,l.kU)(t,n.updateValueFromEvent,n.value);return(0,o.E2)(h,s,c)}function p(c,n,s,t,h,v={},L={}){const g=(0,l.o5)(L,n.updateValueFromEvent,n.value,s,t,h);return(0,o.E2)(g,v,c)}function C(c,n,s={},t={}){const h=(0,l.S)(t,n.updateValueFromEvent,n.value);return(0,o.E2)(h,s,c)}},7877:(F,E,e)=>{e.d(E,{E9:()=>o,FR:()=>p,HX:()=>d,X0:()=>C,pW:()=>D});var l=e(5884);function o(R,w={},N={}){return(0,l.Nm)("\u041F\u043E\u0438\u0441\u043A: ",R,w,N)}function d(R,w={},N={},P=.1,k=3){return(0,l.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",R,P,k,5,w,N)}function p(R,w={},N={},P=.1,k=3){return(0,l.nW)("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",R,P,k,5,w,N)}function C(R,w={},N={}){return n("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",R,w,N)}function c(R,w={},N={}){return n("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",R,w,N)}function n(R,w,N={},P={}){return(0,l.nW)(R,w,"1","1","999999",N,P)}function s(R,w={},N={}){return t("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",R,w,N)}function t(R,w,N={},P={}){return createNumberFilterControl(R,w,"5","0","100",N,P)}function h(R,w={},N={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",R,"5","0","100",w,N)}function v(R,w,N={},P={},k="250"){return createNumberFilterControl(R,w,k,"0","1000000",N,P)}function L(R,w={},N={},P="25"){return v("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",R,w,N,P)}function g(R,w={},N={},P="25"){return v("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",R,w,N,P)}function T(R,w={},N={}){return u("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",R,w,N)}function u(R,w,N={},P={}){return createNumberFilterControl(R,w,"1","0","99999",N,P)}function i(R,w={},N={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",R,"1","2","7",w,N)}function r(R,w={},N={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",R,1,1,10,w,N)}function m(R,w={},N={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",R,w,N)}function a(R,w={},N={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",R,w,N)}function x(R,w={},N={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",R,w,N)}function O(R,w={},N={}){return createCheckboxFilterControl("\u0411\u0430\u043B\u043B\u044B: ",R,w,N)}function D(R,w={},N={}){return(0,l.Hw)("\u0412\u043A\u043B: ",R,w,N)}},8355:(F,E,e)=>{e.d(E,{R:()=>l,f:()=>o});function l(d){return d.value.toLowerCase().split(",").map(p=>p.trim()).filter(p=>p!=="")}function o(d){return l(d).filter(p=>!p.startsWith("!"))}},5213:(F,E,e)=>{e.d(E,{b:()=>d});var l=e(9928),o=e(573);function d(p,C,c=!1,n="customFiltersContainer"){let s=(0,o.Fi)(`#${n}`,p);if(s)if(c)s.remove();else return;s=(0,l.Sw)(),s.id=n,C(s,p)}},8200:(F,E,e)=>{e.d(E,{s:()=>l});function l(o){const{target:d}=o,{type:p}=d;switch(p){case"text":return`"${d.value}"`;case"number":return d.value;case"checkbox":return d.checked;default:return console.log(`Unknown input type: ${p}`),null}}},157:(F,E,e)=>{e.d(E,{Fg:()=>l,vx:()=>d});const l=window.GM_setValue,o=window.GM.setValue,d=window.GM_getValue},1870:(F,E,e)=>{e.d(E,{j:()=>l});class l{constructor(d,p){this.value=d,this.onChange=p}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(F,E,e)=>{e.d(E,{V:()=>C});var l=e(1870),o=e(8200),d=e(3976),p=e(157);class C extends l.j{constructor(n,s=null,t=null){super((0,p.vx)(n,s),t),this.storageKey=n,this.defaultValue=s}static create(n,s=null,t=null){return new C(n,s,t)}static createWithCompositeKey(n,s,t=null,h=null){const v=`${n}-${s}`;return new C(v,t,h)}updateValueFromEvent=n=>{const s=(0,o.s)(n),t=(0,d.$)(s);this.updateValue(t)};updateValue(n,s=!0){this.value!==n&&((0,p.Fg)(this.storageKey,n),this.value=n,s&&this.onChangeIfDefined())}clearValue(n=!1){this.updateValue(null,n)}resetValue(n=!1){this.updateValue(this.defaultValue,n)}}},3976:(F,E,e)=>{e.d(E,{$:()=>l});function l(o){return o===""?null:JSON.parse(o)}},4214:(F,E,e)=>{e.d(E,{$z:()=>l,zr:()=>o});function l(c){return c.replace(/\D/g,"")}function o(c){return c.replace(/[^\d.,-]/g,"")}function d(c){return c.replace(/\s/g,"")}function p(c){return c.charAt(0).toUpperCase()+c.slice(1)}function C(c){return c.replace(/\s+/g," ").trim()}},5406:(F,E,e)=>{e.d(E,{$F:()=>c,Fc:()=>l,bn:()=>o,z2:()=>h});function l(T,u="common",i=!1){const{pathname:r}=window.location;return o(r,T,u,i)}function o(T,u,i,r=!1){const m=T.split("/");u=u<0?m.length+u:u;const a=m[u]||i;return r&&console.log(`Pathname element: ${a}`),a}function d(T,u="common",i=!1){const r=l(T,"",i);return p(r,u,i)}function p(T,u,i){if(!T)return u;const r=T.split("-").at(-1);return i&&console.log(`Pathname element ending: ${r}`),r}function C(T,u,i="common",r=!1){const m=o(T,u,"",r);return p(m,i,r)}function c(T){return new URLSearchParams(window.location.search).get(T)}function n(T){return T.split("?")[0]}function s(T){return window.location.pathname.includes(T)}function t(T){return T.some(u=>s(u))}function h(T){return window.location.pathname.split("/").some(i=>i===T)}function v(T){try{const u=new URL(window.location.href);Object.entries(T).forEach(([i,r])=>{u.searchParams.set(i,r)}),window.location.href=u.toString()}catch(u){console.error("Failed to redirect:",u)}}function L(T,u=[]){const i={pathname:window.location.pathname};u.forEach(O=>{i[O]=c(O)});let r=!1;async function m(){if(r)return;const O={pathname:window.location.pathname};if(u.forEach(D=>{O[D]=c(D)}),Object.keys(i).some(D=>i[D]!==O[D])){Object.assign(i,O),r=!0;try{await T()}catch(D){console.error("Error in URL observer callback:",D)}finally{r=!1}}}function a(){m().catch(O=>{console.error("Error in URL change handler:",O)})}let x=window.location.href;setInterval(()=>{window.location.href!==x&&(x=window.location.href,a())},200),window.addEventListener("popstate",a)}function g(T=[]){L(()=>window.location.reload(),T)}},2524:(F,E,e)=>{e.d(E,{d5:()=>d,vX:()=>n,ft:()=>p});var l=e(157);class o{constructor(h=Date.now(),v=[]){this.lastCheckDate=h,this.reviewsData=v}updateLastCheckDate=()=>{this.lastCheckDate=Date.now()};static fromObject(h){const{lastCheckDate:v,reviewsData:L}=h;return new o(v,L)}}const d={LAST_DOCTOR_UPDATE:"last-doctor-update"};function p(t,h){const v=C(t),L=(0,l.vx)(v),g=c(L);g.reviewsData=h,g.updateLastCheckDate(),(0,l.Fg)(v,g),(0,l.Fg)(d.LAST_DOCTOR_UPDATE,Date.now())}function C(t){return`doctor-${t}`}function c(t){return t?o.fromObject(t):new o}function n(t){return s(t)?.reviewsData??null}function s(t){const h=C(t);return(0,l.vx)(h)}},1753:(F,E,e)=>{e.a(F,async(l,o)=>{try{var d=e(573),p=e(7858),C=e(4231),c=e(5406),n=e(5072);const t=(0,d.Fi)(".appointments_page");t?(0,C.$)(t):(0,c.z2)("otzivi")?await(0,n.N)():(0,c.z2)("vrach")&&(0,p.O)(),o()}catch(s){o(s)}},1)},7653:(F,E,e)=>{e.d(E,{NI:()=>t,z1:()=>L,Np:()=>i,pR:()=>g,sp:()=>m,rd:()=>r});var l=e(9928),o=e(573);const d={DOCTOR_CARD_NAME:'.b-doctor-intro__title-first-line [itemprop="name"]',DOCTOR_INTRO_LEFT:".b-doctor-intro__left-side",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]'};var p=e(8586),C=e(5406),c=e(4214);const n="additionalLinksAppended",s=["\u042F\u043D\u0434\u0435\u043A\u0441","\u041D\u0430\u041F\u043E\u043F\u0440\u0430\u0432\u043A\u0443","DocDoc","\u0414\u043E\u043A\u0442\u0443"];function t(a,x){x.classList.contains(n)||(s.forEach(O=>{h(a,x,O)}),x.classList.add(n))}function h(a,x,O){const D=v(a,O),R=(0,l.d)({},O,D),w=document.createElement("br");x.append(w,R)}function v(a,x){const O=`${a} ${x}`;return`https://www.google.com/search?q=${encodeURIComponent(O)}&btnI`}function L(){const a=(0,o.Fi)(d.DOCTOR_CARD_NAME,document,!0);if(!a)return;const x=a.innerText.trim(),O=(0,l.Sw)();O.style.textAlign="center",(0,o.Fi)(d.DOCTOR_INTRO_LEFT).append(O),t(x,O)}function g(a,x,O=!1){const D=(0,l.Sw)(p.r.REVIEWS_INFO);O&&(D.style.justifyContent="center"),D.classList.add("v-application");const R=(0,l.Sw)(p.r.REVIEWS_INFO_BLOCK);return R.style.height=O?"10px":"23px",R.append(D),a.slice(O?1:0).forEach(w=>{const{category:N,title:P,count:k,bgClassSuffix:Y}=w,f=`${x}?rates_category=${N}`,S=O?k:`${P} ${k}`,_=(0,l.d)(p.r.REVIEW_INFO,S,f);_.classList=T(Y),D.append(_),O&&u(_,P)}),R}function T(a){return`text-caption text--text px-2 py-1 rounded-sm bg-${a}`}function u(a,x){let O=null;a.addEventListener("mouseenter",()=>{O=(0,l.Sw)(p.r.REVIEW_INFO_TOOLTIP,x),document.body.appendChild(O);const D=a.getBoundingClientRect();O.style.left=`${(D.left+D.right)/2-O.offsetWidth/2+window.scrollX+2}px`,O.style.top=`${D.top+window.scrollY-O.offsetHeight-4}px`}),a.addEventListener("mouseleave",()=>{O&&(O.remove(),O=null)})}function i(a){const x=(0,o.Fi)(d.NAME_SPAN_HOLDER,document,!0);if(!x)return;const O=(0,o.Fi)(d.NAME_SPAN,x,!0);O&&O.append(a)}function r(){const a=(0,C.Fc)(3,"unknown");return(0,c.$z)(a)}function m(a){const x=(0,C.bn)(a,5,"");return(0,c.$z)(x)}},8586:(F,E,e)=>{e.d(E,{r:()=>o});const l={INPUT:{border:"1px solid #c7d3d9",borderRadius:"10px",padding:"7px 14px",marginLeft:"6px"}},o={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",flexFlow:"wrap"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...l.INPUT,width:"195px"},NUMBER_INPUT:{...l.INPUT,width:"70px"},CHECKBOX_INPUT:{...l.INPUT,width:"20px",height:"20px"},REVIEWS_INFO:{gridGap:"6px"},REVIEWS_INFO_BLOCK:{marginTop:"5px"},REVIEW_INFO:{textDecoration:"none",flexShrink:0},REVIEW_INFO_TOOLTIP:{position:"absolute",backgroundColor:"#333",color:"#fff",padding:"4px 8px",borderRadius:"8px",fontSize:"12px",zIndex:"1000",pointerEvents:"none",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"}}},4231:(F,E,e)=>{e.d(E,{$:()=>P});var l=e(5406),o=e(573),d=e(5539),p=e(3829),C=e(7653),c=e(5213),n=e(5884),s=e(7877);const t={LIST_HEADER:".h2_rating",DOCTOR_FILTERS:".vue-the-doctors-filters > .b-container",DOCTOR_CARD:".b-doctor-card",DOCTOR_CARD_NAME:".b-doctor-card__name-surname",PROFILE_CARD:".b-profile-card",REVIEWS_LINK:":scope > a",EXPERIENCE_WRAP:".b-doctor-card__experience .mr-2 .text-subtitle-1",SPEC_WRAP:".b-doctor-card__spec",CLINIC_CONTAINER:"div.b-doctor-card__lpu-select",CLINIC_WRAP:".b-select__trigger-main-text"};var h=e(4521),v=e(2524),L=e(4921),g=e(8586),T=e(6754);const u=window.GM_addValueChangeListener,i=(0,l.Fc)(2),{createGlobalFilter:r,createSectionFilter:m}=(0,h.z)(f,i),a=m("spec-filter"),x=m("clinic-filter"),O=m("min-reviews-filter",10),D=m("min-experience-filter",5,B),R=m("max-experience-filter",40),w=r("filter-enabled",!0),N={doctorCardsCache:new WeakMap};function P(b){B(),k();const U=(0,o.Fi)(t.DOCTOR_FILTERS);(0,c.b)(U,Y),f(),u(v.d5.LAST_DOCTOR_UPDATE,f),new MutationObserver((0,L.sg)(f)).observe(b,{childList:!0})}function k(){const b=(0,o.Fi)(t.LIST_HEADER);b&&b.remove()}function Y(b,U){(0,T.ZM)(b,g.r.FILTERS_CONTAINER),b.style.marginTop="6px";const z=(0,n.Nm)("\u0421\u043F\u0435\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F:",a,g.r.CONTROL,g.r.TEXT_INPUT),X=(0,n.Nm)("\u041A\u043B\u0438\u043D\u0438\u043A\u0430:",x,g.r.CONTROL,g.r.TEXT_INPUT),I=(0,s.X0)(O,g.r.CONTROL,g.r.NUMBER_INPUT),A=(0,n.nW)("\u041C\u0438\u043D. \u043E\u043F\u044B\u0442: ",D,"1","0","100",g.r.CONTROL,g.r.NUMBER_INPUT),y=(0,n.nW)("\u041C\u0430\u043A\u0441. \u043E\u043F\u044B\u0442: ",R,"1","0","100",g.r.CONTROL,g.r.NUMBER_INPUT),W=(0,s.pW)(w,g.r.CONTROL,g.r.CHECKBOX_INPUT);b.append(z,X,I,A,y,W),U.append(b)}function f(){(0,o.fI)(t.DOCTOR_CARD).forEach(S)}function S(b){if(!w.value){(0,d.kl)(b);return}let U=N.doctorCardsCache.get(b);if(!U){const X=(0,o.Fi)(t.PROFILE_CARD,b),I=(0,o.Fi)(t.REVIEWS_LINK,X),A=(0,o.Fi)(t.EXPERIENCE_WRAP,b);if(!I||!A){(0,d.Bt)(b);return}const W=(0,o.Fi)(t.SPEC_WRAP,b,!0).innerText.trim(),M=(0,o.Fi)(t.CLINIC_CONTAINER,b,!0),$=(0,o.Fi)(t.CLINIC_WRAP,M,!0).innerText.trim(),H=(0,o.YA)(I,!0),G=(0,o.YA)(A,!0),J=_(I);I.href=J,(0,C.NI)(K(b),X),U={specInfo:W,clinicName:$,reviewsLinkNumber:H,experienceNumber:G,reviewsLink:I,reviewInfoAppended:!1},N.doctorCardsCache.set(b,U)}j(U);const z=(0,p.Ay)(U.specInfo,a)||(0,p.Ay)(U.clinicName,x)||(0,p.JE)(U.reviewsLinkNumber,O)||(0,p.JE)(U.experienceNumber,D)||(0,p.iG)(U.experienceNumber,R);(0,d.UC)(b,z)}function _(b){return b.href.replace(/\/#otzivi$/,"/otzivi/")}function K(b){return(0,o.Fi)(t.DOCTOR_CARD_NAME,b,!0).innerText}function j(b){if(b.reviewInfoAppended)return;const{reviewsLink:U}=b,z=U.href,X=(0,v.vX)((0,C.sp)(z));if(!X)return;const I=(0,C.pR)(X,z,!0);(0,d.WH)(U,I),b.reviewInfoAppended=!0}function B(){if(!D.value)return;const b=new URL(window.location.href);+b.searchParams.get("experience")!==D.value&&(b.searchParams.set("experience",D.value),window.location.href=b.toString())}},7858:(F,E,e)=>{e.d(E,{O:()=>c});var l=e(573),o=e(9928),d=e(7653);const p={REVIEWS_LINK:".b-doctor-intro__rates-wrapper > a",DOCTOR_DETAILS:".b-doctor-details__toc",REVIEWS_FILTER:".reviews-filter:not(.b-reviews-page__filter)",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]',REVIEWS_FILTER_SPAN:":scope > span",DOCTOR_CONTACTS:"#doctor-contacts"};var C=e(2524);function c(){(0,d.z1)(),s();const h=n();t(h);const v=(0,C.vX)((0,d.rd)());if(!v)return;const L=(0,d.pR)(v,h);(0,d.Np)(L)}function n(){const{location:h}=window;return`${h.origin}${h.pathname}otzivi/`}function s(){if(!(0,l.Fi)(p.DOCTOR_CONTACTS))return;const v=[...(0,l.fI)(p.DOCTOR_DETAILS)].pop();if(!v)return;v.style.position="sticky",v.style.top="16px";const L=(0,o.Sw)({},"\u041C\u0435\u0441\u0442\u043E \u0440\u0430\u0431\u043E\u0442\u044B");L.classList.add("b-doctor-details__toc-title");const g=(0,o.d)({},null,"#doctor-contacts");g.classList.add("b-doctor-details__toc-item"),g.append(L),v.insertBefore(g,v.firstChild)}function t(h){const v=(0,l.Fi)(p.REVIEWS_LINK);v&&(v.href=h)}},5072:(F,E,e)=>{e.d(E,{N:()=>S});var l=e(7653);const o={CONTROLS_CONTAINER:".vue-review-filter",REVIEWS:".b-review-card",REVIEW_TEXT_WRAP:".b-review-card__comment",REVIEW_RATING_WRAP:".review-card-tooltips__stars > .ui-text",FILTER_CHIP:'[data-qa="reviews_filter_chip"]',FILTER_LIST:'[data-qa="reviews_filter_list"]',FILTER_LIST_ITEM:'[data-qa^="reviews_filter_list_item"]',FILTER_TITLE_WRAP:'[data-qa="reviews_filter_title"]',FILTER_COUNT_WRAP:'[data-qa="reviews_filter_amount"]',REVIEWS_CONTAINER:"#otzivi"};var d=e(573),p=e(4921),C=e(5406),c=e(2524),n=e(4521),s=e(5213),t=e(8586),h=e(7877),v=e(5539);function L(I,A){I.forEach(y=>g(A,y))}function g(I,A){if(!A)return;const y=new RegExp(`(${A})`,"gi"),W=document.createTreeWalker(I,NodeFilter.SHOW_TEXT,null);let M=W.nextNode();const V=[];for(;M;){const{textContent:$}=M;if(y.test($)){const H=document.createDocumentFragment();let G=0;$.replace(y,(J,re,q)=>{q>G&&H.appendChild(document.createTextNode($.slice(G,q)));const Z=document.createElement("span");Z.className="highlightedSubstring",Z.style.backgroundColor="yellow",Z.textContent=J,H.appendChild(Z),G=q+J.length}),G<$.length&&H.appendChild(document.createTextNode($.slice(G))),V.push({node:M,fragment:H})}M=W.nextNode()}V.forEach(({node:$,fragment:H})=>{$.parentNode.replaceChild(H,$)})}function T(I){(0,d.fI)(".highlightedSubstring",I).forEach(y=>{const{parentNode:W}=y;y.replaceWith(y.textContent),W.normalize()})}var u=e(8355);function i(I,A){const y=(0,u.f)(I);L(y,A)}function r(I,A){const y=getIncludedSearchStrings(I);A.forEach(W=>highlightSubstrings(y,W))}var m=e(3829),a=e(9928);function x(I={}){return(0,a.Sw)(I,"|")}function O(I={},A=75,y="customFiltersContainer"){const W=document.getElementById(y);if(!W)return console.log(`Element with id="${y}" not found.`),null;const M=createButton(I,`${arrowUpIcon}\u041A \u0444\u0438\u043B\u044C\u0442\u0440\u0430\u043C`);return M.addEventListener("mouseenter",()=>{M.style.filter="brightness(0.9)"}),M.addEventListener("mouseleave",()=>{M.style.filter="brightness(1)"}),M.addEventListener("click",()=>{const V=W.getBoundingClientRect();window.scrollTo({top:V.top+window.scrollY-A})}),new IntersectionObserver(([V])=>{M.style.display=V.isIntersecting?"none":"flex"},{threshold:.5}).observe(W),M}function D(I,A={}){const y=O(A);y&&I.appendChild(y)}var R=e(6754);const{createGlobalFilter:w}=(0,n.z)(K),N=w("reviews-text-filter"),P=w("reviews-min-rating-filter"),k=w("reviews-max-rating-filter"),Y=w("reviews-filter-enabled",!0),f={reviewCardsCache:new Map};async function S(){(0,l.z1)();const I=await(0,p.xk)(document,o.CONTROLS_CONTAINER);(0,s.b)(I,_),K();const A=await b();(0,c.ft)((0,l.rd)(),A);const y=(0,l.pR)(A,z());(0,l.Np)(y),(0,C.$F)("rates_category")&&X()}function _(I,A){(0,R.ZM)(I,t.r.FILTERS_CONTAINER),I.style.marginTop="12px";const y=(0,h.E9)(N,t.r.CONTROL,t.r.TEXT_INPUT),W=(0,h.HX)(P,t.r.CONTROL,t.r.NUMBER_INPUT,1,1),M=(0,h.FR)(k,t.r.CONTROL,t.r.NUMBER_INPUT,1,1),V=x(t.r.CONTROL),$=(0,h.pW)(Y,t.r.CONTROL,t.r.CHECKBOX_INPUT);I.append(y,W,M,V,$),A.append(I)}function K(){(0,d.fI)(o.REVIEWS).forEach(j)}function j(I){if(!Y.value){(0,v.kl)(I);return}T(I);let A=f.reviewCardsCache.get(I);if(!A){const W=(0,d.Fi)(o.REVIEW_TEXT_WRAP,I),M=(0,d.Fi)(o.REVIEW_RATING_WRAP,I);if(!W){(0,v.Bt)(I);return}A={reviewTextWrap:W,reviewText:W.innerText,rating:M&&(0,d.YA)(M)},f.reviewCardsCache.set(I,A)}N.value&&i(N,A.reviewTextWrap);const y=(0,m.Ay)(A.reviewText,N)||B(A.rating);(0,v.UC)(I,y)}function B(I){return I?(0,m.JE)(I,P)||(0,m.iG)(I,k):!1}async function b(){const I=(0,d.Fi)(o.FILTER_CHIP);I.click();const A=await(0,p.xk)(document,o.FILTER_LIST),y=[...(0,d.fI)(o.FILTER_LIST_ITEM,A)].map(W=>{const M=W.getAttribute("data-qa");if(!M)return null;const V=M.replace("reviews_filter_list_item_",""),$=(0,d.Fi)(o.FILTER_TITLE_WRAP,W).textContent.trim(),H=(0,d.Fi)(o.FILTER_COUNT_WRAP,W),G=(0,d.YA)(H,!0),J=U(H.classList);return{category:V,title:$,count:G,bgClassSuffix:J}});return I.click(),y}function U(I){const A=I.value.match(/bg-(\w+)/);return A?A[1]:null}function z(){const{location:I}=window;return`${I.origin}${I.pathname}`}function X(){(0,d.Fi)(o.REVIEWS_CONTAINER).scrollIntoView({behavior:"smooth"})}}},ee={};function Q(F){var E=ee[F];if(E!==void 0)return E.exports;var e=ee[F]={exports:{}};return te[F](e,e.exports,Q),e.exports}(()=>{var F=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",E=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",e=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",l=d=>{d&&d.d<1&&(d.d=1,d.forEach(p=>p.r--),d.forEach(p=>p.r--?p.r++:p()))},o=d=>d.map(p=>{if(p!==null&&typeof p=="object"){if(p[F])return p;if(p.then){var C=[];C.d=0,p.then(s=>{c[E]=s,l(C)},s=>{c[e]=s,l(C)});var c={};return c[F]=s=>s(C),c}}var n={};return n[F]=s=>{},n[E]=p,n});Q.a=(d,p,C)=>{var c;C&&((c=[]).d=-1);var n=new Set,s=d.exports,t,h,v,L=new Promise((g,T)=>{v=T,h=g});L[E]=s,L[F]=g=>(c&&g(c),n.forEach(g),L.catch(T=>{})),d.exports=L,p(g=>{t=o(g);var T,u=()=>t.map(r=>{if(r[e])throw r[e];return r[E]}),i=new Promise(r=>{T=()=>r(u),T.r=0;var m=a=>a!==c&&!n.has(a)&&(n.add(a),a&&!a.d&&(T.r++,a.push(T)));t.map(a=>a[F](m))});return T.r?i:u()},g=>(g?v(L[e]=g):h(s),l(c))),c&&c.d<0&&(c.d=0)}})(),Q.d=(F,E)=>{for(var e in E)Q.o(E,e)&&!Q.o(F,e)&&Object.defineProperty(F,e,{enumerable:!0,get:E[e]})},Q.o=(F,E)=>Object.prototype.hasOwnProperty.call(F,E);var ne=Q(1753)})();})();
