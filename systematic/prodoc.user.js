// ==UserScript==
// @name         Prodoc enhancer
// @description  Hide doctor cards by filter, enhance doctor page
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://prodoctorov.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      2.0.75750712
// @icon         https://www.google.com/s2/favicons?sz=64&domain=prodoctorov.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/prodoc.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var te={5467:(F,E,e)=>{e.d(E,{E2:()=>r});var l=e(9928);function r(h,c={},t=null){const n=(0,l.Sw)(c,t);return n.append(h),n}function d(h,c=null,t={},n={}){const o=createActionLink(h,c,n);return r(o,t)}function f(h,c=null,t=null,n={},o={}){const v=createActionLinkWithIcon(h,t,c,o);return r(v,n)}},9928:(F,E,e)=>{e.d(E,{S:()=>h,Sw:()=>L,d:()=>n,kU:()=>d,o5:()=>f});var l=e(4921),r=e(6754);function d(a,i,p){const u=c(a,"text",i);return u.value=p,u}function f(a,i,p,u,_,S){const y=c(a,"number",i);return y.value=p,y.step=u,y.min=_,y.max=S,y}function h(a,i,p){const u=c(a,"checkbox",i);return u.checked=p,u}function c(a={},i=null,p=null){const u=s("input",a);return i&&(u.type=i),p&&(u.addEventListener("keyup",(0,l.sg)(p,200)),u.addEventListener("change",(0,l.sg)(p,100))),u}function t(a={},i=null){return s("span",a,i)}function n(a={},i=null,p=null){const u=s("a",a,i);return p&&(u.href=p),u}function o(a,i=null,p={}){p.cursor||="pointer";const u=n(p,i);return a&&u.addEventListener("click",a),u}function v(a,i,p=null,u={},_={}){u.display||="inline-flex",u.alignItems||="center",u.gap||="0.25em";const S=o(a,p,u);return S.prepend(N(i,_)),S}function g(a={},i=null,p=null){const u=s("button",a,i);return p&&u.addEventListener("click",p),u}function L(a={},i=null){return s("div",a,i)}function C(a={}){return s("i",a)}function N(a,i={}){i.width||="1em",i.height||="1em",i.paddingBottom||="1px";const p=C(i);return p.setAttribute("data-lucide",a),p}function s(a,i,p=null){if(typeof i!="object"||i===null)throw new TypeError("styles should be an object");const u=document.createElement(a);return(0,r.ZM)(u,i),p&&(u.innerHTML=p),u}},573:(F,E,e)=>{e.d(E,{Fi:()=>d,YA:()=>n,fI:()=>f});var l=e(4214);function r(s,a=document){return!!a.querySelector(s)}function d(s,a=document,i=!1){const p=a.querySelector(s);return i&&!p&&console.log(`No element found for selector: ${s}`),p}function f(s,a=document,i=!1){const p=a.querySelectorAll(s);return i&&!p.length&&console.log(`No elements found for selector: ${s}`),p}function h(s,a=1){let i=s;for(let p=0;p<a;p++){if(!i.parentElement)return null;i=i.parentElement}return i}function c(s,a,i){return[...s.querySelectorAll(a)].find(p=>p.textContent.trim().includes(i))}function t(s,a,i=!1,p=!1,u=null){const _=d(a,s);return n(_,i,p,u)}function n(s,a=!1,i=!1,p=null){if(!s)return p===null?(console.log("No element found"),null):p;const u=s.innerText;return g(u,a,i)}function o(s,a,i=!1){const p=s[a];return n(p,i)}function v(s,a=!1,i=!1){const p=s.textContent;return g(p,a,i)}function g(s,a,i){a&&(s=(0,l.zr)(s)),i&&(s=s.replace(",","."));const p=Number(s);return Number.isNaN(p)?(console.log(`Invalid number: ${s}`),0):p}function L(s){return[...s.childNodes].find(a=>a.nodeType===Node.TEXT_NODE)}function C(s){const a=i=>i.nodeType===Node.TEXT_NODE&&i.textContent.trim()!==""?[i]:[...i.childNodes].flatMap(a);return a(s)}function N(s){return normalizeSpacing(s.textContent)}},5539:(F,E,e)=>{e.d(E,{Bt:()=>r,UC:()=>o,WH:()=>l,kl:()=>t});function l(m,O){m.parentNode.insertBefore(O,m.nextSibling)}function r(m){m.style.display="none"}function d(m,O=1){const A=document.querySelector(m);A&&f(A,O)}function f(m,O=1){const A=getElementAncestor(m,O);A&&r(A)}function h(m){L(m),r(m)}function c(m){m.intersectionObserver||runOnceOnIntersection(m,()=>r(m))}function t(m){m.style.display=""}function n(m){const O=g(m);m.style.display=O}function o(m,O){O?r(m):t(m)}function v(m,O){O?c(m):(clearIntersectionObserver(m),t(m))}function g(m){return L(m),m.defaultDisplay}function L(m){if(m.defaultDisplay)return;const{display:O}=getComputedStyle(m);m.defaultDisplay=O}function C(){return{show:[],hide:[]}}function N(m,O,A){m?O.hide.push(A):O.show.push(A)}function s(m){m.show.forEach(t),m.hide.forEach(r)}function a(m,O,A=.3){O?p(m,A):i(m)}function i(m){m.style.opacity=""}function p(m,O=.3){m.style.opacity=O}function u(m){m.style.order=""}function _(m,O){m.style.order=O}function S(m,O){m.style.background=O}function y(m,O){const A=getFirstElement(O);A&&I(m,A)}function I(m,O){const A=createLink();A.href=m,O.parentNode.append(A),A.append(O)}function R(m,O){const A=getFirstElement(O);A&&w(m,A)}function w(m,O){const A=createLink();A.href=m,A.append(...O.childNodes),O.append(A)}function P(){const m=getURLQueryParam("scrollTo");if(!m)return;const O=document.getElementById(m);O?O.scrollIntoView():console.log(`Element with ID "${m}" was not found.`)}function U(m,O,A="text/plain"){const H=new Blob([m],{type:A}),Q=URL.createObjectURL(H),K=document.createElement("a");K.href=Q,K.download=O,document.body.appendChild(K),K.click(),document.body.removeChild(K),requestAnimationFrame(()=>URL.revokeObjectURL(Q))}},6754:(F,E,e)=>{e.d(E,{ZM:()=>l});function l(h,c){Object.assign(h.style,c)}function r(h,c="custom-global-style"){let t=document.getElementById(c);t||(t=document.createElement("style"),t.id=c,t.type="text/css",document.head.appendChild(t)),t.textContent=h}function d(h){return Object.entries(h).map(([c,t])=>`${c.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${t};`).join(" ")}function f(h){return h?h.split(";").filter(c=>c.trim()!=="").reduce((c,t)=>{const[n,o]=t.split(":").map(g=>g.trim()),v=n.replace(/-([a-z])/g,(g,L)=>L.toUpperCase());return c[v]=o,c},{}):{}}},4921:(F,E,e)=>{e.d(E,{sg:()=>f,xk:()=>l});function l(t,n,o=null){const v=t.querySelector(n);return v?Promise.resolve(v):new Promise(g=>{const L=new MutationObserver(N);L.observe(t,{childList:!0,subtree:!0});let C;o&&(C=setTimeout(()=>{L.disconnect(),console.log(`No element found for selector: ${n}`),g(null)},o));function N(){const s=t.querySelector(n);s&&(C&&clearTimeout(C),L.disconnect(),g(s))}})}function r(t,n){return t.querySelector(n)?new Promise(v=>{const g=new MutationObserver(L);g.observe(t,{childList:!0,subtree:!0});function L(){t.querySelector(n)||(g.disconnect(),v())}}):Promise.resolve()}function d(t,n=400){return new Promise(o=>{let v;const g=new MutationObserver(()=>{clearTimeout(v),L()});function L(){v=setTimeout(()=>{g.disconnect(),o()},n)}L(),g.observe(t,{childList:!0,subtree:!0})})}function f(t,n=250){let o;return(...v)=>{clearTimeout(o),o=setTimeout(()=>t(...v),n)}}function h(t,n){const o=new IntersectionObserver(v=>{v.forEach(g=>{g.isIntersecting&&(n(),c(t))})});t.intersectionObserver=o,o.observe(t)}function c(t){t.intersectionObserver&&(t.intersectionObserver.disconnect(),t.intersectionObserver=null)}},3829:(F,E,e)=>{e.d(E,{Ay:()=>r,JE:()=>f,iG:()=>h});var l=e(8355);function r(t,n){return!d(t,n)}function d(t,n){if(!n.value)return!0;const o=t.toLowerCase(),v=(0,l.R)(n),g=[],L=[];return v.forEach(C=>{if(C.startsWith("!")){const N=C.substring(1);N&&L.push(N)}else g.push(C)}),g.every(C=>o.includes(C))&&L.every(C=>!o.includes(C))}function f(t,n){return n.value!=null&&t<n.value}function h(t,n){return n.value!=null&&t>n.value}function c(t,n){return n.value&&t!==n.value}},4521:(F,E,e)=>{e.d(E,{z:()=>r});var l=e(3048);function r(d,f=null){return{createGlobalFilter(h,c=null,t=d){return l.V.create(h,c,t)},createSectionFilter(h,c=null,t=d){if(!f)throw new Error("sectionId must be provided to use createSectionFilter.");return l.V.createWithCompositeKey(f,h,c,t)}}}},5884:(F,E,e)=>{e.d(E,{Hw:()=>h,Nm:()=>d,nW:()=>f});var l=e(9928),r=e(5467);function d(c,t,n={},o={}){const v=(0,l.kU)(o,t.updateValueFromEvent,t.value);return(0,r.E2)(v,n,c)}function f(c,t,n,o,v,g={},L={}){const C=(0,l.o5)(L,t.updateValueFromEvent,t.value,n,o,v);return(0,r.E2)(C,g,c)}function h(c,t,n={},o={}){const v=(0,l.S)(o,t.updateValueFromEvent,t.value);return(0,r.E2)(v,n,c)}},7877:(F,E,e)=>{e.d(E,{E9:()=>r,FR:()=>f,HX:()=>d,X0:()=>h,pW:()=>y});var l=e(5884);function r(I,R={},w={}){return(0,l.Nm)("\u041F\u043E\u0438\u0441\u043A: ",I,R,w)}function d(I,R={},w={},P=.1,U=3){return(0,l.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",I,P,U,5,R,w)}function f(I,R={},w={},P=.1,U=3){return(0,l.nW)("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",I,P,U,5,R,w)}function h(I,R={},w={}){return t("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",I,R,w)}function c(I,R={},w={}){return t("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",I,R,w)}function t(I,R,w={},P={}){return(0,l.nW)(I,R,"1","1","999999",w,P)}function n(I,R={},w={}){return o("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",I,R,w)}function o(I,R,w={},P={}){return createNumberFilterControl(I,R,"5","0","100",w,P)}function v(I,R={},w={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",I,"5","0","100",R,w)}function g(I,R,w={},P={},U="250"){return createNumberFilterControl(I,R,U,"0","1000000",w,P)}function L(I,R={},w={},P="25"){return g("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",I,R,w,P)}function C(I,R={},w={},P="25"){return g("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",I,R,w,P)}function N(I,R={},w={}){return s("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",I,R,w)}function s(I,R,w={},P={}){return createNumberFilterControl(I,R,"1","0","99999",w,P)}function a(I,R={},w={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",I,"1","2","7",R,w)}function i(I,R={},w={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",I,1,1,10,R,w)}function p(I,R={},w={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",I,R,w)}function u(I,R={},w={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",I,R,w)}function _(I,R={},w={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",I,R,w)}function S(I,R={},w={}){return createCheckboxFilterControl("\u0411\u0430\u043B\u043B\u044B: ",I,R,w)}function y(I,R={},w={}){return(0,l.Hw)("\u0412\u043A\u043B: ",I,R,w)}},8355:(F,E,e)=>{e.d(E,{R:()=>l,f:()=>r});function l(d){return d.value.toLowerCase().split(",").map(f=>f.trim()).filter(f=>f!=="")}function r(d){return l(d).filter(f=>!f.startsWith("!"))}},5213:(F,E,e)=>{e.d(E,{b:()=>d});var l=e(9928),r=e(573);function d(f,h,c=!1,t="customFiltersContainer"){let n=(0,r.Fi)(`#${t}`,f);if(n)if(c)n.remove();else return;n=(0,l.Sw)(),n.id=t,h(n,f)}},8200:(F,E,e)=>{e.d(E,{s:()=>l});function l(r){const{target:d}=r,{type:f}=d;switch(f){case"text":return`"${d.value}"`;case"number":return d.value;case"checkbox":return d.checked;default:return console.log(`Unknown input type: ${f}`),null}}},157:(F,E,e)=>{e.d(E,{Fg:()=>l,vx:()=>d});const l=window.GM_setValue,r=window.GM.setValue,d=window.GM_getValue},1870:(F,E,e)=>{e.d(E,{j:()=>l});class l{constructor(d,f){this.value=d,this.onChange=f}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(F,E,e)=>{e.d(E,{V:()=>h});var l=e(1870),r=e(8200),d=e(3976),f=e(157);class h extends l.j{constructor(t,n=null,o=null){super((0,f.vx)(t,n),o),this.storageKey=t,this.defaultValue=n}static create(t,n=null,o=null){return new h(t,n,o)}static createWithCompositeKey(t,n,o=null,v=null){const g=`${t}-${n}`;return new h(g,o,v)}updateValueFromEvent=t=>{const n=(0,r.s)(t),o=(0,d.$)(n);this.updateValue(o)};updateValue(t,n=!0){this.value!==t&&((0,f.Fg)(this.storageKey,t),this.value=t,n&&this.onChangeIfDefined())}clearValue(t=!1){this.updateValue(null,t)}resetValue(t=!1){this.updateValue(this.defaultValue,t)}}},3976:(F,E,e)=>{e.d(E,{$:()=>l});function l(r){return r===""?null:JSON.parse(r)}},4214:(F,E,e)=>{e.d(E,{$z:()=>l,zr:()=>r});function l(c){return c.replace(/\D/g,"")}function r(c){return c.replace(/[^\d.,-]/g,"")}function d(c){return c.replace(/\s/g,"")}function f(c){return c.charAt(0).toUpperCase()+c.slice(1)}function h(c){return c.replace(/\s+/g," ").trim()}},5406:(F,E,e)=>{e.d(E,{$F:()=>c,Fc:()=>l,bn:()=>r,z2:()=>v});function l(N,s="common",a=!1){const{pathname:i}=window.location;return r(i,N,s,a)}function r(N,s,a,i=!1){const p=N.split("/");s=s<0?p.length+s:s;const u=p[s]||a;return i&&console.log(`Pathname element: ${u}`),u}function d(N,s="common",a=!1){const i=l(N,"",a);return f(i,s,a)}function f(N,s,a){if(!N)return s;const i=N.split("-").at(-1);return a&&console.log(`Pathname element ending: ${i}`),i}function h(N,s,a="common",i=!1){const p=r(N,s,"",i);return f(p,a,i)}function c(N){return new URLSearchParams(window.location.search).get(N)}function t(N){return N.split("?")[0]}function n(N){return window.location.pathname.includes(N)}function o(N){return N.some(s=>n(s))}function v(N){return window.location.pathname.split("/").some(a=>a===N)}function g(N){try{const s=new URL(window.location.href);Object.entries(N).forEach(([a,i])=>{s.searchParams.set(a,i)}),window.location.href=s.toString()}catch(s){console.error("Failed to redirect:",s)}}function L(N,s=[]){const a={pathname:window.location.pathname};s.forEach(u=>{a[u]=c(u)});function i(){const u={pathname:window.location.pathname};s.forEach(_=>{u[_]=c(_)}),Object.keys(a).some(_=>a[_]!==u[_])&&N()}let p=window.location.href;setInterval(()=>{window.location.href!==p&&(p=window.location.href,i())},200),window.addEventListener("popstate",i)}function C(N=[]){L(()=>window.location.reload(),N)}},2524:(F,E,e)=>{e.d(E,{d5:()=>d,vX:()=>t,ft:()=>f});var l=e(157);class r{constructor(v=Date.now(),g=[]){this.lastCheckDate=v,this.reviewsData=g}updateLastCheckDate=()=>{this.lastCheckDate=Date.now()};static fromObject(v){const{lastCheckDate:g,reviewsData:L}=v;return new r(g,L)}}const d={LAST_DOCTOR_UPDATE:"last-doctor-update"};function f(o,v){const g=h(o),L=(0,l.vx)(g),C=c(L);C.reviewsData=v,C.updateLastCheckDate(),(0,l.Fg)(g,C),(0,l.Fg)(d.LAST_DOCTOR_UPDATE,Date.now())}function h(o){return`doctor-${o}`}function c(o){return o?r.fromObject(o):new r}function t(o){return n(o)?.reviewsData??null}function n(o){const v=h(o);return(0,l.vx)(v)}},1753:(F,E,e)=>{e.a(F,async(l,r)=>{try{var d=e(573),f=e(7858),h=e(4231),c=e(5406),t=e(5072);const o=(0,d.Fi)(".appointments_page");o?(0,h.$)(o):(0,c.z2)("otzivi")?await(0,t.N)():(0,c.z2)("vrach")&&(0,f.O)(),r()}catch(n){r(n)}},1)},7653:(F,E,e)=>{e.d(E,{NI:()=>o,z1:()=>L,Np:()=>a,pR:()=>C,sp:()=>p,rd:()=>i});var l=e(9928),r=e(573);const d={DOCTOR_CARD_NAME:'.b-doctor-intro__title-first-line [itemprop="name"]',DOCTOR_INTRO_LEFT:".b-doctor-intro__left-side",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]'};var f=e(8586),h=e(5406),c=e(4214);const t="additionalLinksAppended",n=["\u042F\u043D\u0434\u0435\u043A\u0441","\u041D\u0430\u041F\u043E\u043F\u0440\u0430\u0432\u043A\u0443","DocDoc","\u0414\u043E\u043A\u0442\u0443"];function o(u,_){_.classList.contains(t)||(n.forEach(S=>{v(u,_,S)}),_.classList.add(t))}function v(u,_,S){const y=g(u,S),I=(0,l.d)({},S,y),R=document.createElement("br");_.append(R,I)}function g(u,_){const S=`${u} ${_}`;return`https://www.google.com/search?q=${encodeURIComponent(S)}&btnI`}function L(){const u=(0,r.Fi)(d.DOCTOR_CARD_NAME,document,!0);if(!u)return;const _=u.innerText.trim(),S=(0,l.Sw)();S.style.textAlign="center",(0,r.Fi)(d.DOCTOR_INTRO_LEFT).append(S),o(_,S)}function C(u,_,S=!1){const y=(0,l.Sw)(f.r.REVIEWS_INFO);S&&(y.style.justifyContent="center"),y.classList.add("v-application");const I=(0,l.Sw)(f.r.REVIEWS_INFO_BLOCK);return I.style.height=S?"10px":"23px",I.append(y),u.slice(S?1:0).forEach(R=>{const{category:w,title:P,count:U,bgClassSuffix:m}=R,O=`${_}?rates_category=${w}`,A=S?U:`${P} ${U}`,H=(0,l.d)(f.r.REVIEW_INFO,A,O);H.classList=N(m),y.append(H),S&&s(H,P)}),I}function N(u){return`text-caption text--text px-2 py-1 rounded-sm bg-${u}`}function s(u,_){let S=null;u.addEventListener("mouseenter",()=>{S=(0,l.Sw)(f.r.REVIEW_INFO_TOOLTIP,_),document.body.appendChild(S);const y=u.getBoundingClientRect();S.style.left=`${(y.left+y.right)/2-S.offsetWidth/2+window.scrollX+2}px`,S.style.top=`${y.top+window.scrollY-S.offsetHeight-4}px`}),u.addEventListener("mouseleave",()=>{S&&(S.remove(),S=null)})}function a(u){const _=(0,r.Fi)(d.NAME_SPAN_HOLDER,document,!0);if(!_)return;const S=(0,r.Fi)(d.NAME_SPAN,_,!0);S&&S.append(u)}function i(){const u=(0,h.Fc)(3,"unknown");return(0,c.$z)(u)}function p(u){const _=(0,h.bn)(u,5,"");return(0,c.$z)(_)}},8586:(F,E,e)=>{e.d(E,{r:()=>r});const l={INPUT:{border:"1px solid #c7d3d9",borderRadius:"10px",padding:"7px 14px",marginLeft:"6px"}},r={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",flexFlow:"wrap"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...l.INPUT,width:"195px"},NUMBER_INPUT:{...l.INPUT,width:"70px"},CHECKBOX_INPUT:{...l.INPUT,width:"20px",height:"20px"},REVIEWS_INFO:{gridGap:"6px"},REVIEWS_INFO_BLOCK:{marginTop:"5px"},REVIEW_INFO:{textDecoration:"none",flexShrink:0},REVIEW_INFO_TOOLTIP:{position:"absolute",backgroundColor:"#333",color:"#fff",padding:"4px 8px",borderRadius:"8px",fontSize:"12px",zIndex:"1000",pointerEvents:"none",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"}}},4231:(F,E,e)=>{e.d(E,{$:()=>P});var l=e(5406),r=e(573),d=e(5539),f=e(3829),h=e(7653),c=e(5213),t=e(5884),n=e(7877);const o={LIST_HEADER:".h2_rating",DOCTOR_FILTERS:".vue-the-doctors-filters > .b-container",DOCTOR_CARD:".b-doctor-card",DOCTOR_CARD_NAME:".b-doctor-card__name-surname",PROFILE_CARD:".b-profile-card",REVIEWS_LINK:":scope > a",EXPERIENCE_WRAP:".b-doctor-card__experience .mr-2 .text-subtitle-1",SPEC_WRAP:".b-doctor-card__spec",CLINIC_CONTAINER:"div.b-doctor-card__lpu-select",CLINIC_WRAP:".b-select__trigger-main-text"};var v=e(4521),g=e(2524),L=e(4921),C=e(8586),N=e(6754);const s=window.GM_addValueChangeListener,a=(0,l.Fc)(2),{createGlobalFilter:i,createSectionFilter:p}=(0,v.z)(O,a),u=p("spec-filter"),_=p("clinic-filter"),S=p("min-reviews-filter",10),y=p("min-experience-filter",5,J),I=p("max-experience-filter",40),R=i("filter-enabled",!0),w={doctorCardsCache:new WeakMap};function P(D){J(),U();const B=(0,r.Fi)(o.DOCTOR_FILTERS);(0,c.b)(B,m),O(),s(g.d5.LAST_DOCTOR_UPDATE,O),new MutationObserver((0,L.sg)(O)).observe(D,{childList:!0})}function U(){const D=(0,r.Fi)(o.LIST_HEADER);D&&D.remove()}function m(D,B){(0,N.ZM)(D,C.r.FILTERS_CONTAINER),D.style.marginTop="6px";const z=(0,t.Nm)("\u0421\u043F\u0435\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F:",u,C.r.CONTROL,C.r.TEXT_INPUT),X=(0,t.Nm)("\u041A\u043B\u0438\u043D\u0438\u043A\u0430:",_,C.r.CONTROL,C.r.TEXT_INPUT),T=(0,n.X0)(S,C.r.CONTROL,C.r.NUMBER_INPUT),b=(0,t.nW)("\u041C\u0438\u043D. \u043E\u043F\u044B\u0442: ",y,"1","0","100",C.r.CONTROL,C.r.NUMBER_INPUT),x=(0,t.nW)("\u041C\u0430\u043A\u0441. \u043E\u043F\u044B\u0442: ",I,"1","0","100",C.r.CONTROL,C.r.NUMBER_INPUT),W=(0,n.pW)(R,C.r.CONTROL,C.r.CHECKBOX_INPUT);D.append(z,X,T,b,x,W),B.append(D)}function O(){(0,r.fI)(o.DOCTOR_CARD).forEach(A)}function A(D){if(!R.value){(0,d.kl)(D);return}let B=w.doctorCardsCache.get(D);if(!B){const X=(0,r.Fi)(o.PROFILE_CARD,D),T=(0,r.Fi)(o.REVIEWS_LINK,X),b=(0,r.Fi)(o.EXPERIENCE_WRAP,D);if(!T||!b){(0,d.Bt)(D);return}const W=(0,r.Fi)(o.SPEC_WRAP,D,!0).innerText.trim(),M=(0,r.Fi)(o.CLINIC_CONTAINER,D,!0),k=(0,r.Fi)(o.CLINIC_WRAP,M,!0).innerText.trim(),V=(0,r.YA)(T,!0),G=(0,r.YA)(b,!0),Y=H(T);T.href=Y,(0,h.NI)(Q(D),X),B={specInfo:W,clinicName:k,reviewsLinkNumber:V,experienceNumber:G,reviewsLink:T,reviewInfoAppended:!1},w.doctorCardsCache.set(D,B)}K(B);const z=(0,f.Ay)(B.specInfo,u)||(0,f.Ay)(B.clinicName,_)||(0,f.JE)(B.reviewsLinkNumber,S)||(0,f.JE)(B.experienceNumber,y)||(0,f.iG)(B.experienceNumber,I);(0,d.UC)(D,z)}function H(D){return D.href.replace(/\/#otzivi$/,"/otzivi/")}function Q(D){return(0,r.Fi)(o.DOCTOR_CARD_NAME,D,!0).innerText}function K(D){if(D.reviewInfoAppended)return;const{reviewsLink:B}=D,z=B.href,X=(0,g.vX)((0,h.sp)(z));if(!X)return;const T=(0,h.pR)(X,z,!0);(0,d.WH)(B,T),D.reviewInfoAppended=!0}function J(){if(!y.value)return;const D=new URL(window.location.href);+D.searchParams.get("experience")!==y.value&&(D.searchParams.set("experience",y.value),window.location.href=D.toString())}},7858:(F,E,e)=>{e.d(E,{O:()=>c});var l=e(573),r=e(9928),d=e(7653);const f={REVIEWS_LINK:".b-doctor-intro__rates-wrapper > a",DOCTOR_DETAILS:".b-doctor-details__toc",REVIEWS_FILTER:".reviews-filter:not(.b-reviews-page__filter)",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]',REVIEWS_FILTER_SPAN:":scope > span",DOCTOR_CONTACTS:"#doctor-contacts"};var h=e(2524);function c(){(0,d.z1)(),n();const v=t();o(v);const g=(0,h.vX)((0,d.rd)());if(!g)return;const L=(0,d.pR)(g,v);(0,d.Np)(L)}function t(){const{location:v}=window;return`${v.origin}${v.pathname}otzivi/`}function n(){if(!(0,l.Fi)(f.DOCTOR_CONTACTS))return;const g=[...(0,l.fI)(f.DOCTOR_DETAILS)].pop();if(!g)return;g.style.position="sticky",g.style.top="16px";const L=(0,r.Sw)({},"\u041C\u0435\u0441\u0442\u043E \u0440\u0430\u0431\u043E\u0442\u044B");L.classList.add("b-doctor-details__toc-title");const C=(0,r.d)({},null,"#doctor-contacts");C.classList.add("b-doctor-details__toc-item"),C.append(L),g.insertBefore(C,g.firstChild)}function o(v){const g=(0,l.Fi)(f.REVIEWS_LINK);g&&(g.href=v)}},5072:(F,E,e)=>{e.d(E,{N:()=>A});var l=e(7653);const r={CONTROLS_CONTAINER:".vue-review-filter",REVIEWS:".b-review-card",REVIEW_TEXT_WRAP:".b-review-card__comment",REVIEW_RATING_WRAP:".review-card-tooltips__stars > .ui-text",FILTER_CHIP:'[data-qa="reviews_filter_chip"]',FILTER_LIST:'[data-qa="reviews_filter_list"]',FILTER_LIST_ITEM:'[data-qa^="reviews_filter_list_item"]',FILTER_TITLE_WRAP:'[data-qa="reviews_filter_title"]',FILTER_COUNT_WRAP:'[data-qa="reviews_filter_amount"]',REVIEWS_CONTAINER:"#otzivi"};var d=e(573),f=e(4921),h=e(5406),c=e(2524),t=e(4521),n=e(5213),o=e(8586),v=e(7877),g=e(5539);function L(T,b){T.forEach(x=>C(b,x))}function C(T,b){if(!b)return;const x=new RegExp(`(${b})`,"gi"),W=document.createTreeWalker(T,NodeFilter.SHOW_TEXT,null);let M=W.nextNode();const $=[];for(;M;){const{textContent:k}=M;if(x.test(k)){const V=document.createDocumentFragment();let G=0;k.replace(x,(Y,re,q)=>{q>G&&V.appendChild(document.createTextNode(k.slice(G,q)));const Z=document.createElement("span");Z.className="highlightedSubstring",Z.style.backgroundColor="yellow",Z.textContent=Y,V.appendChild(Z),G=q+Y.length}),G<k.length&&V.appendChild(document.createTextNode(k.slice(G))),$.push({node:M,fragment:V})}M=W.nextNode()}$.forEach(({node:k,fragment:V})=>{k.parentNode.replaceChild(V,k)})}function N(T){(0,d.fI)(".highlightedSubstring",T).forEach(x=>{const{parentNode:W}=x;x.replaceWith(x.textContent),W.normalize()})}var s=e(8355);function a(T,b){const x=(0,s.f)(T);L(x,b)}function i(T,b){const x=getIncludedSearchStrings(T);b.forEach(W=>highlightSubstrings(x,W))}var p=e(3829),u=e(9928);function _(T={}){return(0,u.Sw)(T,"|")}function S(T={},b=75,x="customFiltersContainer"){const W=document.getElementById(x);if(!W)return console.log(`Element with id="${x}" not found.`),null;const M=createButton(T,`${arrowUpIcon}\u041A \u0444\u0438\u043B\u044C\u0442\u0440\u0430\u043C`);return M.addEventListener("mouseenter",()=>{M.style.filter="brightness(0.9)"}),M.addEventListener("mouseleave",()=>{M.style.filter="brightness(1)"}),M.addEventListener("click",()=>{const $=W.getBoundingClientRect();window.scrollTo({top:$.top+window.scrollY-b})}),new IntersectionObserver(([$])=>{M.style.display=$.isIntersecting?"none":"flex"},{threshold:.5}).observe(W),M}function y(T,b={}){const x=S(b);x&&T.appendChild(x)}var I=e(6754);const{createGlobalFilter:R}=(0,t.z)(Q),w=R("reviews-text-filter"),P=R("reviews-min-rating-filter"),U=R("reviews-max-rating-filter"),m=R("reviews-filter-enabled",!0),O={reviewCardsCache:new Map};async function A(){(0,l.z1)();const T=await(0,f.xk)(document,r.CONTROLS_CONTAINER);(0,n.b)(T,H),Q();const b=await D();(0,c.ft)((0,l.rd)(),b);const x=(0,l.pR)(b,z());(0,l.Np)(x),(0,h.$F)("rates_category")&&X()}function H(T,b){(0,I.ZM)(T,o.r.FILTERS_CONTAINER),T.style.marginTop="12px";const x=(0,v.E9)(w,o.r.CONTROL,o.r.TEXT_INPUT),W=(0,v.HX)(P,o.r.CONTROL,o.r.NUMBER_INPUT,1,1),M=(0,v.FR)(U,o.r.CONTROL,o.r.NUMBER_INPUT,1,1),$=_(o.r.CONTROL),k=(0,v.pW)(m,o.r.CONTROL,o.r.CHECKBOX_INPUT);T.append(x,W,M,$,k),b.append(T)}function Q(){(0,d.fI)(r.REVIEWS).forEach(K)}function K(T){if(!m.value){(0,g.kl)(T);return}N(T);let b=O.reviewCardsCache.get(T);if(!b){const W=(0,d.Fi)(r.REVIEW_TEXT_WRAP,T),M=(0,d.Fi)(r.REVIEW_RATING_WRAP,T);if(!W){(0,g.Bt)(T);return}b={reviewTextWrap:W,reviewText:W.innerText,rating:M&&(0,d.YA)(M)},O.reviewCardsCache.set(T,b)}w.value&&a(w,b.reviewTextWrap);const x=(0,p.Ay)(b.reviewText,w)||J(b.rating);(0,g.UC)(T,x)}function J(T){return T?(0,p.JE)(T,P)||(0,p.iG)(T,U):!1}async function D(){const T=(0,d.Fi)(r.FILTER_CHIP);T.click();const b=await(0,f.xk)(document,r.FILTER_LIST),x=[...(0,d.fI)(r.FILTER_LIST_ITEM,b)].map(W=>{const M=W.getAttribute("data-qa");if(!M)return null;const $=M.replace("reviews_filter_list_item_",""),k=(0,d.Fi)(r.FILTER_TITLE_WRAP,W).textContent.trim(),V=(0,d.Fi)(r.FILTER_COUNT_WRAP,W),G=(0,d.YA)(V,!0),Y=B(V.classList);return{category:$,title:k,count:G,bgClassSuffix:Y}});return T.click(),x}function B(T){const b=T.value.match(/bg-(\w+)/);return b?b[1]:null}function z(){const{location:T}=window;return`${T.origin}${T.pathname}`}function X(){(0,d.Fi)(r.REVIEWS_CONTAINER).scrollIntoView({behavior:"smooth"})}}},ee={};function j(F){var E=ee[F];if(E!==void 0)return E.exports;var e=ee[F]={exports:{}};return te[F](e,e.exports,j),e.exports}(()=>{var F=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",E=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",e=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",l=d=>{d&&d.d<1&&(d.d=1,d.forEach(f=>f.r--),d.forEach(f=>f.r--?f.r++:f()))},r=d=>d.map(f=>{if(f!==null&&typeof f=="object"){if(f[F])return f;if(f.then){var h=[];h.d=0,f.then(n=>{c[E]=n,l(h)},n=>{c[e]=n,l(h)});var c={};return c[F]=n=>n(h),c}}var t={};return t[F]=n=>{},t[E]=f,t});j.a=(d,f,h)=>{var c;h&&((c=[]).d=-1);var t=new Set,n=d.exports,o,v,g,L=new Promise((C,N)=>{g=N,v=C});L[E]=n,L[F]=C=>(c&&C(c),t.forEach(C),L.catch(N=>{})),d.exports=L,f(C=>{o=r(C);var N,s=()=>o.map(i=>{if(i[e])throw i[e];return i[E]}),a=new Promise(i=>{N=()=>i(s),N.r=0;var p=u=>u!==c&&!t.has(u)&&(t.add(u),u&&!u.d&&(N.r++,u.push(N)));o.map(u=>u[F](p))});return N.r?a:s()},C=>(C?g(L[e]=C):v(n),l(c))),c&&c.d<0&&(c.d=0)}})(),j.d=(F,E)=>{for(var e in E)j.o(E,e)&&!j.o(F,e)&&Object.defineProperty(F,e,{enumerable:!0,get:E[e]})},j.o=(F,E)=>Object.prototype.hasOwnProperty.call(F,E);var ne=j(1753)})();})();
