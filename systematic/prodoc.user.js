// ==UserScript==
// @name         Prodoc enhancer
// @description  Hide doctor cards by filter, enhance doctor page
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://prodoctorov.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      2.0.77101971
// @icon         https://www.google.com/s2/favicons?sz=64&domain=prodoctorov.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/prodoc.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var te={8738:(b,v,n)=>{n.d(v,{d:()=>u});var d=n(5558);function u(e={},i=null,r=null){const t=(0,d.n)("a",e,i);return r&&(t.href=r),t}function s(e,i=null,r={}){r.cursor||="pointer";const t=u(r,i);return e&&t.addEventListener("click",e),t}function f(e,i,r=null,t={},E={}){t.display||="inline-flex",t.alignItems||="center",t.gap||="0.25em";const F=s(e,r,t);return F.prepend(createLucideIcon(i,E)),F}function h(e,i,r,t=null,E={},F={},c="userscript-control"){const g=A=>{A.stopPropagation(),A.preventDefault(),window.confirm(r)&&e()},C=t?`<span>${t}</span>`:null,T=f(g,i,C,E,F);return T.classList.add(c),T}function l(e,i,r={},t={}){return h(e,ThumbsDown,"\u0412\u044B\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u043D\u0438\u0437\u043A\u0438\u0439 \u0440\u0435\u0439\u0442\u0438\u043D\u0433?",i?"\u0414\u0438\u0437\u043B\u0430\u0439\u043A":null,r,t)}function a(e,i,r={},t={}){return h(e,RotateCcw,"\u0423\u0431\u0440\u0430\u0442\u044C \u043D\u0438\u0437\u043A\u0438\u0439 \u0440\u0435\u0439\u0442\u0438\u043D\u0433?",i?"\u0423\u0431\u0440\u0430\u0442\u044C \u0434\u0438\u0437\u043B\u0430\u0439\u043A":null,r,t)}function m(e={},i=null,r=null){const t=createElement("button",e,i);return r&&t.addEventListener("click",r),t}},7273:(b,v,n)=>{n.d(v,{S:()=>s});var d=n(5558);function u(f={},h=null){return createElement("span",f,h)}function s(f={},h=null){return(0,d.n)("div",f,h)}},5467:(b,v,n)=>{n.d(v,{E2:()=>u});var d=n(7273);function u(h,l={},a=null){const m=(0,d.S)(l,a);return m.append(h),m}function s(h,l=null,a={},m={}){const e=createActionLink(h,l,m);return u(e,a)}function f(h,l=null,a=null,m={},e={},i={}){const r=createActionLinkWithIcon(h,a,l,e,i);return u(r,m)}},5558:(b,v,n)=>{n.d(v,{n:()=>u});var d=n(6754);function u(s,f,h=null){if(typeof f!="object"||f===null)throw new TypeError("styles should be an object");const l=document.createElement(s);return(0,d.ZM)(l,f),h&&(l.innerHTML=h),l}},740:(b,v,n)=>{n.d(v,{S:()=>l,kU:()=>s,o5:()=>f});var d=n(5558),u=n(4921);function s(e,i,r){const t=a(e,"text",i);return t.value=r,t}function f(e,i,r,t,E,F){const c=a(e,"number",i);return c.value=r,c.step=t,c.min=E,c.max=F,c}function h(e,i,r){const t=a(e,"date",i);return t.value=r,t}function l(e,i,r){const t=a(e,"checkbox",i);return t.checked=r,t}function a(e={},i=null,r=null){const t=(0,d.n)("input",e);return i&&(t.type=i),r&&(t.addEventListener("keyup",(0,u.sg)(r,200)),t.addEventListener("change",(0,u.sg)(r,100))),t}function m(e,i,r){const t=createElement("select",e);return i&&t.addEventListener("change",i),t.value=r,t}},573:(b,v,n)=>{n.d(v,{Fi:()=>s,YA:()=>m,fI:()=>f});var d=n(4214);function u(c,g=document){return!!g.querySelector(c)}function s(c,g=document,C=!1){const T=g.querySelector(c);return C&&!T&&console.log(`No element found for selector: ${c}`),T}function f(c,g=document,C=!1){const T=g.querySelectorAll(c);return C&&!T.length&&console.log(`No elements found for selector: ${c}`),T}function h(c,g=1){let C=c;for(let T=0;T<g;T++){if(!C.parentElement)return null;C=C.parentElement}return C}function l(c,g,C){return[...c.querySelectorAll(g)].find(T=>T.textContent.trim().includes(C))}function a(c,g,C=!1,T=!1,A=null){const S=s(g,c);return m(S,C,T,A)}function m(c,g=!1,C=!1,T=null){if(!c)return T===null?(console.log("No element found"),null):T;const A=c.innerText;return r(A,g,C)}function e(c,g,C=!1){const T=c[g];return m(T,C)}function i(c,g=!1,C=!1){const T=c.textContent;return r(T,g,C)}function r(c,g,C){g&&(c=(0,d.zr)(c)),C&&(c=c.replace(",","."));const T=Number(c);return Number.isNaN(T)?(console.log(`Invalid number: ${c}`),0):T}function t(c){return[...c.childNodes].find(g=>g.nodeType===Node.TEXT_NODE)}function E(c){const g=C=>C.nodeType===Node.TEXT_NODE&&C.textContent.trim()!==""?[C]:[...C.childNodes].flatMap(g);return g(c)}function F(c){return normalizeSpacing(c.textContent)}},5539:(b,v,n)=>{n.d(v,{Bt:()=>u,UC:()=>i,WH:()=>d,kl:()=>m});function d(o,R){o.parentNode.insertBefore(R,o.nextSibling)}function u(o){o.style.display="none"}function s(o,R=1){const D=document.querySelector(o);D&&f(D,R)}function f(o,R=1){const D=getElementAncestor(o,R);D&&u(D)}function h(o,R,D){const p=findElementByText(o,R,D);p&&u(p)}function l(o){E(o),u(o)}function a(o){o.intersectionObserver||runOnceOnIntersection(o,()=>u(o))}function m(o){o.style.display=""}function e(o){const R=t(o);o.style.display=R}function i(o,R){R?u(o):m(o)}function r(o,R){R?a(o):(clearIntersectionObserver(o),m(o))}function t(o){return E(o),o.dataset.defaultDisplay}function E(o){if(o.dataset.defaultDisplay)return;const{display:R}=getComputedStyle(o);o.dataset.defaultDisplay=R}function F(){return{show:[],hide:[]}}function c(o,R,D){o?R.hide.push(D):R.show.push(D)}function g(o){o.show.forEach(m),o.hide.forEach(u)}function C(o,R,D=.3){R?A(o,D):T(o)}function T(o){o.style.opacity=""}function A(o,R=.3){o.style.opacity=R}function S(o){o.style.order=""}function x(o,R){o.style.order=R}function O(o,R,D,p="inline-flex"){R.style.display=o?p:"none",D.style.display=o?"none":p}function P(o,R=.3){o.style.transition="opacity 0.3s",o.style.opacity=R,I(o)}function U(o){o.style.opacity="",L(o)}function $(o){o.style.animation="loading-pulse 2.5s ease-in-out infinite",I(o)}function w(o){o.style.animation="",L(o)}function I(o){o.style.pointerEvents="none",o.style.cursor="wait"}function L(o){o.style.pointerEvents="",o.style.cursor=""}function W(o,R){const D=getFirstElement(R);D&&k(o,D)}function k(o,R){const D=createLink();D.href=o,R.parentNode.append(D),D.append(R)}function G(o,R){const D=getFirstElement(R);D&&K(o,D)}function K(o,R,D={}){const p=createLink(D);p.href=o,p.append(...R.childNodes),R.append(p)}function Y(){const o=getURLQueryParam("scrollTo");if(!o)return;const R=document.getElementById(o);R?R.scrollIntoView():console.log(`Element with ID "${o}" was not found.`)}function j(o,R,D=null){const p=`${R}-click-passed`,_=D?y=>findElementByText(y,o,D):y=>getFirstElement(o,y);return function(y){if(y.hasAttribute(p))return!1;const B=_(y);return B&&B.click(),y.setAttribute(p,""),!0}}function N(o,R,D="text/plain"){const p=new Blob([o],{type:D}),_=URL.createObjectURL(p),y=document.createElement("a");y.href=_,y.download=R,document.body.appendChild(y),y.click(),document.body.removeChild(y),requestAnimationFrame(()=>URL.revokeObjectURL(_))}},6754:(b,v,n)=>{n.d(v,{ZM:()=>d});function d(h,l){Object.assign(h.style,l)}function u(h,l="custom-global-style"){let a=document.getElementById(l);a||(a=document.createElement("style"),a.id=l,a.type="text/css",document.head.appendChild(a)),a.textContent=h}function s(h){return Object.entries(h).map(([l,a])=>`${l.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${a};`).join(" ")}function f(h){return h?h.split(";").filter(l=>l.trim()!=="").reduce((l,a)=>{const[m,e]=a.split(":").map(r=>r.trim()),i=m.replace(/-([a-z])/g,(r,t)=>t.toUpperCase());return l[i]=e,l},{}):{}}},4921:(b,v,n)=>{n.d(v,{sg:()=>f,xk:()=>d});function d(e,i,r=null){const t=e.querySelector(i);return t?Promise.resolve(t):new Promise(E=>{const F=new MutationObserver(g);F.observe(e,{childList:!0,subtree:!0});let c;r&&(c=setTimeout(()=>{F.disconnect(),console.log(`No element found for selector: ${i}`),E(null)},r));function g(){const C=e.querySelector(i);C&&(c&&clearTimeout(c),F.disconnect(),E(C))}})}function u(e,i){return e.querySelector(i)?new Promise(t=>{const E=new MutationObserver(F);E.observe(e,{childList:!0,subtree:!0});function F(){e.querySelector(i)||(E.disconnect(),t())}}):Promise.resolve()}function s(e,i=400){return new Promise(r=>{let t;const E=new MutationObserver(()=>{clearTimeout(t),F()});function F(){t=setTimeout(()=>{E.disconnect(),r()},i)}F(),E.observe(e,{childList:!0,subtree:!0})})}function f(e,i=250){let r;return function(...t){const E=this;clearTimeout(r),r=setTimeout(()=>e.apply(E,t),i)}}async function h(e){document.visibilityState==="visible"?await e():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await e()},{once:!0})}function l(e,i){const r=new IntersectionObserver(t=>{t.forEach(E=>{E.isIntersecting&&(i(),a(e))})});e.intersectionObserver=r,r.observe(e)}function a(e){e.intersectionObserver&&(e.intersectionObserver.disconnect(),e.intersectionObserver=null)}function m(e){e&&(e.disconnect(),e=null)}},3829:(b,v,n)=>{n.d(v,{Ay:()=>u,JE:()=>l,iG:()=>a});var d=n(8355);function u(r,t){return!s(r,t)}function s(r,t){if(!t||!t.value)return!0;const E=(0,d._7)(t.value);return f(r,E)}function f(r,t){if(!t||!t.length)return!0;const E=(r||"").toLowerCase();return t.every(F=>h(E,F))}function h(r,t){return t.some(({term:E,isNegative:F})=>{const c=r.includes(E);return F?!c:c})}function l(r,t){return t.value!=null&&r<t.value}function a(r,t){return t.value!=null&&r>t.value}function m(r,t){return t.value==null?!1:r<parseDateFromISO(t.value)}function e(r,t){return t.value==null?!1:r>parseDateFromISO(t.value)}function i(r,t){return t.value&&r!==t.value}},4521:(b,v,n)=>{n.d(v,{z:()=>u});var d=n(3048);function u(s,f=null){return{createGlobalFilter(h,l=null,a=s){return d.V.create(h,l,a)},createSectionFilter(h,l=null,a=s){if(!f)throw new Error("sectionId must be provided to use createSectionFilter.");return d.V.createWithCompositeKey(f,h,l,a)}}}},5884:(b,v,n)=>{n.d(v,{Hw:()=>a,Nm:()=>s,nW:()=>f});var d=n(5467),u=n(740);function s(m,e,i={},r={}){const t=(0,u.kU)(r,e.updateValueFromEvent,e.value);return(0,d.E2)(t,i,m)}function f(m,e,i,r,t,E={},F={}){const c=(0,u.o5)(F,e.updateValueFromEvent,e.value,i,r,t);return(0,d.E2)(c,E,m)}function h(m,e,i={},r={}){const t=createSelect(r,e.updateValueFromEvent,e.value);return createControl(t,i,m)}function l(m,e,i={},r={}){const t=createDateInput(r,e.updateValueFromEvent,e.value);return createControl(t,i,m)}function a(m,e,i={},r={}){const t=(0,u.S)(r,e.updateValueFromEvent,e.value);return(0,d.E2)(t,i,m)}},7877:(b,v,n)=>{n.d(v,{E9:()=>u,FR:()=>f,HX:()=>s,X0:()=>h,pW:()=>U});var d=n(5884);function u(w,I={},L={}){return(0,d.Nm)("\u041F\u043E\u0438\u0441\u043A: ",w,I,L)}function s(w,I={},L={},W=.1,k=3){return(0,d.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",w,W,k,5,I,L)}function f(w,I={},L={},W=.1,k=3){return(0,d.nW)("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",w,W,k,5,I,L)}function h(w,I={},L={}){return a("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",w,I,L)}function l(w,I={},L={}){return a("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",w,I,L)}function a(w,I,L={},W={}){return(0,d.nW)(w,I,"1","1","999999",L,W)}function m(w,I={},L={}){return createDateFilterControl("\u041C\u0438\u043D. \u0434\u0430\u0442\u0430: ",w,I,L)}function e(w,I={},L={}){return i("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",w,I,L)}function i(w,I,L={},W={}){return createNumberFilterControl(w,I,"5","0","100",L,W)}function r(w,I={},L={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",w,"5","0","100",I,L)}function t(w,I,L={},W={},k="250"){return createNumberFilterControl(w,I,k,"0","1000000",L,W)}function E(w,I={},L={},W="25"){return t("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",w,I,L,W)}function F(w,I={},L={},W="25"){return t("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",w,I,L,W)}function c(w,I={},L={}){return g("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",w,I,L)}function g(w,I,L={},W={}){return createNumberFilterControl(w,I,"1","0","99999",L,W)}function C(w,I={},L={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",w,"1","2","8",I,L)}function T(w,I={},L={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",w,1,1,10,I,L)}function A(w,I={},L={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",w,I,L)}function S(w,I={},L={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",w,I,L)}function x(w,I={},L={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",w,I,L)}function O(w,I={},L={}){return createCheckboxFilterControl("\u0411\u043E\u043D\u0443\u0441: ",w,I,L)}function P(w,I={},L={}){return createCheckboxFilterControl("\u0412 \u043D\u0430\u043B\u0438\u0447\u0438\u0438: ",w,I,L)}function U(w,I={},L={}){return(0,d.Hw)("\u0412\u043A\u043B: ",w,I,L)}function $(w,I,L={}){const W=[{value:-25,emoji:"\u{1F48E}",tooltip:"\u0421\u0443\u043F\u0435\u0440 \u0446\u0435\u043D\u0430 (-25%)"},{value:-15,emoji:"\u{1F525}",tooltip:"\u041E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-15%)"},{value:-5,emoji:"\u{1F31F}",tooltip:"\u041A\u043B\u0430\u0441\u0441\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-5%)"},{value:5,emoji:"\u{1F44C}",tooltip:"\u0425\u043E\u0440\u043E\u0448\u0430\u044F \u0446\u0435\u043D\u0430 (+5%)"}],k={active:{background:"#e3f2fd",borderColor:"#2196f3",boxShadow:"0 0 0 1px #2196f3"},inactive:{background:"#fff",borderColor:"#ccc",boxShadow:"none"},hover:{background:"#f5f5f5"}},G=createDiv({display:"inline-flex",gap:"4px",marginLeft:"4px"}),K=[],Y=()=>I?parseFloat(I.value)||0:w.value,j=()=>{const N=Y();K.forEach(({button:o,value:R})=>{const p=R<=N?k.active:k.inactive;Object.assign(o.style,p)})};return W.forEach(({value:N,emoji:o,tooltip:R})=>{const D=createButton({padding:"2px 6px",fontSize:"16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"#fff",transition:"all 0.2s",...L},o);D.title=R,D.type="button",D.addEventListener("click",p=>{p.preventDefault(),w.updateValue(N),I&&(I.value=N),j()}),D.addEventListener("mouseenter",()=>{N<=Y()||(D.style.background=k.hover.background)}),D.addEventListener("mouseleave",()=>{j()}),K.push({button:D,value:N}),G.appendChild(D)}),j(),I&&(I.addEventListener("input",j),I.addEventListener("change",j)),G}},8355:(b,v,n)=>{n.d(v,{_7:()=>u,fO:()=>d});function d(e){if(!e)return[];const r=u(e).flat().filter(t=>t&&!t.isNegative&&t.term).map(t=>t.term);return[...new Set(r)]}function u(e){return e?e.toLowerCase().split(",").map(s).filter(Boolean):[]}function s(e){const i=e.split("/").map(t=>t.trim()).filter(Boolean);if(i.length===0)return null;const r=i.map(f).filter(Boolean);return r.length>0?r:null}function f(e){const i=e.startsWith("!"),r=i?e.slice(1).trim():e;return r?{term:r,isNegative:i}:null}function h(e,i){a(e,r=>r.style.display!=="none",i)}function l(e,i){a(e,r=>r.style.opacity==="",i)}function a(e,i,r){const t=[...e].filter(i).length,E=e.length;m(r,t,E)}function m(e,i,r){e.textContent=`\u041F\u043E\u043A\u0430\u0437\u0430\u043D\u043E: ${i} \u0438\u0437 ${r}`}},5213:(b,v,n)=>{n.d(v,{b:()=>u});var d=n(7273);function u(s,f,h=!1,l="customFiltersContainer"){let a=s.querySelector(`#${l}`);if(a){if(!h)return;a.replaceChildren()}else a=(0,d.S)(),a.id=l;f(a,s)}},8200:(b,v,n)=>{n.d(v,{s:()=>d});function d(u){const{target:s}=u,{type:f}=s;switch(f){case"text":return`"${s.value}"`;case"number":return s.value;case"select-one":return s.value;case"date":return`"${s.value}"`;case"checkbox":return s.checked;default:return console.log(`Unknown input type: ${f}`),null}}},157:(b,v,n)=>{n.d(v,{Fg:()=>d,vx:()=>s});const d=window.GM_setValue,u=window.GM.setValue,s=window.GM_getValue},1870:(b,v,n)=>{n.d(v,{j:()=>d});class d{constructor(s,f){this.value=s,this.onChange=f}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(b,v,n)=>{n.d(v,{V:()=>h});var d=n(1870),u=n(8200),s=n(3976),f=n(157);class h extends d.j{constructor(a,m=null,e=null){super((0,f.vx)(a,m),e),this.storageKey=a,this.defaultValue=m}static create(a,m=null,e=null){return new h(a,m,e)}static createWithCompositeKey(a,m,e=null,i=null){const r=`${a}-${m}`;return new h(r,e,i)}updateValueFromEvent=a=>{const m=(0,u.s)(a),e=(0,s.$)(m);this.updateValue(e)};updateValue(a,m=!0){this.value!==a&&((0,f.Fg)(this.storageKey,a),this.value=a,m&&this.onChangeIfDefined())}clearValue(a=!1){this.updateValue(null,a)}resetValue(a=!1){this.updateValue(this.defaultValue,a)}}},3976:(b,v,n)=>{n.d(v,{$:()=>d});function d(u){return u===""?null:JSON.parse(u)}},4214:(b,v,n)=>{n.d(v,{$z:()=>d,zr:()=>u});function d(l){return l.replace(/\D/g,"")}function u(l){return l.replace(/[^\d.,-]/g,"")}function s(l){return l.replace(/\s/g,"")}function f(l){return l.charAt(0).toUpperCase()+l.slice(1)}function h(l){return l.replace(/\s+/g," ").trim()}},5406:(b,v,n)=>{n.d(v,{$F:()=>l,Fc:()=>d,bn:()=>u,z2:()=>i});function d(c,g="common",C=!1){const{pathname:T}=window.location;return u(T,c,g,C)}function u(c,g,C,T=!1){const A=c.split("/");g=g<0?A.length+g:g;const S=A[g]||C;return T&&console.log(`Pathname element: ${S}`),S}function s(c,g="common",C=!1){const T=d(c,"",C);return f(T,g,C)}function f(c,g,C){if(!c)return g;const T=c.split("-").at(-1);return C&&console.log(`Pathname element ending: ${T}`),T}function h(c,g,C="common",T=!1){const A=u(c,g,"",T);return f(A,C,T)}function l(c){return new URLSearchParams(window.location.search).get(c)}function a(c){return c.split("?")[0]}function m(c){return window.location.pathname.includes(c)}function e(c){return c.some(g=>m(g))}function i(...c){return window.location.pathname.split("/").some(C=>c.includes(C))}function r(c){try{const g=new URL(window.location.href);Object.entries(c).forEach(([C,T])=>{g.searchParams.set(C,T)}),window.location.href=g.toString()}catch(g){console.error("Failed to redirect:",g)}}function t(c,g=[]){const C=new AbortController;let T=!1;const A=x=>{const O=new URL(x),P={pathname:O.pathname};return g.forEach(U=>{P[U]=O.searchParams.get(U)}),P};let S=A(window.location.href);return window.navigation.addEventListener("navigatesuccess",async()=>{if(T)return;const x=A(window.navigation.currentEntry.url);if(Object.keys(S).some(P=>S[P]!==x[P])){S=x,T=!0;try{await c(x)}catch(P){console.error("URL observer error:",P)}finally{T=!1}}},{signal:C.signal}),()=>C.abort()}function E(c,g=[]){const C={pathname:window.location.pathname};g.forEach(O=>{C[O]=l(O)});let T=!1;async function A(){if(T)return;const O={pathname:window.location.pathname};if(g.forEach(P=>{O[P]=l(P)}),Object.keys(C).some(P=>C[P]!==O[P])){Object.assign(C,O),T=!0;try{await c()}catch(P){console.error("Error in URL observer callback:",P)}finally{T=!1}}}function S(){A().catch(O=>{console.error("Error in URL change handler:",O)})}let x=window.location.href;setInterval(()=>{window.location.href!==x&&(console.log("URL changed:",window.location.href),x=window.location.href,S())},200),window.addEventListener("popstate",S)}function F(c=[]){E(()=>window.location.reload(),c)}},2524:(b,v,n)=>{n.d(v,{d5:()=>s,vX:()=>a,ft:()=>f});var d=n(157);class u{constructor(i=Date.now(),r=[]){this.lastCheckDate=i,this.reviewsData=r}updateLastCheckDate=()=>{this.lastCheckDate=Date.now()};static fromObject(i){const{lastCheckDate:r,reviewsData:t}=i;return new u(r,t)}}const s={LAST_DOCTOR_UPDATE:"last-doctor-update"};function f(e,i){const r=h(e),t=(0,d.vx)(r),E=l(t);E.reviewsData=i,E.updateLastCheckDate(),(0,d.Fg)(r,E),(0,d.Fg)(s.LAST_DOCTOR_UPDATE,Date.now())}function h(e){return`doctor-${e}`}function l(e){return e?u.fromObject(e):new u}function a(e){return m(e)?.reviewsData??null}function m(e){const i=h(e);return(0,d.vx)(i)}},1753:(b,v,n)=>{n.a(b,async(d,u)=>{try{var s=n(573),f=n(7858),h=n(4231),l=n(5406),a=n(5072);const e=(0,s.Fi)(".appointments_page");e?(0,h.$)(e):(0,l.z2)("otzivi")?await(0,a.N)():(0,l.z2)("vrach")&&(0,f.O)(),u()}catch(m){u(m)}},1)},7653:(b,v,n)=>{n.d(v,{NI:()=>i,z1:()=>E,Np:()=>C,pR:()=>F,sp:()=>A,rd:()=>T});var d=n(573);const u={DOCTOR_CARD_NAME:'.b-doctor-intro__title-first-line [itemprop="name"]',DOCTOR_INTRO_LEFT:".b-doctor-intro__left-side",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]'};var s=n(8586),f=n(5406),h=n(4214),l=n(7273),a=n(8738);const m="additionalLinksAppended",e=["\u042F\u043D\u0434\u0435\u043A\u0441","\u041D\u0430\u041F\u043E\u043F\u0440\u0430\u0432\u043A\u0443","DocDoc","\u0414\u043E\u043A\u0442\u0443"];function i(S,x){x.classList.contains(m)||(e.forEach(O=>{r(S,x,O)}),x.classList.add(m))}function r(S,x,O){const P=t(S,O),U=(0,a.d)({},O,P),$=document.createElement("br");x.append($,U)}function t(S,x){const O=`${S} ${x}`;return`https://www.google.com/search?q=${encodeURIComponent(O)}&btnI`}function E(){const S=(0,d.Fi)(u.DOCTOR_CARD_NAME,document,!0);if(!S)return;const x=S.innerText.trim(),O=(0,l.S)();O.style.textAlign="center",(0,d.Fi)(u.DOCTOR_INTRO_LEFT).append(O),i(x,O)}function F(S,x,O=!1){const P=(0,l.S)(s.r.REVIEWS_INFO);O&&(P.style.justifyContent="center"),P.classList.add("v-application");const U=(0,l.S)(s.r.REVIEWS_INFO_BLOCK);return U.style.height=O?"10px":"23px",U.append(P),S.slice(O?1:0).forEach($=>{const{category:w,title:I,count:L,bgClassSuffix:W}=$,k=`${x}?rates_category=${w}`,G=O?L:`${I} ${L}`,K=(0,a.d)(s.r.REVIEW_INFO,G,k);K.classList=c(W),P.append(K),O&&g(K,I)}),U}function c(S){return`text-caption text--text px-2 py-1 rounded-sm bg-${S}`}function g(S,x){let O=null;S.addEventListener("mouseenter",()=>{O=(0,l.S)(s.r.REVIEW_INFO_TOOLTIP,x),document.body.appendChild(O);const P=S.getBoundingClientRect();O.style.left=`${(P.left+P.right)/2-O.offsetWidth/2+window.scrollX+2}px`,O.style.top=`${P.top+window.scrollY-O.offsetHeight-4}px`}),S.addEventListener("mouseleave",()=>{O&&(O.remove(),O=null)})}function C(S){const x=(0,d.Fi)(u.NAME_SPAN_HOLDER,document,!0);if(!x)return;const O=(0,d.Fi)(u.NAME_SPAN,x,!0);O&&O.append(S)}function T(){const S=(0,f.Fc)(3,"unknown");return(0,h.$z)(S)}function A(S){const x=(0,f.bn)(S,5,"");return(0,h.$z)(x)}},8586:(b,v,n)=>{n.d(v,{r:()=>u});const d={INPUT:{border:"1px solid #c7d3d9",borderRadius:"10px",padding:"7px 14px",marginLeft:"6px"}},u={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",flexFlow:"wrap"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...d.INPUT,width:"195px"},NUMBER_INPUT:{...d.INPUT,width:"70px"},CHECKBOX_INPUT:{...d.INPUT,width:"20px",height:"20px"},REVIEWS_INFO:{gridGap:"6px"},REVIEWS_INFO_BLOCK:{marginTop:"5px"},REVIEW_INFO:{textDecoration:"none",flexShrink:0},REVIEW_INFO_TOOLTIP:{position:"absolute",backgroundColor:"#333",color:"#fff",padding:"4px 8px",borderRadius:"8px",fontSize:"12px",zIndex:"1000",pointerEvents:"none",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"}}},4231:(b,v,n)=>{n.d(v,{$:()=>w});var d=n(5406),u=n(573),s=n(5539),f=n(3829),h=n(7653),l=n(5213),a=n(5884),m=n(7877);const e={LIST_HEADER:".h2_rating",DOCTOR_FILTERS:".vue-the-doctors-filters > .b-container",DOCTOR_CARD:".b-doctor-card",DOCTOR_CARD_NAME:".b-doctor-card__name-surname",PROFILE_CARD:".b-profile-card",REVIEWS_LINK:":scope > a",EXPERIENCE_WRAP:".b-doctor-card__experience .text-subtitle-1",SPEC_WRAP:".b-doctor-card__spec",CLINIC_CONTAINER:"div.b-doctor-card__lpu-select",CLINIC_WRAP:".b-select__trigger-main-text"};var i=n(4521),r=n(2524),t=n(4921),E=n(8586),F=n(6754);const c=window.GM_addValueChangeListener,g=(0,d.Fc)(2),{createGlobalFilter:C,createSectionFilter:T}=(0,i.z)(W,g),A=T("spec-filter"),S=T("clinic-filter"),x=T("min-reviews-filter",10),O=T("min-experience-filter",5,j),P=T("max-experience-filter",40),U=C("filter-enabled",!0),$={doctorCardsCache:new WeakMap};function w(N){j(),I();const o=(0,u.Fi)(e.DOCTOR_FILTERS);(0,l.b)(o,L),W(),c(r.d5.LAST_DOCTOR_UPDATE,W),new MutationObserver((0,t.sg)(W)).observe(N,{childList:!0})}function I(){const N=(0,u.Fi)(e.LIST_HEADER);N&&N.remove()}function L(N,o){(0,F.ZM)(N,E.r.FILTERS_CONTAINER),N.style.marginTop="6px";const R=(0,a.Nm)("\u0421\u043F\u0435\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F:",A,E.r.CONTROL,E.r.TEXT_INPUT),D=(0,a.Nm)("\u041A\u043B\u0438\u043D\u0438\u043A\u0430:",S,E.r.CONTROL,E.r.TEXT_INPUT),p=(0,m.X0)(x,E.r.CONTROL,E.r.NUMBER_INPUT),_=(0,a.nW)("\u041C\u0438\u043D. \u043E\u043F\u044B\u0442: ",O,"1","0","100",E.r.CONTROL,E.r.NUMBER_INPUT),y=(0,a.nW)("\u041C\u0430\u043A\u0441. \u043E\u043F\u044B\u0442: ",P,"1","0","100",E.r.CONTROL,E.r.NUMBER_INPUT),B=(0,m.pW)(U,E.r.CONTROL,E.r.CHECKBOX_INPUT);N.append(R,D,p,_,y,B),o.append(N)}function W(){(0,u.fI)(e.DOCTOR_CARD).forEach(k)}function k(N){if(!U.value){(0,s.kl)(N);return}let o=$.doctorCardsCache.get(N);if(!o){const D=(0,u.Fi)(e.PROFILE_CARD,N),p=(0,u.Fi)(e.REVIEWS_LINK,D),_=(0,u.Fi)(e.EXPERIENCE_WRAP,N);if(!p||!_){(0,s.Bt)(N);return}const B=(0,u.Fi)(e.SPEC_WRAP,N,!0).innerText.trim(),M=(0,u.Fi)(e.CLINIC_CONTAINER,N,!0),V=(0,u.Fi)(e.CLINIC_WRAP,M,!0).innerText.trim(),H=(0,u.YA)(p,!0),X=(0,u.YA)(_,!0),J=G(p);p.href=J,(0,h.NI)(K(N),D),o={specInfo:B,clinicName:V,reviewsLinkNumber:H,experienceNumber:X,reviewsLink:p,reviewInfoAppended:!1},$.doctorCardsCache.set(N,o)}Y(o);const R=(0,f.Ay)(o.specInfo,A)||(0,f.Ay)(o.clinicName,S)||(0,f.JE)(o.reviewsLinkNumber,x)||(0,f.JE)(o.experienceNumber,O)||(0,f.iG)(o.experienceNumber,P);(0,s.UC)(N,R)}function G(N){return N.href.replace(/\/#otzivi$/,"/otzivi/")}function K(N){return(0,u.Fi)(e.DOCTOR_CARD_NAME,N,!0).innerText}function Y(N){if(N.reviewInfoAppended)return;const{reviewsLink:o}=N,R=o.href,D=(0,r.vX)((0,h.sp)(R));if(!D)return;const p=(0,h.pR)(D,R,!0);(0,s.WH)(o,p),N.reviewInfoAppended=!0}function j(){if(!O.value)return;const N=new URL(window.location.href);+N.searchParams.get("experience")!==O.value&&(N.searchParams.set("experience",O.value),window.location.href=N.toString())}},7858:(b,v,n)=>{n.d(v,{O:()=>a});var d=n(573),u=n(7653);const s={REVIEWS_LINK:".b-doctor-intro__rates-wrapper > a",DOCTOR_DETAILS:".b-doctor-details__toc",REVIEWS_FILTER:".reviews-filter:not(.b-reviews-page__filter)",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]',REVIEWS_FILTER_SPAN:":scope > span",DOCTOR_CONTACTS:"#doctor-contacts"};var f=n(2524),h=n(7273),l=n(8738);function a(){(0,u.z1)(),e();const r=m();i(r);const t=(0,f.vX)((0,u.rd)());if(!t)return;const E=(0,u.pR)(t,r);(0,u.Np)(E)}function m(){const{location:r}=window;return`${r.origin}${r.pathname}otzivi/`}function e(){if(!(0,d.Fi)(s.DOCTOR_CONTACTS))return;const t=[...(0,d.fI)(s.DOCTOR_DETAILS)].pop();if(!t)return;t.style.position="sticky",t.style.top="16px";const E=(0,h.S)({},"\u041C\u0435\u0441\u0442\u043E \u0440\u0430\u0431\u043E\u0442\u044B");E.classList.add("b-doctor-details__toc-title");const F=(0,l.d)({},null,"#doctor-contacts");F.classList.add("b-doctor-details__toc-item"),F.append(E),t.insertBefore(F,t.firstChild)}function i(r){const t=(0,d.Fi)(s.REVIEWS_LINK);t&&(t.href=r)}},5072:(b,v,n)=>{n.d(v,{N:()=>k});var d=n(7653);const u={CONTROLS_CONTAINER:".vue-review-filter",REVIEWS:".b-review-card",REVIEW_TEXT_WRAP:".b-review-card__comment",REVIEW_RATING_WRAP:".review-card-tooltips__stars > .ui-text",FILTER_CHIP:'[data-qa="reviews_filter_chip"]',FILTER_LIST:'[data-qa="reviews_filter_list"]',FILTER_LIST_ITEM:'[data-qa^="reviews_filter_list_item"]',FILTER_TITLE_WRAP:'[data-qa="reviews_filter_title"]',FILTER_COUNT_WRAP:'[data-qa="reviews_filter_amount"]',REVIEWS_CONTAINER:"#otzivi"};var s=n(573),f=n(4921),h=n(5406),l=n(2524),a=n(4521),m=n(5213),e=n(8586),i=n(7877),r=n(5539);function t(p,_){p.forEach(y=>E(_,y))}function E(p,_){if(!_)return;const y=new RegExp(`(${_})`,"gi"),B=document.createTreeWalker(p,NodeFilter.SHOW_TEXT,null);let M=B.nextNode();const z=[];for(;M;){const{textContent:V}=M;if(y.test(V)){const H=document.createDocumentFragment();let X=0;V.replace(y,(J,re,q)=>{q>X&&H.appendChild(document.createTextNode(V.slice(X,q)));const Z=document.createElement("span");Z.className="highlightedSubstring",Z.style.backgroundColor="yellow",Z.textContent=J,H.appendChild(Z),X=q+J.length}),X<V.length&&H.appendChild(document.createTextNode(V.slice(X))),z.push({node:M,fragment:H})}M=B.nextNode()}z.forEach(({node:V,fragment:H})=>{V.parentNode.replaceChild(H,V)})}function F(p){(0,s.fI)(".highlightedSubstring",p).forEach(y=>{const{parentNode:B}=y;y.replaceWith(y.textContent),B.normalize()})}var c=n(8355);function g(p,_){const y=(0,c.fO)(p.value);t(y,_)}function C(p,_){const y=getIncludedSearchStrings(p.value);_.forEach(B=>highlightSubstrings(y,B))}var T=n(3829),A=n(7273);function S(p={}){return(0,A.S)(p,"|")}function x(p,_={},y="customFiltersContainer"){const B=document.getElementById(y);if(!B)return console.log(`Element with id="${y}" not found.`),null;const M=createButton(_,`${arrowUpIcon}\u041A \u0444\u0438\u043B\u044C\u0442\u0440\u0430\u043C`);return M.addEventListener("mouseenter",()=>{M.style.filter="brightness(0.9)"}),M.addEventListener("mouseleave",()=>{M.style.filter="brightness(1)"}),M.addEventListener("click",()=>{const z=B.getBoundingClientRect();window.scrollTo({top:z.top+window.scrollY-p,behavior:"smooth"})}),new IntersectionObserver(([z])=>{const V=z.boundingClientRect.top<0,H=!z.isIntersecting&&V;M.style.display=H?"flex":"none"},{threshold:.5}).observe(B),M}function O(p,_={},y=75){const B=x(y,_);B&&p.appendChild(B)}var P=n(6754);const{createGlobalFilter:U}=(0,a.z)(K),$=U("reviews-text-filter"),w=U("reviews-min-rating-filter"),I=U("reviews-max-rating-filter"),L=U("reviews-filter-enabled",!0),W={reviewCardsCache:new Map};async function k(){(0,d.z1)();const p=await(0,f.xk)(document,u.CONTROLS_CONTAINER);(0,m.b)(p,G),K();const _=await N();(0,l.ft)((0,d.rd)(),_);const y=(0,d.pR)(_,R());(0,d.Np)(y),(0,h.$F)("rates_category")&&D()}function G(p,_){(0,P.ZM)(p,e.r.FILTERS_CONTAINER),p.style.marginTop="12px";const y=(0,i.E9)($,e.r.CONTROL,e.r.TEXT_INPUT),B=(0,i.HX)(w,e.r.CONTROL,e.r.NUMBER_INPUT,1,1),M=(0,i.FR)(I,e.r.CONTROL,e.r.NUMBER_INPUT,1,1),z=S(e.r.CONTROL),V=(0,i.pW)(L,e.r.CONTROL,e.r.CHECKBOX_INPUT);p.append(y,B,M,z,V),_.append(p)}function K(){(0,s.fI)(u.REVIEWS).forEach(Y)}function Y(p){if(!L.value){(0,r.kl)(p);return}F(p);let _=W.reviewCardsCache.get(p);if(!_){const B=(0,s.Fi)(u.REVIEW_TEXT_WRAP,p),M=(0,s.Fi)(u.REVIEW_RATING_WRAP,p);if(!B){(0,r.Bt)(p);return}_={reviewTextWrap:B,reviewText:B.innerText,rating:M&&(0,s.YA)(M)},W.reviewCardsCache.set(p,_)}$.value&&g($,_.reviewTextWrap);const y=(0,T.Ay)(_.reviewText,$)||j(_.rating);(0,r.UC)(p,y)}function j(p){return p?(0,T.JE)(p,w)||(0,T.iG)(p,I):!1}async function N(){const p=(0,s.Fi)(u.FILTER_CHIP);p.click();const _=await(0,f.xk)(document,u.FILTER_LIST),y=[...(0,s.fI)(u.FILTER_LIST_ITEM,_)].map(B=>{const M=B.getAttribute("data-qa");if(!M)return null;const z=M.replace("reviews_filter_list_item_",""),V=(0,s.Fi)(u.FILTER_TITLE_WRAP,B).textContent.trim(),H=(0,s.Fi)(u.FILTER_COUNT_WRAP,B),X=(0,s.YA)(H,!0),J=o(H.classList);return{category:z,title:V,count:X,bgClassSuffix:J}});return p.click(),y}function o(p){const _=p.value.match(/bg-(\w+)/);return _?_[1]:null}function R(){const{location:p}=window;return`${p.origin}${p.pathname}`}function D(){(0,s.Fi)(u.REVIEWS_CONTAINER).scrollIntoView({behavior:"smooth"})}}},ee={};function Q(b){var v=ee[b];if(v!==void 0)return v.exports;var n=ee[b]={exports:{}};return te[b](n,n.exports,Q),n.exports}(()=>{var b=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",v=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",n=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",d=s=>{s&&s.d<1&&(s.d=1,s.forEach(f=>f.r--),s.forEach(f=>f.r--?f.r++:f()))},u=s=>s.map(f=>{if(f!==null&&typeof f=="object"){if(f[b])return f;if(f.then){var h=[];h.d=0,f.then(m=>{l[v]=m,d(h)},m=>{l[n]=m,d(h)});var l={};return l[b]=m=>m(h),l}}var a={};return a[b]=m=>{},a[v]=f,a});Q.a=(s,f,h)=>{var l;h&&((l=[]).d=-1);var a=new Set,m=s.exports,e,i,r,t=new Promise((E,F)=>{r=F,i=E});t[v]=m,t[b]=E=>(l&&E(l),a.forEach(E),t.catch(F=>{})),s.exports=t,f(E=>{e=u(E);var F,c=()=>e.map(C=>{if(C[n])throw C[n];return C[v]}),g=new Promise(C=>{F=()=>C(c),F.r=0;var T=A=>A!==l&&!a.has(A)&&(a.add(A),A&&!A.d&&(F.r++,A.push(F)));e.map(A=>A[b](T))});return F.r?g:c()},E=>(E?r(t[n]=E):i(m),d(l))),l&&l.d<0&&(l.d=0)}})(),Q.d=(b,v)=>{for(var n in v)Q.o(v,n)&&!Q.o(b,n)&&Object.defineProperty(b,n,{enumerable:!0,get:v[n]})},Q.o=(b,v)=>Object.prototype.hasOwnProperty.call(b,v);var ne=Q(1753)})();})();
