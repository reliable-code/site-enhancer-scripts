// ==UserScript==
// @name         Prodoc enhancer
// @description  Hide doctor cards by filter, enhance doctor page
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://prodoctorov.ru/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      2.0.76830129
// @icon         https://www.google.com/s2/favicons?sz=64&domain=prodoctorov.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/prodoc.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var te={5467:(S,h,e)=>{e.d(h,{E2:()=>i});var s=e(9928);function i(C,u={},n=null){const l=(0,s.Sw)(u,n);return l.append(C),l}function p(C,u=null,n={},l={}){const t=createActionLink(C,u,l);return i(t,n)}function m(C,u=null,n=null,l={},t={}){const c=createActionLinkWithIcon(C,n,u,t);return i(c,l)}},9928:(S,h,e)=>{e.d(h,{S:()=>u,Sw:()=>w,d:()=>t,kU:()=>p,o5:()=>m});var s=e(4921),i=e(6754);function p(r,d,f){const g=n(r,"text",d);return g.value=f,g}function m(r,d,f,g,O,x){const k=n(r,"number",d);return k.value=f,k.step=g,k.min=O,k.max=x,k}function C(r,d,f){const g=n(r,"date",d);return g.value=f,g}function u(r,d,f){const g=n(r,"checkbox",d);return g.checked=f,g}function n(r={},d=null,f=null){const g=E("input",r);return d&&(g.type=d),f&&(g.addEventListener("keyup",(0,s.sg)(f,200)),g.addEventListener("change",(0,s.sg)(f,100))),g}function l(r={},d=null){return E("span",r,d)}function t(r={},d=null,f=null){const g=E("a",r,d);return f&&(g.href=f),g}function c(r,d=null,f={}){f.cursor||="pointer";const g=t(f,d);return r&&g.addEventListener("click",r),g}function v(r,d,f=null,g={},O={}){g.display||="inline-flex",g.alignItems||="center",g.gap||="0.25em";const x=c(r,f,g);return x.prepend(a(d,O)),x}function N(r={},d=null,f=null){const g=E("button",r,d);return f&&g.addEventListener("click",f),g}function w(r={},d=null){return E("div",r,d)}function T(r={}){return E("i",r)}function a(r,d={}){d.width||="1em",d.height||="1em",d.paddingBottom||="1px";const f=T(d);return f.setAttribute("data-lucide",r),f}function E(r,d,f=null){if(typeof d!="object"||d===null)throw new TypeError("styles should be an object");const g=document.createElement(r);return(0,i.ZM)(g,d),f&&(g.innerHTML=f),g}},573:(S,h,e)=>{e.d(h,{Fi:()=>p,YA:()=>l,fI:()=>m});var s=e(4214);function i(a,E=document){return!!E.querySelector(a)}function p(a,E=document,r=!1){const d=E.querySelector(a);return r&&!d&&console.log(`No element found for selector: ${a}`),d}function m(a,E=document,r=!1){const d=E.querySelectorAll(a);return r&&!d.length&&console.log(`No elements found for selector: ${a}`),d}function C(a,E=1){let r=a;for(let d=0;d<E;d++){if(!r.parentElement)return null;r=r.parentElement}return r}function u(a,E,r){return[...a.querySelectorAll(E)].find(d=>d.textContent.trim().includes(r))}function n(a,E,r=!1,d=!1,f=null){const g=p(E,a);return l(g,r,d,f)}function l(a,E=!1,r=!1,d=null){if(!a)return d===null?(console.log("No element found"),null):d;const f=a.innerText;return v(f,E,r)}function t(a,E,r=!1){const d=a[E];return l(d,r)}function c(a,E=!1,r=!1){const d=a.textContent;return v(d,E,r)}function v(a,E,r){E&&(a=(0,s.zr)(a)),r&&(a=a.replace(",","."));const d=Number(a);return Number.isNaN(d)?(console.log(`Invalid number: ${a}`),0):d}function N(a){return[...a.childNodes].find(E=>E.nodeType===Node.TEXT_NODE)}function w(a){const E=r=>r.nodeType===Node.TEXT_NODE&&r.textContent.trim()!==""?[r]:[...r.childNodes].flatMap(E);return E(a)}function T(a){return normalizeSpacing(a.textContent)}},5539:(S,h,e)=>{e.d(h,{Bt:()=>i,UC:()=>t,WH:()=>s,kl:()=>n});function s(o,b){o.parentNode.insertBefore(b,o.nextSibling)}function i(o){o.style.display="none"}function p(o,b=1){const _=document.querySelector(o);_&&m(_,b)}function m(o,b=1){const _=getElementAncestor(o,b);_&&i(_)}function C(o){N(o),i(o)}function u(o){o.intersectionObserver||runOnceOnIntersection(o,()=>i(o))}function n(o){o.style.display=""}function l(o){const b=v(o);o.style.display=b}function t(o,b){b?i(o):n(o)}function c(o,b){b?u(o):(clearIntersectionObserver(o),n(o))}function v(o){return N(o),o.defaultDisplay}function N(o){if(o.defaultDisplay)return;const{display:b}=getComputedStyle(o);o.defaultDisplay=b}function w(){return{show:[],hide:[]}}function T(o,b,_){o?b.hide.push(_):b.show.push(_)}function a(o){o.show.forEach(n),o.hide.forEach(i)}function E(o,b,_=.3){b?d(o,_):r(o)}function r(o){o.style.opacity=""}function d(o,b=.3){o.style.opacity=b}function f(o){o.style.order=""}function g(o,b){o.style.order=b}function O(o,b){o.style.background=b}function x(o,b){const _=getFirstElement(b);_&&k(o,_)}function k(o,b){const _=createLink();_.href=o,b.parentNode.append(_),_.append(b)}function j(o,b){const _=getFirstElement(b);_&&R(o,_)}function R(o,b,_={}){const $=createLink(_);$.href=o,$.append(...b.childNodes),b.append($)}function I(){const o=getURLQueryParam("scrollTo");if(!o)return;const b=document.getElementById(o);b?b.scrollIntoView():console.log(`Element with ID "${o}" was not found.`)}function L(o,b,_=null){const $=`${b}-click-passed`,H=_?W=>findElementByText(W,o,_):W=>getFirstElement(o,W);return function(W){if(W.hasAttribute($))return!1;const D=H(W);return D&&D.click(),W.setAttribute($,""),!0}}function P(o,b,_="text/plain"){const $=new Blob([o],{type:_}),H=URL.createObjectURL($),W=document.createElement("a");W.href=H,W.download=b,document.body.appendChild(W),W.click(),document.body.removeChild(W),requestAnimationFrame(()=>URL.revokeObjectURL(H))}},6754:(S,h,e)=>{e.d(h,{ZM:()=>s});function s(C,u){Object.assign(C.style,u)}function i(C,u="custom-global-style"){let n=document.getElementById(u);n||(n=document.createElement("style"),n.id=u,n.type="text/css",document.head.appendChild(n)),n.textContent=C}function p(C){return Object.entries(C).map(([u,n])=>`${u.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${n};`).join(" ")}function m(C){return C?C.split(";").filter(u=>u.trim()!=="").reduce((u,n)=>{const[l,t]=n.split(":").map(v=>v.trim()),c=l.replace(/-([a-z])/g,(v,N)=>N.toUpperCase());return u[c]=t,u},{}):{}}},4921:(S,h,e)=>{e.d(h,{sg:()=>m,xk:()=>s});function s(t,c,v=null){const N=t.querySelector(c);return N?Promise.resolve(N):new Promise(w=>{const T=new MutationObserver(E);T.observe(t,{childList:!0,subtree:!0});let a;v&&(a=setTimeout(()=>{T.disconnect(),console.log(`No element found for selector: ${c}`),w(null)},v));function E(){const r=t.querySelector(c);r&&(a&&clearTimeout(a),T.disconnect(),w(r))}})}function i(t,c){return t.querySelector(c)?new Promise(N=>{const w=new MutationObserver(T);w.observe(t,{childList:!0,subtree:!0});function T(){t.querySelector(c)||(w.disconnect(),N())}}):Promise.resolve()}function p(t,c=400){return new Promise(v=>{let N;const w=new MutationObserver(()=>{clearTimeout(N),T()});function T(){N=setTimeout(()=>{w.disconnect(),v()},c)}T(),w.observe(t,{childList:!0,subtree:!0})})}function m(t,c=250){let v;return(...N)=>{clearTimeout(v),v=setTimeout(()=>t(...N),c)}}async function C(t){document.visibilityState==="visible"?await t():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await t()},{once:!0})}function u(t,c){const v=new IntersectionObserver(N=>{N.forEach(w=>{w.isIntersecting&&(c(),n(t))})});t.intersectionObserver=v,v.observe(t)}function n(t){t.intersectionObserver&&(t.intersectionObserver.disconnect(),t.intersectionObserver=null)}function l(t){t&&(t.disconnect(),t=null)}},3829:(S,h,e)=>{e.d(h,{Ay:()=>i,JE:()=>m,iG:()=>C});var s=e(8355);function i(t,c){return!p(t,c)}function p(t,c){if(!c.value)return!0;const v=t.toLowerCase(),N=(0,s.Rn)(c),w=[],T=[];return N.forEach(a=>{if(a.startsWith("!")){const E=a.substring(1);E&&T.push(E)}else w.push(a)}),w.every(a=>v.includes(a))&&T.every(a=>!v.includes(a))}function m(t,c){return c.value!=null&&t<c.value}function C(t,c){return c.value!=null&&t>c.value}function u(t,c){return c.value==null?!1:t<parseDateFromISO(c.value)}function n(t,c){return c.value==null?!1:t>parseDateFromISO(c.value)}function l(t,c){return c.value&&t!==c.value}},4521:(S,h,e)=>{e.d(h,{z:()=>i});var s=e(3048);function i(p,m=null){return{createGlobalFilter(C,u=null,n=p){return s.V.create(C,u,n)},createSectionFilter(C,u=null,n=p){if(!m)throw new Error("sectionId must be provided to use createSectionFilter.");return s.V.createWithCompositeKey(m,C,u,n)}}}},5884:(S,h,e)=>{e.d(h,{Hw:()=>u,Nm:()=>p,nW:()=>m});var s=e(9928),i=e(5467);function p(n,l,t={},c={}){const v=(0,s.kU)(c,l.updateValueFromEvent,l.value);return(0,i.E2)(v,t,n)}function m(n,l,t,c,v,N={},w={}){const T=(0,s.o5)(w,l.updateValueFromEvent,l.value,t,c,v);return(0,i.E2)(T,N,n)}function C(n,l,t={},c={}){const v=createDateInput(c,l.updateValueFromEvent,l.value);return createControl(v,t,n)}function u(n,l,t={},c={}){const v=(0,s.S)(c,l.updateValueFromEvent,l.value);return(0,i.E2)(v,t,n)}},7877:(S,h,e)=>{e.d(h,{E9:()=>i,FR:()=>m,HX:()=>p,X0:()=>C,pW:()=>k});var s=e(5884);function i(R,I={},L={}){return(0,s.Nm)("\u041F\u043E\u0438\u0441\u043A: ",R,I,L)}function p(R,I={},L={},P=.1,o=3){return(0,s.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",R,P,o,5,I,L)}function m(R,I={},L={},P=.1,o=3){return(0,s.nW)("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",R,P,o,5,I,L)}function C(R,I={},L={}){return n("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",R,I,L)}function u(R,I={},L={}){return n("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",R,I,L)}function n(R,I,L={},P={}){return(0,s.nW)(R,I,"1","1","999999",L,P)}function l(R,I={},L={}){return createDateFilterControl("\u041C\u0438\u043D. \u0434\u0430\u0442\u0430: ",R,I,L)}function t(R,I={},L={}){return c("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",R,I,L)}function c(R,I,L={},P={}){return createNumberFilterControl(R,I,"5","0","100",L,P)}function v(R,I={},L={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",R,"5","0","100",I,L)}function N(R,I,L={},P={},o="250"){return createNumberFilterControl(R,I,o,"0","1000000",L,P)}function w(R,I={},L={},P="25"){return N("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",R,I,L,P)}function T(R,I={},L={},P="25"){return N("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",R,I,L,P)}function a(R,I={},L={}){return E("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",R,I,L)}function E(R,I,L={},P={}){return createNumberFilterControl(R,I,"1","0","99999",L,P)}function r(R,I={},L={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",R,"1","2","8",I,L)}function d(R,I={},L={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",R,1,1,10,I,L)}function f(R,I={},L={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",R,I,L)}function g(R,I={},L={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",R,I,L)}function O(R,I={},L={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",R,I,L)}function x(R,I={},L={}){return createCheckboxFilterControl("\u0411\u043E\u043D\u0443\u0441: ",R,I,L)}function k(R,I={},L={}){return(0,s.Hw)("\u0412\u043A\u043B: ",R,I,L)}function j(R,I,L={}){const P=[{value:-25,emoji:"\u{1F48E}",tooltip:"\u0421\u0443\u043F\u0435\u0440 \u0446\u0435\u043D\u0430 (-25%)"},{value:-15,emoji:"\u{1F525}",tooltip:"\u041E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-15%)"},{value:-5,emoji:"\u{1F31F}",tooltip:"\u041A\u043B\u0430\u0441\u0441\u043D\u0430\u044F \u0446\u0435\u043D\u0430 (-5%)"},{value:5,emoji:"\u{1F44C}",tooltip:"\u0425\u043E\u0440\u043E\u0448\u0430\u044F \u0446\u0435\u043D\u0430 (+5%)"}],o={active:{background:"#e3f2fd",borderColor:"#2196f3",boxShadow:"0 0 0 1px #2196f3"},inactive:{background:"#fff",borderColor:"#ccc",boxShadow:"none"},hover:{background:"#f5f5f5"}},b=createDiv({display:"inline-flex",gap:"4px",marginLeft:"4px"}),_=[],$=()=>I?parseFloat(I.value)||0:R.value,H=()=>{const W=$();_.forEach(({button:D,value:B})=>{const K=B<=W?o.active:o.inactive;Object.assign(D.style,K)})};return P.forEach(({value:W,emoji:D,tooltip:B})=>{const V=createButton({padding:"2px 6px",fontSize:"16px",cursor:"pointer",border:"1px solid #ccc",borderRadius:"4px",background:"#fff",transition:"all 0.2s",...L},D);V.title=B,V.type="button",V.addEventListener("click",K=>{K.preventDefault(),R.updateValue(W),I&&(I.value=W),H()}),V.addEventListener("mouseenter",()=>{W<=$()||(V.style.background=o.hover.background)}),V.addEventListener("mouseleave",()=>{H()}),_.push({button:V,value:W}),b.appendChild(V)}),H(),I&&(I.addEventListener("input",H),I.addEventListener("change",H)),b}},8355:(S,h,e)=>{e.d(h,{Rn:()=>s,fO:()=>i});function s(u){return u.value.toLowerCase().split(",").map(n=>n.trim()).filter(n=>n!=="")}function i(u){return s(u).filter(n=>!n.startsWith("!"))}function p(u,n){C(u,l=>l.style.display!=="none",n)}function m(u,n){C(u,l=>l.style.opacity==="",n)}function C(u,n,l){const t=[...u].filter(n).length;l.textContent=`\u041F\u043E\u043A\u0430\u0437\u0430\u043D\u043E: ${t} \u0438\u0437 ${u.length}`}},5213:(S,h,e)=>{e.d(h,{b:()=>p});var s=e(9928),i=e(573);function p(m,C,u=!1,n="customFiltersContainer"){let l=(0,i.Fi)(`#${n}`,m);if(l)if(u)l.remove();else return;l=(0,s.Sw)(),l.id=n,C(l,m)}},8200:(S,h,e)=>{e.d(h,{s:()=>s});function s(i){const{target:p}=i,{type:m}=p;switch(m){case"text":return`"${p.value}"`;case"number":return p.value;case"date":return`"${p.value}"`;case"checkbox":return p.checked;default:return console.log(`Unknown input type: ${m}`),null}}},157:(S,h,e)=>{e.d(h,{Fg:()=>s,vx:()=>p});const s=window.GM_setValue,i=window.GM.setValue,p=window.GM_getValue},1870:(S,h,e)=>{e.d(h,{j:()=>s});class s{constructor(p,m){this.value=p,this.onChange=m}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(S,h,e)=>{e.d(h,{V:()=>C});var s=e(1870),i=e(8200),p=e(3976),m=e(157);class C extends s.j{constructor(n,l=null,t=null){super((0,m.vx)(n,l),t),this.storageKey=n,this.defaultValue=l}static create(n,l=null,t=null){return new C(n,l,t)}static createWithCompositeKey(n,l,t=null,c=null){const v=`${n}-${l}`;return new C(v,t,c)}updateValueFromEvent=n=>{const l=(0,i.s)(n),t=(0,p.$)(l);this.updateValue(t)};updateValue(n,l=!0){this.value!==n&&((0,m.Fg)(this.storageKey,n),this.value=n,l&&this.onChangeIfDefined())}clearValue(n=!1){this.updateValue(null,n)}resetValue(n=!1){this.updateValue(this.defaultValue,n)}}},3976:(S,h,e)=>{e.d(h,{$:()=>s});function s(i){return i===""?null:JSON.parse(i)}},4214:(S,h,e)=>{e.d(h,{$z:()=>s,zr:()=>i});function s(u){return u.replace(/\D/g,"")}function i(u){return u.replace(/[^\d.,-]/g,"")}function p(u){return u.replace(/\s/g,"")}function m(u){return u.charAt(0).toUpperCase()+u.slice(1)}function C(u){return u.replace(/\s+/g," ").trim()}},5406:(S,h,e)=>{e.d(h,{$F:()=>u,Fc:()=>s,bn:()=>i,z2:()=>c});function s(T,a="common",E=!1){const{pathname:r}=window.location;return i(r,T,a,E)}function i(T,a,E,r=!1){const d=T.split("/");a=a<0?d.length+a:a;const f=d[a]||E;return r&&console.log(`Pathname element: ${f}`),f}function p(T,a="common",E=!1){const r=s(T,"",E);return m(r,a,E)}function m(T,a,E){if(!T)return a;const r=T.split("-").at(-1);return E&&console.log(`Pathname element ending: ${r}`),r}function C(T,a,E="common",r=!1){const d=i(T,a,"",r);return m(d,E,r)}function u(T){return new URLSearchParams(window.location.search).get(T)}function n(T){return T.split("?")[0]}function l(T){return window.location.pathname.includes(T)}function t(T){return T.some(a=>l(a))}function c(...T){return window.location.pathname.split("/").some(E=>T.includes(E))}function v(T){try{const a=new URL(window.location.href);Object.entries(T).forEach(([E,r])=>{a.searchParams.set(E,r)}),window.location.href=a.toString()}catch(a){console.error("Failed to redirect:",a)}}function N(T,a=[]){const E={pathname:window.location.pathname};a.forEach(O=>{E[O]=u(O)});let r=!1;async function d(){if(r)return;const O={pathname:window.location.pathname};if(a.forEach(x=>{O[x]=u(x)}),Object.keys(E).some(x=>E[x]!==O[x])){Object.assign(E,O),r=!0;try{await T()}catch(x){console.error("Error in URL observer callback:",x)}finally{r=!1}}}function f(){d().catch(O=>{console.error("Error in URL change handler:",O)})}let g=window.location.href;setInterval(()=>{window.location.href!==g&&(g=window.location.href,f())},200),window.addEventListener("popstate",f)}function w(T=[]){N(()=>window.location.reload(),T)}},2524:(S,h,e)=>{e.d(h,{d5:()=>p,vX:()=>n,ft:()=>m});var s=e(157);class i{constructor(c=Date.now(),v=[]){this.lastCheckDate=c,this.reviewsData=v}updateLastCheckDate=()=>{this.lastCheckDate=Date.now()};static fromObject(c){const{lastCheckDate:v,reviewsData:N}=c;return new i(v,N)}}const p={LAST_DOCTOR_UPDATE:"last-doctor-update"};function m(t,c){const v=C(t),N=(0,s.vx)(v),w=u(N);w.reviewsData=c,w.updateLastCheckDate(),(0,s.Fg)(v,w),(0,s.Fg)(p.LAST_DOCTOR_UPDATE,Date.now())}function C(t){return`doctor-${t}`}function u(t){return t?i.fromObject(t):new i}function n(t){return l(t)?.reviewsData??null}function l(t){const c=C(t);return(0,s.vx)(c)}},1753:(S,h,e)=>{e.a(S,async(s,i)=>{try{var p=e(573),m=e(7858),C=e(4231),u=e(5406),n=e(5072);const t=(0,p.Fi)(".appointments_page");t?(0,C.$)(t):(0,u.z2)("otzivi")?await(0,n.N)():(0,u.z2)("vrach")&&(0,m.O)(),i()}catch(l){i(l)}},1)},7653:(S,h,e)=>{e.d(h,{NI:()=>t,z1:()=>N,Np:()=>E,pR:()=>w,sp:()=>d,rd:()=>r});var s=e(9928),i=e(573);const p={DOCTOR_CARD_NAME:'.b-doctor-intro__title-first-line [itemprop="name"]',DOCTOR_INTRO_LEFT:".b-doctor-intro__left-side",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]'};var m=e(8586),C=e(5406),u=e(4214);const n="additionalLinksAppended",l=["\u042F\u043D\u0434\u0435\u043A\u0441","\u041D\u0430\u041F\u043E\u043F\u0440\u0430\u0432\u043A\u0443","DocDoc","\u0414\u043E\u043A\u0442\u0443"];function t(f,g){g.classList.contains(n)||(l.forEach(O=>{c(f,g,O)}),g.classList.add(n))}function c(f,g,O){const x=v(f,O),k=(0,s.d)({},O,x),j=document.createElement("br");g.append(j,k)}function v(f,g){const O=`${f} ${g}`;return`https://www.google.com/search?q=${encodeURIComponent(O)}&btnI`}function N(){const f=(0,i.Fi)(p.DOCTOR_CARD_NAME,document,!0);if(!f)return;const g=f.innerText.trim(),O=(0,s.Sw)();O.style.textAlign="center",(0,i.Fi)(p.DOCTOR_INTRO_LEFT).append(O),t(g,O)}function w(f,g,O=!1){const x=(0,s.Sw)(m.r.REVIEWS_INFO);O&&(x.style.justifyContent="center"),x.classList.add("v-application");const k=(0,s.Sw)(m.r.REVIEWS_INFO_BLOCK);return k.style.height=O?"10px":"23px",k.append(x),f.slice(O?1:0).forEach(j=>{const{category:R,title:I,count:L,bgClassSuffix:P}=j,o=`${g}?rates_category=${R}`,b=O?L:`${I} ${L}`,_=(0,s.d)(m.r.REVIEW_INFO,b,o);_.classList=T(P),x.append(_),O&&a(_,I)}),k}function T(f){return`text-caption text--text px-2 py-1 rounded-sm bg-${f}`}function a(f,g){let O=null;f.addEventListener("mouseenter",()=>{O=(0,s.Sw)(m.r.REVIEW_INFO_TOOLTIP,g),document.body.appendChild(O);const x=f.getBoundingClientRect();O.style.left=`${(x.left+x.right)/2-O.offsetWidth/2+window.scrollX+2}px`,O.style.top=`${x.top+window.scrollY-O.offsetHeight-4}px`}),f.addEventListener("mouseleave",()=>{O&&(O.remove(),O=null)})}function E(f){const g=(0,i.Fi)(p.NAME_SPAN_HOLDER,document,!0);if(!g)return;const O=(0,i.Fi)(p.NAME_SPAN,g,!0);O&&O.append(f)}function r(){const f=(0,C.Fc)(3,"unknown");return(0,u.$z)(f)}function d(f){const g=(0,C.bn)(f,5,"");return(0,u.$z)(g)}},8586:(S,h,e)=>{e.d(h,{r:()=>i});const s={INPUT:{border:"1px solid #c7d3d9",borderRadius:"10px",padding:"7px 14px",marginLeft:"6px"}},i={FILTERS_CONTAINER:{display:"flex",gridGap:"15px",flexFlow:"wrap"},CONTROL:{display:"flex",alignItems:"center"},TEXT_INPUT:{...s.INPUT,width:"195px"},NUMBER_INPUT:{...s.INPUT,width:"70px"},CHECKBOX_INPUT:{...s.INPUT,width:"20px",height:"20px"},REVIEWS_INFO:{gridGap:"6px"},REVIEWS_INFO_BLOCK:{marginTop:"5px"},REVIEW_INFO:{textDecoration:"none",flexShrink:0},REVIEW_INFO_TOOLTIP:{position:"absolute",backgroundColor:"#333",color:"#fff",padding:"4px 8px",borderRadius:"8px",fontSize:"12px",zIndex:"1000",pointerEvents:"none",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"}}},4231:(S,h,e)=>{e.d(h,{$:()=>I});var s=e(5406),i=e(573),p=e(5539),m=e(3829),C=e(7653),u=e(5213),n=e(5884),l=e(7877);const t={LIST_HEADER:".h2_rating",DOCTOR_FILTERS:".vue-the-doctors-filters > .b-container",DOCTOR_CARD:".b-doctor-card",DOCTOR_CARD_NAME:".b-doctor-card__name-surname",PROFILE_CARD:".b-profile-card",REVIEWS_LINK:":scope > a",EXPERIENCE_WRAP:".b-doctor-card__experience .mr-2 .text-subtitle-1",SPEC_WRAP:".b-doctor-card__spec",CLINIC_CONTAINER:"div.b-doctor-card__lpu-select",CLINIC_WRAP:".b-select__trigger-main-text"};var c=e(4521),v=e(2524),N=e(4921),w=e(8586),T=e(6754);const a=window.GM_addValueChangeListener,E=(0,s.Fc)(2),{createGlobalFilter:r,createSectionFilter:d}=(0,c.z)(o,E),f=d("spec-filter"),g=d("clinic-filter"),O=d("min-reviews-filter",10),x=d("min-experience-filter",5,W),k=d("max-experience-filter",40),j=r("filter-enabled",!0),R={doctorCardsCache:new WeakMap};function I(D){W(),L();const B=(0,i.Fi)(t.DOCTOR_FILTERS);(0,u.b)(B,P),o(),a(v.d5.LAST_DOCTOR_UPDATE,o),new MutationObserver((0,N.sg)(o)).observe(D,{childList:!0})}function L(){const D=(0,i.Fi)(t.LIST_HEADER);D&&D.remove()}function P(D,B){(0,T.ZM)(D,w.r.FILTERS_CONTAINER),D.style.marginTop="6px";const V=(0,n.Nm)("\u0421\u043F\u0435\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F:",f,w.r.CONTROL,w.r.TEXT_INPUT),K=(0,n.Nm)("\u041A\u043B\u0438\u043D\u0438\u043A\u0430:",g,w.r.CONTROL,w.r.TEXT_INPUT),F=(0,l.X0)(O,w.r.CONTROL,w.r.NUMBER_INPUT),A=(0,n.nW)("\u041C\u0438\u043D. \u043E\u043F\u044B\u0442: ",x,"1","0","100",w.r.CONTROL,w.r.NUMBER_INPUT),y=(0,n.nW)("\u041C\u0430\u043A\u0441. \u043E\u043F\u044B\u0442: ",k,"1","0","100",w.r.CONTROL,w.r.NUMBER_INPUT),M=(0,l.pW)(j,w.r.CONTROL,w.r.CHECKBOX_INPUT);D.append(V,K,F,A,y,M),B.append(D)}function o(){(0,i.fI)(t.DOCTOR_CARD).forEach(b)}function b(D){if(!j.value){(0,p.kl)(D);return}let B=R.doctorCardsCache.get(D);if(!B){const K=(0,i.Fi)(t.PROFILE_CARD,D),F=(0,i.Fi)(t.REVIEWS_LINK,K),A=(0,i.Fi)(t.EXPERIENCE_WRAP,D);if(!F||!A){(0,p.Bt)(D);return}const M=(0,i.Fi)(t.SPEC_WRAP,D,!0).innerText.trim(),U=(0,i.Fi)(t.CLINIC_CONTAINER,D,!0),z=(0,i.Fi)(t.CLINIC_WRAP,U,!0).innerText.trim(),X=(0,i.YA)(F,!0),Q=(0,i.YA)(A,!0),J=_(F);F.href=J,(0,C.NI)($(D),K),B={specInfo:M,clinicName:z,reviewsLinkNumber:X,experienceNumber:Q,reviewsLink:F,reviewInfoAppended:!1},R.doctorCardsCache.set(D,B)}H(B);const V=(0,m.Ay)(B.specInfo,f)||(0,m.Ay)(B.clinicName,g)||(0,m.JE)(B.reviewsLinkNumber,O)||(0,m.JE)(B.experienceNumber,x)||(0,m.iG)(B.experienceNumber,k);(0,p.UC)(D,V)}function _(D){return D.href.replace(/\/#otzivi$/,"/otzivi/")}function $(D){return(0,i.Fi)(t.DOCTOR_CARD_NAME,D,!0).innerText}function H(D){if(D.reviewInfoAppended)return;const{reviewsLink:B}=D,V=B.href,K=(0,v.vX)((0,C.sp)(V));if(!K)return;const F=(0,C.pR)(K,V,!0);(0,p.WH)(B,F),D.reviewInfoAppended=!0}function W(){if(!x.value)return;const D=new URL(window.location.href);+D.searchParams.get("experience")!==x.value&&(D.searchParams.set("experience",x.value),window.location.href=D.toString())}},7858:(S,h,e)=>{e.d(h,{O:()=>u});var s=e(573),i=e(9928),p=e(7653);const m={REVIEWS_LINK:".b-doctor-intro__rates-wrapper > a",DOCTOR_DETAILS:".b-doctor-details__toc",REVIEWS_FILTER:".reviews-filter:not(.b-reviews-page__filter)",NAME_SPAN_HOLDER:".b-doctor-intro__title-first-line",NAME_SPAN:'[itemprop="name"]',REVIEWS_FILTER_SPAN:":scope > span",DOCTOR_CONTACTS:"#doctor-contacts"};var C=e(2524);function u(){(0,p.z1)(),l();const c=n();t(c);const v=(0,C.vX)((0,p.rd)());if(!v)return;const N=(0,p.pR)(v,c);(0,p.Np)(N)}function n(){const{location:c}=window;return`${c.origin}${c.pathname}otzivi/`}function l(){if(!(0,s.Fi)(m.DOCTOR_CONTACTS))return;const v=[...(0,s.fI)(m.DOCTOR_DETAILS)].pop();if(!v)return;v.style.position="sticky",v.style.top="16px";const N=(0,i.Sw)({},"\u041C\u0435\u0441\u0442\u043E \u0440\u0430\u0431\u043E\u0442\u044B");N.classList.add("b-doctor-details__toc-title");const w=(0,i.d)({},null,"#doctor-contacts");w.classList.add("b-doctor-details__toc-item"),w.append(N),v.insertBefore(w,v.firstChild)}function t(c){const v=(0,s.Fi)(m.REVIEWS_LINK);v&&(v.href=c)}},5072:(S,h,e)=>{e.d(h,{N:()=>b});var s=e(7653);const i={CONTROLS_CONTAINER:".vue-review-filter",REVIEWS:".b-review-card",REVIEW_TEXT_WRAP:".b-review-card__comment",REVIEW_RATING_WRAP:".review-card-tooltips__stars > .ui-text",FILTER_CHIP:'[data-qa="reviews_filter_chip"]',FILTER_LIST:'[data-qa="reviews_filter_list"]',FILTER_LIST_ITEM:'[data-qa^="reviews_filter_list_item"]',FILTER_TITLE_WRAP:'[data-qa="reviews_filter_title"]',FILTER_COUNT_WRAP:'[data-qa="reviews_filter_amount"]',REVIEWS_CONTAINER:"#otzivi"};var p=e(573),m=e(4921),C=e(5406),u=e(2524),n=e(4521),l=e(5213),t=e(8586),c=e(7877),v=e(5539);function N(F,A){F.forEach(y=>w(A,y))}function w(F,A){if(!A)return;const y=new RegExp(`(${A})`,"gi"),M=document.createTreeWalker(F,NodeFilter.SHOW_TEXT,null);let U=M.nextNode();const G=[];for(;U;){const{textContent:z}=U;if(y.test(z)){const X=document.createDocumentFragment();let Q=0;z.replace(y,(J,re,q)=>{q>Q&&X.appendChild(document.createTextNode(z.slice(Q,q)));const Z=document.createElement("span");Z.className="highlightedSubstring",Z.style.backgroundColor="yellow",Z.textContent=J,X.appendChild(Z),Q=q+J.length}),Q<z.length&&X.appendChild(document.createTextNode(z.slice(Q))),G.push({node:U,fragment:X})}U=M.nextNode()}G.forEach(({node:z,fragment:X})=>{z.parentNode.replaceChild(X,z)})}function T(F){(0,p.fI)(".highlightedSubstring",F).forEach(y=>{const{parentNode:M}=y;y.replaceWith(y.textContent),M.normalize()})}var a=e(8355);function E(F,A){const y=(0,a.fO)(F);N(y,A)}function r(F,A){const y=getIncludedSearchStrings(F);A.forEach(M=>highlightSubstrings(y,M))}var d=e(3829),f=e(9928);function g(F={}){return(0,f.Sw)(F,"|")}function O(F={},A=75,y="customFiltersContainer"){const M=document.getElementById(y);if(!M)return console.log(`Element with id="${y}" not found.`),null;const U=createButton(F,`${arrowUpIcon}\u041A \u0444\u0438\u043B\u044C\u0442\u0440\u0430\u043C`);return U.addEventListener("mouseenter",()=>{U.style.filter="brightness(0.9)"}),U.addEventListener("mouseleave",()=>{U.style.filter="brightness(1)"}),U.addEventListener("click",()=>{const G=M.getBoundingClientRect();window.scrollTo({top:G.top+window.scrollY-A})}),new IntersectionObserver(([G])=>{U.style.display=G.isIntersecting?"none":"flex"},{threshold:.5}).observe(M),U}function x(F,A={}){const y=O(A);y&&F.appendChild(y)}var k=e(6754);const{createGlobalFilter:j}=(0,n.z)($),R=j("reviews-text-filter"),I=j("reviews-min-rating-filter"),L=j("reviews-max-rating-filter"),P=j("reviews-filter-enabled",!0),o={reviewCardsCache:new Map};async function b(){(0,s.z1)();const F=await(0,m.xk)(document,i.CONTROLS_CONTAINER);(0,l.b)(F,_),$();const A=await D();(0,u.ft)((0,s.rd)(),A);const y=(0,s.pR)(A,V());(0,s.Np)(y),(0,C.$F)("rates_category")&&K()}function _(F,A){(0,k.ZM)(F,t.r.FILTERS_CONTAINER),F.style.marginTop="12px";const y=(0,c.E9)(R,t.r.CONTROL,t.r.TEXT_INPUT),M=(0,c.HX)(I,t.r.CONTROL,t.r.NUMBER_INPUT,1,1),U=(0,c.FR)(L,t.r.CONTROL,t.r.NUMBER_INPUT,1,1),G=g(t.r.CONTROL),z=(0,c.pW)(P,t.r.CONTROL,t.r.CHECKBOX_INPUT);F.append(y,M,U,G,z),A.append(F)}function $(){(0,p.fI)(i.REVIEWS).forEach(H)}function H(F){if(!P.value){(0,v.kl)(F);return}T(F);let A=o.reviewCardsCache.get(F);if(!A){const M=(0,p.Fi)(i.REVIEW_TEXT_WRAP,F),U=(0,p.Fi)(i.REVIEW_RATING_WRAP,F);if(!M){(0,v.Bt)(F);return}A={reviewTextWrap:M,reviewText:M.innerText,rating:U&&(0,p.YA)(U)},o.reviewCardsCache.set(F,A)}R.value&&E(R,A.reviewTextWrap);const y=(0,d.Ay)(A.reviewText,R)||W(A.rating);(0,v.UC)(F,y)}function W(F){return F?(0,d.JE)(F,I)||(0,d.iG)(F,L):!1}async function D(){const F=(0,p.Fi)(i.FILTER_CHIP);F.click();const A=await(0,m.xk)(document,i.FILTER_LIST),y=[...(0,p.fI)(i.FILTER_LIST_ITEM,A)].map(M=>{const U=M.getAttribute("data-qa");if(!U)return null;const G=U.replace("reviews_filter_list_item_",""),z=(0,p.Fi)(i.FILTER_TITLE_WRAP,M).textContent.trim(),X=(0,p.Fi)(i.FILTER_COUNT_WRAP,M),Q=(0,p.YA)(X,!0),J=B(X.classList);return{category:G,title:z,count:Q,bgClassSuffix:J}});return F.click(),y}function B(F){const A=F.value.match(/bg-(\w+)/);return A?A[1]:null}function V(){const{location:F}=window;return`${F.origin}${F.pathname}`}function K(){(0,p.Fi)(i.REVIEWS_CONTAINER).scrollIntoView({behavior:"smooth"})}}},ee={};function Y(S){var h=ee[S];if(h!==void 0)return h.exports;var e=ee[S]={exports:{}};return te[S](e,e.exports,Y),e.exports}(()=>{var S=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",h=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",e=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",s=p=>{p&&p.d<1&&(p.d=1,p.forEach(m=>m.r--),p.forEach(m=>m.r--?m.r++:m()))},i=p=>p.map(m=>{if(m!==null&&typeof m=="object"){if(m[S])return m;if(m.then){var C=[];C.d=0,m.then(l=>{u[h]=l,s(C)},l=>{u[e]=l,s(C)});var u={};return u[S]=l=>l(C),u}}var n={};return n[S]=l=>{},n[h]=m,n});Y.a=(p,m,C)=>{var u;C&&((u=[]).d=-1);var n=new Set,l=p.exports,t,c,v,N=new Promise((w,T)=>{v=T,c=w});N[h]=l,N[S]=w=>(u&&w(u),n.forEach(w),N.catch(T=>{})),p.exports=N,m(w=>{t=i(w);var T,a=()=>t.map(r=>{if(r[e])throw r[e];return r[h]}),E=new Promise(r=>{T=()=>r(a),T.r=0;var d=f=>f!==u&&!n.has(f)&&(n.add(f),f&&!f.d&&(T.r++,f.push(T)));t.map(f=>f[S](d))});return T.r?E:a()},w=>(w?v(N[e]=w):c(l),s(u))),u&&u.d<0&&(u.d=0)}})(),Y.d=(S,h)=>{for(var e in h)Y.o(h,e)&&!Y.o(S,e)&&Object.defineProperty(S,e,{enumerable:!0,get:h[e]})},Y.o=(S,h)=>Object.prototype.hasOwnProperty.call(S,h);var ne=Y(1753)})();})();
