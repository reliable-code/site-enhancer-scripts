// ==UserScript==
// @name         Vseins product cards filter
// @description  Hide product cards by filter
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.vseinstrumenti.ru/tag-page/*
// @match        https://www.vseinstrumenti.ru/category/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.75785990
// @icon         https://www.google.com/s2/favicons?sz=64&domain=vseinstrumenti.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/vseins.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var B={5467:(F,l,n)=>{n.d(l,{E2:()=>h});var f=n(9928);function h(g,i={},e=null){const r=(0,f.Sw)(i,e);return r.append(g),r}function v(g,i=null,e={},r={}){const w=createActionLink(g,i,r);return h(w,e)}function s(g,i=null,e=null,r={},w={}){const S=createActionLinkWithIcon(g,e,i,w);return h(S,r)}},9928:(F,l,n)=>{n.d(l,{S:()=>g,Sw:()=>x,kU:()=>v,o5:()=>s});var f=n(4921),h=n(6754);function v(o,t,a){const d=i(o,"text",t);return d.value=a,d}function s(o,t,a,d,R,I){const T=i(o,"number",t);return T.value=a,T.step=d,T.min=R,T.max=I,T}function g(o,t,a){const d=i(o,"checkbox",t);return d.checked=a,d}function i(o={},t=null,a=null){const d=u("input",o);return t&&(d.type=t),a&&(d.addEventListener("keyup",(0,f.sg)(a,200)),d.addEventListener("change",(0,f.sg)(a,100))),d}function e(o={},t=null){return u("span",o,t)}function r(o={},t=null,a=null){const d=u("a",o,t);return a&&(d.href=a),d}function w(o,t=null,a={}){a.cursor||="pointer";const d=r(a,t);return o&&d.addEventListener("click",o),d}function S(o,t,a=null,d={},R={}){d.display||="inline-flex",d.alignItems||="center",d.gap||="0.25em";const I=w(o,a,d);return I.prepend(b(t,R)),I}function C(o={},t=null,a=null){const d=u("button",o,t);return a&&d.addEventListener("click",a),d}function x(o={},t=null){return u("div",o,t)}function N(o={}){return u("i",o)}function b(o,t={}){t.width||="1em",t.height||="1em",t.paddingBottom||="1px";const a=N(t);return a.setAttribute("data-lucide",o),a}function u(o,t,a=null){if(typeof t!="object"||t===null)throw new TypeError("styles should be an object");const d=document.createElement(o);return(0,h.ZM)(d,t),a&&(d.innerHTML=a),d}},573:(F,l,n)=>{n.d(l,{Fi:()=>v,ML:()=>S,fI:()=>s});var f=n(4214);function h(u,o=document){return!!o.querySelector(u)}function v(u,o=document,t=!1){const a=o.querySelector(u);return t&&!a&&console.log(`No element found for selector: ${u}`),a}function s(u,o=document,t=!1){const a=o.querySelectorAll(u);return t&&!a.length&&console.log(`No elements found for selector: ${u}`),a}function g(u,o=1){let t=u;for(let a=0;a<o;a++){if(!t.parentElement)return null;t=t.parentElement}return t}function i(u,o,t){return[...u.querySelectorAll(o)].find(a=>a.textContent.trim().includes(t))}function e(u,o,t=!1,a=!1,d=null){const R=v(o,u);return r(R,t,a,d)}function r(u,o=!1,t=!1,a=null){if(!u)return a===null?(console.log("No element found"),null):a;const d=u.innerText;return C(d,o,t)}function w(u,o,t=!1){const a=u[o];return r(a,t)}function S(u,o=!1,t=!1){const a=u.textContent;return C(a,o,t)}function C(u,o,t){o&&(u=(0,f.zr)(u)),t&&(u=u.replace(",","."));const a=Number(u);return Number.isNaN(a)?(console.log(`Invalid number: ${u}`),0):a}function x(u){return[...u.childNodes].find(o=>o.nodeType===Node.TEXT_NODE)}function N(u){const o=t=>t.nodeType===Node.TEXT_NODE&&t.textContent.trim()!==""?[t]:[...t.childNodes].flatMap(o);return o(u)}function b(u){return normalizeSpacing(u.textContent)}},5539:(F,l,n)=>{n.d(l,{Bt:()=>h,UC:()=>w,kl:()=>e});function f(c,y){c.parentNode.insertBefore(y,c.nextSibling)}function h(c){c.style.display="none"}function v(c,y=1){const k=document.querySelector(c);k&&s(k,y)}function s(c,y=1){const k=getElementAncestor(c,y);k&&h(k)}function g(c){x(c),h(c)}function i(c){c.intersectionObserver||runOnceOnIntersection(c,()=>h(c))}function e(c){c.style.display=""}function r(c){const y=C(c);c.style.display=y}function w(c,y){y?h(c):e(c)}function S(c,y){y?i(c):(clearIntersectionObserver(c),e(c))}function C(c){return x(c),c.defaultDisplay}function x(c){if(c.defaultDisplay)return;const{display:y}=getComputedStyle(c);c.defaultDisplay=y}function N(){return{show:[],hide:[]}}function b(c,y,k){c?y.hide.push(k):y.show.push(k)}function u(c){c.show.forEach(e),c.hide.forEach(h)}function o(c,y,k=.3){y?a(c,k):t(c)}function t(c){c.style.opacity=""}function a(c,y=.3){c.style.opacity=y}function d(c){c.style.order=""}function R(c,y){c.style.order=y}function I(c,y){c.style.background=y}function T(c,y){const k=getFirstElement(y);k&&E(c,k)}function E(c,y){const k=createLink();k.href=c,y.parentNode.append(k),k.append(y)}function m(c,y){const k=getFirstElement(y);k&&p(c,k)}function p(c,y){const k=createLink();k.href=c,k.append(...y.childNodes),y.append(k)}function L(){const c=getURLQueryParam("scrollTo");if(!c)return;const y=document.getElementById(c);y?y.scrollIntoView():console.log(`Element with ID "${c}" was not found.`)}function A(c,y,k){const V=`${k}-click-passed`;return function(O){if(O.hasAttribute(V))return;const D=findElementByText(O,c,y);D&&D.click(),O.setAttribute(V,"")}}function U(c,y,k="text/plain"){const V=new Blob([c],{type:k}),O=URL.createObjectURL(V),D=document.createElement("a");D.href=O,D.download=y,document.body.appendChild(D),D.click(),document.body.removeChild(D),requestAnimationFrame(()=>URL.revokeObjectURL(O))}},6754:(F,l,n)=>{n.d(l,{ZM:()=>f});function f(g,i){Object.assign(g.style,i)}function h(g,i="custom-global-style"){let e=document.getElementById(i);e||(e=document.createElement("style"),e.id=i,e.type="text/css",document.head.appendChild(e)),e.textContent=g}function v(g){return Object.entries(g).map(([i,e])=>`${i.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${e};`).join(" ")}function s(g){return g?g.split(";").filter(i=>i.trim()!=="").reduce((i,e)=>{const[r,w]=e.split(":").map(C=>C.trim()),S=r.replace(/-([a-z])/g,(C,x)=>x.toUpperCase());return i[S]=w,i},{}):{}}},4921:(F,l,n)=>{n.d(l,{sg:()=>s,xk:()=>f});function f(e,r,w=null){const S=e.querySelector(r);return S?Promise.resolve(S):new Promise(C=>{const x=new MutationObserver(b);x.observe(e,{childList:!0,subtree:!0});let N;w&&(N=setTimeout(()=>{x.disconnect(),console.log(`No element found for selector: ${r}`),C(null)},w));function b(){const u=e.querySelector(r);u&&(N&&clearTimeout(N),x.disconnect(),C(u))}})}function h(e,r){return e.querySelector(r)?new Promise(S=>{const C=new MutationObserver(x);C.observe(e,{childList:!0,subtree:!0});function x(){e.querySelector(r)||(C.disconnect(),S())}}):Promise.resolve()}function v(e,r=400){return new Promise(w=>{let S;const C=new MutationObserver(()=>{clearTimeout(S),x()});function x(){S=setTimeout(()=>{C.disconnect(),w()},r)}x(),C.observe(e,{childList:!0,subtree:!0})})}function s(e,r=250){let w;return(...S)=>{clearTimeout(w),w=setTimeout(()=>e(...S),r)}}function g(e,r){const w=new IntersectionObserver(S=>{S.forEach(C=>{C.isIntersecting&&(r(),i(e))})});e.intersectionObserver=w,w.observe(e)}function i(e){e.intersectionObserver&&(e.intersectionObserver.disconnect(),e.intersectionObserver=null)}},3829:(F,l,n)=>{n.d(l,{Ay:()=>h,JE:()=>s});var f=n(8355);function h(e,r){return!v(e,r)}function v(e,r){if(!r.value)return!0;const w=e.toLowerCase(),S=(0,f.R)(r),C=[],x=[];return S.forEach(N=>{if(N.startsWith("!")){const b=N.substring(1);b&&x.push(b)}else C.push(N)}),C.every(N=>w.includes(N))&&x.every(N=>!w.includes(N))}function s(e,r){return r.value!=null&&e<r.value}function g(e,r){return r.value!=null&&e>r.value}function i(e,r){return r.value&&e!==r.value}},4521:(F,l,n)=>{n.d(l,{z:()=>h});var f=n(3048);function h(v,s=null){return{createGlobalFilter(g,i=null,e=v){return f.V.create(g,i,e)},createSectionFilter(g,i=null,e=v){if(!s)throw new Error("sectionId must be provided to use createSectionFilter.");return f.V.createWithCompositeKey(s,g,i,e)}}}},5884:(F,l,n)=>{n.d(l,{Hw:()=>g,Nm:()=>v,nW:()=>s});var f=n(9928),h=n(5467);function v(i,e,r={},w={}){const S=(0,f.kU)(w,e.updateValueFromEvent,e.value);return(0,h.E2)(S,r,i)}function s(i,e,r,w,S,C={},x={}){const N=(0,f.o5)(x,e.updateValueFromEvent,e.value,r,w,S);return(0,h.E2)(N,C,i)}function g(i,e,r={},w={}){const S=(0,f.S)(w,e.updateValueFromEvent,e.value);return(0,h.E2)(S,r,i)}},7877:(F,l,n)=>{n.d(l,{E9:()=>h,HX:()=>v,X0:()=>g,pW:()=>T});var f=n(5884);function h(E,m={},p={}){return(0,f.Nm)("\u041F\u043E\u0438\u0441\u043A: ",E,m,p)}function v(E,m={},p={},L=.1,A=3){return(0,f.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",E,L,A,5,m,p)}function s(E,m={},p={},L=.1,A=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",E,L,A,5,m,p)}function g(E,m={},p={}){return e("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",E,m,p)}function i(E,m={},p={}){return e("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",E,m,p)}function e(E,m,p={},L={}){return(0,f.nW)(E,m,"1","1","999999",p,L)}function r(E,m={},p={}){return w("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",E,m,p)}function w(E,m,p={},L={}){return createNumberFilterControl(E,m,"5","0","100",p,L)}function S(E,m={},p={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",E,"5","0","100",m,p)}function C(E,m,p={},L={},A="250"){return createNumberFilterControl(E,m,A,"0","1000000",p,L)}function x(E,m={},p={},L="25"){return C("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",E,m,p,L)}function N(E,m={},p={},L="25"){return C("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",E,m,p,L)}function b(E,m={},p={}){return u("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",E,m,p)}function u(E,m,p={},L={}){return createNumberFilterControl(E,m,"1","0","99999",p,L)}function o(E,m={},p={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",E,"1","2","7",m,p)}function t(E,m={},p={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",E,1,1,10,m,p)}function a(E,m={},p={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",E,m,p)}function d(E,m={},p={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",E,m,p)}function R(E,m={},p={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",E,m,p)}function I(E,m={},p={}){return createCheckboxFilterControl("\u0411\u0430\u043B\u043B\u044B: ",E,m,p)}function T(E,m={},p={}){return(0,f.Hw)("\u0412\u043A\u043B: ",E,m,p)}},8355:(F,l,n)=>{n.d(l,{R:()=>f});function f(v){return v.value.toLowerCase().split(",").map(s=>s.trim()).filter(s=>s!=="")}function h(v){return f(v).filter(s=>!s.startsWith("!"))}},5213:(F,l,n)=>{n.d(l,{b:()=>v});var f=n(9928),h=n(573);function v(s,g,i=!1,e="customFiltersContainer"){let r=(0,h.Fi)(`#${e}`,s);if(r)if(i)r.remove();else return;r=(0,f.Sw)(),r.id=e,g(r,s)}},8200:(F,l,n)=>{n.d(l,{s:()=>f});function f(h){const{target:v}=h,{type:s}=v;switch(s){case"text":return`"${v.value}"`;case"number":return v.value;case"checkbox":return v.checked;default:return console.log(`Unknown input type: ${s}`),null}}},157:(F,l,n)=>{n.d(l,{Fg:()=>f,vx:()=>v});const f=window.GM_setValue,h=window.GM.setValue,v=window.GM_getValue},1870:(F,l,n)=>{n.d(l,{j:()=>f});class f{constructor(v,s){this.value=v,this.onChange=s}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(F,l,n)=>{n.d(l,{V:()=>g});var f=n(1870),h=n(8200),v=n(3976),s=n(157);class g extends f.j{constructor(e,r=null,w=null){super((0,s.vx)(e,r),w),this.storageKey=e,this.defaultValue=r}static create(e,r=null,w=null){return new g(e,r,w)}static createWithCompositeKey(e,r,w=null,S=null){const C=`${e}-${r}`;return new g(C,w,S)}updateValueFromEvent=e=>{const r=(0,h.s)(e),w=(0,v.$)(r);this.updateValue(w)};updateValue(e,r=!0){this.value!==e&&((0,s.Fg)(this.storageKey,e),this.value=e,r&&this.onChangeIfDefined())}clearValue(e=!1){this.updateValue(null,e)}resetValue(e=!1){this.updateValue(this.defaultValue,e)}}},3976:(F,l,n)=>{n.d(l,{$:()=>f});function f(h){return h===""?null:JSON.parse(h)}},4214:(F,l,n)=>{n.d(l,{zr:()=>h});function f(i){return i.replace(/\D/g,"")}function h(i){return i.replace(/[^\d.,-]/g,"")}function v(i){return i.replace(/\s/g,"")}function s(i){return i.charAt(0).toUpperCase()+i.slice(1)}function g(i){return i.replace(/\s+/g," ").trim()}},5406:(F,l,n)=>{n.d(l,{Fc:()=>f});function f(b,u="common",o=!1){const{pathname:t}=window.location;return h(t,b,u,o)}function h(b,u,o,t=!1){const a=b.split("/");u=u<0?a.length+u:u;const d=a[u]||o;return t&&console.log(`Pathname element: ${d}`),d}function v(b,u="common",o=!1){const t=f(b,"",o);return s(t,u,o)}function s(b,u,o){if(!b)return u;const t=b.split("-").at(-1);return o&&console.log(`Pathname element ending: ${t}`),t}function g(b,u,o="common",t=!1){const a=h(b,u,"",t);return s(a,o,t)}function i(b){return new URLSearchParams(window.location.search).get(b)}function e(b){return b.split("?")[0]}function r(b){return window.location.pathname.includes(b)}function w(b){return b.some(u=>r(u))}function S(b){return window.location.pathname.split("/").some(o=>o===b)}function C(b){try{const u=new URL(window.location.href);Object.entries(b).forEach(([o,t])=>{u.searchParams.set(o,t)}),window.location.href=u.toString()}catch(u){console.error("Failed to redirect:",u)}}function x(b,u=[]){const o={pathname:window.location.pathname};u.forEach(I=>{o[I]=i(I)});let t=!1;async function a(){if(t)return;const I={pathname:window.location.pathname};if(u.forEach(T=>{I[T]=i(T)}),Object.keys(o).some(T=>o[T]!==I[T])){Object.assign(o,I),t=!0;try{await b()}catch(T){console.error("Error in URL observer callback:",T)}finally{t=!1}}}function d(){a().catch(I=>{console.error("Error in URL change handler:",I)})}let R=window.location.href;setInterval(()=>{window.location.href!==R&&(R=window.location.href,d())},200),window.addEventListener("popstate",d)}function N(b=[]){x(()=>window.location.reload(),b)}},6220:(F,l,n)=>{n.a(F,async(f,h)=>{try{let I=function(m,p){(0,N.ZM)(m,C.r.filtersContainer);const L=(0,r.E9)(o,C.r.control,C.r.textInput),A=(0,r.X0)(t,C.r.control,C.r.numberInput),U=(0,r.HX)(a,C.r.control,C.r.numberInput),c=(0,r.pW)(d,C.r.control,C.r.checkboxInput);m.append(L,A,U,c),p.parentNode.insertBefore(m,p)},T=function(){(0,e.fI)(`${x.Z.PRODUCT_LIST} > div`).forEach(E)},E=function(m){if(!d.value){(0,i.kl)(m);return}const p=(0,e.Fi)(x.Z.PRODUCT_NAME_WRAP,m),L=(0,e.Fi)(x.Z.PRODUCT_RATING_WRAP,m);if(!p||!L){(0,i.Bt)(m);return}const A=p.innerText,U=(0,e.ML)(L.childNodes[2],!0),y=+(0,e.Fi)(x.Z.PRODUCT_RATING,L).getAttribute("value"),k=(0,g.Ay)(A,o)||(0,g.JE)(U,t)||(0,g.JE)(y,a);(0,i.UC)(m,k)};var v=n(4921),s=n(5213),g=n(3829),i=n(5539),e=n(573),r=n(7877),w=n(5406),S=n(4521),C=n(6504),x=n(4858),N=n(6754);const b=(0,w.Fc)(2),{createSectionFilter:u}=(0,S.z)(T,b),o=u("name-filter"),t=u("min-reviews-filter"),a=u("min-rating-filter",4.8),d=u("filter-enabled",!0);await R();async function R(){if(!await(0,v.xk)(document,x.Z.PRODUCT_LIST_TOP))return;const p=(0,e.Fi)(x.Z.PRODUCT_LIST,document,!0);(0,s.b)(p,I,!0),new MutationObserver(T).observe(p,{childList:!0,subtree:!0})}h()}catch(b){h(b)}},1)},4858:(F,l,n)=>{n.d(l,{Z:()=>f});const f={PRODUCT_LIST:'[data-qa="listing"]',PRODUCT_LIST_TOP:"#product-listing-top",PRODUCT_NAME_WRAP:'[data-qa="product-name"]',PRODUCT_RATING_WRAP:'[data-qa="product-rating"]',PRODUCT_RATING:'[name="rating"]'}},6504:(F,l,n)=>{n.d(l,{r:()=>h});const f={input:{marginLeft:"5px",border:"1px solid #dadcde",borderRadius:"8px",padding:"8px 16px",fontSize:"16px"}},h={filtersContainer:{display:"flex",gridGap:"11px",marginBottom:"18px"},control:{display:"flex",alignItems:"center",fontSize:"16px"},textInput:{...f.input,width:"180px"},numberInput:{...f.input,width:"90px"},checkboxInput:{marginLeft:"5px",width:"22px",height:"22px"}}}},$={};function P(F){var l=$[F];if(l!==void 0)return l.exports;var n=$[F]={exports:{}};return B[F](n,n.exports,P),n.exports}(()=>{var F=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",l=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",n=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",f=v=>{v&&v.d<1&&(v.d=1,v.forEach(s=>s.r--),v.forEach(s=>s.r--?s.r++:s()))},h=v=>v.map(s=>{if(s!==null&&typeof s=="object"){if(s[F])return s;if(s.then){var g=[];g.d=0,s.then(r=>{i[l]=r,f(g)},r=>{i[n]=r,f(g)});var i={};return i[F]=r=>r(g),i}}var e={};return e[F]=r=>{},e[l]=s,e});P.a=(v,s,g)=>{var i;g&&((i=[]).d=-1);var e=new Set,r=v.exports,w,S,C,x=new Promise((N,b)=>{C=b,S=N});x[l]=r,x[F]=N=>(i&&N(i),e.forEach(N),x.catch(b=>{})),v.exports=x,s(N=>{w=h(N);var b,u=()=>w.map(t=>{if(t[n])throw t[n];return t[l]}),o=new Promise(t=>{b=()=>t(u),b.r=0;var a=d=>d!==i&&!e.has(d)&&(e.add(d),d&&!d.d&&(b.r++,d.push(b)));w.map(d=>d[F](a))});return b.r?o:u()},N=>(N?C(x[n]=N):S(r),f(i))),i&&i.d<0&&(i.d=0)}})(),P.d=(F,l)=>{for(var n in l)P.o(l,n)&&!P.o(F,n)&&Object.defineProperty(F,n,{enumerable:!0,get:l[n]})},P.o=(F,l)=>Object.prototype.hasOwnProperty.call(F,l);var j=P(6220)})();})();
