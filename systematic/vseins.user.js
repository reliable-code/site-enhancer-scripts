// ==UserScript==
// @name         Vseins product cards filter
// @description  Hide product cards by filter
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.vseinstrumenti.ru/tag-page/*
// @match        https://www.vseinstrumenti.ru/category/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.75918878
// @icon         https://www.google.com/s2/favicons?sz=64&domain=vseinstrumenti.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/vseins.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var j={5467:(S,s,n)=>{n.d(s,{E2:()=>b});var p=n(9928);function b(w,i={},t=null){const c=(0,p.Sw)(i,t);return c.append(w),c}function g(w,i=null,t={},c={}){const l=createActionLink(w,i,c);return b(l,t)}function d(w,i=null,t=null,c={},l={}){const N=createActionLinkWithIcon(w,t,i,l);return b(N,c)}},9928:(S,s,n)=>{n.d(s,{S:()=>w,Sw:()=>F,kU:()=>g,o5:()=>d});var p=n(4921),b=n(6754);function g(u,e,a){const m=i(u,"text",e);return m.value=a,m}function d(u,e,a,m,A,T){const I=i(u,"number",e);return I.value=a,I.step=m,I.min=A,I.max=T,I}function w(u,e,a){const m=i(u,"checkbox",e);return m.checked=a,m}function i(u={},e=null,a=null){const m=r("input",u);return e&&(m.type=e),a&&(m.addEventListener("keyup",(0,p.sg)(a,200)),m.addEventListener("change",(0,p.sg)(a,100))),m}function t(u={},e=null){return r("span",u,e)}function c(u={},e=null,a=null){const m=r("a",u,e);return a&&(m.href=a),m}function l(u,e=null,a={}){a.cursor||="pointer";const m=c(a,e);return u&&m.addEventListener("click",u),m}function N(u,e,a=null,m={},A={}){m.display||="inline-flex",m.alignItems||="center",m.gap||="0.25em";const T=l(u,a,m);return T.prepend(f(e,A)),T}function C(u={},e=null,a=null){const m=r("button",u,e);return a&&m.addEventListener("click",a),m}function F(u={},e=null){return r("div",u,e)}function x(u={}){return r("i",u)}function f(u,e={}){e.width||="1em",e.height||="1em",e.paddingBottom||="1px";const a=x(e);return a.setAttribute("data-lucide",u),a}function r(u,e,a=null){if(typeof e!="object"||e===null)throw new TypeError("styles should be an object");const m=document.createElement(u);return(0,b.ZM)(m,e),a&&(m.innerHTML=a),m}},573:(S,s,n)=>{n.d(s,{Fi:()=>g,ML:()=>N,fI:()=>d});var p=n(4214);function b(r,u=document){return!!u.querySelector(r)}function g(r,u=document,e=!1){const a=u.querySelector(r);return e&&!a&&console.log(`No element found for selector: ${r}`),a}function d(r,u=document,e=!1){const a=u.querySelectorAll(r);return e&&!a.length&&console.log(`No elements found for selector: ${r}`),a}function w(r,u=1){let e=r;for(let a=0;a<u;a++){if(!e.parentElement)return null;e=e.parentElement}return e}function i(r,u,e){return[...r.querySelectorAll(u)].find(a=>a.textContent.trim().includes(e))}function t(r,u,e=!1,a=!1,m=null){const A=g(u,r);return c(A,e,a,m)}function c(r,u=!1,e=!1,a=null){if(!r)return a===null?(console.log("No element found"),null):a;const m=r.innerText;return C(m,u,e)}function l(r,u,e=!1){const a=r[u];return c(a,e)}function N(r,u=!1,e=!1){const a=r.textContent;return C(a,u,e)}function C(r,u,e){u&&(r=(0,p.zr)(r)),e&&(r=r.replace(",","."));const a=Number(r);return Number.isNaN(a)?(console.log(`Invalid number: ${r}`),0):a}function F(r){return[...r.childNodes].find(u=>u.nodeType===Node.TEXT_NODE)}function x(r){const u=e=>e.nodeType===Node.TEXT_NODE&&e.textContent.trim()!==""?[e]:[...e.childNodes].flatMap(u);return u(r)}function f(r){return normalizeSpacing(r.textContent)}},5539:(S,s,n)=>{n.d(s,{Bt:()=>b,UC:()=>l,kl:()=>t});function p(o,y){o.parentNode.insertBefore(y,o.nextSibling)}function b(o){o.style.display="none"}function g(o,y=1){const k=document.querySelector(o);k&&d(k,y)}function d(o,y=1){const k=getElementAncestor(o,y);k&&b(k)}function w(o){F(o),b(o)}function i(o){o.intersectionObserver||runOnceOnIntersection(o,()=>b(o))}function t(o){o.style.display=""}function c(o){const y=C(o);o.style.display=y}function l(o,y){y?b(o):t(o)}function N(o,y){y?i(o):(clearIntersectionObserver(o),t(o))}function C(o){return F(o),o.defaultDisplay}function F(o){if(o.defaultDisplay)return;const{display:y}=getComputedStyle(o);o.defaultDisplay=y}function x(){return{show:[],hide:[]}}function f(o,y,k){o?y.hide.push(k):y.show.push(k)}function r(o){o.show.forEach(t),o.hide.forEach(b)}function u(o,y,k=.3){y?a(o,k):e(o)}function e(o){o.style.opacity=""}function a(o,y=.3){o.style.opacity=y}function m(o){o.style.order=""}function A(o,y){o.style.order=y}function T(o,y){o.style.background=y}function I(o,y){const k=getFirstElement(y);k&&E(o,k)}function E(o,y){const k=createLink();k.href=o,y.parentNode.append(k),k.append(y)}function h(o,y){const k=getFirstElement(y);k&&v(o,k)}function v(o,y){const k=createLink();k.href=o,k.append(...y.childNodes),y.append(k)}function L(){const o=getURLQueryParam("scrollTo");if(!o)return;const y=document.getElementById(o);y?y.scrollIntoView():console.log(`Element with ID "${o}" was not found.`)}function D(o,y,k=null){const U=`${y}-click-passed`,V=k?R=>findElementByText(R,o,k):R=>getFirstElement(o,R);return function(R){if(R.hasAttribute(U))return!1;const B=V(R);return B&&B.click(),R.setAttribute(U,""),!0}}function O(o,y,k="text/plain"){const U=new Blob([o],{type:k}),V=URL.createObjectURL(U),R=document.createElement("a");R.href=V,R.download=y,document.body.appendChild(R),R.click(),document.body.removeChild(R),requestAnimationFrame(()=>URL.revokeObjectURL(V))}},6754:(S,s,n)=>{n.d(s,{ZM:()=>p});function p(w,i){Object.assign(w.style,i)}function b(w,i="custom-global-style"){let t=document.getElementById(i);t||(t=document.createElement("style"),t.id=i,t.type="text/css",document.head.appendChild(t)),t.textContent=w}function g(w){return Object.entries(w).map(([i,t])=>`${i.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${t};`).join(" ")}function d(w){return w?w.split(";").filter(i=>i.trim()!=="").reduce((i,t)=>{const[c,l]=t.split(":").map(C=>C.trim()),N=c.replace(/-([a-z])/g,(C,F)=>F.toUpperCase());return i[N]=l,i},{}):{}}},4921:(S,s,n)=>{n.d(s,{sg:()=>d,xk:()=>p});function p(l,N,C=null){const F=l.querySelector(N);return F?Promise.resolve(F):new Promise(x=>{const f=new MutationObserver(u);f.observe(l,{childList:!0,subtree:!0});let r;C&&(r=setTimeout(()=>{f.disconnect(),console.log(`No element found for selector: ${N}`),x(null)},C));function u(){const e=l.querySelector(N);e&&(r&&clearTimeout(r),f.disconnect(),x(e))}})}function b(l,N){return l.querySelector(N)?new Promise(F=>{const x=new MutationObserver(f);x.observe(l,{childList:!0,subtree:!0});function f(){l.querySelector(N)||(x.disconnect(),F())}}):Promise.resolve()}function g(l,N=400){return new Promise(C=>{let F;const x=new MutationObserver(()=>{clearTimeout(F),f()});function f(){F=setTimeout(()=>{x.disconnect(),C()},N)}f(),x.observe(l,{childList:!0,subtree:!0})})}function d(l,N=250){let C;return(...F)=>{clearTimeout(C),C=setTimeout(()=>l(...F),N)}}async function w(l){document.visibilityState==="visible"?await l():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await l()},{once:!0})}function i(l,N){const C=new IntersectionObserver(F=>{F.forEach(x=>{x.isIntersecting&&(N(),t(l))})});l.intersectionObserver=C,C.observe(l)}function t(l){l.intersectionObserver&&(l.intersectionObserver.disconnect(),l.intersectionObserver=null)}function c(l){l&&(l.disconnect(),l=null)}},3829:(S,s,n)=>{n.d(s,{Ay:()=>b,JE:()=>d});var p=n(8355);function b(t,c){return!g(t,c)}function g(t,c){if(!c.value)return!0;const l=t.toLowerCase(),N=(0,p.R)(c),C=[],F=[];return N.forEach(x=>{if(x.startsWith("!")){const f=x.substring(1);f&&F.push(f)}else C.push(x)}),C.every(x=>l.includes(x))&&F.every(x=>!l.includes(x))}function d(t,c){return c.value!=null&&t<c.value}function w(t,c){return c.value!=null&&t>c.value}function i(t,c){return c.value&&t!==c.value}},4521:(S,s,n)=>{n.d(s,{z:()=>b});var p=n(3048);function b(g,d=null){return{createGlobalFilter(w,i=null,t=g){return p.V.create(w,i,t)},createSectionFilter(w,i=null,t=g){if(!d)throw new Error("sectionId must be provided to use createSectionFilter.");return p.V.createWithCompositeKey(d,w,i,t)}}}},5884:(S,s,n)=>{n.d(s,{Hw:()=>w,Nm:()=>g,nW:()=>d});var p=n(9928),b=n(5467);function g(i,t,c={},l={}){const N=(0,p.kU)(l,t.updateValueFromEvent,t.value);return(0,b.E2)(N,c,i)}function d(i,t,c,l,N,C={},F={}){const x=(0,p.o5)(F,t.updateValueFromEvent,t.value,c,l,N);return(0,b.E2)(x,C,i)}function w(i,t,c={},l={}){const N=(0,p.S)(l,t.updateValueFromEvent,t.value);return(0,b.E2)(N,c,i)}},7877:(S,s,n)=>{n.d(s,{E9:()=>b,HX:()=>g,X0:()=>w,pW:()=>I});var p=n(5884);function b(E,h={},v={}){return(0,p.Nm)("\u041F\u043E\u0438\u0441\u043A: ",E,h,v)}function g(E,h={},v={},L=.1,D=3){return(0,p.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",E,L,D,5,h,v)}function d(E,h={},v={},L=.1,D=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",E,L,D,5,h,v)}function w(E,h={},v={}){return t("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",E,h,v)}function i(E,h={},v={}){return t("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",E,h,v)}function t(E,h,v={},L={}){return(0,p.nW)(E,h,"1","1","999999",v,L)}function c(E,h={},v={}){return l("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",E,h,v)}function l(E,h,v={},L={}){return createNumberFilterControl(E,h,"5","0","100",v,L)}function N(E,h={},v={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",E,"5","0","100",h,v)}function C(E,h,v={},L={},D="250"){return createNumberFilterControl(E,h,D,"0","1000000",v,L)}function F(E,h={},v={},L="25"){return C("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",E,h,v,L)}function x(E,h={},v={},L="25"){return C("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",E,h,v,L)}function f(E,h={},v={}){return r("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",E,h,v)}function r(E,h,v={},L={}){return createNumberFilterControl(E,h,"1","0","99999",v,L)}function u(E,h={},v={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",E,"1","2","7",h,v)}function e(E,h={},v={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",E,1,1,10,h,v)}function a(E,h={},v={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",E,h,v)}function m(E,h={},v={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",E,h,v)}function A(E,h={},v={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",E,h,v)}function T(E,h={},v={}){return createCheckboxFilterControl("\u0411\u0430\u043B\u043B\u044B: ",E,h,v)}function I(E,h={},v={}){return(0,p.Hw)("\u0412\u043A\u043B: ",E,h,v)}},8355:(S,s,n)=>{n.d(s,{R:()=>p});function p(g){return g.value.toLowerCase().split(",").map(d=>d.trim()).filter(d=>d!=="")}function b(g){return p(g).filter(d=>!d.startsWith("!"))}},5213:(S,s,n)=>{n.d(s,{b:()=>g});var p=n(9928),b=n(573);function g(d,w,i=!1,t="customFiltersContainer"){let c=(0,b.Fi)(`#${t}`,d);if(c)if(i)c.remove();else return;c=(0,p.Sw)(),c.id=t,w(c,d)}},8200:(S,s,n)=>{n.d(s,{s:()=>p});function p(b){const{target:g}=b,{type:d}=g;switch(d){case"text":return`"${g.value}"`;case"number":return g.value;case"checkbox":return g.checked;default:return console.log(`Unknown input type: ${d}`),null}}},157:(S,s,n)=>{n.d(s,{Fg:()=>p,vx:()=>g});const p=window.GM_setValue,b=window.GM.setValue,g=window.GM_getValue},1870:(S,s,n)=>{n.d(s,{j:()=>p});class p{constructor(g,d){this.value=g,this.onChange=d}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(S,s,n)=>{n.d(s,{V:()=>w});var p=n(1870),b=n(8200),g=n(3976),d=n(157);class w extends p.j{constructor(t,c=null,l=null){super((0,d.vx)(t,c),l),this.storageKey=t,this.defaultValue=c}static create(t,c=null,l=null){return new w(t,c,l)}static createWithCompositeKey(t,c,l=null,N=null){const C=`${t}-${c}`;return new w(C,l,N)}updateValueFromEvent=t=>{const c=(0,b.s)(t),l=(0,g.$)(c);this.updateValue(l)};updateValue(t,c=!0){this.value!==t&&((0,d.Fg)(this.storageKey,t),this.value=t,c&&this.onChangeIfDefined())}clearValue(t=!1){this.updateValue(null,t)}resetValue(t=!1){this.updateValue(this.defaultValue,t)}}},3976:(S,s,n)=>{n.d(s,{$:()=>p});function p(b){return b===""?null:JSON.parse(b)}},4214:(S,s,n)=>{n.d(s,{zr:()=>b});function p(i){return i.replace(/\D/g,"")}function b(i){return i.replace(/[^\d.,-]/g,"")}function g(i){return i.replace(/\s/g,"")}function d(i){return i.charAt(0).toUpperCase()+i.slice(1)}function w(i){return i.replace(/\s+/g," ").trim()}},5406:(S,s,n)=>{n.d(s,{Fc:()=>p});function p(f,r="common",u=!1){const{pathname:e}=window.location;return b(e,f,r,u)}function b(f,r,u,e=!1){const a=f.split("/");r=r<0?a.length+r:r;const m=a[r]||u;return e&&console.log(`Pathname element: ${m}`),m}function g(f,r="common",u=!1){const e=p(f,"",u);return d(e,r,u)}function d(f,r,u){if(!f)return r;const e=f.split("-").at(-1);return u&&console.log(`Pathname element ending: ${e}`),e}function w(f,r,u="common",e=!1){const a=b(f,r,"",e);return d(a,u,e)}function i(f){return new URLSearchParams(window.location.search).get(f)}function t(f){return f.split("?")[0]}function c(f){return window.location.pathname.includes(f)}function l(f){return f.some(r=>c(r))}function N(f){return window.location.pathname.split("/").some(u=>u===f)}function C(f){try{const r=new URL(window.location.href);Object.entries(f).forEach(([u,e])=>{r.searchParams.set(u,e)}),window.location.href=r.toString()}catch(r){console.error("Failed to redirect:",r)}}function F(f,r=[]){const u={pathname:window.location.pathname};r.forEach(T=>{u[T]=i(T)});let e=!1;async function a(){if(e)return;const T={pathname:window.location.pathname};if(r.forEach(I=>{T[I]=i(I)}),Object.keys(u).some(I=>u[I]!==T[I])){Object.assign(u,T),e=!0;try{await f()}catch(I){console.error("Error in URL observer callback:",I)}finally{e=!1}}}function m(){a().catch(T=>{console.error("Error in URL change handler:",T)})}let A=window.location.href;setInterval(()=>{window.location.href!==A&&(A=window.location.href,m())},200),window.addEventListener("popstate",m)}function x(f=[]){F(()=>window.location.reload(),f)}},6220:(S,s,n)=>{n.a(S,async(p,b)=>{try{let T=function(h,v){(0,x.ZM)(h,C.r.filtersContainer);const L=(0,c.E9)(u,C.r.control,C.r.textInput),D=(0,c.X0)(e,C.r.control,C.r.numberInput),O=(0,c.HX)(a,C.r.control,C.r.numberInput),o=(0,c.pW)(m,C.r.control,C.r.checkboxInput);h.append(L,D,O,o),v.parentNode.insertBefore(h,v)},I=function(){(0,t.fI)(`${F.Z.PRODUCT_LIST} > div`).forEach(E)},E=function(h){if(!m.value){(0,i.kl)(h);return}const v=(0,t.Fi)(F.Z.PRODUCT_NAME_WRAP,h),L=(0,t.Fi)(F.Z.PRODUCT_RATING_WRAP,h);if(!v||!L){(0,i.Bt)(h);return}const D=v.innerText,O=(0,t.ML)(L.childNodes[2],!0),y=+(0,t.Fi)(F.Z.PRODUCT_RATING,L).getAttribute("value"),k=(0,w.Ay)(D,u)||(0,w.JE)(O,e)||(0,w.JE)(y,a);(0,i.UC)(h,k)};var g=n(4921),d=n(5213),w=n(3829),i=n(5539),t=n(573),c=n(7877),l=n(5406),N=n(4521),C=n(6504),F=n(4858),x=n(6754);const f=(0,l.Fc)(2),{createSectionFilter:r}=(0,N.z)(I,f),u=r("name-filter"),e=r("min-reviews-filter"),a=r("min-rating-filter",4.8),m=r("filter-enabled",!0);await A();async function A(){if(!await(0,g.xk)(document,F.Z.PRODUCT_LIST_TOP))return;const v=(0,t.Fi)(F.Z.PRODUCT_LIST,document,!0);(0,d.b)(v,T,!0),new MutationObserver(I).observe(v,{childList:!0,subtree:!0})}b()}catch(f){b(f)}},1)},4858:(S,s,n)=>{n.d(s,{Z:()=>p});const p={PRODUCT_LIST:'[data-qa="listing"]',PRODUCT_LIST_TOP:"#product-listing-top",PRODUCT_NAME_WRAP:'[data-qa="product-name"]',PRODUCT_RATING_WRAP:'[data-qa="product-rating"]',PRODUCT_RATING:'[name="rating"]'}},6504:(S,s,n)=>{n.d(s,{r:()=>b});const p={input:{marginLeft:"5px",border:"1px solid #dadcde",borderRadius:"8px",padding:"8px 16px",fontSize:"16px"}},b={filtersContainer:{display:"flex",gridGap:"11px",marginBottom:"18px"},control:{display:"flex",alignItems:"center",fontSize:"16px"},textInput:{...p.input,width:"180px"},numberInput:{...p.input,width:"90px"},checkboxInput:{marginLeft:"5px",width:"22px",height:"22px"}}}},$={};function P(S){var s=$[S];if(s!==void 0)return s.exports;var n=$[S]={exports:{}};return j[S](n,n.exports,P),n.exports}(()=>{var S=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",s=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",n=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",p=g=>{g&&g.d<1&&(g.d=1,g.forEach(d=>d.r--),g.forEach(d=>d.r--?d.r++:d()))},b=g=>g.map(d=>{if(d!==null&&typeof d=="object"){if(d[S])return d;if(d.then){var w=[];w.d=0,d.then(c=>{i[s]=c,p(w)},c=>{i[n]=c,p(w)});var i={};return i[S]=c=>c(w),i}}var t={};return t[S]=c=>{},t[s]=d,t});P.a=(g,d,w)=>{var i;w&&((i=[]).d=-1);var t=new Set,c=g.exports,l,N,C,F=new Promise((x,f)=>{C=f,N=x});F[s]=c,F[S]=x=>(i&&x(i),t.forEach(x),F.catch(f=>{})),g.exports=F,d(x=>{l=b(x);var f,r=()=>l.map(e=>{if(e[n])throw e[n];return e[s]}),u=new Promise(e=>{f=()=>e(r),f.r=0;var a=m=>m!==i&&!t.has(m)&&(t.add(m),m&&!m.d&&(f.r++,m.push(f)));l.map(m=>m[S](a))});return f.r?u:r()},x=>(x?C(F[n]=x):N(c),p(i))),i&&i.d<0&&(i.d=0)}})(),P.d=(S,s)=>{for(var n in s)P.o(s,n)&&!P.o(S,n)&&Object.defineProperty(S,n,{enumerable:!0,get:s[n]})},P.o=(S,s)=>Object.prototype.hasOwnProperty.call(S,s);var W=P(6220)})();})();
