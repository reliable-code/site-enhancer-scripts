// ==UserScript==
// @name         Yamaps reviews filter
// @description  Hide reviews by filter
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://yandex.ru/maps/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.75805085
// @icon         https://www.google.com/s2/favicons?sz=64&domain=yandex.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/yamaps.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var $={5467:(N,f,n)=>{n.d(f,{E2:()=>b});var g=n(9928);function b(d,c={},e=null){const u=(0,g.Sw)(c,e);return u.append(d),u}function p(d,c=null,e={},u={}){const l=createActionLink(d,c,u);return b(l,e)}function m(d,c=null,e=null,u={},l={}){const x=createActionLinkWithIcon(d,e,c,l);return b(x,u)}},9928:(N,f,n)=>{n.d(f,{Sw:()=>E,kU:()=>p});var g=n(4921),b=n(6754);function p(o,i,s){const v=c(o,"text",i);return v.value=s,v}function m(o,i,s,v,L,R){const A=c(o,"number",i);return A.value=s,A.step=v,A.min=L,A.max=R,A}function d(o,i,s){const v=c(o,"checkbox",i);return v.checked=s,v}function c(o={},i=null,s=null){const v=a("input",o);return i&&(v.type=i),s&&(v.addEventListener("keyup",(0,g.sg)(s,200)),v.addEventListener("change",(0,g.sg)(s,100))),v}function e(o={},i=null){return a("span",o,i)}function u(o={},i=null,s=null){const v=a("a",o,i);return s&&(v.href=s),v}function l(o,i=null,s={}){s.cursor||="pointer";const v=u(s,i);return o&&v.addEventListener("click",o),v}function x(o,i,s=null,v={},L={}){v.display||="inline-flex",v.alignItems||="center",v.gap||="0.25em";const R=l(o,s,v);return R.prepend(r(i,L)),R}function S(o={},i=null,s=null){const v=a("button",o,i);return s&&v.addEventListener("click",s),v}function E(o={},i=null){return a("div",o,i)}function w(o={}){return a("i",o)}function r(o,i={}){i.width||="1em",i.height||="1em",i.paddingBottom||="1px";const s=w(i);return s.setAttribute("data-lucide",o),s}function a(o,i,s=null){if(typeof i!="object"||i===null)throw new TypeError("styles should be an object");const v=document.createElement(o);return(0,b.ZM)(v,i),s&&(v.innerHTML=s),v}},573:(N,f,n)=>{n.d(f,{Fi:()=>b,Yl:()=>d,fI:()=>p});function g(r,a=document){return!!a.querySelector(r)}function b(r,a=document,o=!1){const i=a.querySelector(r);return o&&!i&&console.log(`No element found for selector: ${r}`),i}function p(r,a=document,o=!1){const i=a.querySelectorAll(r);return o&&!i.length&&console.log(`No elements found for selector: ${r}`),i}function m(r,a=1){let o=r;for(let i=0;i<a;i++){if(!o.parentElement)return null;o=o.parentElement}return o}function d(r,a,o){return[...r.querySelectorAll(a)].find(i=>i.textContent.trim().includes(o))}function c(r,a,o=!1,i=!1,s=null){const v=b(a,r);return e(v,o,i,s)}function e(r,a=!1,o=!1,i=null){if(!r)return i===null?(console.log("No element found"),null):i;const s=r.innerText;return x(s,a,o)}function u(r,a,o=!1){const i=r[a];return e(i,o)}function l(r,a=!1,o=!1){const i=r.textContent;return x(i,a,o)}function x(r,a,o){a&&(r=removeNonNumber(r)),o&&(r=r.replace(",","."));const i=Number(r);return Number.isNaN(i)?(console.log(`Invalid number: ${r}`),0):i}function S(r){return[...r.childNodes].find(a=>a.nodeType===Node.TEXT_NODE)}function E(r){const a=o=>o.nodeType===Node.TEXT_NODE&&o.textContent.trim()!==""?[o]:[...o.childNodes].flatMap(a);return a(r)}function w(r){return normalizeSpacing(r.textContent)}},8506:(N,f,n)=>{n.d(f,{hf:()=>b,kZ:()=>m});var g=n(573);function b(d,c){d.forEach(e=>p(c,e))}function p(d,c){if(!c)return;const e=new RegExp(`(${c})`,"gi"),u=document.createTreeWalker(d,NodeFilter.SHOW_TEXT,null);let l=u.nextNode();const x=[];for(;l;){const{textContent:S}=l;if(e.test(S)){const E=document.createDocumentFragment();let w=0;S.replace(e,(r,a,o)=>{o>w&&E.appendChild(document.createTextNode(S.slice(w,o)));const i=document.createElement("span");i.className="highlightedSubstring",i.style.backgroundColor="yellow",i.textContent=r,E.appendChild(i),w=o+r.length}),w<S.length&&E.appendChild(document.createTextNode(S.slice(w))),x.push({node:l,fragment:E})}l=u.nextNode()}x.forEach(({node:S,fragment:E})=>{S.parentNode.replaceChild(E,S)})}function m(d){(0,g.fI)(".highlightedSubstring",d).forEach(e=>{const{parentNode:u}=e;e.replaceWith(e.textContent),u.normalize()})}},5539:(N,f,n)=>{n.d(f,{Bt:()=>p,Bz:()=>r,GY:()=>a,L5:()=>D,pB:()=>o});var g=n(573);function b(t,h){t.parentNode.insertBefore(h,t.nextSibling)}function p(t){t.style.display="none"}function m(t,h=1){const T=document.querySelector(t);T&&d(T,h)}function d(t,h=1){const T=getElementAncestor(t,h);T&&p(T)}function c(t){w(t),p(t)}function e(t){t.intersectionObserver||runOnceOnIntersection(t,()=>p(t))}function u(t){t.style.display=""}function l(t){const h=E(t);t.style.display=h}function x(t,h){h?p(t):u(t)}function S(t,h){h?e(t):(clearIntersectionObserver(t),u(t))}function E(t){return w(t),t.defaultDisplay}function w(t){if(t.defaultDisplay)return;const{display:h}=getComputedStyle(t);t.defaultDisplay=h}function r(){return{show:[],hide:[]}}function a(t,h,T){t?h.hide.push(T):h.show.push(T)}function o(t){t.show.forEach(u),t.hide.forEach(p)}function i(t,h,T=.3){h?v(t,T):s(t)}function s(t){t.style.opacity=""}function v(t,h=.3){t.style.opacity=h}function L(t){t.style.order=""}function R(t,h){t.style.order=h}function A(t,h){t.style.background=h}function C(t,h){const T=getFirstElement(h);T&&y(t,T)}function y(t,h){const T=createLink();T.href=t,h.parentNode.append(T),T.append(h)}function F(t,h){const T=getFirstElement(h);T&&I(t,T)}function I(t,h){const T=createLink();T.href=t,T.append(...h.childNodes),h.append(T)}function O(){const t=getURLQueryParam("scrollTo");if(!t)return;const h=document.getElementById(t);h?h.scrollIntoView():console.log(`Element with ID "${t}" was not found.`)}function D(t,h,T=null){const P=`${h}-click-passed`,V=T?k=>(0,g.Yl)(k,t,T):k=>(0,g.Fi)(t,k);return function(k){if(k.hasAttribute(P))return!1;const z=V(k);return z&&z.click(),k.setAttribute(P,""),!0}}function B(t,h,T="text/plain"){const P=new Blob([t],{type:T}),V=URL.createObjectURL(P),k=document.createElement("a");k.href=V,k.download=h,document.body.appendChild(k),k.click(),document.body.removeChild(k),requestAnimationFrame(()=>URL.revokeObjectURL(V))}},6754:(N,f,n)=>{n.d(f,{ZM:()=>g});function g(d,c){Object.assign(d.style,c)}function b(d,c="custom-global-style"){let e=document.getElementById(c);e||(e=document.createElement("style"),e.id=c,e.type="text/css",document.head.appendChild(e)),e.textContent=d}function p(d){return Object.entries(d).map(([c,e])=>`${c.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${e};`).join(" ")}function m(d){return d?d.split(";").filter(c=>c.trim()!=="").reduce((c,e)=>{const[u,l]=e.split(":").map(S=>S.trim()),x=u.replace(/-([a-z])/g,(S,E)=>E.toUpperCase());return c[x]=l,c},{}):{}}},4921:(N,f,n)=>{n.d(f,{Un:()=>d,XW:()=>p,sg:()=>m,wP:()=>u,xk:()=>g});function g(l,x,S=null){const E=l.querySelector(x);return E?Promise.resolve(E):new Promise(w=>{const r=new MutationObserver(o);r.observe(l,{childList:!0,subtree:!0});let a;S&&(a=setTimeout(()=>{r.disconnect(),console.log(`No element found for selector: ${x}`),w(null)},S));function o(){const i=l.querySelector(x);i&&(a&&clearTimeout(a),r.disconnect(),w(i))}})}function b(l,x){return l.querySelector(x)?new Promise(E=>{const w=new MutationObserver(r);w.observe(l,{childList:!0,subtree:!0});function r(){l.querySelector(x)||(w.disconnect(),E())}}):Promise.resolve()}function p(l,x=400){return new Promise(S=>{let E;const w=new MutationObserver(()=>{clearTimeout(E),r()});function r(){E=setTimeout(()=>{w.disconnect(),S()},x)}r(),w.observe(l,{childList:!0,subtree:!0})})}function m(l,x=250){let S;return(...E)=>{clearTimeout(S),S=setTimeout(()=>l(...E),x)}}async function d(l){document.visibilityState==="visible"?await l():document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await l()},{once:!0})}function c(l,x){const S=new IntersectionObserver(E=>{E.forEach(w=>{w.isIntersecting&&(x(),e(l))})});l.intersectionObserver=S,S.observe(l)}function e(l){l.intersectionObserver&&(l.intersectionObserver.disconnect(),l.intersectionObserver=null)}function u(l){l&&(l.disconnect(),l=null)}},3829:(N,f,n)=>{n.d(f,{Ay:()=>b});var g=n(8355);function b(e,u){return!p(e,u)}function p(e,u){if(!u.value)return!0;const l=e.toLowerCase(),x=(0,g.R)(u),S=[],E=[];return x.forEach(w=>{if(w.startsWith("!")){const r=w.substring(1);r&&E.push(r)}else S.push(w)}),S.every(w=>l.includes(w))&&E.every(w=>!l.includes(w))}function m(e,u){return u.value!=null&&e<u.value}function d(e,u){return u.value!=null&&e>u.value}function c(e,u){return u.value&&e!==u.value}},4521:(N,f,n)=>{n.d(f,{z:()=>b});var g=n(3048);function b(p,m=null){return{createGlobalFilter(d,c=null,e=p){return g.V.create(d,c,e)},createSectionFilter(d,c=null,e=p){if(!m)throw new Error("sectionId must be provided to use createSectionFilter.");return g.V.createWithCompositeKey(m,d,c,e)}}}},5884:(N,f,n)=>{n.d(f,{Nm:()=>p});var g=n(9928),b=n(5467);function p(c,e,u={},l={}){const x=(0,g.kU)(l,e.updateValueFromEvent,e.value);return(0,b.E2)(x,u,c)}function m(c,e,u,l,x,S={},E={}){const w=createNumberInput(E,e.updateValueFromEvent,e.value,u,l,x);return createControl(w,S,c)}function d(c,e,u={},l={}){const x=createCheckboxInput(l,e.updateValueFromEvent,e.value);return createControl(x,u,c)}},7877:(N,f,n)=>{n.d(f,{E9:()=>b});var g=n(5884);function b(C,y={},F={}){return(0,g.Nm)("\u041F\u043E\u0438\u0441\u043A: ",C,y,F)}function p(C,y={},F={},I=.1,O=3){return createNumberFilterControl("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",C,I,O,5,y,F)}function m(C,y={},F={},I=.1,O=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",C,I,O,5,y,F)}function d(C,y={},F={}){return e("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",C,y,F)}function c(C,y={},F={}){return e("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",C,y,F)}function e(C,y,F={},I={}){return createNumberFilterControl(C,y,"1","1","999999",F,I)}function u(C,y={},F={}){return l("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",C,y,F)}function l(C,y,F={},I={}){return createNumberFilterControl(C,y,"5","0","100",F,I)}function x(C,y={},F={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",C,"5","0","100",y,F)}function S(C,y,F={},I={},O="250"){return createNumberFilterControl(C,y,O,"0","1000000",F,I)}function E(C,y={},F={},I="25"){return S("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",C,y,F,I)}function w(C,y={},F={},I="25"){return S("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",C,y,F,I)}function r(C,y={},F={}){return a("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",C,y,F)}function a(C,y,F={},I={}){return createNumberFilterControl(C,y,"1","0","99999",F,I)}function o(C,y={},F={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",C,"1","2","7",y,F)}function i(C,y={},F={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",C,1,1,10,y,F)}function s(C,y={},F={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",C,y,F)}function v(C,y={},F={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",C,y,F)}function L(C,y={},F={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",C,y,F)}function R(C,y={},F={}){return createCheckboxFilterControl("\u0411\u0430\u043B\u043B\u044B: ",C,y,F)}function A(C,y={},F={}){return createCheckboxFilterControl("\u0412\u043A\u043B: ",C,y,F)}},8355:(N,f,n)=>{n.d(f,{R:()=>g,f:()=>b});function g(p){return p.value.toLowerCase().split(",").map(m=>m.trim()).filter(m=>m!=="")}function b(p){return g(p).filter(m=>!m.startsWith("!"))}},4292:(N,f,n)=>{n.d(f,{C:()=>p});var g=n(8355),b=n(8506);function p(d,c){const e=(0,g.f)(d);(0,b.hf)(e,c)}function m(d,c){const e=getIncludedSearchStrings(d);c.forEach(u=>highlightSubstrings(e,u))}},5213:(N,f,n)=>{n.d(f,{b:()=>p});var g=n(9928),b=n(573);function p(m,d,c=!1,e="customFiltersContainer"){let u=(0,b.Fi)(`#${e}`,m);if(u)if(c)u.remove();else return;u=(0,g.Sw)(),u.id=e,d(u,m)}},8200:(N,f,n)=>{n.d(f,{s:()=>g});function g(b){const{target:p}=b,{type:m}=p;switch(m){case"text":return`"${p.value}"`;case"number":return p.value;case"checkbox":return p.checked;default:return console.log(`Unknown input type: ${m}`),null}}},157:(N,f,n)=>{n.d(f,{Fg:()=>g,vx:()=>p});const g=window.GM_setValue,b=window.GM.setValue,p=window.GM_getValue},1870:(N,f,n)=>{n.d(f,{j:()=>g});class g{constructor(p,m){this.value=p,this.onChange=m}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(N,f,n)=>{n.d(f,{V:()=>d});var g=n(1870),b=n(8200),p=n(3976),m=n(157);class d extends g.j{constructor(e,u=null,l=null){super((0,m.vx)(e,u),l),this.storageKey=e,this.defaultValue=u}static create(e,u=null,l=null){return new d(e,u,l)}static createWithCompositeKey(e,u,l=null,x=null){const S=`${e}-${u}`;return new d(S,l,x)}updateValueFromEvent=e=>{const u=(0,b.s)(e),l=(0,p.$)(u);this.updateValue(l)};updateValue(e,u=!0){this.value!==e&&((0,m.Fg)(this.storageKey,e),this.value=e,u&&this.onChangeIfDefined())}clearValue(e=!1){this.updateValue(null,e)}resetValue(e=!1){this.updateValue(this.defaultValue,e)}}},3976:(N,f,n)=>{n.d(f,{$:()=>g});function g(b){return b===""?null:JSON.parse(b)}},5406:(N,f,n)=>{n.d(f,{k1:()=>E,z2:()=>x});function g(r,a="common",o=!1){const{pathname:i}=window.location;return b(i,r,a,o)}function b(r,a,o,i=!1){const s=r.split("/");a=a<0?s.length+a:a;const v=s[a]||o;return i&&console.log(`Pathname element: ${v}`),v}function p(r,a="common",o=!1){const i=g(r,"",o);return m(i,a,o)}function m(r,a,o){if(!r)return a;const i=r.split("-").at(-1);return o&&console.log(`Pathname element ending: ${i}`),i}function d(r,a,o="common",i=!1){const s=b(r,a,"",i);return m(s,o,i)}function c(r){return new URLSearchParams(window.location.search).get(r)}function e(r){return r.split("?")[0]}function u(r){return window.location.pathname.includes(r)}function l(r){return r.some(a=>u(a))}function x(r){return window.location.pathname.split("/").some(o=>o===r)}function S(r){try{const a=new URL(window.location.href);Object.entries(r).forEach(([o,i])=>{a.searchParams.set(o,i)}),window.location.href=a.toString()}catch(a){console.error("Failed to redirect:",a)}}function E(r,a=[]){const o={pathname:window.location.pathname};a.forEach(R=>{o[R]=c(R)});let i=!1;async function s(){if(i)return;const R={pathname:window.location.pathname};if(a.forEach(A=>{R[A]=c(A)}),Object.keys(o).some(A=>o[A]!==R[A])){Object.assign(o,R),i=!0;try{await r()}catch(A){console.error("Error in URL observer callback:",A)}finally{i=!1}}}function v(){s().catch(R=>{console.error("Error in URL change handler:",R)})}let L=window.location.href;setInterval(()=>{window.location.href!==L&&(L=window.location.href,v())},200),window.addEventListener("popstate",v)}function w(r=[]){E(()=>window.location.reload(),r)}},3539:(N,f,n)=>{n.a(N,async(g,b)=>{try{let L=function(){return(0,a.z2)("org")&&(0,a.z2)("reviews")},A=function(){C(u.Z.REVIEWS_VIEW_SUMMARY),C(u.Z.TAGS_CONTAINER),C(u.Z.FRIENDS_SUGGEST)},C=function(t,h=s.activeTabWrapper){const T=(0,c.Fi)(t,h);T&&(0,d.Bt)(T)},y=function(){if(!s.isFiltersInitialized){const{createGlobalFilter:t}=(0,x.z)(I);s.reviewTextFilter=t("review-text-filter"),s.isFiltersInitialized=!0}},F=function(t,h){(0,S.ZM)(t,l.r.FILTERS_CONTAINER);const T=(0,e.E9)(s.reviewTextFilter,l.r.CONTROL,l.r.TEXT_INPUT);s.reviewsInfo=(0,o.Sw)(l.r.INFO),t.append(T,s.reviewsInfo),h.append(t)},D=function(t){const h=[...t].filter(T=>T.style.display!=="none").length;s.reviewsInfo.textContent=`\u041F\u043E\u043A\u0430\u0437\u0430\u043D\u043E: ${h} \u0438\u0437 ${t.length} \u043E\u0442\u0437\u044B\u0432\u043E\u0432`},B=function(){s.activeTabWrapper=null,s.isFiltersInitialized=!1,s.reviewTextFilter=null,s.reviewsInfo=null,(0,E.wP)(s.reviewsObserver)};var p=n(5213),m=n(3829),d=n(5539),c=n(573),e=n(7877),u=n(6613),l=n(3613),x=n(4521),S=n(6754),E=n(4921),w=n(4292),r=n(8506),a=n(5406),o=n(9928);const i=(0,d.L5)("span.business-review-view__expand","read-more"),s={activeTabWrapper:null,isFiltersInitialized:!1,reviewTextFilter:null,reviewsInfo:null,reviewsObserver:null};await(0,E.Un)(v),(0,a.k1)(async()=>{await v(!0)});async function v(t=!1){t&&B(),L()&&(await(0,E.XW)(document.body),await R())}async function R(){s.activeTabWrapper=await(0,E.xk)(document,u.Z.ACTIVE_TAB_WRAPPER),A(),y();const t=(0,c.Fi)(u.Z.FILTER_CONTAINER_WRAP,s.activeTabWrapper,!0);(0,p.b)(t,F,!0),await I();const h=(0,c.Fi)(u.Z.REVIEWS_CONTAINER,s.activeTabWrapper);s.reviewsObserver=new MutationObserver((0,E.sg)(I)),s.reviewsObserver.observe(h,{childList:!0})}async function I(){s.isFiltersInitialized||y();const t=(0,c.fI)(u.Z.REVIEW_CARD,s.activeTabWrapper),h=(0,d.Bz)();await Promise.all([...t].map(async T=>{const P=await O(T);(0,d.GY)(P,h,T)})),(0,d.pB)(h),D(t)}async function O(t){i(t)&&await(0,E.XW)(t),(0,r.kZ)(t);const h=(0,c.Fi)(u.Z.REVIEW_TEXT_WRAP,t);if(!h)return!0;s.reviewTextFilter.value&&(0,w.C)(s.reviewTextFilter,h);const T=h.innerText;return(0,m.Ay)(T,s.reviewTextFilter)}b()}catch(i){b(i)}},1)},6613:(N,f,n)=>{n.d(f,{Z:()=>g});const g={ACTIVE_TAB_WRAPPER:"div.business-tab-wrapper._materialized",FILTER_CONTAINER_WRAP:"div.business-reviews-card-view__header",REVIEWS_VIEW_SUMMARY:"div.card-reviews-view__summary",TAGS_CONTAINER:"div.business-reviews-card-view__tags-container",FRIENDS_SUGGEST:"div.business-reviews-card-view__friends-suggest",REVIEWS_CONTAINER:"div.business-reviews-card-view__reviews-container",REVIEW_CARD:"div.business-reviews-card-view__review",REVIEW_TEXT_WRAP:"span.spoiler-view__text-container"}},3613:(N,f,n)=>{n.d(f,{r:()=>b});const b={FILTERS_CONTAINER:{display:"flex",flexDirection:"column",gap:"4px",padding:"0px 20px 8px 16px",backgroundColor:"#fff",boxShadow:"0 1px 0 #d6d6d6",zIndex:100,margin:"0 auto",maxWidth:"640px"},CONTROL:{display:"flex",flexDirection:"column",gap:"5px",fontSize:"14px",fontWeight:"500",width:"100%",letterSpacing:"0.01em"},TEXT_INPUT:{...{INPUT:{padding:"7px 14px",fontSize:"14px",borderRadius:"4px",border:"1px solid #ccc",outline:"none"}}.INPUT,width:"100%",boxSizing:"border-box"},INFO:{margin:"4px 2px 0",fontSize:"13px",color:"#9ca3af",textAlign:"right"}}}},U={};function W(N){var f=U[N];if(f!==void 0)return f.exports;var n=U[N]={exports:{}};return $[N](n,n.exports,W),n.exports}(()=>{var N=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",f=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",n=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",g=p=>{p&&p.d<1&&(p.d=1,p.forEach(m=>m.r--),p.forEach(m=>m.r--?m.r++:m()))},b=p=>p.map(m=>{if(m!==null&&typeof m=="object"){if(m[N])return m;if(m.then){var d=[];d.d=0,m.then(u=>{c[f]=u,g(d)},u=>{c[n]=u,g(d)});var c={};return c[N]=u=>u(d),c}}var e={};return e[N]=u=>{},e[f]=m,e});W.a=(p,m,d)=>{var c;d&&((c=[]).d=-1);var e=new Set,u=p.exports,l,x,S,E=new Promise((w,r)=>{S=r,x=w});E[f]=u,E[N]=w=>(c&&w(c),e.forEach(w),E.catch(r=>{})),p.exports=E,m(w=>{l=b(w);var r,a=()=>l.map(i=>{if(i[n])throw i[n];return i[f]}),o=new Promise(i=>{r=()=>i(a),r.r=0;var s=v=>v!==c&&!e.has(v)&&(e.add(v),v&&!v.d&&(r.r++,v.push(r)));l.map(v=>v[N](s))});return r.r?o:a()},w=>(w?S(E[n]=w):x(u),g(c))),c&&c.d<0&&(c.d=0)}})(),W.d=(N,f)=>{for(var n in f)W.o(f,n)&&!W.o(N,n)&&Object.defineProperty(N,n,{enumerable:!0,get:f[n]})},W.o=(N,f)=>Object.prototype.hasOwnProperty.call(N,f);var M=W(3539)})();})();
