// ==UserScript==
// @name         Vseins product cards filter
// @description  Hide product cards by filter
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.vseinstrumenti.ru/tag-page/*
// @match        https://www.vseinstrumenti.ru/category/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.75620635
// @icon         https://www.google.com/s2/favicons?sz=64&domain=vseinstrumenti.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/systematic/vseins.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var U={5467:(x,s,n)=>{n.d(s,{E2:()=>g});var f=n(9928);function g(p,c={},e=null){const r=(0,f.Sw)(c,e);return r.append(p),r}function v(p,c=null,e={},r={}){const b=createActionLink(p,c,r);return g(b,e)}function l(p,c=null,e=null,r={},b={}){const y=createActionLinkWithIcon(p,e,c,b);return g(y,r)}},9928:(x,s,n)=>{n.d(s,{S:()=>p,Sw:()=>S,kU:()=>v,o5:()=>l});var f=n(4921),g=n(6754);function v(i,o,w){const d=c(i,"text",o);return d.value=w,d}function l(i,o,w,d,k,T){const I=c(i,"number",o);return I.value=w,I.step=d,I.min=k,I.max=T,I}function p(i,o,w){const d=c(i,"checkbox",o);return d.checked=w,d}function c(i={},o=null,w=null){const d=a("input",i);return o&&(d.type=o),w&&(d.addEventListener("keyup",(0,f.sg)(w,200)),d.addEventListener("change",(0,f.sg)(w,100))),d}function e(i={},o=null){return a("span",i,o)}function r(i={},o=null,w=null){const d=a("a",i,o);return w&&(d.href=w),d}function b(i,o=null,w={}){w.cursor||="pointer";const d=r(w,o);return i&&d.addEventListener("click",i),d}function y(i,o,w=null,d={},k={}){d.display||="inline-flex",d.alignItems||="center",d.gap||="0.25em";const T=b(i,w,d);return T.prepend(u(o,k)),T}function F(i={},o=null,w=null){const d=a("button",i,o);return w&&d.addEventListener("click",w),d}function S(i={},o=null){return a("div",i,o)}function N(i={}){return a("i",i)}function u(i,o={}){o.width||="1em",o.height||="1em",o.paddingBottom||="1px";const w=N(o);return w.setAttribute("data-lucide",i),w}function a(i,o,w=null){if(typeof o!="object"||o===null)throw new TypeError("styles should be an object");const d=document.createElement(i);return(0,g.ZM)(d,o),w&&(d.innerHTML=w),d}},573:(x,s,n)=>{n.d(s,{Fi:()=>v,ML:()=>b,fI:()=>l});var f=n(4214);function g(u,a=document){return!!a.querySelector(u)}function v(u,a=document,i=!1){const o=a.querySelector(u);return i&&!o&&console.log(`No element found for selector: ${u}`),o}function l(u,a=document,i=!1){const o=a.querySelectorAll(u);return i&&!o.length&&console.log(`No elements found for selector: ${u}`),o}function p(u,a,i){return[...u.querySelectorAll(a)].find(o=>o.textContent.trim().includes(i))}function c(u,a,i=!1,o=!1,w=null){const d=v(a,u);return e(d,i,o,w)}function e(u,a=!1,i=!1,o=null){if(!u)return o===null?(console.log("No element found"),null):o;const w=u.innerText;return y(w,a,i)}function r(u,a,i=!1){const o=u[a];return e(o,i)}function b(u,a=!1,i=!1){const o=u.textContent;return y(o,a,i)}function y(u,a,i){a&&(u=(0,f.zr)(u)),i&&(u=u.replace(",","."));const o=Number(u);return Number.isNaN(o)?(console.log(`Invalid number: ${u}`),0):o}function F(u){return[...u.childNodes].find(a=>a.nodeType===Node.TEXT_NODE)}function S(u){const a=i=>i.nodeType===Node.TEXT_NODE&&i.textContent.trim()!==""?[i]:[...i.childNodes].flatMap(a);return a(u)}function N(u){return normalizeSpacing(u.textContent)}},5539:(x,s,n)=>{n.d(s,{Bt:()=>g,UC:()=>e,kl:()=>p});function f(t,E){t.parentNode.insertBefore(E,t.nextSibling)}function g(t){t.style.display="none"}function v(t){y(t),g(t)}function l(t){t.intersectionObserver||runOnceOnIntersection(t,()=>g(t))}function p(t){t.style.display=""}function c(t){const E=b(t);t.style.display=E}function e(t,E){E?g(t):p(t)}function r(t,E){E?l(t):(clearIntersectionObserver(t),p(t))}function b(t){return y(t),t.defaultDisplay}function y(t){if(t.defaultDisplay)return;const{display:E}=getComputedStyle(t);t.defaultDisplay=E}function F(){return{show:[],hide:[]}}function S(t,E,L){t?E.hide.push(L):E.show.push(L)}function N(t){t.show.forEach(p),t.hide.forEach(g)}function u(t,E,L=.3){E?i(t,L):a(t)}function a(t){t.style.opacity=""}function i(t,E=.3){t.style.opacity=E}function o(t){t.style.order=""}function w(t,E){t.style.order=E}function d(t,E){t.style.background=E}function k(t,E){const L=getFirstElement(E);L&&T(t,L)}function T(t,E){const L=createLink();L.href=t,E.parentNode.append(L),L.append(E)}function I(t,E){const L=getFirstElement(E);L&&C(t,L)}function C(t,E){const L=createLink();L.href=t,L.append(...E.childNodes),E.append(L)}function m(){const t=getURLQueryParam("scrollTo");if(!t)return;const E=document.getElementById(t);E?E.scrollIntoView():console.log(`Element with ID "${t}" was not found.`)}function h(t,E,L="text/plain"){const D=new Blob([t],{type:L}),P=URL.createObjectURL(D),A=document.createElement("a");A.href=P,A.download=E,document.body.appendChild(A),A.click(),document.body.removeChild(A),requestAnimationFrame(()=>URL.revokeObjectURL(P))}},6754:(x,s,n)=>{n.d(s,{ZM:()=>f});function f(p,c){Object.assign(p.style,c)}function g(p,c="custom-global-style"){let e=document.getElementById(c);e||(e=document.createElement("style"),e.id=c,e.type="text/css",document.head.appendChild(e)),e.textContent=p}function v(p){return Object.entries(p).map(([c,e])=>`${c.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${e};`).join(" ")}function l(p){return p?p.split(";").filter(c=>c.trim()!=="").reduce((c,e)=>{const[r,b]=e.split(":").map(F=>F.trim()),y=r.replace(/-([a-z])/g,(F,S)=>S.toUpperCase());return c[y]=b,c},{}):{}}},4921:(x,s,n)=>{n.d(s,{sg:()=>l,xk:()=>f});function f(e,r,b=null){const y=e.querySelector(r);return y?Promise.resolve(y):new Promise(F=>{const S=new MutationObserver(u);S.observe(e,{childList:!0,subtree:!0});let N;b&&(N=setTimeout(()=>{S.disconnect(),console.log(`No element found for selector: ${r}`),F(null)},b));function u(){const a=e.querySelector(r);a&&(N&&clearTimeout(N),S.disconnect(),F(a))}})}function g(e,r){return e.querySelector(r)?new Promise(y=>{const F=new MutationObserver(S);F.observe(e,{childList:!0,subtree:!0});function S(){e.querySelector(r)||(F.disconnect(),y())}}):Promise.resolve()}function v(e,r=400){return new Promise(b=>{let y;const F=new MutationObserver(()=>{clearTimeout(y),S()});function S(){y=setTimeout(()=>{F.disconnect(),b()},r)}S(),F.observe(e,{childList:!0,subtree:!0})})}function l(e,r=250){let b;return(...y)=>{clearTimeout(b),b=setTimeout(()=>e(...y),r)}}function p(e,r){const b=new IntersectionObserver(y=>{y.forEach(F=>{F.isIntersecting&&(r(),c(e))})});e.intersectionObserver=b,b.observe(e)}function c(e){e.intersectionObserver&&(e.intersectionObserver.disconnect(),e.intersectionObserver=null)}},3829:(x,s,n)=>{n.d(s,{Ay:()=>g,JE:()=>l});var f=n(8355);function g(e,r){return!v(e,r)}function v(e,r){if(!r.value)return!0;const b=e.toLowerCase(),y=(0,f.R)(r),F=[],S=[];return y.forEach(N=>{if(N.startsWith("!")){const u=N.substring(1);u&&S.push(u)}else F.push(N)}),F.every(N=>b.includes(N))&&S.every(N=>!b.includes(N))}function l(e,r){return r.value!=null&&e<r.value}function p(e,r){return r.value!=null&&e>r.value}function c(e,r){return r.value&&e!==r.value}},4521:(x,s,n)=>{n.d(s,{z:()=>g});var f=n(3048);function g(v,l=null){return{createGlobalFilter(p,c=null,e=v){return f.V.create(p,c,e)},createSectionFilter(p,c=null,e=v){if(!l)throw new Error("sectionId must be provided to use createSectionFilter.");return f.V.createWithCompositeKey(l,p,c,e)}}}},5884:(x,s,n)=>{n.d(s,{Hw:()=>p,Nm:()=>v,nW:()=>l});var f=n(9928),g=n(5467);function v(c,e,r={},b={}){const y=(0,f.kU)(b,e.updateValueFromEvent,e.value);return(0,g.E2)(y,r,c)}function l(c,e,r,b,y,F={},S={}){const N=(0,f.o5)(S,e.updateValueFromEvent,e.value,r,b,y);return(0,g.E2)(N,F,c)}function p(c,e,r={},b={}){const y=(0,f.S)(b,e.updateValueFromEvent,e.value);return(0,g.E2)(y,r,c)}},7877:(x,s,n)=>{n.d(s,{E9:()=>g,HX:()=>v,X0:()=>p,pW:()=>I});var f=n(5884);function g(C,m={},h={}){return(0,f.Nm)("\u041F\u043E\u0438\u0441\u043A: ",C,m,h)}function v(C,m={},h={},t=.1,E=3){return(0,f.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",C,t,E,5,m,h)}function l(C,m={},h={},t=.1,E=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",C,t,E,5,m,h)}function p(C,m={},h={}){return e("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",C,m,h)}function c(C,m={},h={}){return e("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",C,m,h)}function e(C,m,h={},t={}){return(0,f.nW)(C,m,"1","1","999999",h,t)}function r(C,m={},h={}){return b("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",C,m,h)}function b(C,m,h={},t={}){return createNumberFilterControl(C,m,"5","0","100",h,t)}function y(C,m={},h={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",C,"5","0","100",m,h)}function F(C,m,h={},t={},E="250"){return createNumberFilterControl(C,m,E,"0","1000000",h,t)}function S(C,m={},h={},t="25"){return F("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",C,m,h,t)}function N(C,m={},h={},t="25"){return F("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",C,m,h,t)}function u(C,m={},h={}){return a("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",C,m,h)}function a(C,m,h={},t={}){return createNumberFilterControl(C,m,"1","0","99999",h,t)}function i(C,m={},h={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",C,"1","2","7",m,h)}function o(C,m={},h={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",C,1,1,10,m,h)}function w(C,m={},h={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",C,m,h)}function d(C,m={},h={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",C,m,h)}function k(C,m={},h={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",C,m,h)}function T(C,m={},h={}){return createCheckboxFilterControl("\u0411\u0430\u043B\u043B\u044B: ",C,m,h)}function I(C,m={},h={}){return(0,f.Hw)("\u0412\u043A\u043B: ",C,m,h)}},8355:(x,s,n)=>{n.d(s,{R:()=>f});function f(v){return v.value.toLowerCase().split(",").map(l=>l.trim()).filter(l=>l!=="")}function g(v){return f(v).filter(l=>!l.startsWith("!"))}},5213:(x,s,n)=>{n.d(s,{b:()=>v});var f=n(9928),g=n(573);function v(l,p,c=!1,e="customFiltersContainer"){let r=(0,g.Fi)(`#${e}`,l);if(r)if(c)r.remove();else return;r=(0,f.Sw)(),r.id=e,p(r,l)}},8200:(x,s,n)=>{n.d(s,{s:()=>f});function f(g){const{target:v}=g,{type:l}=v;switch(l){case"text":return`"${v.value}"`;case"number":return v.value;case"checkbox":return v.checked;default:return console.log(`Unknown input type: ${l}`),null}}},157:(x,s,n)=>{n.d(s,{Fg:()=>f,vx:()=>v});const f=window.GM_setValue,g=window.GM.setValue,v=window.GM_getValue,l=window.GM_addValueChangeListener},1870:(x,s,n)=>{n.d(s,{j:()=>f});class f{constructor(v,l){this.value=v,this.onChange=l}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(x,s,n)=>{n.d(s,{V:()=>p});var f=n(1870),g=n(8200),v=n(3976),l=n(157);class p extends f.j{constructor(e,r=null,b=null){super((0,l.vx)(e,r),b),this.storageKey=e,this.defaultValue=r}static create(e,r=null,b=null){return new p(e,r,b)}static createWithCompositeKey(e,r,b=null,y=null){const F=`${e}-${r}`;return new p(F,b,y)}updateValueFromEvent=e=>{const r=(0,g.s)(e),b=(0,v.$)(r);this.updateValue(b)};updateValue(e,r=!0){this.value!==e&&((0,l.Fg)(this.storageKey,e),this.value=e,r&&this.onChangeIfDefined())}clearValue(e=!1){this.updateValue(null,e)}resetValue(e=!1){this.updateValue(this.defaultValue,e)}}},3976:(x,s,n)=>{n.d(s,{$:()=>f});function f(g){return g===""?null:JSON.parse(g)}},4214:(x,s,n)=>{n.d(s,{zr:()=>g});function f(c){return c.replace(/\D/g,"")}function g(c){return c.replace(/[^\d.,-]/g,"")}function v(c){return c.replace(/\s/g,"")}function l(c){return c.charAt(0).toUpperCase()+c.slice(1)}function p(c){return c.replace(/\s+/g," ").trim()}},5406:(x,s,n)=>{n.d(s,{Fc:()=>f});function f(u,a="common",i=!1){const{pathname:o}=window.location;return g(o,u,a,i)}function g(u,a,i,o=!1){const w=u.split("/");a=a<0?w.length+a:a;const d=w[a]||i;return o&&console.log(`Pathname element: ${d}`),d}function v(u,a="common",i=!1){const o=f(u,"",i);return l(o,a,i)}function l(u,a,i){if(!u)return a;const o=u.split("-").at(-1);return i&&console.log(`Pathname element ending: ${o}`),o}function p(u,a,i="common",o=!1){const w=g(u,a,"",o);return l(w,i,o)}function c(u){return new URLSearchParams(window.location.search).get(u)}function e(u){return u.split("?")[0]}function r(u){return window.location.pathname.includes(u)}function b(u){return u.some(a=>r(a))}function y(u){return window.location.pathname.split("/").some(i=>i===u)}function F(u){try{const a=new URL(window.location.href);Object.entries(u).forEach(([i,o])=>{a.searchParams.set(i,o)}),window.location.href=a.toString()}catch(a){console.error("Failed to redirect:",a)}}function S(u,a=[]){const i={pathname:window.location.pathname};a.forEach(d=>{i[d]=c(d)});function o(){const d={pathname:window.location.pathname};a.forEach(k=>{d[k]=c(k)}),Object.keys(i).some(k=>i[k]!==d[k])&&u()}let w=window.location.href;setInterval(()=>{window.location.href!==w&&(w=window.location.href,o())},200),window.addEventListener("popstate",o)}function N(u=[]){S(()=>window.location.reload(),u)}},6220:(x,s,n)=>{n.a(x,async(f,g)=>{try{let T=function(m,h){(0,N.ZM)(m,F.r.filtersContainer);const t=(0,r.E9)(i,F.r.control,F.r.textInput),E=(0,r.X0)(o,F.r.control,F.r.numberInput),L=(0,r.HX)(w,F.r.control,F.r.numberInput),D=(0,r.pW)(d,F.r.control,F.r.checkboxInput);m.append(t,E,L,D),h.parentNode.insertBefore(m,h)},I=function(){(0,e.fI)(`${S.Z.PRODUCT_LIST} > div`).forEach(C)},C=function(m){if(!d.value){(0,c.kl)(m);return}const h=(0,e.Fi)(S.Z.PRODUCT_NAME_WRAP,m),t=(0,e.Fi)(S.Z.PRODUCT_RATING_WRAP,m);if(!h||!t){(0,c.Bt)(m);return}const E=h.innerText,L=(0,e.ML)(t.childNodes[2],!0),P=+(0,e.Fi)(S.Z.PRODUCT_RATING,t).getAttribute("value"),A=(0,p.Ay)(E,i)||(0,p.JE)(L,o)||(0,p.JE)(P,w);(0,c.UC)(m,A)};var v=n(4921),l=n(5213),p=n(3829),c=n(5539),e=n(573),r=n(7877),b=n(5406),y=n(4521),F=n(6504),S=n(4858),N=n(6754);const u=(0,b.Fc)(2),{createSectionFilter:a}=(0,y.z)(I,u),i=a("name-filter"),o=a("min-reviews-filter"),w=a("min-rating-filter",4.8),d=a("filter-enabled",!0);await k();async function k(){if(!await(0,v.xk)(document,S.Z.PRODUCT_LIST_TOP))return;const h=(0,e.Fi)(S.Z.PRODUCT_LIST,document,!0);(0,l.b)(h,T,!0),new MutationObserver(I).observe(h,{childList:!0,subtree:!0})}g()}catch(u){g(u)}},1)},4858:(x,s,n)=>{n.d(s,{Z:()=>f});const f={PRODUCT_LIST:'[data-qa="listing"]',PRODUCT_LIST_TOP:"#product-listing-top",PRODUCT_NAME_WRAP:'[data-qa="product-name"]',PRODUCT_RATING_WRAP:'[data-qa="product-rating"]',PRODUCT_RATING:'[name="rating"]'}},6504:(x,s,n)=>{n.d(s,{r:()=>g});const f={input:{marginLeft:"5px",border:"1px solid #dadcde",borderRadius:"8px",padding:"8px 16px",fontSize:"16px"}},g={filtersContainer:{display:"flex",gridGap:"11px",marginBottom:"18px"},control:{display:"flex",alignItems:"center",fontSize:"16px"},textInput:{...f.input,width:"180px"},numberInput:{...f.input,width:"90px"},checkboxInput:{marginLeft:"5px",width:"22px",height:"22px"}}}},O={};function R(x){var s=O[x];if(s!==void 0)return s.exports;var n=O[x]={exports:{}};return U[x](n,n.exports,R),n.exports}(()=>{var x=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",s=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",n=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",f=v=>{v&&v.d<1&&(v.d=1,v.forEach(l=>l.r--),v.forEach(l=>l.r--?l.r++:l()))},g=v=>v.map(l=>{if(l!==null&&typeof l=="object"){if(l[x])return l;if(l.then){var p=[];p.d=0,l.then(r=>{c[s]=r,f(p)},r=>{c[n]=r,f(p)});var c={};return c[x]=r=>r(p),c}}var e={};return e[x]=r=>{},e[s]=l,e});R.a=(v,l,p)=>{var c;p&&((c=[]).d=-1);var e=new Set,r=v.exports,b,y,F,S=new Promise((N,u)=>{F=u,y=N});S[s]=r,S[x]=N=>(c&&N(c),e.forEach(N),S.catch(u=>{})),v.exports=S,l(N=>{b=g(N);var u,a=()=>b.map(o=>{if(o[n])throw o[n];return o[s]}),i=new Promise(o=>{u=()=>o(a),u.r=0;var w=d=>d!==c&&!e.has(d)&&(e.add(d),d&&!d.d&&(u.r++,d.push(u)));b.map(d=>d[x](w))});return u.r?i:a()},N=>(N?F(S[n]=N):y(r),f(c))),c&&c.d<0&&(c.d=0)}})(),R.d=(x,s)=>{for(var n in s)R.o(s,n)&&!R.o(x,n)&&Object.defineProperty(x,n,{enumerable:!0,get:s[n]})},R.o=(x,s)=>Object.prototype.hasOwnProperty.call(x,s);var V=R(6220)})();})();
