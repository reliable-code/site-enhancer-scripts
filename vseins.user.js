// ==UserScript==
// @name         Vseins product cards filter
// @description  Hide product cards by filter
// @grant        GM_addValueChangeListener
// @grant        GM_setValue
// @grant        GM_getValue
// @match        https://www.vseinstrumenti.ru/tag-page/*
// @match        https://www.vseinstrumenti.ru/category/*
// @namespace    https://github.com/reliable-code/site-enhancer-scripts
// @version      1.0.74673087
// @icon         https://www.google.com/s2/favicons?sz=64&domain=vseinstrumenti.ru
// @author       reliable-code
// @downloadURL  https://raw.githubusercontent.com/reliable-code/site-enhancer-scripts/main/vseins.user.js
// ==/UserScript==

(()=>{(()=>{"use strict";var B={5467:(x,s,n)=>{n.d(s,{E2:()=>b});var p=n(9928);function b(E,a={},e=null){const r=(0,p.Sw)(a,e);return r.append(E),r}function v(E,a=null,e={},r={}){const g=createActionLink(E,a,r);return b(g,e)}function l(E,a=null,e=null,r={},g={}){const F=createActionLinkWithIcon(E,e,a,g);return b(F,r)}},9928:(x,s,n)=>{n.d(s,{S:()=>E,Sw:()=>S,kU:()=>v,o5:()=>l});var p=n(4921),b=n(5539);function v(o,u,C){const d=a(o,"text",u);return d.value=C,d}function l(o,u,C,d,I,A){const T=a(o,"number",u);return T.value=C,T.step=d,T.min=I,T.max=A,T}function E(o,u,C){const d=a(o,"checkbox",u);return d.checked=C,d}function a(o={},u=null,C=null){const d=c("input",o);return u&&(d.type=u),C&&(d.addEventListener("keyup",(0,p.sg)(C,200)),d.addEventListener("change",(0,p.sg)(C,100))),d}function e(o={},u=null){return c("span",o,u)}function r(o={},u=null,C=null){const d=c("a",o,u);return C&&(d.href=C),d}function g(o,u=null,C={}){C.cursor||="pointer";const d=r(C,u);return o&&d.addEventListener("click",o),d}function F(o,u,C=null,d={},I={}){d.display||="inline-flex",d.alignItems||="center",d.gap||="0.25em";const A=g(o,C,d);return A.prepend(t(u,I)),A}function y(o={},u=null,C=null){const d=c("button",o,u);return C&&d.addEventListener("click",C),d}function S(o={},u=null){return c("div",o,u)}function N(o={}){return c("i",o)}function t(o,u={}){u.width||="1em",u.height||="1em",u.paddingBottom||="1px";const C=N(u);return C.setAttribute("data-lucide",o),C}function c(o,u,C=null){if(typeof u!="object"||u===null)throw new TypeError("styles should be an object");const d=document.createElement(o);return(0,b.ZM)(d,u),C&&(d.innerHTML=C),d}},573:(x,s,n)=>{n.d(s,{Fi:()=>v,ML:()=>g,fI:()=>l});var p=n(4214);function b(t,c=document){return!!c.querySelector(t)}function v(t,c=document,o=!1){const u=c.querySelector(t);return o&&!u&&console.log(`No element found for selector: ${t}`),u}function l(t,c=document,o=!1){const u=c.querySelectorAll(t);return o&&!u.length&&console.log(`No elements found for selector: ${t}`),u}function E(t,c,o){return[...t.querySelectorAll(c)].find(u=>u.textContent.trim().includes(o))}function a(t,c,o=!1,u=!1,C=null){const d=v(c,t);return e(d,o,u,C)}function e(t,c=!1,o=!1,u=null){if(!t)return u===null?(console.log("No element found"),null):u;const C=t.innerText;return F(C,c,o)}function r(t,c,o=!1){const u=t[c];return e(u,o)}function g(t,c=!1,o=!1){const u=t.textContent;return F(u,c,o)}function F(t,c,o){c&&(t=(0,p.zr)(t)),o&&(t=t.replace(",","."));const u=Number(t);return Number.isNaN(u)?(console.log(`Invalid number: ${t}`),0):u}function y(t){return[...t.childNodes].find(c=>c.nodeType===Node.TEXT_NODE)}function S(t){const c=o=>o.nodeType===Node.TEXT_NODE&&o.textContent.trim()!==""?[o]:[...o.childNodes].flatMap(c);return c(t)}function N(t){return normalizeSpacing(t.textContent)}},5539:(x,s,n)=>{n.d(s,{Bt:()=>b,UC:()=>e,ZM:()=>h,kl:()=>E});function p(i,w){i.parentNode.insertBefore(w,i.nextSibling)}function b(i){i.style.display="none"}function v(i){F(i),b(i)}function l(i){i.intersectionObserver||runOnceOnIntersection(i,()=>b(i))}function E(i){i.style.display=""}function a(i){const w=g(i);i.style.display=w}function e(i,w){w?b(i):E(i)}function r(i,w){w?l(i):(clearIntersectionObserver(i),E(i))}function g(i){return F(i),i.defaultDisplay}function F(i){if(i.defaultDisplay)return;const{display:w}=getComputedStyle(i);i.defaultDisplay=w}function y(){return{show:[],hide:[]}}function S(i,w,k){i?w.hide.push(k):w.show.push(k)}function N(i){i.show.forEach(E),i.hide.forEach(b)}function t(i,w,k=.3){w?o(i,k):c(i)}function c(i){i.style.opacity=""}function o(i,w=.3){i.style.opacity=w}function u(i){i.style.order=""}function C(i,w){i.style.order=w}function d(i,w){i.style.background=w}function I(i,w){const k=getFirstElement(w);if(!k)return;const P=createLink();P.href=i,k.parentNode.append(P),P.append(k)}function A(i,w){const k=getFirstElement(w);k&&T(i,k)}function T(i,w){const k=createLink();k.href=i,k.append(...w.childNodes),w.append(k)}function f(){const i=getURLQueryParam("scrollTo");if(!i)return;const w=document.getElementById(i);w?w.scrollIntoView():console.log(`Element with ID "${i}" was not found.`)}function m(i,w="custom-global-style"){let k=document.getElementById(w);k||(k=document.createElement("style"),k.id=w,k.type="text/css",document.head.appendChild(k)),k.textContent=i}function h(i,w){Object.assign(i.style,w)}function L(i){return Object.entries(i).map(([w,k])=>`${w.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${k};`).join(" ")}function R(i){return i?i.split(";").filter(w=>w.trim()!=="").reduce((w,k)=>{const[P,U]=k.split(":").map(j=>j.trim()),O=P.replace(/-([a-z])/g,(j,G)=>G.toUpperCase());return w[O]=U,w},{}):{}}function V(i,w,k="text/plain"){const P=new Blob([i],{type:k}),U=URL.createObjectURL(P),O=document.createElement("a");O.href=U,O.download=w,document.body.appendChild(O),O.click(),document.body.removeChild(O),requestAnimationFrame(()=>URL.revokeObjectURL(U))}},4921:(x,s,n)=>{n.d(s,{sg:()=>l,xk:()=>p});function p(e,r,g=null){const F=e.querySelector(r);return F?Promise.resolve(F):new Promise(y=>{const S=new MutationObserver(t);S.observe(e,{childList:!0,subtree:!0});let N;g&&(N=setTimeout(()=>{S.disconnect(),console.log(`No element found for selector: ${r}`),y(null)},g));function t(){const c=e.querySelector(r);c&&(N&&clearTimeout(N),S.disconnect(),y(c))}})}function b(e,r){return e.querySelector(r)?new Promise(F=>{const y=new MutationObserver(S);y.observe(e,{childList:!0,subtree:!0});function S(){e.querySelector(r)||(y.disconnect(),F())}}):Promise.resolve()}function v(e,r=400){return new Promise(g=>{let F;const y=new MutationObserver(()=>{clearTimeout(F),S()});function S(){F=setTimeout(()=>{y.disconnect(),g()},r)}S(),y.observe(e,{childList:!0,subtree:!0})})}function l(e,r=250){let g;return(...F)=>{clearTimeout(g),g=setTimeout(()=>e(...F),r)}}function E(e,r){const g=new IntersectionObserver(F=>{F.forEach(y=>{y.isIntersecting&&(r(),a(e))})});e.intersectionObserver=g,g.observe(e)}function a(e){e.intersectionObserver&&(e.intersectionObserver.disconnect(),e.intersectionObserver=null)}},3829:(x,s,n)=>{n.d(s,{Ay:()=>b,JE:()=>l});var p=n(8355);function b(e,r){return!v(e,r)}function v(e,r){if(!r.value)return!0;const g=e.toLowerCase(),F=(0,p.R)(r),y=[],S=[];return F.forEach(N=>{if(N.startsWith("!")){const t=N.substring(1);t&&S.push(t)}else y.push(N)}),y.every(N=>g.includes(N))&&S.every(N=>!g.includes(N))}function l(e,r){return r.value!=null&&e<r.value}function E(e,r){return r.value!=null&&e>r.value}function a(e,r){return r.value&&e!==r.value}},4521:(x,s,n)=>{n.d(s,{z:()=>b});var p=n(3048);function b(v,l=null){return{createGlobalFilter(E,a=null,e=v){return p.V.create(E,a,e)},createSectionFilter(E,a=null,e=v){if(!l)throw new Error("sectionId must be provided to use createSectionFilter.");return p.V.createWithCompositeKey(l,E,a,e)}}}},5884:(x,s,n)=>{n.d(s,{Hw:()=>E,Nm:()=>v,nW:()=>l});var p=n(9928),b=n(5467);function v(a,e,r={},g={}){const F=(0,p.kU)(g,e.updateValueFromEvent,e.value);return(0,b.E2)(F,r,a)}function l(a,e,r,g,F,y={},S={}){const N=(0,p.o5)(S,e.updateValueFromEvent,e.value,r,g,F);return(0,b.E2)(N,y,a)}function E(a,e,r={},g={}){const F=(0,p.S)(g,e.updateValueFromEvent,e.value);return(0,b.E2)(F,r,a)}},7877:(x,s,n)=>{n.d(s,{E9:()=>b,HX:()=>v,X0:()=>E,pW:()=>T});var p=n(5884);function b(f,m={},h={}){return(0,p.Nm)("\u041F\u043E\u0438\u0441\u043A: ",f,m,h)}function v(f,m={},h={},L=.1,R=3){return(0,p.nW)("\u041C\u0438\u043D. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",f,L,R,5,m,h)}function l(f,m={},h={},L=.1,R=3){return createNumberFilterControl("\u041C\u0430\u043A\u0441. \u0440\u0435\u0439\u0442\u0438\u043D\u0433: ",f,L,R,5,m,h)}function E(f,m={},h={}){return e("\u041C\u0438\u043D. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",f,m,h)}function a(f,m={},h={}){return e("\u041C\u0430\u043A\u0441. \u043E\u0442\u0437\u044B\u0432\u043E\u0432: ",f,m,h)}function e(f,m,h={},L={}){return(0,p.nW)(f,m,"1","1","999999",h,L)}function r(f,m={},h={}){return g("\u041C\u0438\u043D. \u0441\u043A\u0438\u0434\u043A\u0430: ",f,m,h)}function g(f,m,h={},L={}){return createNumberFilterControl(f,m,"5","0","100",h,L)}function F(f,m={},h={}){return createNumberFilterControl("\u041C\u0438\u043D. \u043A\u0435\u0448\u0431\u0435\u043A: ",f,"5","0","100",m,h)}function y(f,m,h={},L={},R="250"){return createNumberFilterControl(f,m,R,"0","1000000",h,L)}function S(f,m={},h={},L="25"){return y("\u041C\u0438\u043D. \u0446\u0435\u043D\u0430: ",f,m,h,L)}function N(f,m={},h={},L="25"){return y("\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430: ",f,m,h,L)}function t(f,m={},h={}){return c("\u041C\u0438\u043D. \u043B\u0430\u0438\u0306\u043A\u043E\u0432: ",f,m,h)}function c(f,m,h={},L={}){return createNumberFilterControl(f,m,"1","0","99999",h,L)}function o(f,m={},h={}){return createNumberFilterControl("\u041A\u043E\u043B\u043E\u043D\u043E\u043A: ",f,"1","2","7",m,h)}function u(f,m={},h={}){return createNumberFilterControl("\u0421\u0442\u0440\u043E\u043A \u0438\u043C\u0435\u043D\u0438: ",f,1,1,10,m,h)}function C(f,m={},h={}){return createCheckboxFilterControl("\u0411\u0435\u0437 \u0440\u0435\u0439\u0442\u0438\u043D\u0433\u0430: ",f,m,h)}function d(f,m={},h={}){return createCheckboxFilterControl("\u0421 \u0444\u043E\u0442\u043E: ",f,m,h)}function I(f,m={},h={}){return createCheckboxFilterControl("\u041F\u0440\u043E\u0433\u0440\u0443\u0437\u043A\u0430: ",f,m,h)}function A(f,m={},h={}){return createCheckboxFilterControl("\u0411\u0430\u043B\u043B\u044B: ",f,m,h)}function T(f,m={},h={}){return(0,p.Hw)("\u0412\u043A\u043B: ",f,m,h)}},8355:(x,s,n)=>{n.d(s,{R:()=>p});function p(v){return v.value.toLowerCase().split(",").map(l=>l.trim()).filter(l=>l!=="")}function b(v){return p(v).filter(l=>!l.startsWith("!"))}},5213:(x,s,n)=>{n.d(s,{b:()=>v});var p=n(9928),b=n(573);function v(l,E,a=!1,e="customFiltersContainer"){let r=(0,b.Fi)(`#${e}`,l);if(r)if(a)r.remove();else return;r=(0,p.Sw)(),r.id=e,E(r,l)}},8200:(x,s,n)=>{n.d(s,{s:()=>p});function p(b){const{target:v}=b,{type:l}=v;switch(l){case"text":return`"${v.value}"`;case"number":return v.value;case"checkbox":return v.checked;default:return console.log(`Unknown input type: ${l}`),null}}},157:(x,s,n)=>{n.d(s,{Fg:()=>p,vx:()=>v});const p=window.GM_setValue,b=window.GM.setValue,v=window.GM_getValue,l=window.GM_addValueChangeListener},1870:(x,s,n)=>{n.d(s,{j:()=>p});class p{constructor(v,l){this.value=v,this.onChange=l}onChangeIfDefined=()=>{this.onChange&&this.onChange()}}},3048:(x,s,n)=>{n.d(s,{V:()=>E});var p=n(1870),b=n(8200),v=n(3976),l=n(157);class E extends p.j{constructor(e,r=null,g=null){super((0,l.vx)(e,r),g),this.storageKey=e,this.defaultValue=r}static create(e,r=null,g=null){return new E(e,r,g)}static createWithCompositeKey(e,r,g=null,F=null){const y=`${e}-${r}`;return new E(y,g,F)}updateValueFromEvent=e=>{const r=(0,b.s)(e),g=(0,v.$)(r);this.updateValue(g)};updateValue(e,r=!0){this.value!==e&&((0,l.Fg)(this.storageKey,e),this.value=e,r&&this.onChangeIfDefined())}clearValue(e=!1){this.updateValue(null,e)}resetValue(e=!1){this.updateValue(this.defaultValue,e)}}},3976:(x,s,n)=>{n.d(s,{$:()=>p});function p(b){return b===""?null:JSON.parse(b)}},4214:(x,s,n)=>{n.d(s,{zr:()=>b});function p(a){return a.replace(/\D/g,"")}function b(a){return a.replace(/[^\d.,-]/g,"")}function v(a){return a.replace(/\s/g,"")}function l(a){return a.charAt(0).toUpperCase()+a.slice(1)}function E(a){return a.replace(/\s+/g," ").trim()}},5406:(x,s,n)=>{n.d(s,{Fc:()=>p});function p(t,c="common",o=!1){const{pathname:u}=window.location;return b(u,t,c,o)}function b(t,c,o,u=!1){const d=t.split("/")[c]||o;return u&&console.log(`Pathname element: ${d}`),d}function v(t,c="common",o=!1){const u=p(t,"",o);return l(u,c,o)}function l(t,c,o){if(!t)return c;const u=t.split("-").at(-1);return o&&console.log(`Pathname element ending: ${u}`),u}function E(t,c,o="common",u=!1){const C=b(t,c,"",u);return l(C,o,u)}function a(t){return new URLSearchParams(window.location.search).get(t)}function e(t){return t.split("?")[0]}function r(t){return window.location.pathname.includes(t)}function g(t){return t.some(c=>r(c))}function F(t){return window.location.pathname.split("/").some(o=>o===t)}function y(t){try{const c=new URL(window.location.href);Object.entries(t).forEach(([o,u])=>{c.searchParams.set(o,u)}),window.location.href=c.toString()}catch(c){console.error("Failed to redirect:",c)}}function S(t,c=[]){const o={pathname:window.location.pathname};c.forEach(d=>{o[d]=a(d)});function u(){const d={pathname:window.location.pathname};c.forEach(I=>{d[I]=a(I)}),Object.keys(o).some(I=>o[I]!==d[I])&&t()}let C=window.location.href;setInterval(()=>{window.location.href!==C&&(C=window.location.href,u())},200),window.addEventListener("popstate",u)}function N(t=[]){S(()=>window.location.reload(),t)}},6220:(x,s,n)=>{n.a(x,async(p,b)=>{try{let I=function(f,m){(0,a.ZM)(f,y.r.filtersContainer);const h=(0,r.E9)(c,y.r.control,y.r.textInput),L=(0,r.X0)(o,y.r.control,y.r.numberInput),R=(0,r.HX)(u,y.r.control,y.r.numberInput),V=(0,r.pW)(C,y.r.control,y.r.checkboxInput);f.append(h,L,R,V),m.parentNode.insertBefore(f,m)},A=function(){(0,e.fI)(`${S.Z.PRODUCT_LIST} > div`).forEach(T)},T=function(f){if(!C.value){(0,a.kl)(f);return}const m=(0,e.Fi)(S.Z.PRODUCT_NAME_WRAP,f),h=(0,e.Fi)(S.Z.PRODUCT_RATING_WRAP,f);if(!m||!h){(0,a.Bt)(f);return}const L=m.innerText,R=(0,e.ML)(h.childNodes[2],!0),i=+(0,e.Fi)(S.Z.PRODUCT_RATING,h).getAttribute("value"),w=(0,E.Ay)(L,c)||(0,E.JE)(R,o)||(0,E.JE)(i,u);(0,a.UC)(f,w)};var v=n(4921),l=n(5213),E=n(3829),a=n(5539),e=n(573),r=n(7877),g=n(5406),F=n(4521),y=n(6504),S=n(4858);const N=(0,g.Fc)(2),{createSectionFilter:t}=(0,F.z)(A,N),c=t("name-filter"),o=t("min-reviews-filter"),u=t("min-rating-filter",4.8),C=t("filter-enabled",!0);await d();async function d(){if(!await(0,v.xk)(document,S.Z.PRODUCT_LIST_TOP))return;const m=(0,e.Fi)(S.Z.PRODUCT_LIST,document,!0);(0,l.b)(m,I,!0),new MutationObserver(A).observe(m,{childList:!0,subtree:!0})}b()}catch(N){b(N)}},1)},4858:(x,s,n)=>{n.d(s,{Z:()=>p});const p={PRODUCT_LIST:'[data-qa="listing"]',PRODUCT_LIST_TOP:"#product-listing-top",PRODUCT_NAME_WRAP:'[data-qa="product-name"]',PRODUCT_RATING_WRAP:'[data-qa="product-rating"]',PRODUCT_RATING:'[name="rating"]'}},6504:(x,s,n)=>{n.d(s,{r:()=>b});const p={input:{marginLeft:"5px",border:"1px solid #dadcde",borderRadius:"8px",padding:"8px 16px",fontSize:"16px"}},b={filtersContainer:{display:"flex",gridGap:"11px",marginBottom:"18px"},control:{display:"flex",alignItems:"center",fontSize:"16px"},textInput:{...p.input,width:"180px"},numberInput:{...p.input,width:"90px"},checkboxInput:{marginLeft:"5px",width:"22px",height:"22px"}}}},$={};function D(x){var s=$[x];if(s!==void 0)return s.exports;var n=$[x]={exports:{}};return B[x](n,n.exports,D),n.exports}(()=>{var x=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",s=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",n=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",p=v=>{v&&v.d<1&&(v.d=1,v.forEach(l=>l.r--),v.forEach(l=>l.r--?l.r++:l()))},b=v=>v.map(l=>{if(l!==null&&typeof l=="object"){if(l[x])return l;if(l.then){var E=[];E.d=0,l.then(r=>{a[s]=r,p(E)},r=>{a[n]=r,p(E)});var a={};return a[x]=r=>r(E),a}}var e={};return e[x]=r=>{},e[s]=l,e});D.a=(v,l,E)=>{var a;E&&((a=[]).d=-1);var e=new Set,r=v.exports,g,F,y,S=new Promise((N,t)=>{y=t,F=N});S[s]=r,S[x]=N=>(a&&N(a),e.forEach(N),S.catch(t=>{})),v.exports=S,l(N=>{g=b(N);var t,c=()=>g.map(u=>{if(u[n])throw u[n];return u[s]}),o=new Promise(u=>{t=()=>u(c),t.r=0;var C=d=>d!==a&&!e.has(d)&&(e.add(d),d&&!d.d&&(t.r++,d.push(t)));g.map(d=>d[x](C))});return t.r?o:c()},N=>(N?y(S[n]=N):F(r),p(a))),a&&a.d<0&&(a.d=0)}})(),D.d=(x,s)=>{for(var n in s)D.o(s,n)&&!D.o(x,n)&&Object.defineProperty(x,n,{enumerable:!0,get:s[n]})},D.o=(x,s)=>Object.prototype.hasOwnProperty.call(x,s);var z=D(6220)})();})();
